<html><head></head><body>
  <div id="_idContainer248">
   <h1 class="chapter-number" id="_idParaDest-318">
    <a id="_idTextAnchor322">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     8
    </span>
   </h1>
   <h1 id="_idParaDest-319">
    <a id="_idTextAnchor323">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     Compliance with GuardDuty, Macie, Inspector, and Analyzer
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.3.1">
     Regularly checking for compliance within our account and being notified if anything is not compliant is an important step toward keeping our account secure.
    </span>
    <span class="koboSpan" id="kobo.3.2">
     In this chapter, we will learn about some services within AWS that can help us in checking compliance, with the help of additional intelligence and rules.
    </span>
    <span class="koboSpan" id="kobo.3.3">
     We
    </span>
    <a id="_idIndexMarker957">
    </a>
    <span class="koboSpan" id="kobo.4.1">
     will learn about
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.5.1">
      Amazon GuardDuty
     </span>
    </strong>
    <span class="koboSpan" id="kobo.6.1">
     ,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.7.1">
      Amazon Macie
     </span>
    </strong>
    <span class="koboSpan" id="kobo.8.1">
     , and
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.9.1">
      Amazon Inspector
     </span>
    </strong>
    <span class="koboSpan" id="kobo.10.1">
     , which use machine learning
    </span>
    <a id="_idIndexMarker958">
    </a>
    <span class="koboSpan" id="kobo.11.1">
     and advanced algorithms
    </span>
    <a id="_idIndexMarker959">
    </a>
    <span class="koboSpan" id="kobo.12.1">
     to help us check for compliance.
    </span>
    <span class="koboSpan" id="kobo.12.2">
     AWS Config is another service that can help with compliance, but we already covered it in
    </span>
    <a href="B21384_07.xhtml#_idTextAnchor265">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.13.1">
        Chapter 7
       </span>
      </em>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.14.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.15.1">
     This chapter includes the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.16.1">
      following recipes:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.17.1">
      Setting up and using
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.18.1">
       Amazon GuardDuty
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.19.1">
      Aggregating findings from multiple accounts
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.20.1">
       in GuardDuty
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.21.1">
      Setting up and using
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.22.1">
       Amazon Macie
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.23.1">
      Setting up and using
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.24.1">
       Amazon Inspector
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.25.1">
      Setting up and using AWS
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.26.1">
       Security Hub
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.27.1">
      Using IAM Analyzer to inspect
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.28.1">
       unused access
      </span>
     </span>
    </li>
   </ul>
   <h1 id="_idParaDest-320">
    <a id="_idTextAnchor324">
    </a>
    <span class="koboSpan" id="kobo.29.1">
     Technical requirements
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.30.1">
     Before diving into the recipes of this chapter, we need to ensure that we have the following requirements and knowledge
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.31.1">
      in place:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.32.1">
      We need an active AWS Account to complete the recipes within this chapter.
     </span>
     <span class="koboSpan" id="kobo.32.2">
      If we are using an AWS Organization, we can use the management account of the Organization as we will be configuring many things at the AWS Organization level in this chapter.
     </span>
     <span class="koboSpan" id="kobo.32.3">
      I will be using the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.33.1">
       aws-sec-cookbook-1
      </span>
     </strong>
     <span class="koboSpan" id="kobo.34.1">
      account that we created in the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.35.1">
       Multi-account management with AWS Organizations
      </span>
     </em>
     <span class="koboSpan" id="kobo.36.1">
      recipe in
     </span>
     <a href="B21384_01.xhtml#_idTextAnchor020">
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.37.1">
         Chapter 1
        </span>
       </em>
      </span>
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.38.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.39.1">
      For administrative actions, we need a user who has
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.40.1">
       AdministratorAccess
      </span>
     </strong>
     <span class="koboSpan" id="kobo.41.1">
      permission to the AWS account we are
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.42.1">
       working with.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.43.1">
     Code files for this chapter are available
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.44.1">
      at
     </span>
    </span>
    <a href="https://github.com/PacktPublishing/AWS-Security-Cookbook-Second-Edition/tree/main/Chapter08">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.45.1">
       https://github.com/PacktPublishing/AWS-Security-Cookbook-Second-Edition/tree/main/Chapter08
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.46.1">
      .
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-321">
    <a id="_idTextAnchor325">
    </a>
    <span class="koboSpan" id="kobo.47.1">
     Setting up and using Amazon GuardDuty
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.48.1">
     In this recipe, we will learn
    </span>
    <a id="_idIndexMarker960">
    </a>
    <span class="koboSpan" id="kobo.49.1">
     how to set up
    </span>
    <a id="_idIndexMarker961">
    </a>
    <span class="koboSpan" id="kobo.50.1">
     and use Amazon GuardDuty.
    </span>
    <span class="koboSpan" id="kobo.50.2">
     GuardDuty analyzes data from sources such as CloudTrail management logs, VPC flow logs, and Route 53 DNS logs, and uses machine learning, anomaly detection, and integrated threat intelligence to find malicious activities and unauthorized behavior.
    </span>
    <span class="koboSpan" id="kobo.50.3">
     Note that if you use another DNS resolver, such as OpenDNS or GoogleDNS, or if you set up your own DNS resolvers, GuardDuty cannot access and process data from these sources.
    </span>
    <span class="koboSpan" id="kobo.50.4">
     GuardDuty can be integrated with CloudWatch and SNS to raise alarms and send notifications.
    </span>
    <span class="koboSpan" id="kobo.50.5">
     GuardDuty can also aggregate data from
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.51.1">
      multiple accounts.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-322">
    <a id="_idTextAnchor326">
    </a>
    <span class="koboSpan" id="kobo.52.1">
     Getting ready
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.53.1">
     To successfully complete this recipe, we will need a working AWS account and a user, as described in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.54.1">
      Technical requirements
     </span>
    </em>
    <span class="koboSpan" id="kobo.55.1">
     section.
    </span>
    <span class="koboSpan" id="kobo.55.2">
     We will also need an
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.56.1">
      S3 bucket.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-323">
    <a id="_idTextAnchor327">
    </a>
    <span class="koboSpan" id="kobo.57.1">
     How to do it...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.58.1">
     If we are using GuardDuty for the first time, we need to first enable GuardDuty.
    </span>
    <span class="koboSpan" id="kobo.58.2">
     Let us
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.59.1">
      get started:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.60.1">
      Go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.61.1">
       GuardDuty
      </span>
     </strong>
     <span class="koboSpan" id="kobo.62.1">
      service in the AWS
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.63.1">
       management console.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.64.1">
      If we are using GuardDuty for the first time, we should see options such as the following.
     </span>
     <span class="koboSpan" id="kobo.64.2">
      If GuardDuty is already enabled, proceed to
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.65.1">
        Step 4
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.66.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer231">
     <span class="koboSpan" id="kobo.67.1">
      <img alt="Figure 8.1 – Enabling GuardDuty" src="image/B21384_08_1.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.68.1">
     Figure 8.1 – Enabling GuardDuty
    </span>
   </p>
   <ol>
    <li value="3">
     <span class="koboSpan" id="kobo.69.1">
      Select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.70.1">
       Amazon GuardDuty - all features
      </span>
     </strong>
     <span class="koboSpan" id="kobo.71.1">
      and click
     </span>
     <a id="_idIndexMarker962">
     </a>
     <span class="koboSpan" id="kobo.72.1">
      on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.73.1">
       Get started
      </span>
     </strong>
     <span class="koboSpan" id="kobo.74.1">
      .
     </span>
     <span class="koboSpan" id="kobo.74.2">
      We should
     </span>
     <a id="_idIndexMarker963">
     </a>
     <span class="koboSpan" id="kobo.75.1">
      now see the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.76.1">
       Welcome to GuardDuty
      </span>
     </strong>
     <span class="koboSpan" id="kobo.77.1">
      screen; click on
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.78.1">
        Enable GuardDuty
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.79.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.80.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.81.1">
       Findings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.82.1">
      in the left sidebar on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.83.1">
       GuardDuty
      </span>
     </strong>
     <span class="koboSpan" id="kobo.84.1">
      dashboard.
     </span>
     <span class="koboSpan" id="kobo.84.2">
      We can see the findings categorized as
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.85.1">
       High
      </span>
     </strong>
     <span class="koboSpan" id="kobo.86.1">
      ,
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.87.1">
       Medium
      </span>
     </strong>
     <span class="koboSpan" id="kobo.88.1">
      , and
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.89.1">
       Low
      </span>
     </strong>
     <span class="koboSpan" id="kobo.90.1">
      here.
     </span>
     <span class="koboSpan" id="kobo.90.2">
      As we have just enabled it, you may not see any
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.91.1">
       findings initially.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer232">
     <span class="koboSpan" id="kobo.92.1">
      <img alt="Figure 8.2 – The Findings screen" src="image/B21384_08_2.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.93.1">
     Figure 8.2 – The Findings screen
    </span>
   </p>
   <ol>
    <li value="5">
     <span class="koboSpan" id="kobo.94.1">
      We can click on any of the events
     </span>
     <a id="_idIndexMarker964">
     </a>
     <span class="koboSpan" id="kobo.95.1">
      to see additional information
     </span>
     <a id="_idIndexMarker965">
     </a>
     <span class="koboSpan" id="kobo.96.1">
      provided about that finding.
     </span>
     <span class="koboSpan" id="kobo.96.2">
      We can then scroll down to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.97.1">
       Action
      </span>
     </strong>
     <span class="koboSpan" id="kobo.98.1">
      ,
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.99.1">
       Target
      </span>
     </strong>
     <span class="koboSpan" id="kobo.100.1">
      , and
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.101.1">
       Additional information
      </span>
     </strong>
     <span class="koboSpan" id="kobo.102.1">
      sections to learn more about
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.103.1">
       the event.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.104.1">
     Next, we will whitelist and blacklist IPs
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.105.1">
      in GuardDuty.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.106.1">
     Whitelisting and blacklisting IPs in GuardDuty
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.107.1">
     We can whitelist
    </span>
    <a id="_idIndexMarker966">
    </a>
    <span class="koboSpan" id="kobo.108.1">
     and blacklist
    </span>
    <a id="_idIndexMarker967">
    </a>
    <span class="koboSpan" id="kobo.109.1">
     IPs in GuardDuty
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.110.1">
      as follows:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.111.1">
      Create and upload the following two files, one with trusted IPs and one with threat lists, and upload them into an
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.112.1">
       S3 bucket:
      </span>
     </span>
     <ul>
      <li>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.113.1">
         trusted-ips.txt
        </span>
       </strong>
       <span class="koboSpan" id="kobo.114.1">
        : This is a text file with the list of IPs and CIDR ranges we want to trust.
       </span>
       <span class="koboSpan" id="kobo.114.2">
        Each IP or CIDR range should be on its
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.115.1">
         own line.
        </span>
       </span>
      </li>
     </ul>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer233">
     <span class="koboSpan" id="kobo.116.1">
      <img alt="Figure 8.3 – The trusted-ips file" src="image/B21384_08_3.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.117.1">
     Figure 8.3 – The trusted-ips file
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.118.1">
       threat-lists.txt
      </span>
     </strong>
     <span class="koboSpan" id="kobo.119.1">
      : This is a text file
     </span>
     <a id="_idIndexMarker968">
     </a>
     <span class="koboSpan" id="kobo.120.1">
      with the list of IPs
     </span>
     <a id="_idIndexMarker969">
     </a>
     <span class="koboSpan" id="kobo.121.1">
      and CIDR ranges we want to add to the suspicious IP list.
     </span>
     <span class="koboSpan" id="kobo.121.2">
      Each IP or CIDR range should be on its
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.122.1">
       own line.
      </span>
     </span>
    </li>
   </ul>
   <div>
    <div class="IMG---Figure" id="_idContainer234">
     <span class="koboSpan" id="kobo.123.1">
      <img alt="Figure 8.4 – The threat-list file" src="image/B21384_08_4.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.124.1">
     Figure 8.4 – The threat-list file
    </span>
   </p>
   <ol>
    <li value="2">
     <span class="koboSpan" id="kobo.125.1">
      Now, go back to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.126.1">
       GuardDuty
      </span>
     </strong>
     <span class="koboSpan" id="kobo.127.1">
      dashboard.
     </span>
     <span class="koboSpan" id="kobo.127.2">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.128.1">
       Lists
      </span>
     </strong>
     <span class="koboSpan" id="kobo.129.1">
      in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.130.1">
       left sidebar.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.131.1">
      Under
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.132.1">
       Trusted IP lists
      </span>
     </strong>
     <span class="koboSpan" id="kobo.133.1">
      , click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.134.1">
       Add a trusted
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.135.1">
        IP list
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.136.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.137.1">
      In the pop-up screen named
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.138.1">
       Add a trusted IP list
      </span>
     </strong>
     <span class="koboSpan" id="kobo.139.1">
      , give a name to our list in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.140.1">
       List name
      </span>
     </strong>
     <span class="koboSpan" id="kobo.141.1">
      field.
     </span>
     <span class="koboSpan" id="kobo.141.2">
      For
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.142.1">
       Location
      </span>
     </strong>
     <span class="koboSpan" id="kobo.143.1">
      , enter the S3 URL of your trusted IP list, which is of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.144.1">
       https://myguarddutydemo.s3.amazonaws.com/trusted-ips.txt
      </span>
     </strong>
     <span class="koboSpan" id="kobo.145.1">
      form.
     </span>
     <span class="koboSpan" id="kobo.145.2">
      For
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.146.1">
       Format
      </span>
     </strong>
     <span class="koboSpan" id="kobo.147.1">
      , select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.148.1">
       Plaintext
      </span>
     </strong>
     <span class="koboSpan" id="kobo.149.1">
      .
     </span>
     <span class="koboSpan" id="kobo.149.2">
      Then select the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.150.1">
       I agree
      </span>
     </strong>
     <span class="koboSpan" id="kobo.151.1">
      checkbox.
     </span>
     <span class="koboSpan" id="kobo.151.2">
      Finally, click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.152.1">
       Add list
      </span>
     </strong>
     <span class="koboSpan" id="kobo.153.1">
      .
     </span>
     <span class="koboSpan" id="kobo.153.2">
      We should now see our list under T
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.154.1">
       rusted
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.155.1">
        IP lists
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.156.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.157.1">
      Click the checkbox beside our list.
     </span>
     <span class="koboSpan" id="kobo.157.2">
      Click on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.158.1">
       Action
      </span>
     </strong>
     <span class="koboSpan" id="kobo.159.1">
      dropdown and click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.160.1">
       Activate
      </span>
     </strong>
     <span class="koboSpan" id="kobo.161.1">
      .
     </span>
     <span class="koboSpan" id="kobo.161.2">
      We should see a success message indicating that the list has been activated.
     </span>
     <span class="koboSpan" id="kobo.161.3">
      It may take some time for the changes to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.162.1">
       take effect.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.163.1">
      Under
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.164.1">
       Threat IP lists
      </span>
     </strong>
     <span class="koboSpan" id="kobo.165.1">
      , click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.166.1">
       Add a threat IP list
      </span>
     </strong>
     <span class="koboSpan" id="kobo.167.1">
      .
     </span>
     <span class="koboSpan" id="kobo.167.2">
      We should see a pop-up screen named
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.168.1">
       Add a threat
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.169.1">
        IP list
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.170.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.171.1">
      Repeat
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.172.1">
       Steps 3
      </span>
     </em>
     <em class="italic">
      <span class="koboSpan" id="kobo.173.1">
       to
      </span>
     </em>
     <em class="italic">
      <span class="koboSpan" id="kobo.174.1">
       5
      </span>
     </em>
     <span class="koboSpan" id="kobo.175.1">
      but add our threat list instead of a trusted IP list.
     </span>
     <span class="koboSpan" id="kobo.175.2">
      We should see our list under
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.176.1">
       Threat
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.177.1">
        IP lists
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.178.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.179.1">
      To verify that the trusted and threat IP lists are working correctly, we can simulate traffic from IPs in our lists and check the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.180.1">
       GuardDuty findings:
      </span>
     </span>
     <ul>
      <li>
       <strong class="bold">
        <span class="koboSpan" id="kobo.181.1">
         Whitelisted IPs
        </span>
       </strong>
       <span class="koboSpan" id="kobo.182.1">
        (
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.183.1">
         Trusted IPs
        </span>
       </strong>
       <span class="koboSpan" id="kobo.184.1">
        ): Generate traffic from an IP
       </span>
       <a id="_idIndexMarker970">
       </a>
       <span class="koboSpan" id="kobo.185.1">
        address that is in our
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.186.1">
         trusted-ips.txt
        </span>
       </strong>
       <span class="koboSpan" id="kobo.187.1">
        file.
       </span>
       <span class="koboSpan" id="kobo.187.2">
        Monitor GuardDuty findings to ensure that this traffic is not flagged as suspicious
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.188.1">
         or malicious.
        </span>
       </span>
      </li>
      <li>
       <strong class="bold">
        <span class="koboSpan" id="kobo.189.1">
         Blacklisted IPs
        </span>
       </strong>
       <span class="koboSpan" id="kobo.190.1">
        (
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.191.1">
         Threat IPs
        </span>
       </strong>
       <span class="koboSpan" id="kobo.192.1">
        ): Generate traffic from an IP address
       </span>
       <a id="_idIndexMarker971">
       </a>
       <span class="koboSpan" id="kobo.193.1">
        that is in our threat-lists.txt file.
       </span>
       <span class="koboSpan" id="kobo.193.2">
        Check the GuardDuty findings to confirm that this traffic is flagged as suspicious
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.194.1">
         or malicious.
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="koboSpan" id="kobo.195.1">
      Review the GuardDuty dashboard and findings to ensure that the whitelisted IPs are not generating any alerts and that the blacklisted IPs are flagged appropriately.
     </span>
     <span class="koboSpan" id="kobo.195.2">
      This will confirm that our lists are being used effectively
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.196.1">
       by GuardDuty.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.197.1">
     In this section, we whitelisted
    </span>
    <a id="_idIndexMarker972">
    </a>
    <span class="koboSpan" id="kobo.198.1">
     and blacklisted a few IP addresses
    </span>
    <a id="_idIndexMarker973">
    </a>
    <span class="koboSpan" id="kobo.199.1">
     by adding them to the trusted IP lists and threat lists, respectively.
    </span>
    <span class="koboSpan" id="kobo.199.2">
     We will learn more about how they work in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.200.1">
      How it works...
     </span>
    </em>
    <span class="koboSpan" id="kobo.201.1">
     section of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.202.1">
      this recipe.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-324">
    <a id="_idTextAnchor328">
    </a>
    <span class="koboSpan" id="kobo.203.1">
     How it works...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.204.1">
     We first enabled GuardDuty.
    </span>
    <span class="koboSpan" id="kobo.204.2">
     When we enabled GuardDuty, we granted it permissions to analyze various logs and data sources, such as VPC Flow logs, AWS CloudTrail management event logs, DNS query logs, AWS CloudTrail S3 data event logs, EKS audit logs, Lambda network activity logs, and RDS login activity logs, to generate security findings, as you should have seen while doing
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.205.1">
      Step 3
     </span>
    </em>
    <span class="koboSpan" id="kobo.206.1">
     of the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.207.1">
      How to do it...
     </span>
    </em>
    <span class="koboSpan" id="kobo.208.1">
     section for this recipe.
    </span>
    <span class="koboSpan" id="kobo.208.2">
     Additionally, GuardDuty can analyze
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.209.1">
      Elastic Block Storage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.210.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.211.1">
      EBS
     </span>
    </strong>
    <span class="koboSpan" id="kobo.212.1">
     ) volume data to detect
    </span>
    <a id="_idIndexMarker974">
    </a>
    <span class="koboSpan" id="kobo.213.1">
     malware.
    </span>
    <span class="koboSpan" id="kobo.213.2">
     When we enable GuardDuty in a supported region for the first time, our account is automatically enrolled in a 30-day free trial, which may also include some protection plans
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.214.1">
      by default.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.215.1">
     By default, when we first enable
    </span>
    <a id="_idIndexMarker975">
    </a>
    <span class="koboSpan" id="kobo.216.1">
     GuardDuty, all protection plans
    </span>
    <a id="_idIndexMarker976">
    </a>
    <span class="koboSpan" id="kobo.217.1">
     are activated, except for Runtime Monitoring and Malware Protection for S3.
    </span>
    <span class="koboSpan" id="kobo.217.2">
     These can be enabled through the GuardDuty console or APIs.
    </span>
    <span class="koboSpan" id="kobo.217.3">
     Usage of GuardDuty’s Malware Protection and Runtime Monitoring services is governed by the Amazon GuardDuty Service Terms.
    </span>
    <span class="koboSpan" id="kobo.217.4">
     We can suspend or disable GuardDuty or any specific protection plan at any time to stop it from processing and analyzing data, events, and logs.
    </span>
    <span class="koboSpan" id="kobo.217.5">
     However, suspending or disabling GuardDuty does not affect Malware Protection for S3.
    </span>
    <span class="koboSpan" id="kobo.217.6">
     To stop malware scanning of our S3 buckets, we must individually delete the Malware Protection plan for each bucket.
    </span>
    <span class="koboSpan" id="kobo.217.7">
     Note that GuardDuty does not manage or provide access to the logs and data it analyzes; we can configure these data sources through their respective consoles
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.218.1">
      or APIs.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.219.1">
     For testing purposes, we generated sample findings from the GuardDuty console; GuardDuty generated 54 sample events (in my case – it could vary for you since GuardDuty adds and deprecates finding types throughout the year).
    </span>
    <span class="koboSpan" id="kobo.219.2">
     GuardDuty events are categorized into three severity levels, from lowest to highest, denoted by blue, yellow, and red icons, where blue is the least severe and red is the most severe.
    </span>
    <span class="koboSpan" id="kobo.219.3">
     Once we click on a finding, we will get additional information about
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.220.1">
      the finding.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.221.1">
     We whitelisted and blacklisted a few IP addresses by adding them to the trusted IP and threat lists, respectively.
    </span>
    <span class="koboSpan" id="kobo.221.2">
     GuardDuty will not generate findings for IP addresses that are included in the trusted IP lists.
    </span>
    <span class="koboSpan" id="kobo.221.3">
     This is done to avoid false alarms, especially from company IP addresses.
    </span>
    <span class="koboSpan" id="kobo.221.4">
     However, we need to keep in mind that attacks can be internal too.
    </span>
    <span class="koboSpan" id="kobo.221.5">
     Threat lists consist of known malicious IP addresses.
    </span>
    <span class="koboSpan" id="kobo.221.6">
     The addresses we provide will be used along with the ones already available with AWS based on their research
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.222.1">
      and experiences.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.223.1">
     We can add an IP or a CIDR range to the trusted IP lists and threat lists
    </span>
    <a id="_idIndexMarker977">
    </a>
    <span class="koboSpan" id="kobo.224.1">
     in various formats, such as plain text (an IP or a CIDR per line),
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.225.1">
      Structured Threat Information Expression
     </span>
    </strong>
    <span class="koboSpan" id="kobo.226.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.227.1">
      STIX
     </span>
    </strong>
    <span class="koboSpan" id="kobo.228.1">
     ),
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.229.1">
      Open Threat Exchange
     </span>
    </strong>
    <span class="koboSpan" id="kobo.230.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.231.1">
      OTX
     </span>
    </strong>
    <span class="koboSpan" id="kobo.232.1">
     ) CSV, FireEye iSIGHT Threat Intelligence
    </span>
    <a id="_idIndexMarker978">
    </a>
    <span class="koboSpan" id="kobo.233.1">
     CSV, Proofpoint ET Intelligence Feed CSV, and AlienVault Reputation Feed.
    </span>
    <span class="koboSpan" id="kobo.233.2">
     Currently, we can have up to 2,000 lines in a trusted IP list and 250,000 lines in a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.234.1">
      threat list.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-325">
    <a id="_idTextAnchor329">
    </a>
    <span class="koboSpan" id="kobo.235.1">
     There’s more...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.236.1">
     As a new feature, Amazon GuardDuty Malware Protection for S3 detects malicious file uploads to our selected Amazon S3 buckets.
    </span>
    <span class="koboSpan" id="kobo.236.2">
     We can enable Malware Protection for S3 for a bucket that belongs to our own account and monitor the malware scan status using the embedded Amazon CloudWatch metrics in the GuardDuty console.
    </span>
    <span class="koboSpan" id="kobo.236.3">
     We have seen this option in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.237.1">
       Figure 8
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.238.1">
       .1
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.239.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.240.1">
     Let’s go through some important concepts
    </span>
    <a id="_idIndexMarker979">
    </a>
    <span class="koboSpan" id="kobo.241.1">
     related
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.242.1">
      to GuardDuty:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.243.1">
      GuardDuty can detect compromised EC2 instances by analyzing VPC flow logs—for example, GuardDuty
     </span>
     <a id="_idIndexMarker980">
     </a>
     <span class="koboSpan" id="kobo.244.1">
      can detect whether an instance is used in a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.245.1">
       Denial of Service
      </span>
     </strong>
     <span class="koboSpan" id="kobo.246.1">
      (
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.247.1">
        DOS
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.248.1">
       ) attack.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.249.1">
      GuardDuty can detect whether our instances have been used for cryptocurrency mining.
     </span>
     <span class="koboSpan" id="kobo.249.2">
      It can also detect whether our credentials have been stolen by accessing malicious IPs, using EC2 instance profiles outside of EC2, or making anomalous API calls to AWS resources such as S3, EC2, RDS, and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.250.1">
       so on.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.251.1">
      GuardDuty can scan for and detect malicious artifacts in EC2 instances and EKS infrastructure.
     </span>
     <span class="koboSpan" id="kobo.251.2">
      It can also help identify malicious file uploads to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.252.1">
       S3 buckets.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.253.1">
      GuardDuty is a regional service.
     </span>
     <span class="koboSpan" id="kobo.253.2">
      Even when multiple accounts are enabled and multiple AWS regions are used, the GuardDuty security findings remain in the same regions where the underlying data
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.254.1">
       was generated.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.255.1">
      We can aggregate GuardDuty findings across different accounts into one account.
     </span>
     <span class="koboSpan" id="kobo.255.2">
      We will discuss this in the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.256.1">
       Aggregating findings from multiple accounts in
      </span>
     </em>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.257.1">
        GuardDuty
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.258.1">
       recipe.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.259.1">
      We can export GuardDuty findings across different accounts and regions to an Amazon S3 bucket to simplify the aggregation of all the findings.
     </span>
     <span class="koboSpan" id="kobo.259.2">
      This is a new feature and is different from aggregating findings across different accounts into
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.260.1">
       one account.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.261.1">
      We can use CloudWatch and SNS to monitor GuardDuty findings and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.262.1">
       send notifications.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.263.1">
      GuardDuty pricing is based on the amount of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.264.1">
       data analyzed:
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.265.1">
        For VPC flow log and DNS log analysis, GuardDuty charges us based on the size of the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.266.1">
         data analyzed.
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.267.1">
        For CloudTrail events, GuardDuty charges us based on the number of
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.268.1">
         events analyzed.
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="koboSpan" id="kobo.269.1">
      GuardDuty supports
     </span>
     <a id="_idIndexMarker981">
     </a>
     <span class="koboSpan" id="kobo.270.1">
      the processing, storage, and transmission of credit card data by a merchant
     </span>
     <a id="_idIndexMarker982">
     </a>
     <span class="koboSpan" id="kobo.271.1">
      or service provider, and has been validated
     </span>
     <a id="_idIndexMarker983">
     </a>
     <span class="koboSpan" id="kobo.272.1">
      as being compliant with the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.273.1">
       Payment Card Industry
      </span>
     </strong>
     <span class="koboSpan" id="kobo.274.1">
      (
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.275.1">
       PCI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.276.1">
      )
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.277.1">
       Data Security
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.278.1">
        Standard
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.279.1">
       (
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.280.1">
        DSS
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.281.1">
       )
      </span>
     </span>
    </li>
   </ul>
   <h3>
    <span class="koboSpan" id="kobo.282.1">
     Setting up Amazon EventBridge to monitor our findings from GuardDuty
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.283.1">
     The steps to set up
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.284.1">
      Amazon EventBridge
     </span>
    </strong>
    <span class="koboSpan" id="kobo.285.1">
     to monitor our findings
    </span>
    <a id="_idIndexMarker984">
    </a>
    <span class="koboSpan" id="kobo.286.1">
     from GuardDuty
    </span>
    <a id="_idIndexMarker985">
    </a>
    <span class="koboSpan" id="kobo.287.1">
     can be summarized
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.288.1">
      as follows:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.289.1">
      Go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.290.1">
       EventBridge
      </span>
     </strong>
     <span class="koboSpan" id="kobo.291.1">
      service in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.292.1">
       management console.
      </span>
     </span>
    </li>
   </ol>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.293.1">
     Important note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.294.1">
     EventBridge was formerly known
    </span>
    <a id="_idIndexMarker986">
    </a>
    <span class="koboSpan" id="kobo.295.1">
     as Amazon CloudWatch Events.
    </span>
    <span class="koboSpan" id="kobo.295.2">
     As of now, if we navigate to CloudWatch and click on
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.296.1">
      Rules
     </span>
    </strong>
    <span class="koboSpan" id="kobo.297.1">
     under the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.298.1">
      Events
     </span>
    </strong>
    <span class="koboSpan" id="kobo.299.1">
     section, we will be redirected to the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.300.1">
      EventBridge console.
     </span>
    </span>
   </p>
   <ol>
    <li value="2">
     <span class="koboSpan" id="kobo.301.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.302.1">
       Rules
      </span>
     </strong>
     <span class="koboSpan" id="kobo.303.1">
      under
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.304.1">
       Buses
      </span>
     </strong>
     <span class="koboSpan" id="kobo.305.1">
      from the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.306.1">
       left sidebar.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.307.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.308.1">
       Create rule
      </span>
     </strong>
     <span class="koboSpan" id="kobo.309.1">
      to go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.310.1">
       Create
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.311.1">
        rule
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.312.1">
       page.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.313.1">
      On the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.314.1">
       Define rule detail
      </span>
     </strong>
     <span class="koboSpan" id="kobo.315.1">
      page, provide a name and description for our rule.
     </span>
     <span class="koboSpan" id="kobo.315.2">
      Leave the value for
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.316.1">
       Event bus
      </span>
     </strong>
     <span class="koboSpan" id="kobo.317.1">
      as
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.318.1">
       default
      </span>
     </strong>
     <span class="koboSpan" id="kobo.319.1">
      and
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.320.1">
       Rule type
      </span>
     </strong>
     <span class="koboSpan" id="kobo.321.1">
      as
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.322.1">
       Rule with an event pattern
      </span>
     </strong>
     <span class="koboSpan" id="kobo.323.1">
      and click
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.324.1">
       on
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.325.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.326.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.327.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.328.1">
       Build event pattern
      </span>
     </strong>
     <span class="koboSpan" id="kobo.329.1">
      section, scroll down to
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.330.1">
        Event pattern
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.331.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.332.1">
      Set
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.333.1">
       Event source
      </span>
     </strong>
     <span class="koboSpan" id="kobo.334.1">
      to
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.335.1">
       AWS events or Eventbridge
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.336.1">
        partner events
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.337.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.338.1">
      Set
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.339.1">
       AWS service
      </span>
     </strong>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.340.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.341.1">
        GuardDuty
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.342.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.343.1">
      Set
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.344.1">
       Event Type
      </span>
     </strong>
     <span class="koboSpan" id="kobo.345.1">
      to
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.346.1">
        GuardDuty Finding
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.347.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.348.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.349.1">
       Next
      </span>
     </strong>
     <span class="koboSpan" id="kobo.350.1">
      .
     </span>
     <span class="koboSpan" id="kobo.350.2">
      Under
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.351.1">
       Targets
      </span>
     </strong>
     <span class="koboSpan" id="kobo.352.1">
      , do
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.353.1">
       the following:
      </span>
     </span>
     <ol>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.354.1">
        Under
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.355.1">
         Select a target
        </span>
       </strong>
       <span class="koboSpan" id="kobo.356.1">
        , select
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.357.1">
         SNS topic
        </span>
       </strong>
       <span class="koboSpan" id="kobo.358.1">
        from
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.359.1">
         the dropdown.
        </span>
       </span>
      </li>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.360.1">
        Select a topic.
       </span>
       <span class="koboSpan" id="kobo.360.2">
        You can create an SNS topic by following the
       </span>
       <em class="italic">
        <span class="koboSpan" id="kobo.361.1">
         Creating an SNS topic to send emails
        </span>
       </em>
       <span class="koboSpan" id="kobo.362.1">
        recipe in
       </span>
       <a href="B21384_07.xhtml#_idTextAnchor265">
        <span class="No-Break">
         <em class="italic">
          <span class="koboSpan" id="kobo.363.1">
           Chapter 7
          </span>
         </em>
        </span>
       </a>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.364.1">
         .
        </span>
       </span>
      </li>
     </ol>
    </li>
    <li>
     <span class="koboSpan" id="kobo.365.1">
      Click
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.366.1">
       on
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.367.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.368.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.369.1">
      Optionally, click
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.370.1">
       Add new tags
      </span>
     </strong>
     <span class="koboSpan" id="kobo.371.1">
      and click
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.372.1">
       on
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.373.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.374.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.375.1">
      Review the rule and click on
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.376.1">
        Create rule
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.377.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.378.1">
      Navigate back to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.379.1">
       GuardDuty
      </span>
     </strong>
     <span class="koboSpan" id="kobo.380.1">
      service and click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.381.1">
       Settings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.382.1">
      on the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.383.1">
       left sidebar.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.384.1">
      Scroll down to
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.385.1">
       Sample findings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.386.1">
      and click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.387.1">
       Generate sample findings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.388.1">
      .
     </span>
     <span class="koboSpan" id="kobo.388.2">
      After some time, check the inbox of the email address we configured for our SNS topic, and we should get an email about our
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.389.1">
       GuardDuty findings.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.390.1">
      To configure and modify
     </span>
     <a id="_idIndexMarker987">
     </a>
     <span class="koboSpan" id="kobo.391.1">
      the frequency
     </span>
     <a id="_idIndexMarker988">
     </a>
     <span class="koboSpan" id="kobo.392.1">
      with which GuardDuty updates Event Bridge and S3, we can go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.393.1">
       GuardDuty
      </span>
     </strong>
     <span class="koboSpan" id="kobo.394.1">
      service, click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.395.1">
       Settings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.396.1">
      from the left sidebar, and
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.397.1">
       Edit
      </span>
     </strong>
     <span class="koboSpan" id="kobo.398.1">
      in the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.399.1">
       Findings export
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.400.1">
        options
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.401.1">
       section.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.402.1">
      If we have not yet configured the export to S3, we will be provided with a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.403.1">
       Configure now
      </span>
     </strong>
     <span class="koboSpan" id="kobo.404.1">
      option to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.405.1">
       configure it.
      </span>
     </span>
    </li>
   </ol>
   <h2 id="_idParaDest-326">
    <a id="_idTextAnchor330">
    </a>
    <span class="koboSpan" id="kobo.406.1">
     See also
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.407.1">
     Read more about
    </span>
    <a id="_idIndexMarker989">
    </a>
    <span class="koboSpan" id="kobo.408.1">
     GuardDuty
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.409.1">
      at
     </span>
    </span>
    <a href="https://www.cloudericks.com/blog/getting-started-with-amazon-guardduty">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.410.1">
       https://www.cloudericks.com/blog/getting-started-with-amazon-guardduty
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.411.1">
      .
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-327">
    <a id="_idTextAnchor331">
    </a>
    <span class="koboSpan" id="kobo.412.1">
     Aggregating findings from multiple accounts in GuardDuty
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.413.1">
     In this recipe, we
    </span>
    <a id="_idIndexMarker990">
    </a>
    <span class="koboSpan" id="kobo.414.1">
     will configure GuardDuty to
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.415.1">
      aggregate findings
     </span>
    </strong>
    <span class="koboSpan" id="kobo.416.1">
     from multiple AWS accounts
    </span>
    <a id="_idIndexMarker991">
    </a>
    <span class="koboSpan" id="kobo.417.1">
     into a single account.
    </span>
    <span class="koboSpan" id="kobo.417.2">
     Aggregating findings from multiple accounts into a single dedicated account provides a central place to query the findings from all our accounts.
    </span>
    <span class="koboSpan" id="kobo.417.3">
     We can also make configuration changes in one place for all
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.418.1">
      the accounts.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-328">
    <a id="_idTextAnchor332">
    </a>
    <span class="koboSpan" id="kobo.419.1">
     Getting ready
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.420.1">
     We need the following to successfully complete
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.421.1">
      this recipe:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.422.1">
      Two working AWS accounts are required.
     </span>
     <span class="koboSpan" id="kobo.422.2">
      We will call them the aggregate account and the logger account.
     </span>
     <span class="koboSpan" id="kobo.422.3">
      The aggregate account will aggregate logs from the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.423.1">
       member account.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.424.1">
      Note down the AWS account ID and the email address of the member account.
     </span>
     <span class="koboSpan" id="kobo.424.2">
      If we are using AWS Organizations and IAM Identity Center, as we saw in
     </span>
     <a href="B21384_01.xhtml#_idTextAnchor020">
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.425.1">
         Chapter 1
        </span>
       </em>
      </span>
     </a>
     <span class="koboSpan" id="kobo.426.1">
      , we can get these from the management account within the AWS Organizations service or the IAM Identity
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.427.1">
       Center service.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.428.1">
      We should enable GuardDuty in the aggregate account and member by following the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.429.1">
       Setting up and using Amazon GuardDuty
      </span>
     </em>
     <span class="koboSpan" id="kobo.430.1">
      recipe from
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.431.1">
       this chapter.
      </span>
     </span>
    </li>
   </ul>
   <h2 id="_idParaDest-329">
    <a id="_idTextAnchor333">
    </a>
    <span class="koboSpan" id="kobo.432.1">
     How to do it...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.433.1">
     We can configure GuardDuty
    </span>
    <a id="_idIndexMarker992">
    </a>
    <span class="koboSpan" id="kobo.434.1">
     to aggregate the findings
    </span>
    <a id="_idIndexMarker993">
    </a>
    <span class="koboSpan" id="kobo.435.1">
     from member accounts
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.436.1">
      as follows:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.437.1">
      Go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.438.1">
       GuardDuty
      </span>
     </strong>
     <span class="koboSpan" id="kobo.439.1">
      service in the management console of the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.440.1">
       aggregate account.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.441.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.442.1">
       Accounts
      </span>
     </strong>
     <span class="koboSpan" id="kobo.443.1">
      from the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.444.1">
       left sidebar.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.445.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.446.1">
       Add accounts
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.447.1">
        by invitation
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.448.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.449.1">
      Enter the AWS account ID and email address for the member account.
     </span>
     <span class="koboSpan" id="kobo.449.2">
      Click
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.450.1">
       on
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.451.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.452.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.453.1">
      We should see our account on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.454.1">
       Accounts
      </span>
     </strong>
     <span class="koboSpan" id="kobo.455.1">
      page.
     </span>
     <span class="koboSpan" id="kobo.455.2">
      The
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.456.1">
       Status
      </span>
     </strong>
     <span class="koboSpan" id="kobo.457.1">
      field will have the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.458.1">
       Invite not
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.459.1">
        sent
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.460.1">
       value.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.461.1">
      Select the account we just added, click on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.462.1">
       Actions
      </span>
     </strong>
     <span class="koboSpan" id="kobo.463.1">
      dropdown, and click
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.464.1">
       on
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.465.1">
        Invite
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.466.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.467.1">
      On the pop-up screen, you may optionally provide a message.
     </span>
     <span class="koboSpan" id="kobo.467.2">
      Leave the selection for
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.468.1">
       Also send an email notification to the root user on the invitee’s AWS account and generate an alert in the invitee’s Personal Health Dashboard
      </span>
     </strong>
     <span class="koboSpan" id="kobo.469.1">
      unchecked and click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.470.1">
       Send invitation.
      </span>
     </strong>
     <span class="koboSpan" id="kobo.471.1">
      The status of our account should change
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.472.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.473.1">
        Invited
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.474.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.475.1">
      Go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.476.1">
       GuardDuty
      </span>
     </strong>
     <span class="koboSpan" id="kobo.477.1">
      service in the management console of the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.478.1">
       member account.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.479.1">
      If we are enabling GuardDuty now, we will be taken to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.480.1">
       Invitations
      </span>
     </strong>
     <span class="koboSpan" id="kobo.481.1">
      page after enabling.
     </span>
     <span class="koboSpan" id="kobo.481.2">
      Otherwise, go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.482.1">
       Accounts
      </span>
     </strong>
     <span class="koboSpan" id="kobo.483.1">
      page from the left sidebar and click
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.484.1">
        Accept invitation
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.485.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.486.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.487.1">
       Settings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.488.1">
      from the left sidebar to go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.489.1">
       Settings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.490.1">
      page and click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.491.1">
       Generate
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.492.1">
        sample findings
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.493.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.494.1">
      Go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.495.1">
       GuardDuty
      </span>
     </strong>
     <span class="koboSpan" id="kobo.496.1">
      dashboard in the aggregator account and check for findings from our
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.497.1">
       member account.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.498.1">
     In this recipe, we configured a member account to send logs to an aggregator account.
    </span>
    <span class="koboSpan" id="kobo.498.2">
     The aggregate account will aggregate logs from the member account that we added and any other member accounts we will
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.499.1">
      add later.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-330">
    <a id="_idTextAnchor334">
    </a>
    <span class="koboSpan" id="kobo.500.1">
     How it works...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.501.1">
     First, we logged
    </span>
    <a id="_idIndexMarker994">
    </a>
    <span class="koboSpan" id="kobo.502.1">
     in to the main account, which is the account
    </span>
    <a id="_idIndexMarker995">
    </a>
    <span class="koboSpan" id="kobo.503.1">
     that will aggregate all GuardDuty findings.
    </span>
    <span class="koboSpan" id="kobo.503.2">
     We then invited a member account.
    </span>
    <span class="koboSpan" id="kobo.503.3">
     We had already noted down the account ID, and so it should have known the root email address of this account.
    </span>
    <span class="koboSpan" id="kobo.503.4">
     We then logged in to our member account and accepted the invitation.
    </span>
    <span class="koboSpan" id="kobo.503.5">
     After that, we generated sample findings from the member account.
    </span>
    <span class="koboSpan" id="kobo.503.6">
     Finally, we logged back into our main account and verified that the findings from the member account were now present in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.504.1">
      main account.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-331">
    <a id="_idTextAnchor335">
    </a>
    <span class="koboSpan" id="kobo.505.1">
     There’s more...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.506.1">
     GuardDuty retains the generated
    </span>
    <a id="_idIndexMarker996">
    </a>
    <span class="koboSpan" id="kobo.507.1">
     findings for 90 days.
    </span>
    <span class="koboSpan" id="kobo.507.2">
     It exports the active findings to Amazon EventBridge (EventBridge).
    </span>
    <span class="koboSpan" id="kobo.507.3">
     Additionally, we have the option to export these findings to an Amazon S3 bucket.
    </span>
    <span class="koboSpan" id="kobo.507.4">
     This allows us to track historical data of potentially suspicious activities in our account and assess the effectiveness of the recommended remediation steps.
    </span>
    <span class="koboSpan" id="kobo.507.5">
     We can do this by following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.508.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.509.1">
      Configure the KMS key
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.510.1">
       as follows:
      </span>
     </span>
     <ol>
      <li class="upper-roman">
       <strong class="bold">
        <span class="koboSpan" id="kobo.511.1">
         Create or choose a KMS key
        </span>
       </strong>
       <span class="koboSpan" id="kobo.512.1">
        : Select an existing KMS key or create a
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.513.1">
         new one.
        </span>
       </span>
      </li>
      <li class="upper-roman">
       <strong class="bold">
        <span class="koboSpan" id="kobo.514.1">
         Attach a policy to the KMS key
        </span>
       </strong>
       <span class="koboSpan" id="kobo.515.1">
        : Attach a policy to the KMS key to grant GuardDuty access.
       </span>
       <span class="koboSpan" id="kobo.515.2">
        Refer to the
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.516.1">
         guardduty_kms_policy.json
        </span>
       </strong>
       <span class="koboSpan" id="kobo.517.1">
        file from the code files for sample
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.518.1">
         policy content.
        </span>
       </span>
      </li>
     </ol>
    </li>
    <li>
     <span class="koboSpan" id="kobo.519.1">
      Configure the S3 bucket
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.520.1">
       as follows:
      </span>
     </span>
     <ol>
      <li class="upper-roman">
       <strong class="bold">
        <span class="koboSpan" id="kobo.521.1">
         Choose an S3 bucket
        </span>
       </strong>
       <span class="koboSpan" id="kobo.522.1">
        : Either create a new bucket or use an
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.523.1">
         existing one.
        </span>
       </span>
      </li>
      <li class="upper-roman">
       <strong class="bold">
        <span class="koboSpan" id="kobo.524.1">
         Update the bucket policy
        </span>
       </strong>
       <span class="koboSpan" id="kobo.525.1">
        : Update the bucket policy to allow GuardDuty uploads.
       </span>
       <span class="koboSpan" id="kobo.525.2">
        Refer to the
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.526.1">
         guardduty_s3_bucket_policy.json
        </span>
       </strong>
       <span class="koboSpan" id="kobo.527.1">
        file from the code files for sample
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.528.1">
         policy content.
        </span>
       </span>
      </li>
     </ol>
    </li>
    <li>
     <span class="koboSpan" id="kobo.529.1">
      Configure findings export in GuardDuty Console
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.530.1">
       as follows:
      </span>
     </span>
     <ol>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.531.1">
        Got to the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.532.1">
         GuardDuty dashboard.
        </span>
       </span>
      </li>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.533.1">
        Navigate to
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.534.1">
         Settings
        </span>
       </strong>
       <span class="koboSpan" id="kobo.535.1">
        by clicking on the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.536.1">
         Settings
        </span>
       </strong>
       <span class="koboSpan" id="kobo.537.1">
        option from the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.538.1">
         left sidebar.
        </span>
       </span>
      </li>
      <li class="upper-roman">
       <span class="koboSpan" id="kobo.539.1">
        Configure
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.540.1">
         Export Options
        </span>
       </strong>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.541.1">
         as follows:
        </span>
       </span>
       <ol>
        <li class="lower-roman">
         <span class="koboSpan" id="kobo.542.1">
          Scroll down to the
         </span>
         <strong class="bold">
          <span class="koboSpan" id="kobo.543.1">
           Finding export
          </span>
         </strong>
         <span class="No-Break">
          <strong class="bold">
           <span class="koboSpan" id="kobo.544.1">
            options
           </span>
          </strong>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.545.1">
           section.
          </span>
         </span>
        </li>
        <li class="lower-roman">
         <span class="koboSpan" id="kobo.546.1">
          Click on
         </span>
         <span class="No-Break">
          <strong class="bold">
           <span class="koboSpan" id="kobo.547.1">
            Configure now
           </span>
          </strong>
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.548.1">
           .
          </span>
         </span>
        </li>
        <li class="lower-roman">
         <span class="koboSpan" id="kobo.549.1">
          Enter the S3 bucket and KMS key ARNs.
         </span>
         <span class="koboSpan" id="kobo.549.2">
          Provide the ARN of the S3 bucket where the findings will be exported.
         </span>
         <span class="koboSpan" id="kobo.549.3">
          Provide the ARN of the KMS key to encrypt
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.550.1">
           the findings.
          </span>
         </span>
        </li>
        <li class="lower-roman">
         <span class="koboSpan" id="kobo.551.1">
          Click on
         </span>
         <strong class="bold">
          <span class="koboSpan" id="kobo.552.1">
           Save
          </span>
         </strong>
         <span class="koboSpan" id="kobo.553.1">
          to apply
         </span>
         <span class="No-Break">
          <span class="koboSpan" id="kobo.554.1">
           the settings.
          </span>
         </span>
        </li>
       </ol>
      </li>
     </ol>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.555.1">
     By following the preceding
    </span>
    <a id="_idIndexMarker997">
    </a>
    <span class="koboSpan" id="kobo.556.1">
     steps, we can configure AWS GuardDuty to export its findings to an S3 bucket, ensuring that the data is aggregated and secured across accounts and regions.
    </span>
    <span class="koboSpan" id="kobo.556.2">
     Please make sure that you update the sample policy files with actual values
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.557.1">
      as needed.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-332">
    <a id="_idTextAnchor336">
    </a>
    <span class="koboSpan" id="kobo.558.1">
     See also
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.559.1">
     Read more about the export findings
    </span>
    <a id="_idIndexMarker998">
    </a>
    <span class="koboSpan" id="kobo.560.1">
     feature in GuardDuty
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.561.1">
      at
     </span>
    </span>
    <a href="https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_exportfindings.html">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.562.1">
       https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_exportfindings.html
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.563.1">
      .
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-333">
    <a id="_idTextAnchor337">
    </a>
    <span class="koboSpan" id="kobo.564.1">
     Setting up and using Amazon Macie
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.565.1">
     In this recipe, we will learn
    </span>
    <a id="_idIndexMarker999">
    </a>
    <span class="koboSpan" id="kobo.566.1">
     how to set up and use
    </span>
    <a id="_idIndexMarker1000">
    </a>
    <span class="koboSpan" id="kobo.567.1">
     Amazon Macie.
    </span>
    <span class="koboSpan" id="kobo.567.2">
     Macie is a machine learning-powered service in AWS and is used primarily to discover, classify, and protect sensitive data.
    </span>
    <span class="koboSpan" id="kobo.567.3">
     Macie can analyze data in S3 buckets
    </span>
    <a id="_idIndexMarker1001">
    </a>
    <span class="koboSpan" id="kobo.568.1">
     to find sensitive
    </span>
    <a id="_idIndexMarker1002">
    </a>
    <span class="koboSpan" id="kobo.569.1">
     information, such
    </span>
    <a id="_idIndexMarker1003">
    </a>
    <span class="koboSpan" id="kobo.570.1">
     as credentials, financial information,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.571.1">
      Protected Health Information
     </span>
    </strong>
    <span class="koboSpan" id="kobo.572.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.573.1">
      PHI
     </span>
    </strong>
    <span class="koboSpan" id="kobo.574.1">
     ),
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.575.1">
      Personally Identifiable Information
     </span>
    </strong>
    <span class="koboSpan" id="kobo.576.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.577.1">
      PII
     </span>
    </strong>
    <span class="koboSpan" id="kobo.578.1">
     ),
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.579.1">
      API keys
     </span>
    </strong>
    <span class="koboSpan" id="kobo.580.1">
     , source code, and so on, and then classify them into different security levels.
    </span>
    <span class="koboSpan" id="kobo.580.2">
     Macie can be used with CloudWatch to raise alarms and send notifications.
    </span>
    <span class="koboSpan" id="kobo.580.3">
     Macie can also analyze API calls from CloudTrail to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.581.1">
      detect anomalies.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-334">
    <a id="_idTextAnchor338">
    </a>
    <span class="koboSpan" id="kobo.582.1">
     Getting ready
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.583.1">
     We need the following to successfully complete
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.584.1">
      this recipe:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.585.1">
      We will need a working AWS account and a user, as described in the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.586.1">
       Technical
      </span>
     </em>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.587.1">
        requirements
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.588.1">
       section.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.589.1">
      We need an S3 bucket.
     </span>
     <span class="koboSpan" id="kobo.589.2">
      The bucket should be in the same region in which we configure Macie.
     </span>
     <span class="koboSpan" id="kobo.589.3">
      I have created a bucket in the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.590.1">
        us-east-1
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.591.1">
       region.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.592.1">
      Our S3 bucket should have the following files with fake sensitive data and are provided with the code files associated with
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.593.1">
       the chapter:
      </span>
     </span>
     <ul>
      <li>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.594.1">
         credit-cards-data.txt
        </span>
       </strong>
       <span class="koboSpan" id="kobo.595.1">
        with sample credit
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.596.1">
         card data
        </span>
       </span>
      </li>
      <li>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.597.1">
         custom-data-license-plates.txt
        </span>
       </strong>
       <span class="koboSpan" id="kobo.598.1">
        with sample
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.599.1">
         license plates
        </span>
       </span>
      </li>
     </ul>
    </li>
   </ul>
   <h2 id="_idParaDest-335">
    <a id="_idTextAnchor339">
    </a>
    <span class="koboSpan" id="kobo.600.1">
     How to do it...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.601.1">
     We can configure Macie to discover and classify risks in an S3 bucket
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.602.1">
      as follows:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.603.1">
      Go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.604.1">
       Amazon Macie
      </span>
     </strong>
     <span class="koboSpan" id="kobo.605.1">
      service in the AWS
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.606.1">
       management console.
      </span>
     </span>
    </li>
   </ol>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.607.1">
     Important note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.608.1">
     If we are using Macie for the first time, we should see a page with a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.609.1">
      Get started
     </span>
    </strong>
    <span class="koboSpan" id="kobo.610.1">
     button.
    </span>
    <span class="koboSpan" id="kobo.610.2">
     Click on
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.611.1">
      Get started
     </span>
    </strong>
    <span class="koboSpan" id="kobo.612.1">
     .
    </span>
    <span class="koboSpan" id="kobo.612.2">
     Make sure that the region selected is the same as our bucket, view the service role permissions, and enable Macie to start a 30-day trial.
    </span>
    <span class="koboSpan" id="kobo.612.3">
     We will then be taken to the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.613.1">
      Summary
     </span>
    </strong>
    <span class="koboSpan" id="kobo.614.1">
     page.
    </span>
    <span class="koboSpan" id="kobo.614.2">
     The 30-day free trial of automated sensitive data discovery does not cover sensitive data discovery jobs.
    </span>
    <span class="koboSpan" id="kobo.614.3">
     If you initiate and execute a job, you will incur charges based on the total volume of uncompressed data analyzed by
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.615.1">
      the job.
     </span>
    </span>
   </p>
   <ol>
    <li value="2">
     <span class="koboSpan" id="kobo.616.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.617.1">
       Jobs
      </span>
     </strong>
     <span class="koboSpan" id="kobo.618.1">
      in the left
     </span>
     <a id="_idIndexMarker1004">
     </a>
     <span class="koboSpan" id="kobo.619.1">
      sidebar of the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.620.1">
       Macie
      </span>
     </span>
     <span class="No-Break">
      <a id="_idIndexMarker1005">
      </a>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.621.1">
       dashboard.
      </span>
     </span>
    </li>
   </ol>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.622.1">
     Important note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.623.1">
     If we haven’t configured a repository for our sensitive data discovery results, we will get a warning.
    </span>
    <span class="koboSpan" id="kobo.623.2">
     We need to set up this repository within 30 days of enabling Macie.
    </span>
    <span class="koboSpan" id="kobo.623.3">
     Please note that Macie only stores our sensitive data discovery results and findings for 90 days.
    </span>
    <span class="koboSpan" id="kobo.623.4">
     We can click on
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.624.1">
      Configure
     </span>
    </strong>
    <span class="koboSpan" id="kobo.625.1">
     now to configure an existing or new bucket as the repository for sensitive data discovery results, or we can do it later (within 30 days) using the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.626.1">
      Discovery results
     </span>
    </strong>
    <span class="koboSpan" id="kobo.627.1">
     menu item under
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.628.1">
      Settings
     </span>
    </strong>
    <span class="koboSpan" id="kobo.629.1">
     on the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.630.1">
      left sidebar.
     </span>
    </span>
   </p>
   <ol>
    <li value="3">
     <span class="koboSpan" id="kobo.631.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.632.1">
       Create job
      </span>
     </strong>
     <span class="koboSpan" id="kobo.633.1">
      to initiate the job
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.634.1">
       creation process.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.635.1">
      On the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.636.1">
       Choose S3 buckets
      </span>
     </strong>
     <span class="koboSpan" id="kobo.637.1">
      page, opt for
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.638.1">
       Select specific buckets
      </span>
     </strong>
     <span class="koboSpan" id="kobo.639.1">
      to select the buckets you want to include in the job.
     </span>
     <span class="koboSpan" id="kobo.639.2">
      We will select the bucket we created in the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.640.1">
       Getting ready
      </span>
     </em>
     <span class="koboSpan" id="kobo.641.1">
      section of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.642.1">
       this recipe.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.643.1">
      Scroll down and click
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.644.1">
       on
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.645.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.646.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.647.1">
      For the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.648.1">
       Review S3 buckets
      </span>
     </strong>
     <span class="koboSpan" id="kobo.649.1">
      page, review and verify our bucket selections, and then
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.650.1">
       choose
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.651.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.652.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.653.1">
      For the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.654.1">
       Refine the scope
      </span>
     </strong>
     <span class="koboSpan" id="kobo.655.1">
      page, choose
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.656.1">
       One-time job
      </span>
     </strong>
     <span class="koboSpan" id="kobo.657.1">
      , provide the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.658.1">
       100%
      </span>
     </strong>
     <span class="koboSpan" id="kobo.659.1">
      value for
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.660.1">
       Sampling depth
      </span>
     </strong>
     <span class="koboSpan" id="kobo.661.1">
      , and click
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.662.1">
       on
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.663.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.664.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.665.1">
     Important note
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.666.1">
     Instead of choosing
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.667.1">
      One-time job
     </span>
    </strong>
    <span class="koboSpan" id="kobo.668.1">
     , we can select the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.669.1">
      Scheduled job
     </span>
    </strong>
    <span class="koboSpan" id="kobo.670.1">
     option and set
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.671.1">
      Update frequency
     </span>
    </strong>
    <span class="koboSpan" id="kobo.672.1">
     to
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.673.1">
      Daily
     </span>
    </strong>
    <span class="koboSpan" id="kobo.674.1">
     ,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.675.1">
      Weekly
     </span>
    </strong>
    <span class="koboSpan" id="kobo.676.1">
     , or
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.677.1">
      Monthly
     </span>
    </strong>
    <span class="koboSpan" id="kobo.678.1">
     , but let us select
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.679.1">
      One-time job
     </span>
    </strong>
    <span class="koboSpan" id="kobo.680.1">
     for this recipe.
    </span>
    <span class="koboSpan" id="kobo.680.2">
     Under
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.681.1">
      Advanced settings
     </span>
    </strong>
    <span class="koboSpan" id="kobo.682.1">
     , we can specify criteria to include or exclude certain objects from the job’s analysis.
    </span>
    <span class="koboSpan" id="kobo.682.2">
     If no criteria are provided, the job will analyze all objects in the buckets.
    </span>
    <span class="koboSpan" id="kobo.682.3">
     For now, we should leave these settings as
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.683.1">
      their defaults.
     </span>
    </span>
   </p>
   <ol>
    <li value="8">
     <span class="koboSpan" id="kobo.684.1">
      For
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.685.1">
       Managed data identifier options
      </span>
     </strong>
     <span class="koboSpan" id="kobo.686.1">
      ,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.687.1">
       select
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.688.1">
        Recommended
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.689.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <p class="IMG---Figure">
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer235">
     <span class="koboSpan" id="kobo.690.1">
      <img alt="Figure 8.5 – Managed data identifier options" src="image/B21384_08_5.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.691.1">
     Figure 8.5 – Managed data identifier options
    </span>
   </p>
   <ol>
    <li value="9">
     <span class="koboSpan" id="kobo.692.1">
      Scroll down and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.693.1">
       click
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.694.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.695.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.696.1">
      For
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.697.1">
       Custom data identifiers
      </span>
     </strong>
     <span class="koboSpan" id="kobo.698.1">
      , don’t add anything and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.699.1">
       click
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.700.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.701.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.702.1">
      For
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.703.1">
       Select allow lists
      </span>
     </strong>
     <span class="koboSpan" id="kobo.704.1">
      , don’t add anything, and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.705.1">
       click
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.706.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.707.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.708.1">
      On the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.709.1">
       Enter general settings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.710.1">
      pane, enter
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.711.1">
       AWS Sec CB Demo
      </span>
     </strong>
     <span class="koboSpan" id="kobo.712.1">
      under
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.713.1">
       Job name
      </span>
     </strong>
     <span class="koboSpan" id="kobo.714.1">
      .
     </span>
     <span class="koboSpan" id="kobo.714.2">
      Optionally, provide
     </span>
     <a id="_idIndexMarker1006">
     </a>
     <span class="koboSpan" id="kobo.715.1">
      a job description
     </span>
     <a id="_idIndexMarker1007">
     </a>
     <span class="koboSpan" id="kobo.716.1">
      and add any tags as needed.
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.717.1">
       Click
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.718.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.719.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.720.1">
      On the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.721.1">
       Review and create
      </span>
     </strong>
     <span class="koboSpan" id="kobo.722.1">
      page, take a moment to carefully examine the configuration settings to ensure their accuracy, and review the estimated total cost of the job.
     </span>
     <span class="koboSpan" id="kobo.722.2">
      Click
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.723.1">
       on
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.724.1">
        Submit
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.725.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.726.1">
      If we go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.727.1">
       Jobs
      </span>
     </strong>
     <span class="koboSpan" id="kobo.728.1">
      page, the status of our job will be
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.729.1">
       Active (Running)
      </span>
     </strong>
     <span class="koboSpan" id="kobo.730.1">
      .
     </span>
     <span class="koboSpan" id="kobo.730.2">
      Wait until the status is
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.731.1">
       Complete
      </span>
     </strong>
     <span class="koboSpan" id="kobo.732.1">
      .
     </span>
     <span class="koboSpan" id="kobo.732.2">
      It could take 10 to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.733.1">
       15 minutes.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.734.1">
      Click on the hyper-linked job name from the list, and from the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.735.1">
       Show results
      </span>
     </strong>
     <span class="koboSpan" id="kobo.736.1">
      dropdown, click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.737.1">
       Show findings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.738.1">
      to view the findings.
     </span>
     <span class="koboSpan" id="kobo.738.2">
      Click on the finding to learn more
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.739.1">
       about it.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer236">
     <span class="koboSpan" id="kobo.740.1">
      <img alt="Figure 8.6 – The Macie Findings tab" src="image/B21384_08_6.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.741.1">
     Figure 8.6 – The Macie Findings tab
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.742.1">
     In this section, we saw how we can
    </span>
    <a id="_idIndexMarker1008">
    </a>
    <span class="koboSpan" id="kobo.743.1">
     use Amazon Macie to find the S3 objects that contain
    </span>
    <a id="_idIndexMarker1009">
    </a>
    <span class="koboSpan" id="kobo.744.1">
     financial information such as bank account numbers or credit card numbers.
    </span>
    <span class="koboSpan" id="kobo.744.2">
     Next, we will see how we can use a custom Macie
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.745.1">
      data identifier.
     </span>
    </span>
   </p>
   <h3>
    <span class="koboSpan" id="kobo.746.1">
     Adding a custom Macie data identifier
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.747.1">
     We can configure
    </span>
    <a id="_idIndexMarker1010">
    </a>
    <span class="koboSpan" id="kobo.748.1">
     and use a custom Macie data identifier
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.749.1">
      as follows:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.750.1">
      Navigate back to the Macie service in the AWS
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.751.1">
       Management Console.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.752.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.753.1">
       Custom data identifiers
      </span>
     </strong>
     <span class="koboSpan" id="kobo.754.1">
      in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.755.1">
       left sidebar.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.756.1">
      Click
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.757.1">
       on
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.758.1">
        Create
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.759.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.760.1">
      Provide
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.761.1">
       UKLicensePlates
      </span>
     </strong>
     <span class="koboSpan" id="kobo.762.1">
      under
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.763.1">
       Name
      </span>
     </strong>
     <span class="koboSpan" id="kobo.764.1">
      .
     </span>
     <span class="koboSpan" id="kobo.764.2">
      For
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.765.1">
       Description - optional
      </span>
     </strong>
     <span class="koboSpan" id="kobo.766.1">
      , enter
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.767.1">
       UK License Plates
      </span>
     </strong>
     <span class="koboSpan" id="kobo.768.1">
      , and set the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.769.1">
       Regular expression
      </span>
     </strong>
     <span class="koboSpan" id="kobo.770.1">
      as the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.771.1">
       following:
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.772.1">
        ([0-9][a-zA-Z][a-zA-Z]-?[0-9][a-zA-Z][a-zA-Z])|([a-zA-Z][a-zA-Z][a-zA-Z]-?[0-9][0-9][0-9])|([a-zA-Z][a-zA-Z]-?[0-9][0-9]-?[a-zA-Z][a-zA-Z])|([0-9][0-9][0-9]-?[a-zA-Z][a-zA-Z][a-zA-Z])|([0-9][0-9][0-9]-?[0-9][a-zA-Z][a-zA-Z])
       </span>
      </strong>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.773.1">
      Leave everything else
     </span>
     <a id="_idIndexMarker1011">
     </a>
     <span class="koboSpan" id="kobo.774.1">
      as default and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.775.1">
       click
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.776.1">
        Submit
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.777.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.778.1">
      Create a new job by following the steps in the previous section; however, on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.779.1">
       Custom data identifiers
      </span>
     </strong>
     <span class="koboSpan" id="kobo.780.1">
      page, select
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.781.1">
       UKLicensePlates
      </span>
     </strong>
     <span class="koboSpan" id="kobo.782.1">
      , which we created in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.783.1">
       this section.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer237">
     <span class="koboSpan" id="kobo.784.1">
      <img alt="Figure 8.7 – Selecting custom data identifiers" src="image/B21384_08_7.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.785.1">
     Figure 8.7 – Selecting custom data identifiers
    </span>
   </p>
   <ol>
    <li value="7">
     <span class="koboSpan" id="kobo.786.1">
      Once the status of the job is
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.787.1">
       Complete
      </span>
     </strong>
     <span class="koboSpan" id="kobo.788.1">
      on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.789.1">
       Jobs
      </span>
     </strong>
     <span class="koboSpan" id="kobo.790.1">
      page, from the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.791.1">
       Show results
      </span>
     </strong>
     <span class="koboSpan" id="kobo.792.1">
      dropdown, click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.793.1">
       Show findings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.794.1">
      .
     </span>
     <span class="koboSpan" id="kobo.794.2">
      We should be able to see a new finding corresponding to our custom
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.795.1">
       identifier job.
      </span>
     </span>
    </li>
   </ol>
   <h2 id="_idParaDest-336">
    <a id="_idTextAnchor340">
    </a>
    <span class="koboSpan" id="kobo.796.1">
     How it works...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.797.1">
     Macie can be used to analyze
    </span>
    <a id="_idIndexMarker1012">
    </a>
    <span class="koboSpan" id="kobo.798.1">
     S3 buckets
    </span>
    <a id="_idIndexMarker1013">
    </a>
    <span class="koboSpan" id="kobo.799.1">
     and CloudTrail logs.
    </span>
    <span class="koboSpan" id="kobo.799.2">
     In this recipe, we explored Amazon Macie, a machine learning-powered service in AWS that helps discover, classify, and protect sensitive data stored in S3 buckets.
    </span>
    <span class="koboSpan" id="kobo.799.3">
     We set up Macie, initiated a discovery job to scan a specific S3 bucket, and observed how it successfully identified pre-defined sensitive data types such as credit card numbers.
    </span>
    <span class="koboSpan" id="kobo.799.4">
     We then extended its capabilities by creating a custom data identifier named
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.800.1">
      UKLicensePlates
     </span>
    </strong>
    <span class="koboSpan" id="kobo.801.1">
     using a regular expression to recognize a specific format within our S3 bucket.
    </span>
    <span class="koboSpan" id="kobo.801.2">
     This custom identifier was incorporated into a new discovery job.
    </span>
    <span class="koboSpan" id="kobo.801.3">
     Upon completion, we confirmed that Macie successfully recognized the six license plates, showcasing its ability to discover both pre-defined and user-defined sensitive
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.802.1">
      data types.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-337">
    <a id="_idTextAnchor341">
    </a>
    <span class="koboSpan" id="kobo.803.1">
     There’s more...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.804.1">
     Let’s go through some important concepts
    </span>
    <a id="_idIndexMarker1014">
    </a>
    <span class="koboSpan" id="kobo.805.1">
     related
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.806.1">
      to Macie:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.807.1">
      Macie can be used within enterprises for a variety of use cases.
     </span>
     <span class="koboSpan" id="kobo.807.2">
      Macie can detect whether sensitive data or source code has been downloaded from unusual IP addresses.
     </span>
     <span class="koboSpan" id="kobo.807.3">
      Macie can detect which users are causing the most high-risk events.
     </span>
     <span class="koboSpan" id="kobo.807.4">
      Macie can group events by location and help us detect any activity from unknown locations.
     </span>
     <span class="koboSpan" id="kobo.807.5">
      Macie can also give a high-level breakdown of the type of CloudTrail events within our account.
     </span>
     <span class="koboSpan" id="kobo.807.6">
      If we see any unexpected calls, we can drill down to find out the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.808.1">
       root cause.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.809.1">
      Both Macie and GuardDuty have an overlap of functionalities related to analyzing API calls.
     </span>
     <span class="koboSpan" id="kobo.809.2">
      Unlike GuardDuty, the focus of Macie is more on access patterns, such as uploading or downloading more data than is normally done.
     </span>
     <span class="koboSpan" id="kobo.809.3">
      In general, it is preferable to use Macie alongside GuardDuty for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.810.1">
       better protection.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.811.1">
      Macie can be used alongside CloudWatch for raising alarms and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.812.1">
       sending notifications.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.813.1">
      Macie can aggregate data from multiple accounts.
     </span>
     <span class="koboSpan" id="kobo.813.2">
      We can add additional accounts from the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.814.1">
       ACCOUNTS
      </span>
     </strong>
     <span class="koboSpan" id="kobo.815.1">
      tab on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.816.1">
       INTEGRATIONS
      </span>
     </strong>
     <span class="koboSpan" id="kobo.817.1">
      page after setting up the required permissions
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.818.1">
       as mentioned.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.819.1">
      Macie currently charges us for S3 content classification and CloudTrail
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.820.1">
       event processing.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.821.1">
      Macie is a regional
     </span>
     <a id="_idIndexMarker1015">
     </a>
     <span class="koboSpan" id="kobo.822.1">
      service.
     </span>
     <span class="koboSpan" id="kobo.822.2">
      Macie must be enabled on a region-by-region basis and helps you view findings across all your accounts within
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.823.1">
       each region.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.824.1">
     The steps to configure notifications for Macie alerts
    </span>
    <a id="_idIndexMarker1016">
    </a>
    <span class="koboSpan" id="kobo.825.1">
     with Amazon EventBridge and SNS can be summarized
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.826.1">
      as follows:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.827.1">
      Go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.828.1">
       Amazon EventBridge
      </span>
     </strong>
     <span class="koboSpan" id="kobo.829.1">
      service in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.830.1">
       the console.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.831.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.832.1">
       Rules
      </span>
     </strong>
     <span class="koboSpan" id="kobo.833.1">
      under
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.834.1">
       Buses
      </span>
     </strong>
     <span class="koboSpan" id="kobo.835.1">
      from the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.836.1">
       left sidebar.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.837.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.838.1">
       Create rule
      </span>
     </strong>
     <span class="koboSpan" id="kobo.839.1">
      to go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.840.1">
       Create
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.841.1">
        rule
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.842.1">
       page.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.843.1">
      On the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.844.1">
       Define rule detail
      </span>
     </strong>
     <span class="koboSpan" id="kobo.845.1">
      page, provide a name and description for our rule.
     </span>
     <span class="koboSpan" id="kobo.845.2">
      Leave
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.846.1">
       Event bus
      </span>
     </strong>
     <span class="koboSpan" id="kobo.847.1">
      and
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.848.1">
       Rule type
      </span>
     </strong>
     <span class="koboSpan" id="kobo.849.1">
      as
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.850.1">
       Rule with an event pattern
      </span>
     </strong>
     <span class="koboSpan" id="kobo.851.1">
      and click
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.852.1">
       on
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.853.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.854.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.855.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.856.1">
       Build event pattern
      </span>
     </strong>
     <span class="koboSpan" id="kobo.857.1">
      section, scroll down to
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.858.1">
        Event pattern
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.859.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.860.1">
      Set
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.861.1">
       Event source
      </span>
     </strong>
     <span class="koboSpan" id="kobo.862.1">
      to
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.863.1">
        AWS services
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.864.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.865.1">
      Set
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.866.1">
       AWS service
      </span>
     </strong>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.867.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.868.1">
        Macie
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.869.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.870.1">
      Set
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.871.1">
       Event Type
      </span>
     </strong>
     <span class="koboSpan" id="kobo.872.1">
      to
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.873.1">
        Macie Finding
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.874.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.875.1">
      Click
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.876.1">
       on
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.877.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.878.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.879.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.880.1">
       Targets
      </span>
     </strong>
     <span class="koboSpan" id="kobo.881.1">
      section, under
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.882.1">
       Select a target
      </span>
     </strong>
     <span class="koboSpan" id="kobo.883.1">
      , select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.884.1">
       SNS topic
      </span>
     </strong>
     <span class="koboSpan" id="kobo.885.1">
      from
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.886.1">
       the dropdown.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.887.1">
      Select a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.888.1">
       Topic
      </span>
     </strong>
     <span class="koboSpan" id="kobo.889.1">
      .
     </span>
     <span class="koboSpan" id="kobo.889.2">
      You can create an SNS topic by following the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.890.1">
       Creating an SNS topic to send emails
      </span>
     </em>
     <span class="koboSpan" id="kobo.891.1">
      recipe in
     </span>
     <a href="B21384_07.xhtml#_idTextAnchor265">
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.892.1">
         Chapter 7
        </span>
       </em>
      </span>
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.893.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.894.1">
      Click
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.895.1">
       on
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.896.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.897.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.898.1">
      Optionally, click
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.899.1">
       Add new tags
      </span>
     </strong>
     <span class="koboSpan" id="kobo.900.1">
      and click
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.901.1">
       on
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.902.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.903.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.904.1">
      Review the rule and click on
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.905.1">
        Create rule
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.906.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.907.1">
      Navigate back to
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.908.1">
       Macie service
      </span>
     </strong>
     <span class="koboSpan" id="kobo.909.1">
      and create a job for our S3 bucket by following the steps in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.910.1">
       previous section.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.911.1">
      After some time, check
     </span>
     <a id="_idIndexMarker1017">
     </a>
     <span class="koboSpan" id="kobo.912.1">
      the inbox of the email we configured for our SNS topic, and we should get an email about our
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.913.1">
       Macie findings.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.914.1">
     By default, Macie automatically sends its findings to Amazon EventBridge for further processing and integration with other AWS services.
    </span>
    <span class="koboSpan" id="kobo.914.2">
     You have the flexibility to configure Macie to deliver findings to additional destinations and define how frequently updates are sent to each destination by following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.915.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.916.1">
      Navigate to the Macie console and click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.917.1">
       settings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.918.1">
      on the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.919.1">
       left sidebar.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.920.1">
      Scroll down to
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.921.1">
       Publication of findings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.922.1">
      and update the frequency for the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.923.1">
       policy findings.
      </span>
     </span>
    </li>
   </ol>
   <h2 id="_idParaDest-338">
    <a id="_idTextAnchor342">
    </a>
    <span class="koboSpan" id="kobo.924.1">
     See also
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.925.1">
     Read more about
    </span>
    <a id="_idIndexMarker1018">
    </a>
    <span class="koboSpan" id="kobo.926.1">
     Amazon Macie
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.927.1">
      at
     </span>
    </span>
    <a href="https://www.cloudericks.com/blog/getting-started-with-amazon-macie">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.928.1">
       https://www.cloudericks.com/blog/getting-started-with-amazon-macie
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.929.1">
      .
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-339">
    <a id="_idTextAnchor343">
    </a>
    <span class="koboSpan" id="kobo.930.1">
     Setting up and using Amazon Inspector
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.931.1">
     In this recipe, we will learn
    </span>
    <a id="_idIndexMarker1019">
    </a>
    <span class="koboSpan" id="kobo.932.1">
     how to set up
    </span>
    <a id="_idIndexMarker1020">
    </a>
    <span class="koboSpan" id="kobo.933.1">
     and use Amazon Inspector.
    </span>
    <span class="koboSpan" id="kobo.933.2">
     Inspector
    </span>
    <a id="_idIndexMarker1021">
    </a>
    <span class="koboSpan" id="kobo.934.1">
     is a service that performs automated
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.935.1">
      security assessments
     </span>
    </strong>
    <span class="koboSpan" id="kobo.936.1">
     to find vulnerabilities or deviations from standard practices for applications deployed on AWS.
    </span>
    <span class="koboSpan" id="kobo.936.2">
     We can check the Inspector’s findings directly in the console or from the detailed assessment report provided by
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.937.1">
      the Inspector.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-340">
    <a id="_idTextAnchor344">
    </a>
    <span class="koboSpan" id="kobo.938.1">
     Getting ready
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.939.1">
     We need the following
    </span>
    <a id="_idIndexMarker1022">
    </a>
    <span class="koboSpan" id="kobo.940.1">
     to successfully
    </span>
    <a id="_idIndexMarker1023">
    </a>
    <span class="koboSpan" id="kobo.941.1">
     complete
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.942.1">
      this recipe:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.943.1">
      We need a working AWS account and a user, as described in the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.944.1">
       Technical
      </span>
     </em>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.945.1">
        requirements
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.946.1">
       section.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.947.1">
      An EC2 instance in the default VPC, within a public subnet within the VPC, is also required.
     </span>
     <span class="koboSpan" id="kobo.947.2">
      For
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.948.1">
       Amazon Machine Image (AMI)
      </span>
     </strong>
     <span class="koboSpan" id="kobo.949.1">
      , select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.950.1">
       Amazon Linux 2023 AMI
      </span>
     </strong>
     <span class="koboSpan" id="kobo.951.1">
      .
     </span>
     <span class="koboSpan" id="kobo.951.2">
      For
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.952.1">
       Instance type
      </span>
     </strong>
     <span class="koboSpan" id="kobo.953.1">
      , select
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.954.1">
       t2.micro
      </span>
     </strong>
     <span class="koboSpan" id="kobo.955.1">
      .
     </span>
     <span class="koboSpan" id="kobo.955.2">
      For
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.956.1">
       Key pair (login)
      </span>
     </strong>
     <span class="koboSpan" id="kobo.957.1">
      , select an existing one you have access to or create a new one.
     </span>
     <span class="koboSpan" id="kobo.957.2">
      Under
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.958.1">
       Network settings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.959.1">
      , make sure that the value for
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.960.1">
       Auto-assign public IP
      </span>
     </strong>
     <span class="koboSpan" id="kobo.961.1">
      is
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.962.1">
       Enable
      </span>
     </strong>
     <span class="koboSpan" id="kobo.963.1">
      , and that
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.964.1">
       Create security group
      </span>
     </strong>
     <span class="koboSpan" id="kobo.965.1">
      is selected with the value for
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.966.1">
       Allow SSH traffic from
      </span>
     </strong>
     <span class="koboSpan" id="kobo.967.1">
      set
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.968.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.969.1">
        Anywhere
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.970.1">
       .
      </span>
     </span>
    </li>
   </ul>
   <h2 id="_idParaDest-341">
    <a id="_idTextAnchor345">
    </a>
    <span class="koboSpan" id="kobo.971.1">
     How to do it...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.972.1">
     We can set up Inspector
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.973.1">
      as follows:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.974.1">
      Go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.975.1">
       Amazon Inspector
      </span>
     </strong>
     <span class="koboSpan" id="kobo.976.1">
      service in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.977.1">
       the console.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.978.1">
      If we are logging in for the first time, we should see a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.979.1">
       Get started
      </span>
     </strong>
     <span class="koboSpan" id="kobo.980.1">
      page.
     </span>
     <span class="koboSpan" id="kobo.980.2">
      Currently, there is a free 15-day trial for accounts that are new to Inspector.
     </span>
     <span class="koboSpan" id="kobo.980.3">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.981.1">
       Get started
      </span>
     </strong>
     <span class="koboSpan" id="kobo.982.1">
      .
     </span>
     <span class="koboSpan" id="kobo.982.2">
      On the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.983.1">
       Activate Inspector
      </span>
     </strong>
     <span class="koboSpan" id="kobo.984.1">
      page, we should see a message that reads as follows:
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.985.1">
       When you activate Inspector, you grant Inspector permissions to discover, classify, and protect sensitive data in AWS on your behalf and to generate findings about potential security issues.
      </span>
      <span class="koboSpan" id="kobo.985.2">
       This will activate Inspector for your account only
      </span>
     </strong>
     <span class="koboSpan" id="kobo.986.1">
      .
     </span>
     <span class="koboSpan" id="kobo.986.2">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.987.1">
       Activate Inspector
      </span>
     </strong>
     <span class="koboSpan" id="kobo.988.1">
      and wait until it is fully activated.
     </span>
     <span class="koboSpan" id="kobo.988.2">
      On the left sidebar, we should get options including
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.989.1">
       the following:
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer238">
     <span class="koboSpan" id="kobo.990.1">
      <img alt="Figure 8.8 – Amazon Inspector’s left sidebar" src="image/B21384_08_8.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.991.1">
     Figure 8.8 – Amazon Inspector’s left sidebar
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.992.1">
     If we expand
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.993.1">
      Findings
     </span>
    </strong>
    <span class="koboSpan" id="kobo.994.1">
     , we can
    </span>
    <a id="_idIndexMarker1024">
    </a>
    <span class="koboSpan" id="kobo.995.1">
     see options
    </span>
    <a id="_idIndexMarker1025">
    </a>
    <span class="koboSpan" id="kobo.996.1">
     such as
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.997.1">
      By vulnerability
     </span>
    </strong>
    <span class="koboSpan" id="kobo.998.1">
     ,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.999.1">
      By instance
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1000.1">
     ,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1001.1">
      By container image
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1002.1">
     ,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1003.1">
      By container repository
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1004.1">
     ,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1005.1">
      By Lambda function
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1006.1">
     , and
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1007.1">
      All findings
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1008.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1008.2">
     We should also see messages such as the following, but it could be different in your case, as Amazon updates its user interface and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1009.1">
      messages frequently.
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer239">
     <span class="koboSpan" id="kobo.1010.1">
      <img alt="Figure 8.9 – Messages post-activating Amazon Inspector" src="image/B21384_08_9.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1011.1">
     Figure 8.9 – Messages post-activating Amazon Inspector
    </span>
   </p>
   <ol>
    <li value="3">
     <span class="koboSpan" id="kobo.1012.1">
      Wait for some
     </span>
     <a id="_idIndexMarker1026">
     </a>
     <span class="koboSpan" id="kobo.1013.1">
      time, then click
     </span>
     <a id="_idIndexMarker1027">
     </a>
     <span class="koboSpan" id="kobo.1014.1">
      on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1015.1">
       Account management
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1016.1">
      from the left sidebar, go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1017.1">
       Instances
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1018.1">
      tab, and verify that the status of our instance is
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1019.1">
       Actively monitoring
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1020.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1020.2">
      The
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1021.1">
       Monitored using
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1022.1">
      column will have a value of
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1023.1">
       Agentless
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1024.1">
      as we are using an EBS-backed
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1025.1">
       EC2 instance.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1026.1">
      In the left sidebar, expand
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1027.1">
       Findings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1028.1">
      and click on
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1029.1">
        All findings
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1030.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer240">
     <span class="koboSpan" id="kobo.1031.1">
      <img alt="Figure 8.10 – Inspector’s Findings menu" src="image/B21384_08_10.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1032.1">
     Figure 8.10 – Inspector’s Findings menu
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.1033.1">
     As we are using a newly launched EC2 instance with Amazon Linux, we won’t see many findings, but we should see one with
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1034.1">
      Severity
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1035.1">
     as
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1036.1">
      Medium
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1037.1">
     for
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1038.1">
      Port 22 is reachable from an Internet Gateway –
     </span>
    </strong>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.1039.1">
       TCP
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1040.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1041.1">
     We quickly explored how
    </span>
    <a id="_idIndexMarker1028">
    </a>
    <span class="koboSpan" id="kobo.1042.1">
     to see the Inspector findings
    </span>
    <a id="_idIndexMarker1029">
    </a>
    <span class="koboSpan" id="kobo.1043.1">
     in this recipe.
    </span>
    <span class="koboSpan" id="kobo.1043.2">
     We will look into more options available within Inspector’s dashboard in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1044.1">
      There’s more...
     </span>
    </em>
    <span class="koboSpan" id="kobo.1045.1">
     section of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1046.1">
      this recipe.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-342">
    <a id="_idTextAnchor346">
    </a>
    <span class="koboSpan" id="kobo.1047.1">
     How it works...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1048.1">
     Amazon Inspector for EC2 scanning extracts metadata from instances and compares it to security advisories to produce findings, focusing on package vulnerabilities and network reachability issues.
    </span>
    <span class="koboSpan" id="kobo.1048.2">
     Network reachability scans occur every 24 hours, while package vulnerability scans have variable frequencies based on the scan method.
    </span>
    <span class="koboSpan" id="kobo.1048.3">
     Amazon Inspector employs both agent-based and agentless scan methods, depending on the account’s scan mode settings, to collect software inventory and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1049.1">
      detect vulnerabilities.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1050.1">
     Agent-based scans use the SSM agent to continuously collect software inventory from eligible instances.
    </span>
    <span class="koboSpan" id="kobo.1050.2">
     These scans identify vulnerabilities in both operating systems and application programming language packages in Linux instances.
    </span>
    <span class="koboSpan" id="kobo.1050.3">
     To perform agent-based scans, instances must have a supported OS, be SSM managed, and not be excluded by specific tags.
    </span>
    <span class="koboSpan" id="kobo.1050.4">
     Amazon Inspector uses various SSM associations and plugins to gather inventory data and update vulnerability findings regularly.
    </span>
    <span class="koboSpan" id="kobo.1050.5">
     Additionally, agentless scans, part of the hybrid scanning mode, utilize EBS snapshots to collect inventory data from instances, scanning for operating system and application
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1051.1">
      package vulnerabilities.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1052.1">
     Amazon Inspector offers two scan modes: agent-based and hybrid scanning.
    </span>
    <span class="koboSpan" id="kobo.1052.2">
     The agent-based mode provides continuous scans for SSM-managed instances, while hybrid scanning combines both methods, using agent-based scans for SSM-managed instances and agentless scans for eligible EBS-backed instances.
    </span>
    <span class="koboSpan" id="kobo.1052.3">
     Users can configure scan modes, manage exclusions, and ensure proper SSM agent setup to optimize vulnerability detection and maintain
    </span>
    <a id="_idIndexMarker1030">
    </a>
    <span class="koboSpan" id="kobo.1053.1">
     effective security monitoring
    </span>
    <a id="_idIndexMarker1031">
    </a>
    <span class="koboSpan" id="kobo.1054.1">
     for their
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1055.1">
      EC2 instances.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-343">
    <a id="_idTextAnchor347">
    </a>
    <span class="koboSpan" id="kobo.1056.1">
     There’s more...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1057.1">
     We explored how EC2 instances are scanned in this recipe.
    </span>
    <span class="koboSpan" id="kobo.1057.2">
     Amazon Inspector also supports scanning for the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1058.1">
      following resources:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1059.1">
       Amazon Elastic Container Registry
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1060.1">
      (
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1061.1">
       ECR
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1062.1">
      ): Amazon Inspector scans
     </span>
     <a id="_idIndexMarker1032">
     </a>
     <span class="koboSpan" id="kobo.1063.1">
      container images stored in Amazon ECR for vulnerabilities.
     </span>
     <span class="koboSpan" id="kobo.1063.2">
      This ensures that container images used in your environment are secure and free from
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1064.1">
       known issues.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1065.1">
       AWS Lambda
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1066.1">
      : Amazon Inspector scans AWS Lambda
     </span>
     <a id="_idIndexMarker1033">
     </a>
     <span class="koboSpan" id="kobo.1067.1">
      functions for vulnerabilities, checking the code and dependencies to ensure serverless applications
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1068.1">
       remain secure.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.1069.1">
     In this recipe, we explored the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1070.1">
      Findings
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1071.1">
     option in the left sidebar to review the findings.
    </span>
    <span class="koboSpan" id="kobo.1071.2">
     The left sidebar also offers several other options, including
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1072.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1073.1">
       Export SBOMs
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1074.1">
      : The
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1075.1">
       Software Bill of Materials
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1076.1">
      (
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1077.1">
       SBOM
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1078.1">
      ) provides a detailed list of software
     </span>
     <a id="_idIndexMarker1034">
     </a>
     <span class="koboSpan" id="kobo.1079.1">
      components and their relationships within a system.
     </span>
     <span class="koboSpan" id="kobo.1079.2">
      Amazon Inspector can generate and export SBOMs, which are helpful for understanding and managing software dependencies, ensuring compliance with security policies, and identifying potential vulnerabilities.
     </span>
     <span class="koboSpan" id="kobo.1079.3">
      This helps organizations maintain a comprehensive inventory of their
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1080.1">
       software components.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1081.1">
       Suppression rules
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1082.1">
      : Suppression rules in Amazon Inspector allow users to manage findings by suppressing specific types or sources of findings.
     </span>
     <span class="koboSpan" id="kobo.1082.2">
      This helps reduce noise and focus on critical vulnerabilities.
     </span>
     <span class="koboSpan" id="kobo.1082.3">
      Users can create suppression rules based on criteria such as vulnerability ID, resource tags, or resource types to ensure that only relevant findings are highlighted in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1083.1">
       security reports.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1084.1">
       On-demand scans
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1085.1">
      : On-demand scans allow users to manually initiate scans for vulnerabilities or network reachability issues on EC2 instances as needed.
     </span>
     <span class="koboSpan" id="kobo.1085.2">
      This is particularly useful after deploying new software or making significant infrastructure changes.
     </span>
     <span class="koboSpan" id="kobo.1085.3">
      Under the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1086.1">
       On-demand scans
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1087.1">
      menu, using the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1088.1">
       CIS scans
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1089.1">
      option, we can evaluate
     </span>
     <a id="_idIndexMarker1035">
     </a>
     <span class="koboSpan" id="kobo.1090.1">
      the compliance of EC2 instances with
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1091.1">
       Center for Internet Security
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1092.1">
      (
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1093.1">
       CIS
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1094.1">
      ) benchmarks, which are best practices for securing IT systems
     </span>
     <a id="_idIndexMarker1036">
     </a>
     <span class="koboSpan" id="kobo.1095.1">
      and data.
     </span>
     <span class="koboSpan" id="kobo.1095.2">
      These scans help organizations adhere to security standards and improve their security posture by identifying and addressing
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1096.1">
       non-compliant configurations.
      </span>
     </span>
    </li>
   </ul>
   <h3>
    <span class="koboSpan" id="kobo.1097.1">
     Note on Inspector Classic
    </span>
   </h3>
   <p>
    <span class="koboSpan" id="kobo.1098.1">
     The Inspector dashboard
    </span>
    <a id="_idIndexMarker1037">
    </a>
    <span class="koboSpan" id="kobo.1099.1">
     currently has a sidebar link called
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1100.1">
      Switch to Inspector Classic
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1101.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1101.2">
     Inspector Classic was the original version of Amazon Inspector, designed to help AWS users automate security assessments for their applications by checking for vulnerabilities and compliance issues.
    </span>
    <span class="koboSpan" id="kobo.1101.3">
     Although Inspector Classic was initially vital, it has largely been replaced by the new Amazon Inspector, which offers enhanced features and a more comprehensive, streamlined approach to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1102.1">
      security assessments.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1103.1">
     Inspector Classic remains available for users with existing dependencies, but transitioning to the new Amazon Inspector is advisable for the latest features, improved performance, and enhanced security capabilities.
    </span>
    <span class="koboSpan" id="kobo.1103.2">
     AWS continues to support Inspector Classic for backward compatibility, but new users and assessments should use the updated Amazon Inspector for optimal security management.
    </span>
    <span class="koboSpan" id="kobo.1103.3">
     For those interested in working with Inspector Classic, refer to the first edition of this book or the link provided in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1104.1">
      See
     </span>
    </em>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.1105.1">
       also
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1106.1">
      section.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-344">
    <a id="_idTextAnchor348">
    </a>
    <span class="koboSpan" id="kobo.1107.1">
     See also
    </span>
   </h2>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.1108.1">
      You can read more about
     </span>
     <a id="_idIndexMarker1038">
     </a>
     <span class="koboSpan" id="kobo.1109.1">
      Amazon Inspector
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1110.1">
       at
      </span>
     </span>
     <a href="https://www.cloudericks.com/blog/a-deep-dive-into-amazon-inspector-capabilities-and-integrations">
      <span class="No-Break">
       <span class="koboSpan" id="kobo.1111.1">
        https://www.cloudericks.com/blog/a-deep-dive-into-amazon-inspector-capabilities-and-integrations
       </span>
      </span>
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1112.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1113.1">
      Read about
     </span>
     <a id="_idIndexMarker1039">
     </a>
     <span class="koboSpan" id="kobo.1114.1">
      Inspector Classic
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1115.1">
       at
      </span>
     </span>
     <a href="https://www.cloudericks.com/blog/understanding-inspector-classic-and-transitioning-to-the-new-amazon-inspector">
      <span class="No-Break">
       <span class="koboSpan" id="kobo.1116.1">
        https://www.cloudericks.com/blog/understanding-inspector-classic-and-transitioning-to-the-new-amazon-inspector
       </span>
      </span>
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1117.1">
       .
      </span>
     </span>
    </li>
   </ul>
   <h1 id="_idParaDest-345">
    <a id="_idTextAnchor349">
    </a>
    <span class="koboSpan" id="kobo.1118.1">
     Setting up and using AWS Security Hub
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.1119.1">
     In this recipe, we
    </span>
    <a id="_idIndexMarker1040">
    </a>
    <span class="koboSpan" id="kobo.1120.1">
     will explore
    </span>
    <a id="_idIndexMarker1041">
    </a>
    <span class="koboSpan" id="kobo.1121.1">
     how to set up and utilize AWS Security Hub.
    </span>
    <span class="koboSpan" id="kobo.1121.2">
     Security Hub aggregates findings from services such as Config, GuardDuty, Macie, and Inspector, offering a centralized platform to manage security alerts and automate compliance checks.
    </span>
    <span class="koboSpan" id="kobo.1121.3">
     Security Hub can do automated compliance checks using the CIS AWS Foundations Benchmarks, which is enabled by default when we enable
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1122.1">
      Security Hub.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-346">
    <a id="_idTextAnchor350">
    </a>
    <span class="koboSpan" id="kobo.1123.1">
     Getting ready
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1124.1">
     We need the following to successfully complete
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1125.1">
      this recipe:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.1126.1">
      A working AWS account and a user, as described in the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.1127.1">
       Technical
      </span>
     </em>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1128.1">
        requirements
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1129.1">
       section.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1130.1">
      Set up AWS Config and enable recording as discussed in the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.1131.1">
       Setting up and using AWS Config
      </span>
     </em>
     <span class="koboSpan" id="kobo.1132.1">
      recipe in
     </span>
     <a href="B21384_07.xhtml#_idTextAnchor265">
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.1133.1">
         Chapter 7
        </span>
       </em>
      </span>
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1134.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1135.1">
      Set up one or more of the following services: Amazon GuardDuty, Amazon Macie, and Amazon Inspector, following the respective recipes in
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.1136.1">
       Chapters 7
      </span>
     </em>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1137.1">
        and
       </span>
      </em>
     </span>
     <span class="No-Break">
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1138.1">
        8
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1139.1">
       .
      </span>
     </span>
    </li>
   </ul>
   <h2 id="_idParaDest-347">
    <a id="_idTextAnchor351">
    </a>
    <span class="koboSpan" id="kobo.1140.1">
     How to do it...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1141.1">
     We can set up Security Hub in a region
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1142.1">
      as follows:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1143.1">
      Go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1144.1">
       Security Hub
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1145.1">
      service in the AWS
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1146.1">
       management console.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1147.1">
      If we are using Security Hub for the first time, we should see a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1148.1">
       Get started with Security Hub
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1149.1">
      section.
     </span>
     <span class="koboSpan" id="kobo.1149.2">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1150.1">
       Go to Security Hub
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1151.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1151.2">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1152.1">
       Enable AWS Config
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1153.1">
      section, we should see a message that AWS Config needs to be enabled
     </span>
     <a id="_idIndexMarker1042">
     </a>
     <span class="koboSpan" id="kobo.1154.1">
      with recording along
     </span>
     <a id="_idIndexMarker1043">
     </a>
     <span class="koboSpan" id="kobo.1155.1">
      with possible steps, which I assume you have done as mentioned in the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.1156.1">
       Getting
      </span>
     </em>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1157.1">
        ready
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1158.1">
       section.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer241">
     <span class="koboSpan" id="kobo.1159.1">
      <img alt="Figure 8.11 – The Enable AWS Config message while enabling Security Hub" src="image/B21384_08_11.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1160.1">
     Figure 8.11 – The Enable AWS Config message while enabling Security Hub
    </span>
   </p>
   <ol>
    <li value="3">
     <span class="koboSpan" id="kobo.1161.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1162.1">
       Security standards
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1163.1">
      section, select the security standards we want to enable from the available options as we can see in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1164.1">
        Figure 8
       </span>
      </em>
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.1165.1">
       .12
      </span>
     </em>
     <span class="koboSpan" id="kobo.1166.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1166.2">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1167.1">
       Delegated Administrator
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1168.1">
      section, we can add a delegated administrator account to manage Security Hub for this organization.
     </span>
     <span class="koboSpan" id="kobo.1168.2">
      Finally, click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1169.1">
       Enable
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1170.1">
        Security Hub
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1171.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer242">
     <span class="koboSpan" id="kobo.1172.1">
      <img alt="Figure 8.12 – Setting security standards while enabling Security Hub" src="image/B21384_08_12.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1173.1">
     Figure 8.12 – Setting security standards while enabling Security Hub
    </span>
   </p>
   <p class="list-inset">
    <span class="koboSpan" id="kobo.1174.1">
     We should see a screen
    </span>
    <a id="_idIndexMarker1044">
    </a>
    <span class="koboSpan" id="kobo.1175.1">
     with sections
    </span>
    <a id="_idIndexMarker1045">
    </a>
    <span class="koboSpan" id="kobo.1176.1">
     for
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1177.1">
      Summary
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1178.1">
     ,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1179.1">
      Security standards
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1180.1">
     ,
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.1181.1">
      Insights
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1182.1">
     , and so on.
    </span>
    <span class="koboSpan" id="kobo.1182.2">
     It may take some time for the findings to get updated.
    </span>
    <span class="koboSpan" id="kobo.1182.3">
     So, wait for some time before proceeding with
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1183.1">
      further steps.
     </span>
    </span>
   </p>
   <ol>
    <li value="4">
     <span class="koboSpan" id="kobo.1184.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1185.1">
       Security standards
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1186.1">
      from the left sidebar.
     </span>
     <span class="koboSpan" id="kobo.1186.2">
      If we are following on from
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.1187.1">
       Step 2
      </span>
     </em>
     <span class="koboSpan" id="kobo.1188.1">
      , for the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1189.1">
       AWS Foundational Security Best Practices v1.0.0
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1190.1">
      and
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1191.1">
       CIS AWS Foundations Benchmark v1.2.0
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1192.1">
      standards, we should see the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1193.1">
       View results
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1194.1">
      and
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1195.1">
       Disable standard
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1196.1">
      options.
     </span>
     <span class="koboSpan" id="kobo.1196.2">
      For the rest of the standards that are not enabled, we should see the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1197.1">
       Enable Standard
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1198.1">
      option.
     </span>
     <span class="koboSpan" id="kobo.1198.2">
      If we are not following on from
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.1199.1">
       Step 2
      </span>
     </em>
     <span class="koboSpan" id="kobo.1200.1">
      , we should enable the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1201.1">
       AWS Foundational Security Best Practices v1.0.0
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1202.1">
      and
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1203.1">
       CIS AWS Foundations Benchmark v1.2.0
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1204.1">
      standards using the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1205.1">
       Enable Standard
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1206.1">
      option and wait for some time until we see the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1207.1">
       Security score
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1208.1">
      for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1209.1">
       each standard.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1210.1">
      Once the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1211.1">
       Security
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1212.1">
      score is available for the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1213.1">
       AWS Foundational Security Best Practices v1.0.0
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1214.1">
      , click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1215.1">
       View results
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1216.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1216.2">
      We should see the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1217.1">
       Security score
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1218.1">
      and
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1219.1">
       Failed controls
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1220.1">
      values such as the following, but the exact details could differ from account
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1221.1">
       to account.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer243">
     <span class="koboSpan" id="kobo.1222.1">
      <img alt="Figure 8.13 – Viewing the results for a security standard" src="image/B21384_08_13.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1223.1">
     Figure 8.13 – Viewing the results for a security standard
    </span>
   </p>
   <ol>
    <li value="6">
     <span class="koboSpan" id="kobo.1224.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1225.1">
       Insights
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1226.1">
      on the left
     </span>
     <a id="_idIndexMarker1046">
     </a>
     <span class="koboSpan" id="kobo.1227.1">
      sidebar.
     </span>
     <span class="koboSpan" id="kobo.1227.2">
      We should see a list of existing
     </span>
     <a id="_idIndexMarker1047">
     </a>
     <span class="koboSpan" id="kobo.1228.1">
      insights, which are saved filters that display related findings.
     </span>
     <span class="koboSpan" id="kobo.1228.2">
      We can either select one of these existing insights or create a new one by clicking on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1229.1">
       Create
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1230.1">
        insight
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1231.1">
       button.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer244">
     <span class="koboSpan" id="kobo.1232.1">
      <img alt="Figure 8.14 – Insights" src="image/B21384_08_14.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1233.1">
     Figure 8.14 – Insights
    </span>
   </p>
   <ol>
    <li value="7">
     <span class="koboSpan" id="kobo.1234.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1235.1">
       Findings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1236.1">
      in the left sidebar
     </span>
     <a id="_idIndexMarker1048">
     </a>
     <span class="koboSpan" id="kobo.1237.1">
      to navigate to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1238.1">
       Findings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1239.1">
      page.
     </span>
     <span class="koboSpan" id="kobo.1239.2">
      Here, you can view
     </span>
     <a id="_idIndexMarker1049">
     </a>
     <span class="koboSpan" id="kobo.1240.1">
      a list of findings from various service integrations.
     </span>
     <span class="koboSpan" id="kobo.1240.2">
      You can filter this list based on multiple criteria, such as the service that generated the finding or the severity of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1241.1">
       the finding.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer245">
     <span class="koboSpan" id="kobo.1242.1">
      <img alt="Figure 8.15 – Findings" src="image/B21384_08_15.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1243.1">
     Figure 8.15 – Findings
    </span>
   </p>
   <ol>
    <li value="8">
     <span class="koboSpan" id="kobo.1244.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1245.1">
       Integrations
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1246.1">
      from the left
     </span>
     <a id="_idIndexMarker1050">
     </a>
     <span class="koboSpan" id="kobo.1247.1">
      sidebar to go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1248.1">
       Integrations
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1249.1">
      page, where
     </span>
     <a id="_idIndexMarker1051">
     </a>
     <span class="koboSpan" id="kobo.1250.1">
      we can see the list of integrations currently enabled and those that are yet to be enabled.
     </span>
     <span class="koboSpan" id="kobo.1250.2">
      For integrations that are already enabled, we can disable them from the
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1251.1">
        Integrations
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1252.1">
       page.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer246">
     <span class="koboSpan" id="kobo.1253.1">
      <img alt="Figure 8.16 – Integrations" src="image/B21384_08_16.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1254.1">
     Figure 8.16 – Integrations
    </span>
   </p>
   <ol>
    <li value="9">
     <span class="koboSpan" id="kobo.1255.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1256.1">
       Usage
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1257.1">
      from the left sidebar
     </span>
     <a id="_idIndexMarker1052">
     </a>
     <span class="koboSpan" id="kobo.1258.1">
      to see the estimated usage
     </span>
     <a id="_idIndexMarker1053">
     </a>
     <span class="koboSpan" id="kobo.1259.1">
      and pricing, including
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1260.1">
       Usage during
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1261.1">
        trial period
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1262.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1263.1">
      Go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1264.1">
       Configuration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1265.1">
      from the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1266.1">
       left sidebar.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1267.1">
      If central configuration is not enabled, we will see a link to
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1268.1">
       Start central configuration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1269.1">
      along with a warning message as follows:
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1270.1">
       Local configuration gives you limited access to security settings for your organization, for new accounts only.
      </span>
      <span class="koboSpan" id="kobo.1270.2">
       For additional configuration options, switch to central configuration.
      </span>
      <span class="koboSpan" id="kobo.1270.3">
       You can now use configuration policies to configure Security Hub across multiple Regions, accounts, and organizational units (OUs).
      </span>
      <span class="koboSpan" id="kobo.1270.4">
       When you switch, configuration policies replace the limited configuration settings for new organization accounts.
      </span>
      <span class="koboSpan" id="kobo.1270.5">
       We recommend central configuration for
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1271.1">
        account management
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1272.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1273.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1274.1">
       Accounts
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1275.1">
      section on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1276.1">
       Configuration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1277.1">
      page, we can add additional member accounts to share their findings with this account.
     </span>
     <span class="koboSpan" id="kobo.1277.2">
      An invitation will be sent to the member accounts, and they must accept
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1278.1">
       the invitation.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1279.1">
      Click on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1280.1">
       Custom actions
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1281.1">
      from the left sidebar to send selected insights and findings to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1282.1">
       Amazon EventBridge.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1283.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1284.1">
       Automations
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1285.1">
      from the left sidebar to update the Security Hub findings based on criteria that
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1286.1">
       we define.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1287.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1288.1">
       Regions
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1289.1">
      in the left sidebar to view findings across multiple regions.
     </span>
     <span class="koboSpan" id="kobo.1289.2">
      To start aggregating findings, click on the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1290.1">
       Configure finding aggregation
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1291.1">
      button to set an aggregation region and then link other regions to it for a consolidated view of your
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1292.1">
       security findings.
      </span>
     </span>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.1293.1">
       We can also disable Security Hub by clicking on
      </span>
      <strong class="bold">
       <span class="koboSpan" id="kobo.1294.1">
        General
       </span>
      </strong>
      <span class="koboSpan" id="kobo.1295.1">
       from the left sidebar and clicking on
      </span>
      <strong class="bold">
       <span class="koboSpan" id="kobo.1296.1">
        Disable AWS Security Hub
       </span>
      </strong>
      <span class="koboSpan" id="kobo.1297.1">
       .
      </span>
      <span class="koboSpan" id="kobo.1297.2">
       However, it is always recommended to have Security Hub enabled for all regions if the applicable costs are not
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.1298.1">
        a constraint.
       </span>
      </span>
     </p>
    </li>
   </ol>
   <h2 id="_idParaDest-348">
    <a id="_idTextAnchor352">
    </a>
    <span class="koboSpan" id="kobo.1299.1">
     How it works...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1300.1">
     AWS Security Hub
    </span>
    <a id="_idIndexMarker1054">
    </a>
    <span class="koboSpan" id="kobo.1301.1">
     acts as a centralized platform for security monitoring
    </span>
    <a id="_idIndexMarker1055">
    </a>
    <span class="koboSpan" id="kobo.1302.1">
     and management within the AWS environment.
    </span>
    <span class="koboSpan" id="kobo.1302.2">
     To get started, activate the service in the AWS Management Console.
    </span>
    <span class="koboSpan" id="kobo.1302.3">
     Once enabled, configure Security Hub to gather findings from a range of AWS services such as Amazon GuardDuty, AWS Inspector, and Amazon Macie, along with third-party tools and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1303.1">
      custom integrations.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1304.1">
     The service provides continuous monitoring for security issues, collecting and organizing findings on a unified dashboard.
    </span>
    <span class="koboSpan" id="kobo.1304.2">
     It prioritizes these findings based on their severity and impact, helping users to address the most critical issues first.
    </span>
    <span class="koboSpan" id="kobo.1304.3">
     Within the Security Hub console, users can investigate these findings to gain insights into potential security threats and vulnerabilities.
    </span>
    <span class="koboSpan" id="kobo.1304.4">
     Additionally, Security Hub supports automated responses through AWS Lambda integration, allowing users to automate remediation actions for detected
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1305.1">
      security issues.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1306.1">
     In summary, AWS Security Hub offers a comprehensive solution for managing security posture, compliance, and incident response, thereby streamlining security operations and enhancing
    </span>
    <a id="_idIndexMarker1056">
    </a>
    <span class="koboSpan" id="kobo.1307.1">
     overall protection
    </span>
    <a id="_idIndexMarker1057">
    </a>
    <span class="koboSpan" id="kobo.1308.1">
     within the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1309.1">
      AWS environment.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-349">
    <a id="_idTextAnchor353">
    </a>
    <span class="koboSpan" id="kobo.1310.1">
     There’s more...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1311.1">
     Let’s quickly go through some important concepts
    </span>
    <a id="_idIndexMarker1058">
    </a>
    <span class="koboSpan" id="kobo.1312.1">
     around Security Hub and its
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1313.1">
      related services:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.1314.1">
      Security Hub is a regional service.
     </span>
     <span class="koboSpan" id="kobo.1314.2">
      If cost is not a constraint, it is recommended to enable it in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1315.1">
       all regions.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1316.1">
      Security Hub can integrate with third-party security tools such as Alert Logic, Armor, Atlassian Opsgenie,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1317.1">
       and more.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1318.1">
      We can archive security findings from the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1319.1">
       Findings
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1320.1">
      page so that older ones won’t appear on
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1321.1">
       the page.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1322.1">
      The CIS provides security standards for different servers, applications, and cloud providers.
     </span>
     <span class="koboSpan" id="kobo.1322.2">
      For example, they provide a set of security standards that are specific to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1323.1">
       AWS security.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1324.1">
      CIS Benchmarks for AWS can be categorized into four categories: identity and access management, logging, monitoring,
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1325.1">
       and networking.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1326.1">
      IAM Access Analyzer uses logic-based reasoning to analyze resource-based policies in our AWS environment to inform us which resources in our account are shared with
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1327.1">
       external principals.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1328.1">
      AWS Firewall Manager can be used to manage firewall rules across accounts
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1329.1">
       and applications.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.1330.1">
     Learning about and understanding the CIS security benchmark controls for AWS will provide us with a better sense of security while working with AWS infrastructure.
    </span>
    <span class="koboSpan" id="kobo.1330.2">
     These controls can also help us make better decisions at work and even
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1331.1">
      during exams.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-350">
    <a id="_idTextAnchor354">
    </a>
    <span class="koboSpan" id="kobo.1332.1">
     See also
    </span>
   </h2>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.1333.1">
      Read more about
     </span>
     <a id="_idIndexMarker1059">
     </a>
     <span class="koboSpan" id="kobo.1334.1">
      AWS Security Hub
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1335.1">
       at
      </span>
     </span>
     <a href="https://www.cloudericks.com/blog/getting-started-with-aws-security-hub">
      <span class="No-Break">
       <span class="koboSpan" id="kobo.1336.1">
        https://www.cloudericks.com/blog/getting-started-with-aws-security-hub
       </span>
      </span>
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1337.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1338.1">
      You can find the list of
     </span>
     <a id="_idIndexMarker1060">
     </a>
     <span class="koboSpan" id="kobo.1339.1">
      CIS security standards supported by Security Hub
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1340.1">
       at
      </span>
     </span>
     <a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards.html">
      <span class="No-Break">
       <span class="koboSpan" id="kobo.1341.1">
        https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards.html
       </span>
      </span>
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1342.1">
       .
      </span>
     </span>
    </li>
   </ul>
   <h1 id="_idParaDest-351">
    <a id="_idTextAnchor355">
    </a>
    <span class="koboSpan" id="kobo.1343.1">
     Using IAM Access Analyzer to inspect unused access
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.1344.1">
     In this recipe, we will demonstrate
    </span>
    <a id="_idIndexMarker1061">
    </a>
    <span class="koboSpan" id="kobo.1345.1">
     how to utilize IAM Access Analyzer
    </span>
    <a id="_idIndexMarker1062">
    </a>
    <span class="koboSpan" id="kobo.1346.1">
     to identify and manage unused IAM resources within our environment.
    </span>
    <span class="koboSpan" id="kobo.1346.2">
     By focusing on detecting unused roles, access keys, and other critical components, we ensure adherence to security best practices.
    </span>
    <span class="koboSpan" id="kobo.1346.3">
     Through the process of configuring the analyzer to scan for unused resources, and interpreting the findings it generates, we gain valuable insights into potential security risks.
    </span>
    <span class="koboSpan" id="kobo.1346.4">
     By addressing any identified unused resources, we mitigate the risk of unauthorized access or misuse, enhancing the overall security posture of our
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1347.1">
      IAM environment.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-352">
    <a id="_idTextAnchor356">
    </a>
    <span class="koboSpan" id="kobo.1348.1">
     Getting ready
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1349.1">
     We need the following to successfully complete
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1350.1">
      this recipe:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.1351.1">
      A working AWS account and a user, as described in the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.1352.1">
       Technical
      </span>
     </em>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1353.1">
        requirements
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1354.1">
       section.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1355.1">
      We need to have some IAM users and roles within our AWS account; we can create these by referring to the recipes in
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.1356.1">
       Chapters 1
      </span>
     </em>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1357.1">
        and
       </span>
      </em>
     </span>
     <span class="No-Break">
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.1358.1">
        2
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1359.1">
       .
      </span>
     </span>
    </li>
   </ul>
   <h2 id="_idParaDest-353">
    <a id="_idTextAnchor357">
    </a>
    <span class="koboSpan" id="kobo.1360.1">
     How to do it...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1361.1">
     We can use IAM Analyzer to inspect unused access
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1362.1">
      as follows:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1363.1">
      Navigate to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1364.1">
       IAM
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1365.1">
      service in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1366.1">
       the console.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1367.1">
      Under
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1368.1">
       Access reports
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1369.1">
      , click on
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1370.1">
        Access Analyzer
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1371.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1372.1">
      Click on
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1373.1">
        Create analyzer
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1374.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1375.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1376.1">
       Analysis
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1377.1">
      section, we can
     </span>
     <a id="_idIndexMarker1063">
     </a>
     <span class="koboSpan" id="kobo.1378.1">
      see options
     </span>
     <a id="_idIndexMarker1064">
     </a>
     <span class="koboSpan" id="kobo.1379.1">
      for
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1380.1">
       External access analysis
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1381.1">
      and
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1382.1">
       Unused access analysis
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1383.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1383.2">
      Select the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1384.1">
       Unused access
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1385.1">
        analysis
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1386.1">
       option.
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer247">
     <span class="koboSpan" id="kobo.1387.1">
      <img alt="Figure 8.17 – Configuring the Findings type" src="image/B21384_08_17.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1388.1">
     Figure 8.17 – Configuring the Findings type
    </span>
   </p>
   <ol>
    <li value="5">
     <span class="koboSpan" id="kobo.1389.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1390.1">
       Analyzer details
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1391.1">
      section, leave the autogenerated
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1392.1">
       Name
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1393.1">
      for our Analyzer as-is.
     </span>
     <span class="koboSpan" id="kobo.1393.2">
      For
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1394.1">
       Zone of trust
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1395.1">
      , select
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1396.1">
        Current organization
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1397.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1398.1">
      Scroll down and click
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1399.1">
       Create analyzer
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1400.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1400.2">
      Wait for some time for the findings to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1401.1">
       be populated.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1402.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1403.1">
       Access Analyzer
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1404.1">
      in the left sidebar to see the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1405.1">
       Findings overview
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1406.1">
      page that contains the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1407.1">
       findings summary.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1408.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1409.1">
       Unused access
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1410.1">
      from the left sidebar.
     </span>
     <span class="koboSpan" id="kobo.1410.2">
      We should see findings related to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1411.1">
       unused access.
      </span>
     </span>
    </li>
   </ol>
   <h2 id="_idParaDest-354">
    <a id="_idTextAnchor358">
    </a>
    <span class="koboSpan" id="kobo.1412.1">
     How it works...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1413.1">
     Using IAM Analyzer
    </span>
    <a id="_idIndexMarker1065">
    </a>
    <span class="koboSpan" id="kobo.1414.1">
     to inspect unused access works
    </span>
    <a id="_idIndexMarker1066">
    </a>
    <span class="koboSpan" id="kobo.1415.1">
     by employing it as a security scanner for your IAM resources.
    </span>
    <span class="koboSpan" id="kobo.1415.2">
     It analyzes roles, access keys, and permissions across your environment.
    </span>
    <span class="koboSpan" id="kobo.1415.3">
     By examining how recently these resources were used, it identifies elements that haven’t been active for a specific period.
    </span>
    <span class="koboSpan" id="kobo.1415.4">
     This can indicate unnecessary access or forgotten configurations, potentially posing security vulnerabilities.
    </span>
    <span class="koboSpan" id="kobo.1415.5">
     With these insights, you can tighten access controls and improve the security posture of your
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1416.1">
      IAM environment.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-355">
    <a id="_idTextAnchor359">
    </a>
    <span class="koboSpan" id="kobo.1417.1">
     There’s more...
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1418.1">
     While identifying unused resources
    </span>
    <a id="_idIndexMarker1067">
    </a>
    <span class="koboSpan" id="kobo.1419.1">
     is a valuable capability, IAM Analyzer offers a broader range of functionalities to enhance your IAM
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1420.1">
      security posture:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1421.1">
       Verifying Permissions
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1422.1">
      : IAM Analyzer can validate policies against best practices and identify overly permissive settings that could grant
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1423.1">
       unintended access.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1424.1">
       Monitoring External Sharing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1425.1">
      : Keep track of resources shared with external entities outside your AWS account.
     </span>
     <span class="koboSpan" id="kobo.1425.2">
      This helps identify potential security risks associated with unintended access granted to external users
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1426.1">
       or applications.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1427.1">
       Custom Policy Checks
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1428.1">
      : Define your own security standards and leverage IAM Analyzer to validate IAM policies against these custom checks.
     </span>
     <span class="koboSpan" id="kobo.1428.2">
      This empowers you to enforce specific security requirements within
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1429.1">
       your organization.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1430.1">
       Automating Policy Generation
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1431.1">
      : Simplify policy creation by leveraging IAM Analyzer’s ability to generate IAM policies based on access activity logs from CloudTrail.
     </span>
     <span class="koboSpan" id="kobo.1431.2">
      This streamlines the process and helps ensure policies reflect actual
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1432.1">
       usage patterns.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1433.1">
       Continuous Monitoring
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1434.1">
      : IAM Analyzer is not a one-time scan; it provides ongoing monitoring of your IAM environment.
     </span>
     <span class="koboSpan" id="kobo.1434.2">
      This allows for the proactive identification of potential security
     </span>
     <a id="_idIndexMarker1068">
     </a>
     <span class="koboSpan" id="kobo.1435.1">
      issues as your IAM
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1436.1">
       configuration evolves.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.1437.1">
     The steps to set up Amazon EventBridge
    </span>
    <a id="_idIndexMarker1069">
    </a>
    <span class="koboSpan" id="kobo.1438.1">
     to monitor our findings from Access Analyzer can be summarized
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1439.1">
      as follows:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.1440.1">
      Go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1441.1">
       Amazon EventBridge
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1442.1">
      service in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1443.1">
       the console.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1444.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1445.1">
       Rules
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1446.1">
      under
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1447.1">
       Buses
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1448.1">
      from the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1449.1">
       left sidebar.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1450.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1451.1">
       Create rule
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1452.1">
      to go to the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1453.1">
       Create
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1454.1">
        rule
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1455.1">
       page.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1456.1">
      On the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1457.1">
       Define rule detail
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1458.1">
      page, provide a name and description for our rule.
     </span>
     <span class="koboSpan" id="kobo.1458.2">
      Leave the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1459.1">
       Event bus
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1460.1">
      as
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1461.1">
       default
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1462.1">
      and
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1463.1">
       Rule type
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1464.1">
      as
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1465.1">
       Rule with an event pattern
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1466.1">
      and click
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1467.1">
       on
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1468.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1469.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1470.1">
      In the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1471.1">
       Build event pattern
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1472.1">
      section, scroll down to
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1473.1">
        Event pattern
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1474.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1475.1">
      Set
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1476.1">
       Event source
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1477.1">
      to
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1478.1">
        AWS services
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1479.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1480.1">
      Set
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1481.1">
       AWS service
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1482.1">
      to
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1483.1">
        Access Analyzer
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1484.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1485.1">
      Set
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1486.1">
       Event Type
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1487.1">
      to
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1488.1">
       Access
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1489.1">
        Analyzer Finding
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1490.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1491.1">
      Set
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1492.1">
       Event Type Specification 1
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1493.1">
      to
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1494.1">
       Any resource
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1495.1">
        by ARN
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1496.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1497.1">
      Click on
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1498.1">
       Next
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1499.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1499.2">
      Under
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1500.1">
       Targets
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1501.1">
      , Choose
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1502.1">
       SNS topic
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1503.1">
      from the dropdown under
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1504.1">
       Select
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1505.1">
        a target
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1506.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1507.1">
      Select a topic.
     </span>
     <span class="koboSpan" id="kobo.1507.2">
      You can create an SNS topic by following the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.1508.1">
       Creating an SNS topic to send emails
      </span>
     </em>
     <span class="koboSpan" id="kobo.1509.1">
      recipe in
     </span>
     <a href="B21384_07.xhtml#_idTextAnchor265">
      <span class="No-Break">
       <em class="italic">
        <span class="koboSpan" id="kobo.1510.1">
         Chapter 7
        </span>
       </em>
      </span>
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1511.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1512.1">
      Click
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1513.1">
       on
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1514.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1515.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1516.1">
      Optionally, click
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1517.1">
       Add new tags
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1518.1">
      and click
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1519.1">
       on
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1520.1">
        Next
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1521.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1522.1">
      Review the rule and click on
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1523.1">
        Create rule
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1524.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <h2 id="_idParaDest-356">
    <a id="_idTextAnchor360">
    </a>
    <span class="koboSpan" id="kobo.1525.1">
     See also
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.1526.1">
     Read about
    </span>
    <a id="_idIndexMarker1070">
    </a>
    <span class="koboSpan" id="kobo.1527.1">
     essential tools to Secure IAM
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1528.1">
      at
     </span>
    </span>
    <a href="https://www.cloudericks.com/blog/essential-tools-to-secure-iam">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1529.1">
       https://www.cloudericks.com/blog/essential-tools-to-secure-iam
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1530.1">
      .
     </span>
    </span>
   </p>
  </div>
 </body></html>