<html><head></head><body><div class="chapter" title="Chapter&#xA0;1.&#xA0;Introduction to Attacking Web&#xA0;Applications"><div class="titlepage"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Introduction to Attacking Web Applications</h1></div></div></div><p>Web applications are everywhere. They are part of the fabric of society and we depend on them in many aspects of our lives. Nowadays, they are easy to develop, quick to deploy, and accessible by anyone with an internet connection.</p><p>The technology designed to help develop and deploy web applications has also boomed. New frameworks that enhance functionality and usability are released daily. Companies have shifted power to the developer, allowing them to be more agile and produce web applications quickly.</p><p>The following figure gives a taste of the more popular development environments and frameworks that have taken the application development world by storm. <span class="strong"><strong>Node.js</strong></span> has brought the browser client scripting language <span class="strong"><strong>JavaScript</strong></span> to the server-side, complete with a massive library of modules to aid in fast application development. JavaScript, a once seldom-used scripting language for the browser, is supercharged on the client-side with <span class="strong"><strong>React</strong></span> and <span class="strong"><strong>Angular</strong></span>, and is even available for cross-platform development with the likes of <span class="strong"><strong>Electron</strong></span> and <span class="strong"><strong>Chromium</strong></span>:</p><div class="mediaobject"><img src="graphics/B09238_01_01.jpg" alt="Introduction to Attacking Web Applications"/><div class="caption"><p>Figure 1.1: The world has changed since Netscape ruled online and this graphic shows but a taste of the technologies that dominate the web today</p></div></div><p>GitHub has become the one-stop shop for open-source libraries, applications, and anything a developer may want to share with the world. Anyone can upload anything they want and others can collaborate by pushing code changes or saving a dying codebase, by forking it and continuing development locally. GitHub is not alone, of course, as there are similar repositories for Node.js, Python, and PHP modules.</p><p>The developer's focus is always on getting the product shipped, whether it's a simple feature implementation in an internal web application used by the marketing department, or the latest and greatest web banking interface. The infrastructure required to support these applications has also evolved and developers struggle to integrate security into their workflow. It's not always ignorance that hurts secure application development, however. More often than not, time constraints and deadlines are to blame.</p><p>The goal of this book is to showcase how attackers view web applications and how they take advantage of weaknesses in the application code and infrastructure. We will consider all the common mistakes made during the development process that are used to gain meaningful access. We will look at practical attacks and making the most of common application vulnerabilities.</p><p>Some assumptions about your knowledge level are made. To get the most value out of reading this book, a basic knowledge of application security should be there. Readers do not have to be experts in the field of penetration testing or application security, but they should have an <a id="id0" class="indexterm"/>idea about what <span class="strong"><strong>cross-site scripting</strong></span> (<span class="strong"><strong>XSS</strong></span>) or <span class="strong"><strong>SQL injection</strong></span> (<span class="strong"><strong>SQLi</strong></span>) attacks are. We will not devote a chapter to the standard "Hello World" example for XSS, but <a id="id1" class="indexterm"/>we will show the impact of exploiting such a vulnerability. The reader should also be familiar with the Linux command prompt and common console tools, such as <code class="literal">curl</code>, <code class="literal">git</code>, and <code class="literal">wget</code>. Some familiarity with programming will certainly help, but it is not a hard requirement.</p><p>In this chapter, we will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The typical rules of engagement when conducting a test</li><li class="listitem" style="list-style-type: disc">The tester's toolkit</li><li class="listitem" style="list-style-type: disc">Attack proxies</li><li class="listitem" style="list-style-type: disc">How the cloud can help with engagements</li></ul></div><div class="section" title="Rules of engagement"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Rules of engagement</h1></div></div></div><p>Before moving forward with the fun stuff, it is important to <a id="id2" class="indexterm"/>always remember the <span class="strong"><strong>rules of engagement</strong></span> (<span class="strong"><strong>ROE</strong></span>) when conducting an attack. The ROE are typically written out in the pre-engagement <span class="strong"><strong>statement of work</strong></span> (<span class="strong"><strong>SoW</strong></span>) and all testers <a id="id3" class="indexterm"/>must adhere to them. They outline expectations of the tester and set some limits to what can be done during the engagement.</p><p>While the goal of a typical penetration test is to simulate an actual attack and find weaknesses in the infrastructure or application, there are many limitations, and with good reason. We cannot go in guns blazing and cause more damage than an actual adversary. The target (client), be they a third party or an internal group, should feel comfortable letting professional hackers hammer away at their applications.</p><div class="section" title="Communication"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec05"/>Communication</h2></div></div></div><p>Good communication is <a id="id4" class="indexterm"/>key to a successful engagement. <span class="strong"><strong>Kickoff</strong></span> and <span class="strong"><strong>close-out</strong></span> meetings are extremely valuable to both parties involved. The client should be well aware of who is performing the exercise, and how they can reach them, or a backup, in case of an emergency.</p><p>The kickoff <a id="id5" class="indexterm"/>meeting is a chance to go over all aspects of the test, including reviewing the project scope, the <a id="id6" class="indexterm"/>criticality of the systems, any credentials that were provided, and contact information. With any luck, all of this information was included in the <span class="strong"><strong>scoping document</strong></span>. This document's purpose is to clearly outline what parts of the infrastructure or applications are to be tested during the engagement. The scope can be a combination of IP ranges, applications, specific domains, or URLs. This document is usually written with the input of the client, well in advance of the test start date. Things can change, however, and the kickoff is a good time to go over everything one last time.</p><p>Useful questions to clarify during the kickoff meeting are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Has the scope <a id="id7" class="indexterm"/>changed since the document's last revision? Has the target list changed? Should certain parts of the application or network be avoided?</li><li class="listitem" style="list-style-type: disc">Is there a testing window to which you must adhere?</li><li class="listitem" style="list-style-type: disc">Are the target applications in production or in a development environment? Are they customer-facing or internal only?</li><li class="listitem" style="list-style-type: disc">Are the emergency contacts still valid?</li><li class="listitem" style="list-style-type: disc">If credentials were provided, are they still valid? Now is the time to check these again.</li><li class="listitem" style="list-style-type: disc">Is there an application firewall that may hinder testing?</li></ul></div><p>The goal is generally to test the application and not third-party defenses. Penetration testers have deadlines, while malicious actors do not.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip02"/>Tip</h3><p>When testing an application for vulnerabilities, it is a good idea to ask the client to whitelist out IPs in any third-party <span class="strong"><strong>web application firewalls</strong></span> (<span class="strong"><strong>WAFs</strong></span>). WAFs inspect traffic reaching the <a id="id8" class="indexterm"/>protected application and will drop requests that match known attack signatures or patterns. Some clients will choose to keep the WAF in an enforcing mode, as their goal may be to simulate a real-world attack. This is when you should remind the clients that firewalls can introduce delays in assessing the actual application, as the tester may have to spend extra time attempting to evade defenses. Further, since there is a time limit to most engagements, the final report may not accurately reflect the security posture of the application.</p></div></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip03"/>Tip</h3><p>No manager wants to hear that their critical application may go offline during a test, but this does occasionally happen. Some applications cannot handle the increased workload of a simple scan and will failover. Certain payloads can also break poorly-designed applications or infrastructure, and may bring productivity to a grinding halt.</p></div></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip04"/>Tip</h3><p>If, during a test, an application becomes unresponsive, it's a good idea to call the primary contact, informing them of this as soon as possible, especially if the application is a critical production system. If the client is unavailable by phone, then be sure to send an email alert at minimum.</p></div></div><p>Close-out meetings <a id="id9" class="indexterm"/>or post-mortems are also very important. A particularly successful engagement with lots of critical findings may leave the tester feeling great, but the client could be mortified, as they must explain the results to their superiors. This is the time to meet with the client and go over every finding, and explain clearly how the security breach occurred and what could be done to fix it. Keep the audience in mind and convey the concerns in a common language, without assigning blame or ridiculing any parties involved.</p></div><div class="section" title="Privacy considerations"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec06"/>Privacy considerations</h2></div></div></div><p>Engagements that involve <a id="id10" class="indexterm"/>any kind of social engineering or human interaction, such as <span class="strong"><strong>phishing</strong></span> exercises, should be carefully handled. A phishing attack attempts to trick a user into following an email link to a credential stealer, or opening a malicious attachment, and some employees may be uncomfortable being used in this manner.</p><p>Before sending phishing emails, for example, testers should confirm that the client is comfortable with their employees unknowingly participating in the engagement. This should be recorded in writing, usually in the SoW. The kickoff meeting is a good place to synchronize with the client and their expectations.</p><p>Unless there is explicit written permission from the client, avoid the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Do not perform social engineering attacks that may be considered immoral, for example, using intelligence gathered about a target's family to entice them to click on a link</li><li class="listitem" style="list-style-type: disc">Do not exfiltrate medical records or sensitive user data</li><li class="listitem" style="list-style-type: disc">Do not capture screenshots of a user's machines</li><li class="listitem" style="list-style-type: disc">Do not replay credentials to a user's personal emails, social media, or other accounts</li></ul></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note02"/>Note</h3><p>Some web attacks, such as SQLi or <span class="strong"><strong>XML External Entity</strong></span> (<span class="strong"><strong>XXE</strong></span>), may lead to data leaks, in which case <a id="id11" class="indexterm"/>you should inform the client of the vulnerability as soon as possible and securely destroy anything already downloaded.</p></div></div><p>While most tests are done under <span class="strong"><strong>non-disclosure agreements</strong></span> (<span class="strong"><strong>NDAs</strong></span>), handling sensitive data should be avoided where <a id="id12" class="indexterm"/>possible. There is little reason to hold onto medical records or credit card information after an engagement. In fact, hoarding this data could put the client in breach of regulatory compliance and could also be illegal. This type of data does not usually provide any <a id="id13" class="indexterm"/>kind of leverage when attempting to exploit additional applications. When entering proof in the final report, extra care must be taken to ensure that the evidence is sanitized and that it contains only enough context to prove the finding.</p><div class="blockquote"><blockquote class="blockquote"><p>"Data is a toxic asset. We need to start thinking about it as such, and treat it as we would any other source of toxicity. To do anything else is to risk our security and privacy."</p><p>                                                                                                      - Bruce Schneier</p></blockquote></div><p>The preceding quote is generally aimed at companies with questionable practices when it comes to private user data, but it applies to testers as well. We often come across sensitive data in our adventures.</p></div><div class="section" title="Cleaning up"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec07"/>Cleaning up</h2></div></div></div><p>A successful penetration test or application assessment will undoubtedly leave many traces of the activity behind. Log <a id="id14" class="indexterm"/>entries could show how the intrusion was possible and a shell history file can provide clues as to how the attacker moved laterally. There is a benefit in leaving breadcrumbs behind, however. The defenders, also referred to as the blue team, can analyze the activity during or post-engagement and evaluate the efficacy of their defenses. Log entries provide valuable information on how the attacker was able to bypass the system defenses and execute code, exfiltrate data, or otherwise breach the network.</p><p>There are many tools to wipe logs post-exploitation, but unless the client has explicitly permitted these actions, this <a id="id15" class="indexterm"/>practice should be avoided. There are instances where the blue team may want to test the resilience of their <span class="strong"><strong>security information and event monitoring</strong></span> (<span class="strong"><strong>SIEM</strong></span>) infrastructure (a centralized log collection and analysis system), so <a id="id16" class="indexterm"/>wiping logs may be in scope, but this should be explicitly allowed in the engagement documents.</p><p>That being said, there are certain artifacts that should almost always be completely removed from systems or application databases when the engagement has completed. The following artifacts can expose the client to unnecessary risk, even after they've patched the vulnerabilities:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Web shells providing access to the <span class="strong"><strong>operating system </strong></span>(<span class="strong"><strong>OS</strong></span>)</li><li class="listitem" style="list-style-type: disc">Malware droppers, reverse shells, and privilege escalation exploit payloads</li><li class="listitem" style="list-style-type: disc">Malware in the form of Java applets deployed via Tomcat</li><li class="listitem" style="list-style-type: disc">Modified or backdoored application or system components:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Example: overwriting the password binary with a race condition root exploit and not restoring the backup before leaving the system</li></ul></div></li></ul></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Stored XSS payloads: this can be more of a nuisance to users on production systems</li></ul></div><p>Not all malware introduced during the test can be removed by the tester. Cleanup requires reaching out to the client.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip05"/>Tip</h3><p>Make a note of all malicious files, paths, and payloads used in the assessment. At the end of the engagement, attempt to remove as much as possible. If anything is left behind, inform the primary contact, providing details and stressing the importance of removing the artifacts.</p></div></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip06"/>Tip</h3><p>Tagging payloads with a unique keyword can help to identify bogus data during the cleanup effort, for example: "Please remove any database records that contain the keyword: 2017Q3TestXyZ123."</p></div></div><p>A follow-up email confirming <a id="id17" class="indexterm"/>that the client has removed any lingering malware or artifacts serves as a reminder and is always appreciated.</p></div></div></div>
<div class="section" title="The tester's toolkit"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>The tester's toolkit</h1></div></div></div><p>The penetration testing tools <a id="id18" class="indexterm"/>used vary from professional to professional. Tools and techniques evolve every day and you have to keep up. While it's nearly impossible to compile an exhaustive list of tools that will cover every scenario, there are some tried-and-true programs, techniques, and environments that will undoubtedly help any attacker to reach their goal.</p><div class="section" title="Kali Linux"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec08"/>Kali Linux</h2></div></div></div><p>Previously known as <span class="strong"><strong>BackTrack</strong></span>, <span class="strong"><strong>Kali Linux</strong></span> has been the Linux distribution of choice for penetration <a id="id19" class="indexterm"/>testers for many years. It is hard to argue with its value, as it incorporates almost all of the tools required to do application and network assessments. The <a id="id20" class="indexterm"/>Kali Linux team also provides regular updates, keeping not only the OS but also the attack tools current.</p><p>Kali Linux is easy to deploy just about everywhere and it comes in many formats. There are 32-bit and 64-bit variants, portable virtual machine packages, and even a version that runs on the Android OS:</p><div class="mediaobject"><img src="graphics/B09238_01_02.jpg" alt="Kali Linux"/><div class="caption"><p>Figure 1.2: A fresh instance of the Kali Linux screen</p></div></div></div><div class="section" title="Kali Linux alternatives"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec09"/>Kali Linux alternatives</h2></div></div></div><p>One alternative or supplement to Kali Linux is the <span class="strong"><strong>Penetration Testing Framework</strong></span> (<span class="strong"><strong>PTF</strong></span>) from the TrustedSec team and it is written in Python. This <a id="id21" class="indexterm"/>is a modular <a id="id22" class="indexterm"/>framework that allows you to turn the Linux environment of your choice into a penetration testing toolset. There <a id="id23" class="indexterm"/>are hundreds of PTF modules already available, and new ones can be quickly created. PTF can also be run on Kali to quickly organize existing tools in one location.</p><div class="mediaobject"><img src="graphics/B09238_01_03.jpg" alt="Kali Linux alternatives"/><div class="caption"><p>Figure 1.3: The PTF interactive console</p></div></div><p>Another well-established <a id="id24" class="indexterm"/>alternative to Kali Linux is <span class="strong"><strong>BlackArch</strong></span>, a distribution based on <span class="strong"><strong>Arch Linux</strong></span> that includes many of the tools bundled with other penetration <a id="id25" class="indexterm"/>testing distributions. BlackArch has many of <a id="id26" class="indexterm"/>the tools that testers are familiar with <a id="id27" class="indexterm"/>for network testing or application assessments, and it is regularly updated, much like Kali Linux. For Arch Linux fans, this is a welcome alternative to the Debian-based Kali distribution.</p><div class="mediaobject"><img src="graphics/B09238_01_04.jpg" alt="Kali Linux alternatives"/><div class="caption"><p>Figure 1.4: The main BlackArch screen</p></div></div><p>BlackArch is available in many formats on <a class="ulink" href="https://blackarch.org">https://blackarch.org</a>.</p></div></div>
<div class="section" title="The attack proxy"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec12"/>The attack proxy</h1></div></div></div><p>When testing <a id="id28" class="indexterm"/>applications, traffic manipulation and recording is invaluable. The major players in this market are also extendable, allowing the community of researchers to improve functionality with free add-ons. Well-built and supported proxies are powerful weapons in the attacker's arsenal.</p><div class="section" title="Burp Suite"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec10"/>Burp Suite</h2></div></div></div><p>
<span class="strong"><strong>Burp Suite</strong></span> is arguably <a id="id29" class="indexterm"/>the king when it comes to attack proxies. It allows you to intercept, change, replay, and record traffic out of the box. Burp Suite is highly extendable, with <a id="id30" class="indexterm"/>powerful community plugins that integrate with <span class="strong"><strong>sqlmap</strong></span> (the de facto SQLi exploitation tool), automatically test for privilege escalation, and offer other useful modules:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Proxy</strong></span>: Record, intercept, and modify requests on the fly</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Spider</strong></span>: Content discovery with powerful crawling capabilities</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Decoder</strong></span>: Unscramble encoded data quickly</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Intruder</strong></span>: A highly customizable brute-forcing module</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Repeater</strong></span>: Allows the replay of any request previously recorded, with the ability to modify any part of the request itself</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Scanner</strong></span> (<span class="strong"><strong>pro only</strong></span>): A vulnerability scanner that integrates with <span class="strong"><strong>Burp Collaborator</strong></span> to find obscure vulnerabilities</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Collaborator</strong></span>: Aids in the discovery of obscure vulnerabilities, which would normally be missed by traditional scanners</li></ul></div><p>There is a free version of Burp Suite, but the professional edition of the product is well worth the investment. While the free<a id="id31" class="indexterm"/> version is perfectly usable for quick tests, it does have some limitations. Notably, the Intruder module is time-throttled, making it useless for large payloads. The Scanner <a id="id32" class="indexterm"/>module is also only available in the professional version and it is worth the price. Scanner can quickly find low-hanging fruit and even automatically leverage Collaborator to find out-of-band vulnerabilities. The free version can still intercept, inspect, and replay requests, and it can also alert of any vulnerabilities it has passively detected.</p><div class="mediaobject"><img src="graphics/B09238_01_05.jpg" alt="Burp Suite"/><div class="caption"><p>Figure 1.5: The main Burp Suite Free Edition screen</p></div></div></div><div class="section" title="Zed Attack Proxy"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec11"/>Zed Attack Proxy</h2></div></div></div><p>OWASP's <span class="strong"><strong>Zed Attack Proxy</strong></span> (<span class="strong"><strong>ZAP</strong></span>) is another really great attack proxy. It is extendable and easy to use. However, it lacks <a id="id33" class="indexterm"/>some of the features of Burp Suite; for example, ZAP does not have the extensive active vulnerability scanning capabilities of <a id="id34" class="indexterm"/>Burp Suite Pro, nor does it have an automated out-of-band vulnerability discovery system comparable to Collaborator.</p><p>However, there is no time-throttling on its version of the Intruder module and all of its features are available out of the box. ZAP is open-source and it is actively worked on by hundreds of volunteers.</p><div class="mediaobject"><img src="graphics/B09238_01_06.jpg" alt="Zed Attack Proxy"/><div class="caption"><p>Figure 1.6: The main ZAP screen</p></div></div></div></div>
<div class="section" title="Cloud infrastructure"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Cloud infrastructure</h1></div></div></div><p>When conducting assessments, it is <a id="id35" class="indexterm"/>common for an attacker to leverage <span class="strong"><strong>command and control</strong></span> (<span class="strong"><strong>C2</strong></span>) servers during a campaign. The purpose of most C2 servers is to issue commands to <a id="id36" class="indexterm"/>malware running inside the compromised environment. </p><p>Attackers can instruct malware to exfiltrate data, start a keylogger, execute arbitrary commands or shellcode, and much more. In later chapters, we will primarily use the cloud C2 server to exfiltrate data and to discover vulnerabilities out-of-band.</p><p>A C2 server, being accessible from anywhere, is versatile in any engagement. The cloud is the perfect location to host C2 infrastructure. It allows quick and programmable deployments that can be accessed from anywhere in the world. Some cloud providers will even support HTTPS, allowing for the quick spin up of a C2 without having to worry about purchasing and managing domains or certificates.</p><p>The popular <a id="id37" class="indexterm"/>choice for penetration testers is <span class="strong"><strong>Amazon Web Services</strong></span> (<span class="strong"><strong>AWS</strong></span>), a leader in the cloud space. Its services are fairly inexpensive <a id="id38" class="indexterm"/>and it offers an introductory <a id="id39" class="indexterm"/>free tier option.</p><p>Other <a id="id40" class="indexterm"/>viable cloud providers include <a id="id41" class="indexterm"/>the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Microsoft Azure</strong></span>: <a class="ulink" href="https://portal.azure.com">https://portal.azure.com</a></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Google Cloud Platform</strong></span>: <a class="ulink" href="https://cloud.google.com">https://cloud.google.com</a></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>DigitalOcean</strong></span>: <a class="ulink" href="https://www.digitalocean.com">https://www.digitalocean.com</a></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Linode</strong></span>: <a class="ulink" href="https://www.linode.com">https://www.linode.com</a></li></ul></div><p>Microsoft's Azure has a <span class="strong"><strong>software as a service</strong></span> (<span class="strong"><strong>SaaS</strong></span>) free tier feature that lets you deploy C2 automatically from a GitHub <a id="id42" class="indexterm"/>repository. It also provides HTTPS support out of the box, making it easier to hide C2 data from prying eyes and enabling it to blend in with normal user traffic.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note03"/>Note</h3><p>Always get permission (in writing!) from the cloud provider before conducting assessments using its infrastructure, even if it's something as simple as hosting a malicious JavaScript file on a temporary virtual machine.</p></div></div><p>Cloud <span class="strong"><strong>internet service providers</strong></span> (<span class="strong"><strong>ISPs</strong></span>) should have a form available for you to fill out that will detail an upcoming <a id="id43" class="indexterm"/>penetration test on their infrastructure. A testing window and contact information will likely need to be provided.</p><p>Whether we are using the <a id="id44" class="indexterm"/>cloud to house a C2 for an engagement or attacking applications hosted in the cloud, we should always notify the client of penetration testing - related activity.</p><div class="mediaobject"><img src="graphics/B09238_01_07.jpg" alt="Cloud infrastructure"/><div class="caption"><p>Figure 1.7: A typical penetration test notification form</p></div></div></div>
<div class="section" title="Resources"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec14"/>Resources</h1></div></div></div><p>Consult the following <a id="id45" class="indexterm"/>resources for more information on penetration testing tools and techniques:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Penetration Testers Framework</strong></span> (<span class="strong"><strong>PTF</strong></span>): <a class="ulink" href="https://github.com/trustedsec/ptf">https://github.com/trustedsec/ptf</a></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>BlackArch</strong></span>: <a class="ulink" href="https://blackarch.org">https://blackarch.org</a></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Burp Suite</strong></span>: <a class="ulink" href="https://portswigger.net/burp/">https://portswigger.net/burp/</a></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>OWASP ZAP</strong></span>: <a class="ulink" href="https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project">https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project</a></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Amazon Web Services</strong></span>: <a class="ulink" href="https://aws.amazon.com">https://aws.amazon.com</a></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Microsoft Azure</strong></span>: <a class="ulink" href="https://portal.azure.com">https://portal.azure.com</a></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Google Cloud Platform</strong></span>: <a class="ulink" href="https://cloud.google.com">https://cloud.google.com</a></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>DigitalOcean</strong></span>: <a class="ulink" href="https://www.digitalocean.com">https://www.digitalocean.com</a></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Linode</strong></span>: <a class="ulink" href="https://www.linode.com">https://www.linode.com</a></li></ul></div></div>
<div class="section" title="Exercises"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec15"/>Exercises</h1></div></div></div><p>Complete the following exercises to get better acquainted with the hacker toolset and the tools we'll be using throughout this book:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Download and install your preferred penetration testing distribution: Kali or BlackArch, or play around with PTF</li><li class="listitem">Use Burp Suite Free or ZAP to intercept, inspect, and modify traffic to your favorite site</li><li class="listitem">Create a free account on the cloud computing provider of your choice and use its free tier to launch a Linux virtual machine instance</li></ol></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec16"/>Summary</h1></div></div></div><p>In this chapter, we looked at tools, environments, and the bare minimum ROE we must follow during engagements. We stressed how important communication is and how critical it is to consider client privacy while testing. We are not the bad guys and we cannot operate with impunity. We've also gone over the clean - up process and it is vital that we leave no artifacts, unless otherwise requested by the client. Our leftover shells should not be the feature of a future breach.</p><p>We've also covered the penetration tester's toolkit; an all-in-one Linux distribution, Kali; and a couple of its alternatives. The more important piece to a web application hacker's toolkit is arguably the attack proxy, two of which we've highlighted: Burp Suite and ZAP. Finally, we've mentioned the cloud as an emerging useful tool for the web application tester.</p><p>The attacker's job will always be easier than that of the defender. Any professional hacker with experience in the corporate world will attest to this. The attacker needs just one weak link in the chain — even if that weakness is temporary — to own the environment completely.</p><p>Security is difficult to do right the first time and it is even more difficult to keep it close to the baseline as time passes. There are often resourcing issues, lack of knowledge, or wrong priorities, including simply making the organization profitable. Applications have to be useable — they must be available and provide feature enhancements to be useful. There never seems to be enough time to test the code properly, let alone to test it for security bugs.</p><p>Staff turnover can also lead to inexperienced developers shipping insufficiently-tested code. The security team is often stretched thin with daily incidents, let alone having the time to be bothered with secure code reviews. There is no silver bullet for security testing applications and there is rarely enough money in the budget. There are many pieces to this puzzle and many factors that act against a completely secure application and underlying infrastructure.</p><p>This is where the professional hacker, who understands these limitations, can shine. With shell access to a server, one can search for a potential privilege escalation exploit, try to get it working, and, after some trial and error, gain full access. Alternatively, one could take advantage of the fact that inter-server communication is a common sysadmin requirement. This means that connections between servers are either passwordless, or that the password is improperly stored somewhere close by. It's not uncommon to find unprotected private keys in globally-readable directories, allowing access to every other server in the infrastructure. <span class="strong"><strong>Secure Shell</strong></span> (<span class="strong"><strong>SSH</strong></span>) private keys, frequently used in automating SSH connections, are not password protected because password protecting a private key will break the automation script that is using it.</p><p>In upcoming chapters, we will use these unfortunate truths about application development and deployment to our advantage.</p></div></body></html>