<html><head></head><body>
  <div id="_idContainer230">
   <h1 class="chapter-number" id="_idParaDest-233">
    <a id="_idTextAnchor641">
    </a>
    <span class="koboSpan" id="kobo.1.1">
     16
    </span>
   </h1>
   <h1 id="_idParaDest-234">
    <a id="_idTextAnchor642">
    </a>
    <span class="koboSpan" id="kobo.2.1">
     DevSecOps for Pentesters
    </span>
   </h1>
   <p>
    <strong class="bold">
     <span class="koboSpan" id="kobo.3.1">
      DevSecOps
     </span>
    </strong>
    <span class="koboSpan" id="kobo.4.1">
     is a combination of
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.5.1">
      Development
     </span>
    </em>
    <span class="koboSpan" id="kobo.6.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.7.1">
      Security
     </span>
    </em>
    <span class="koboSpan" id="kobo.8.1">
     , and
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.9.1">
      Operations
     </span>
    </em>
    <span class="koboSpan" id="kobo.10.1">
     .
    </span>
    <span class="koboSpan" id="kobo.10.2">
     DevSecOps represents a shift in how organizations approach security in software development.
    </span>
    <span class="koboSpan" id="kobo.10.3">
     Integrating security
    </span>
    <a id="_idIndexMarker1020">
    </a>
    <span class="koboSpan" id="kobo.11.1">
     practices throughout the development life cycle leads to the early detection and mitigation of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.12.1">
      security issues.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.13.1">
     In this chapter, we’ll explore the role of pentesters within a DevSecOps framework.
    </span>
    <span class="koboSpan" id="kobo.13.2">
     We’ll examine how Bash scripting can be used to automate and enhance security processes.
    </span>
    <span class="koboSpan" id="kobo.13.3">
     From integrating security checks into
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.14.1">
      Continuous Integration/Continuous Delivery
     </span>
    </strong>
    <span class="koboSpan" id="kobo.15.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.16.1">
      CI/CD
     </span>
    </strong>
    <span class="koboSpan" id="kobo.17.1">
     ) pipelines to building custom security tools, we’ll cover practical techniques that can help pentesters in a
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.18.1">
      DevSecOps setting.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.19.1">
     If you don’t work in a DevSecOps
    </span>
    <a id="_idIndexMarker1021">
    </a>
    <span class="koboSpan" id="kobo.20.1">
     environment, this chapter still has something for you.
    </span>
    <span class="koboSpan" id="kobo.20.2">
     You may wish to skip ahead to the section on creating custom Kali builds.
    </span>
    <span class="koboSpan" id="kobo.20.3">
     This section will help you to automate the creation of highly customizable Kali Linux installation
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.21.1">
      ISO images.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.22.1">
     In this chapter, we’re going to cover the following
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.23.1">
      main topics:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.24.1">
      Introduction to DevSecOps
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.25.1">
       for pentester
      </span>
      <a id="_idTextAnchor643">
      </a>
      <a id="_idTextAnchor644">
      </a>
      <span class="koboSpan" id="kobo.26.1">
       s
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.27.1">
      Configuring the CI/CD pipeline
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.28.1">
       with Bash
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.29.1">
      Crafting security-focused Bash scripts
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.30.1">
       for DevSecOps
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.31.1">
      Integrating real-time security monitoring
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.32.1">
       with Bas
      </span>
      <a id="_idTextAnchor645">
      </a>
      <a id="_idTextAnchor646">
      </a>
      <span class="koboSpan" id="kobo.33.1">
       h
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.34.1">
      Automating custom Kali Linux builds
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.35.1">
       for pentesting
      </span>
     </span>
    </li>
   </ul>
   <h1 id="_idParaDest-235">
    <a id="_idTextAnchor647">
    </a>
    <span class="koboSpan" id="kobo.36.1">
     Technical requirements
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.37.1">
     The code for this chapter can be found
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.38.1">
      a
     </span>
     <a id="_idTextAnchor648">
     </a>
     <a id="_idTextAnchor649">
     </a>
     <a id="_idTextAnchor650">
     </a>
     <span class="koboSpan" id="kobo.39.1">
      t
     </span>
    </span>
    <a href="https://github.com/PacktPublishing/Bash-Shell-Scripting-for-Pentesters/tree/main/Chapter16">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.40.1">
       https://github.com/PacktPublishing/Bash-Shell-Scripting-for-Pentesters/tree/main/Chapter16
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.41.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.42.1">
     This chapter will utilize a Kali virtual machine with GitLab and Bash scripts for running security checks and monitoring.
    </span>
    <span class="koboSpan" id="kobo.42.2">
     Configure your Kali Linux virtual machine with at least
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.43.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.44.1">
      4
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.45.1">
       GB RAM
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.46.1">
      30
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.47.1">
       GB storage
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.48.1">
      Two
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.49.1">
       virtual CPUs
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.50.1">
     Once you have a working Kali installation that meets or exceeds the preceding specifications, run the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.51.1">
      ch16_setup_environment.sh
     </span>
    </strong>
    <span class="koboSpan" id="kobo.52.1">
     script found in this chapter’s GitHub directory.
    </span>
    <span class="koboSpan" id="kobo.52.2">
     We’ll review the script later in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.53.1">
      this chapter.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.54.1">
     Next, configure the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.55.1">
      system email:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.56.1">
      Run the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.57.1">
       ch16_setup_mail.sh
      </span>
     </strong>
     <span class="koboSpan" id="kobo.58.1">
      script.
     </span>
     <span class="koboSpan" id="kobo.58.2">
      This script can be found in the GitHub repository directory for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.59.1">
       this chapter.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.60.1">
      Test sending
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.61.1">
       yourself mail:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.62.1">$ echo "Test message" | mail -s "Test Subject" $USER</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.63.1">
      Check
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.64.1">
       your mail:
      </span>
     </span>
     <ol>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.65.1">
        Enter the
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.66.1">
         mail
        </span>
       </strong>
       <span class="koboSpan" id="kobo.67.1">
        command in
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.68.1">
         the terminal
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.69.1">
        Press the
       </span>
       <em class="italic">
        <span class="koboSpan" id="kobo.70.1">
         Enter
        </span>
       </em>
       <span class="koboSpan" id="kobo.71.1">
        /
       </span>
       <em class="italic">
        <span class="koboSpan" id="kobo.72.1">
         Return
        </span>
       </em>
       <span class="koboSpan" id="kobo.73.1">
        key to read
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.74.1">
         a message
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.75.1">
        Enter
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.76.1">
         q
        </span>
       </strong>
       <span class="koboSpan" id="kobo.77.1">
        to quit reading
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.78.1">
         a message
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.79.1">
        Enter
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.80.1">
         d
        </span>
       </strong>
       <span class="koboSpan" id="kobo.81.1">
        to delete
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.82.1">
         a message
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.83.1">
        Enter
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.84.1">
         h
        </span>
       </strong>
       <span class="koboSpan" id="kobo.85.1">
        to show the message
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.86.1">
         list again
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.87.1">
        Enter
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.88.1">
         q
        </span>
       </strong>
       <span class="koboSpan" id="kobo.89.1">
        to quit the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.90.1">
         mail program
        </span>
       </span>
      </li>
     </ol>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.91.1">
     With the prerequisites out of the way, let’s
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.92.1">
      dive in
     </span>
     <a id="_idTextAnchor651">
     </a>
     <a id="_idTextAnchor652">
     </a>
     <span class="koboSpan" id="kobo.93.1">
      !
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-236">
    <a id="_idTextAnchor653">
    </a>
    <span class="koboSpan" id="kobo.94.1">
     Introduction to DevSecOps for pentesters
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.95.1">
     This section is an introduction
    </span>
    <a id="_idIndexMarker1022">
    </a>
    <span class="koboSpan" id="kobo.96.1">
     and explanation of DevSecOps.
    </span>
    <span class="koboSpan" id="kobo.96.2">
     By the end of this section, you’ll understand the terminology, history, and common tasks for integrating security into the development
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.97.1">
      life cycle.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-237">
    <a id="_idTextAnchor654">
    </a>
    <span class="koboSpan" id="kobo.98.1">
     Understanding the intersection of DevOps and security
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.99.1">
     Although DevOps and security
    </span>
    <a id="_idIndexMarker1023">
    </a>
    <span class="koboSpan" id="kobo.100.1">
     may appear separate, they are increasingly merging in modern software development.
    </span>
    <span class="koboSpan" id="kobo.100.2">
     DevOps, focusing on collaboration, automation, and continuous delivery, has transformed how organizations handle software development and deployment.
    </span>
    <span class="koboSpan" id="kobo.100.3">
     However, this shift has also introduced new security challenges that must be addressed to ensure the integrity and reliability of the software
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.101.1">
      being delivered.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.102.1">
     Traditional security practices often involved manual testing and reviews, which were typically performed at the end of the development cycle.
    </span>
    <span class="koboSpan" id="kobo.102.2">
     This approach was time-consuming and resource-intensive, and often resulted in security issues being discovered late in the process.
    </span>
    <span class="koboSpan" id="kobo.102.3">
     This led to costly fixes and delayed releases.
    </span>
    <span class="koboSpan" id="kobo.102.4">
     With the adoption of DevOps, the focus shifted toward integrating security into the development process from the very beginning.
    </span>
    <span class="koboSpan" id="kobo.102.5">
     This gave
    </span>
    <a id="_idIndexMarker1024">
    </a>
    <span class="koboSpan" id="kobo.103.1">
     rise to the concept
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.104.1">
      of
     </span>
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.105.1">
       DevSecOps
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.106.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.107.1">
     DevSecOps integrates security into every phase of the software development life cycle.
    </span>
    <span class="koboSpan" id="kobo.107.2">
     This fosters a shared responsibility among developers, operations, and security teams.
    </span>
    <span class="koboSpan" id="kobo.107.3">
     By embedding security practices, tools, and automation into DevOps, organizations can identify vulnerabilities early, minimize security risks, and deliver secure software
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.108.1">
      by design.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.109.1">
     With DevSecOps on the rise, pentesters should adjust their methods and use automation to match fast development cycles.
    </span>
    <span class="koboSpan" id="kobo.109.2">
     Integrating security testing into CI/CD pipelines allows testers to give ongoing feedback on software security, helping teams quickly find and fix vulnerabilities.
    </span>
    <span class="koboSpan" id="kobo.109.3">
     Additionally, pentesters can support the DevSecOps culture by working closely with development and operations teams.
    </span>
    <span class="koboSpan" id="kobo.109.4">
     Through sharing their knowledge and experience, pentesters can instruct teams on secure coding techniques, common vulnerabilities, and best practices for secure deployment and configuration.
    </span>
    <span class="koboSpan" id="kobo.109.5">
     This collaborative effort promotes a collective awareness of security and contributes to creating a more secure
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.110.1">
      software environment.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.111.1">
     In DevSecOps, Bash scripting is an effective tool for automating security tasks within the CI/CD pipeline.
    </span>
    <span class="koboSpan" id="kobo.111.2">
     As a flexible scripting language, Bash enables pentesters to write custom scripts for activities such as vulnerability scanning, configuration analysis, and automated exploitation.
    </span>
    <span class="koboSpan" id="kobo.111.3">
     This reduces manual work, streamlines testing processes, and ensures consistent security checks
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.112.1">
      across environments.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.113.1">
     Throughout this chapter, we’ll explore
    </span>
    <a id="_idIndexMarker1025">
    </a>
    <span class="koboSpan" id="kobo.114.1">
     the use of Bash scripting to automate security tasks within the DevOps workflow.
    </span>
    <span class="koboSpan" id="kobo.114.2">
     Mastering Bash scripting can help pentesters streamline testing processes and enhance
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.115.1">
      organizational security.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-238">
    <a id="_idTextAnchor655">
    </a>
    <span class="koboSpan" id="kobo.116.1">
     Common use cases for Bash in security automation
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.117.1">
     Security teams often integrate Bash scripting throughout the DevSecOps life cycle to streamline and automate repetitive security tasks.
    </span>
    <span class="koboSpan" id="kobo.117.2">
     Understanding these common tasks helps pentesters identify opportunities
    </span>
    <a id="_idIndexMarker1026">
    </a>
    <span class="koboSpan" id="kobo.118.1">
     for automation in their
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.119.1">
      own workflows.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.120.1">
     Some of the more common security workflows include
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.121.1">
      these components:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.122.1">
       Vulnerability scanning orchestration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.123.1">
      : Bash scripts coordinate multiple scanning tools to run sequentially or in parallel against target systems.
     </span>
     <span class="koboSpan" id="kobo.123.2">
      Security teams typically automate Nmap port scans, followed by targeted vulnerability scanners for detected services.
     </span>
     <span class="koboSpan" id="kobo.123.3">
      The scripts handle scheduling, parameter configuration, and results aggregation.
     </span>
     <span class="koboSpan" id="kobo.123.4">
      This turns hours of manual scanning into an
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.124.1">
       automated process.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.125.1">
       Continuous security testing
      </span>
     </strong>
     <span class="koboSpan" id="kobo.126.1">
      : In modern development environments, security testing runs automatically with each code commit.
     </span>
     <span class="koboSpan" id="kobo.126.2">
      Bash scripts integrate security tools into CI pipelines, scanning application code, dependencies, and container images.
     </span>
     <span class="koboSpan" id="kobo.126.3">
      When vulnerabilities are found, the scripts can fail the build and notify the security team through chat platforms or
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.127.1">
       ticketing systems.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.128.1">
       Configuration management
      </span>
     </strong>
     <span class="koboSpan" id="kobo.129.1">
      : Infrastructure security relies heavily on proper system configuration.
     </span>
     <span class="koboSpan" id="kobo.129.2">
      Bash scripts verify security baselines across servers, checking file permissions, user access, service configurations, and network settings.
     </span>
     <span class="koboSpan" id="kobo.129.3">
      When misconfigurations are detected, scripts can either automatically remediate issues or create detailed reports for the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.130.1">
       operations team.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.131.1">
       Log analysis and monitoring
      </span>
     </strong>
     <span class="koboSpan" id="kobo.132.1">
      : Security teams use Bash to process system logs, looking for indicators of compromise or suspicious behavior.
     </span>
     <span class="koboSpan" id="kobo.132.2">
      Scripts parse log files, extract relevant data, and trigger alerts based on predefined rules.
     </span>
     <span class="koboSpan" id="kobo.132.3">
      This automated monitoring runs continuously, providing real-time security visibility across
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.133.1">
       the infrastructure.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.134.1">
       Incident response automation
      </span>
     </strong>
     <span class="koboSpan" id="kobo.135.1">
      : During security incidents, time is critical.
     </span>
     <span class="koboSpan" id="kobo.135.2">
      Bash scripts automate initial response actions such as isolating compromised systems, collecting forensic data, or blocking malicious IP addresses.
     </span>
     <span class="koboSpan" id="kobo.135.3">
      This automation ensures
     </span>
     <a id="_idIndexMarker1027">
     </a>
     <span class="koboSpan" id="kobo.136.1">
      consistent incident handling and reduces response time from hours
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.137.1">
       to minutes.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.138.1">
       Compliance validation
      </span>
     </strong>
     <span class="koboSpan" id="kobo.139.1">
      : Organizations must regularly verify compliance with security standards.
     </span>
     <span class="koboSpan" id="kobo.139.2">
      Bash scripts automate compliance checks against frameworks such as CIS Benchmarks or NIST guidelines.
     </span>
     <span class="koboSpan" id="kobo.139.3">
      The scripts generate compliance reports and highlight areas requiring remediation, simplifying the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.140.1">
       audit process.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.141.1">
       Security tool integration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.142.1">
      : Many security tools provide command-line interfaces but lack direct integration capabilities.
     </span>
     <span class="koboSpan" id="kobo.142.2">
      Bash serves as the glue connecting these tools into cohesive security workflows.
     </span>
     <span class="koboSpan" id="kobo.142.3">
      Scripts can chain tools together, transform data formats, and create unified
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.143.1">
       reporting interfaces.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.144.1">
       Environment hardening
      </span>
     </strong>
     <span class="koboSpan" id="kobo.145.1">
      : Security teams use Bash to automate the hardening of new systems.
     </span>
     <span class="koboSpan" id="kobo.145.2">
      Scripts apply security patches, configure firewalls, set up intrusion detection, and implement access controls.
     </span>
     <span class="koboSpan" id="kobo.145.3">
      This automation ensures consistent security measures across
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.146.1">
       all environments.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.147.1">
     These automation use cases form the foundation for modern security operations.
    </span>
    <span class="koboSpan" id="kobo.147.2">
     In subsequent sections, we’ll explore specific code implementations for some of these scenarios, building practical automation solutions for real-world
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.148.1">
      security chal
     </span>
     <a id="_idTextAnchor656">
     </a>
     <a id="_idTextAnchor657">
     </a>
     <a id="_idTextAnchor658">
     </a>
     <span class="koboSpan" id="kobo.149.1">
      lenges.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-239">
    <a id="_idTextAnchor659">
    </a>
    <span class="koboSpan" id="kobo.150.1">
     Configuring the CI/CD pipeline with Bash
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.151.1">
     In this section, we’ll cover Bash scripting for setting up our CI/CD test lab environment.
    </span>
    <span class="koboSpan" id="kobo.151.2">
     This will automate the
    </span>
    <a id="_idIndexMarker1028">
    </a>
    <span class="koboSpan" id="kobo.152.1">
     installation of all tools needed for the rest of the chapter exercises.
    </span>
    <span class="koboSpan" id="kobo.152.2">
     This script can be found in GitHub
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.153.1">
      as
     </span>
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.154.1">
       ch16_setup_environment.sh
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.155.1">
      .
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-240">
    <a id="_idTextAnchor660">
    </a>
    <span class="koboSpan" id="kobo.156.1">
     Initial setup and error handling
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.157.1">
     This section of the code sets up error-handling behaviors that prevent the script from continuing when errors
    </span>
    <a id="_idIndexMarker1029">
    </a>
    <span class="koboSpan" id="kobo.158.1">
     occur.
    </span>
    <span class="koboSpan" id="kobo.158.2">
     These safety measures help catch problems early and prevent cascading failures that could leave the system in an inconsistent state.
    </span>
    <span class="koboSpan" id="kobo.158.3">
     As usual, the code starts with the familiar
    </span>
    <span class="No-Break">
     <strong class="bold">
      <span class="koboSpan" id="kobo.159.1">
       shebang
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.160.1">
      line:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.161.1">
#!/usr/bin/env bash
set -euo pipefail
IFS=$'\n\t'
# Setup logging
</span><a id="_idTextAnchor661"/><a id="_idTextAnchor662"/><span class="koboSpan" id="kobo.162.1">LOG_FILE="/var/log/devsecops_setup.log"
SCRIPT_NAME=$(basename "$0")</span></pre>
   <p>
    <span class="koboSpan" id="kobo.163.1">
     This section establishes core script behaviors.
    </span>
    <span class="koboSpan" id="kobo.163.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.164.1">
      set
     </span>
    </strong>
    <span class="koboSpan" id="kobo.165.1">
     command configures important
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.166.1">
      safety features:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.167.1">
       -e
      </span>
     </strong>
     <span class="koboSpan" id="kobo.168.1">
      : Exits on
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.169.1">
       any error
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.170.1">
       -u
      </span>
     </strong>
     <span class="koboSpan" id="kobo.171.1">
      : Treats unset variables
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.172.1">
       as errors
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.173.1">
       -o pipefail
      </span>
     </strong>
     <span class="koboSpan" id="kobo.174.1">
      : Returns an error if any command in a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.175.1">
       pipeline fails
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.176.1">
     The internal field separator (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.177.1">
      IFS
     </span>
    </strong>
    <span class="koboSpan" id="kobo.178.1">
     ) is set to newline and tab characters, preventing word splitting
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.179.1">
      on spaces.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.180.1">
     Note that the log file can be found at
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.181.1">
      /var/log/devsecops_setup.log
     </span>
    </strong>
    <span class="koboSpan" id="kobo.182.1">
     .
    </span>
    <span class="koboSpan" id="kobo.182.2">
     If the script fails, examine
    </span>
    <a id="_idIndexMarker1030">
    </a>
    <span class="koboSpan" id="kobo.183.1">
     the end of the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.184.1">
      log file.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-241">
    <a id="_idTextAnchor663">
    </a>
    <span class="koboSpan" id="kobo.185.1">
     Logging functions
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.186.1">
     Proper logging is essential for debugging and auditing script execution.
    </span>
    <span class="koboSpan" id="kobo.186.2">
     These functions create a standardized logging
    </span>
    <a id="_idIndexMarker1031">
    </a>
    <span class="koboSpan" id="kobo.187.1">
     system that records all significant events during the installation process, making it easier to track down issues and verify
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.188.1">
      successful execution:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.189.1">
log_info() {
    local msg="[$(date +'%Y-%m-%d %H:%M:%S')] [INFO] $1"
    echo "$msg" | tee -a "$LOG_FILE"
}
log_error() {
    local msg="[$(date +'%Y-%m-%d %H:%M:%S')] [ERROR] $1"
    echo "$msg" | tee -a "$LOG_FILE" &gt;&amp;2
}
log_warning() {
    local msg="[$(date +'%Y-%m-%d %H:%M:%S')] [WARNING] $1"
    echo "$msg" | tee -a "$LOG_FILE"
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.190.1">
     These functions implement
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.191.1">
      structured logging:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.192.1">
      Each function accepts a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.193.1">
       message parameter.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.194.1">
      Messages are timestamped
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.195.1">
       using
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.196.1">
        date
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.197.1">
       .
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.198.1">
       tee -a
      </span>
     </strong>
     <span class="koboSpan" id="kobo.199.1">
      writes to both the log file and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.200.1">
       standard output.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.201.1">
      Error messages are directed to stderr
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.202.1">
       using
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.203.1">
        &gt;&amp;2
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.204.1">
       .
      </span>
     </span>
    </li>
   </ol>
   <h2 id="_idParaDest-242">
    <a id="_idTextAnchor664">
    </a>
    <span class="koboSpan" id="kobo.205.1">
     Error handler and initialization
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.206.1">
     When things go wrong in a
    </span>
    <a id="_idIndexMarker1032">
    </a>
    <span class="koboSpan" id="kobo.207.1">
     script, providing clear error messages helps users understand and fix problems.
    </span>
    <span class="koboSpan" id="kobo.207.2">
     This section establishes error-handling routines and initializes the logging system, ensuring that all script activities are properly tracked, and errors are caught
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.208.1">
      and reported:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.209.1">
handle_error() {
    local line_num=$1
    local error_code=$2
    log_error "Error in $SCRIPT_NAME at line $line_num (Exit code: $error_code)"
}
trap 'handle_error ${LINENO} $?' </span><span class="koboSpan" id="kobo.209.2">ERR
init_logging() {
    if [[ ! </span><span class="koboSpan" id="kobo.209.3">-f "$LOG_FILE" ]]; then
        touch "$LOG_FILE"
        chmod 644 "$LOG_FILE"
    fi
    log_info "Starting setup script execution"
    log_info "Logging to $LOG_FILE"
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.210.1">
     The error-handling system uses
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.211.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.212.1">
      A
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.213.1">
       trap
      </span>
     </strong>
     <span class="koboSpan" id="kobo.214.1">
      to catch errors.
     </span>
     <span class="koboSpan" id="kobo.214.2">
      A
     </span>
     <a id="_idIndexMarker1033">
     </a>
     <span class="koboSpan" id="kobo.215.1">
      trap is a mechanism that allows you to specify a command or series of commands to be executed when the shell receives a specified signal or condition.
     </span>
     <span class="koboSpan" id="kobo.215.2">
      To catch
     </span>
     <a id="_idIndexMarker1034">
     </a>
     <span class="koboSpan" id="kobo.216.1">
      errors, you can use the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.217.1">
       trap
      </span>
     </strong>
     <span class="koboSpan" id="kobo.218.1">
      command with the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.219.1">
       ERR
      </span>
     </strong>
     <span class="koboSpan" id="kobo.220.1">
      signal, which triggers when a command within a script returns a non-zero
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.221.1">
       exit status.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.222.1">
      The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.223.1">
       handle_error
      </span>
     </strong>
     <span class="koboSpan" id="kobo.224.1">
      function receives the line number and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.225.1">
       exit code.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.226.1">
       init_logging
      </span>
     </strong>
     <span class="koboSpan" id="kobo.227.1">
      creates the log file if needed and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.228.1">
       sets permissions.
      </span>
     </span>
    </li>
   </ul>
   <h2 id="_idParaDest-243">
    <a id="_idTextAnchor665">
    </a>
    <span class="koboSpan" id="kobo.229.1">
     System checks
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.230.1">
     Before installing software or
    </span>
    <a id="_idIndexMarker1035">
    </a>
    <span class="koboSpan" id="kobo.231.1">
     making system changes, we need to verify that the script is running in the correct environment.
    </span>
    <span class="koboSpan" id="kobo.231.2">
     The following code ensures the script runs with proper permissions and on the intended operating system, preventing potential issues from incorrect
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.232.1">
      execution conditions:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.233.1">
if [[ $EUID -ne 0 ]]; then
   log_error "This script must be run as root"
   exit 1
fi
if ! </span><span class="koboSpan" id="kobo.233.2">grep -q "Kali" /etc/os-release; then
    log_error "This script must be run on Kali Linux"
    exit 1
fi</span></pre>
   <p>
    <span class="koboSpan" id="kobo.234.1">
     The following checks ensure proper
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.235.1">
      execution conditions:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.236.1">
      Verifies root privileges by checking the effective
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.237.1">
       user ID
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.238.1">
      Confirms the system is Kali Linux by checking the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.239.1">
       OS information
      </span>
     </span>
    </li>
   </ul>
   <h2 id="_idParaDest-244">
    <a id="_idTextAnchor666">
    </a>
    <span class="koboSpan" id="kobo.240.1">
     Development tools installation
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.241.1">
     A DevSecOps environment requires various development tools and languages.
    </span>
    <span class="koboSpan" id="kobo.241.2">
     This section installs core development dependencies including Docker, Java, and Python tools that will be
    </span>
    <a id="_idIndexMarker1036">
    </a>
    <span class="koboSpan" id="kobo.242.1">
     needed for building and testing
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.243.1">
      applications securely:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.244.1">
install_dev_tools() {
    log_info "Installing developme</span><a id="_idTextAnchor667"/><a id="_idTextAnchor668"/><span class="koboSpan" id="kobo.245.1">nt tools..."
</span><span class="koboSpan" id="kobo.245.2">    export DEBIAN_FRONTEND=noninteractive
    apt-get update &gt;&gt; "$LOG_FILE" 2&gt;&amp;1
    apt-get install -y \
        docker.io \
        docker-compose \
        openjdk-11-jdk \
        maven \
        gradle \
        python3-venv \
        python3-full \
        pipx &gt;&gt; "$LOG_FILE" 2&gt;&amp;1 || {
            log_error "Failed to install development tools"
            return 1
        }
    pipx ensurepath &gt;&gt; "$LOG_FILE" 2&gt;&amp;1
    export PATH="/root/.local/bin:$PATH"</span></pre>
   <p>
    <span class="koboSpan" id="kobo.246.1">
     Here’s a breakdown of this
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.247.1">
      code block:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.248.1">
      Sets up non-interactive package installation by setting an environment variable.
     </span>
     <span class="koboSpan" id="kobo.248.2">
      This prevents the package manager from prompting you during the installation process:
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.249.1">
        export DEBIAN_FRONTEND=noninteractive
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.250.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.251.1">
      Updates
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.252.1">
       package lists.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.253.1">
      Installs development tools
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.254.1">
       using
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.255.1">
        apt-get
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.256.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.257.1">
      Configures
     </span>
     <a id="_idIndexMarker1037">
     </a>
     <span class="koboSpan" id="kobo.258.1">
      Python package management
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.259.1">
       with
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.260.1">
        pipx
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.261.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.262.1">
      Updates the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.263.1">
       PATH
      </span>
     </strong>
     <span class="koboSpan" id="kobo.264.1">
      to include
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.265.1">
       local binaries.
      </span>
     </span>
    </li>
   </ol>
   <h2 id="_idParaDest-245">
    <a id="_idTextAnchor669">
    </a>
    <span class="koboSpan" id="kobo.266.1">
     Security tools installation
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.267.1">
     Security scanning tools are essential for identifying vulnerabilities in code and dependencies.
    </span>
    <span class="koboSpan" id="kobo.267.2">
     This
    </span>
    <a id="_idIndexMarker1038">
    </a>
    <span class="koboSpan" id="kobo.268.1">
     section installs specialized security tools that help identify potential vulnerabilities in application dependencies and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.269.1">
      container images:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.270.1">
install_dep_scanners() {
    log_info "Installing dependency scanners..."
</span><span class="koboSpan" id="kobo.270.2">    # OWASP Dependency-Check
    wget https://github.com/jeremylong/DependencyCheck/releases/download/v7.1.1/dependency-check-7.1.1-release.zip
    unzip dependency-check-7.1.1-release.zip -d /opt/
    ln -sf /opt/dependency-check/bin/dependency-check.sh /usr/local/bin/dependency-check
    # Trivy Installation
    TRIVY_VERSION=$(curl -s https://api.github.com/repos/aquasecurity/trivy/releases/latest | grep '"tag_name":' | sed -E 's/.*"v([^"]+)".*/\1/')
    wget "https://github.com/aquasecurity/trivy/releases/download/v${TRIVY_VERSION}/trivy_${TRIVY_VERSION}_Linux-64bit.deb"
    dpkg -i trivy.deb
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.271.1">
     Here’s a breakdown
    </span>
    <a id="_idIndexMarker1039">
    </a>
    <span class="koboSpan" id="kobo.272.1">
     of the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.273.1">
      preceding code:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.274.1">
      Downloads
     </span>
     <a id="_idIndexMarker1040">
     </a>
     <span class="koboSpan" id="kobo.275.1">
      and installs
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.276.1">
        OWASP Dependency-Check
       </span>
      </strong>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.277.1">
      Fetches the latest Trivy version from the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.278.1">
       GitHub API
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.279.1">
      Downloads and installs the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.280.1">
       Trivy package
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.281.1">
     OWASP Dependency-Check scans software dependency versions for vulnerabilities.
    </span>
    <span class="koboSpan" id="kobo.281.2">
     Trivy scans Git repositories, filesystems, and containers
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.282.1">
      for vulnerabilities.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-246">
    <a id="_idTextAnchor670">
    </a>
    <span class="koboSpan" id="kobo.283.1">
     GitLab CI/CD setup
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.284.1">
     This section installs
    </span>
    <a id="_idIndexMarker1041">
    </a>
    <span class="koboSpan" id="kobo.285.1">
     and configures GitLab and GitLab Runner to provide a simple CI/CD platform for automated security testing
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.286.1">
      and deployment:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.287.1">
setup_gitlab_cicd() {
    docker run --detach \
        --hostname gitlab.local \
        --publish 443:443 --publish 80:80 --publish 22:22 \
        --name gitlab \
        --restart always \
        --volume /srv/gitlab/config:/etc/gitlab \
        --volume /srv/gitlab/logs:/var/log/gitlab \
        --volume /srv/gitlab/data:/var/opt/gitlab \
        gitlab/gitlab-ce:latest
    # GitLab Runner installation
    curl -L "https://packages.gitlab.com/install/repositories/runner/gitlab-runner/script.deb.sh" | \
        os=debian dist=bullseye bash
    apt-get install -y gitlab-runner
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.288.1">
     This code block does
    </span>
    <a id="_idIndexMarker1042">
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.289.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.290.1">
      Deploys GitLab using Docker with
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.291.1">
       persistent storage
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.292.1">
      Maps necessary ports for web and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.293.1">
       SSH access
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.294.1">
      Installs GitLab Runner for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.295.1">
       CI/CD capabilities
      </span>
     </span>
    </li>
   </ol>
   <h2 id="_idParaDest-247">
    <a id="_idTextAnchor671">
    </a>
    <span class="koboSpan" id="kobo.296.1">
     Workspace creation
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.297.1">
     A well-organized workspace
    </span>
    <a id="_idIndexMarker1043">
    </a>
    <span class="koboSpan" id="kobo.298.1">
     helps maintain order in security testing projects.
    </span>
    <span class="koboSpan" id="kobo.298.2">
     This section creates a structured directory layout and provides example configurations to help users get started with their
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.299.1">
      DevSecOps practices:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.300.1">
create_workspace() {
    mkdir -p /opt/devsecops/{scripts,tools,reports,pipelines,monitoring}
    cat &gt; /opt/devsecops/pipelines/example-pipeline.yml &lt;&lt;EOF
stages:
  - static-analysis
  - dependency-check
  - container-scan
  - dynamic-scan
...
</span><span class="koboSpan" id="kobo.300.2">EOF
    chown -R "$SUDO_USER:$SUDO_USER" /opt/devsecops
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.301.1">
     This function
    </span>
    <a id="_idIndexMarker1044">
    </a>
    <span class="koboSpan" id="kobo.302.1">
     performs
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.303.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.304.1">
      Creates a directory structure for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.305.1">
       DevSecOps work
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.306.1">
      Sets up an example
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.307.1">
       pipeline configuration
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.308.1">
      Adjusts ownership of
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.309.1">
       workspace files
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.310.1">
     The script uses several shell scripting
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.311.1">
      best practices:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.312.1">
      Consistent error handling
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.313.1">
       and logging
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.314.1">
      Modular
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.315.1">
       function design
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.316.1">
      Proper
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.317.1">
       permission management
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.318.1">
      Careful
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.319.1">
       dependency installation
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.320.1">
      Container-based
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.321.1">
       service deployment
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.322.1">
     This script creates a simple DevSecOps learning environment that leverages Kali Linux’s pre-installed security tools while adding the necessary components.
    </span>
    <span class="koboSpan" id="kobo.322.2">
     The environment allows you to practice security automation, continuous testing, and monitoring in an
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.323.1">
      isolated setting.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.324.1">
     In the next section, we’ll explore using Bash scripting to perform security tests once code
    </span>
    <a id="_idTextAnchor672">
    </a>
    <a id="_idTextAnchor673">
    </a>
    <a id="_idTextAnchor674">
    </a>
    <span class="koboSpan" id="kobo.325.1">
     is checked
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.326.1">
      into GitLab.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-248">
    <a id="_idTextAnchor675">
    </a>
    <span class="koboSpan" id="kobo.327.1">
     Crafting security-focused Bash scripts for DevSecOps
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.328.1">
     In this section, we’ll review the code for a Bash scanner script that we’ll integrate into the CI/CD pipeline.
    </span>
    <span class="koboSpan" id="kobo.328.2">
     First, I’ll create
    </span>
    <a id="_idIndexMarker1045">
    </a>
    <span class="koboSpan" id="kobo.329.1">
     and review the scanner script.
    </span>
    <span class="koboSpan" id="kobo.329.2">
     Then I’ll demonstrate how to integrate it into the pipeline for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.330.1">
      automated
     </span>
    </span>
    <span class="No-Break">
     <a id="_idIndexMarker1046">
     </a>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.331.1">
      scanning.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-249">
    <a id="_idTextAnchor676">
    </a>
    <span class="koboSpan" id="kobo.332.1">
     Creating the scan script
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.333.1">
     Creating secure and maintainable Bash scripts
    </span>
    <a id="_idIndexMarker1047">
    </a>
    <span class="koboSpan" id="kobo.334.1">
     requires careful attention to defensive coding practices, proper error handling, and thorough logging.
    </span>
    <span class="koboSpan" id="kobo.334.2">
     Let’s build a security scanning script that leverages our DevSecOps environment to demonstrate
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.335.1">
      these principles.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.336.1">
     This script can be found in GitHub as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.337.1">
      ch16_devsecops_scanner.sh
     </span>
    </strong>
    <span class="koboSpan" id="kobo.338.1">
     .
    </span>
    <span class="koboSpan" id="kobo.338.2">
     Let’s break down this script into its core components and examine
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.339.1">
      each section.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.340.1">
     First, we’ll look at the script initialization and safety measures.
    </span>
    <span class="koboSpan" id="kobo.340.2">
     The purpose of this section is
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.341.1">
      as follows:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.342.1">
      En
     </span>
     <a id="_idTextAnchor677">
     </a>
     <a id="_idTextAnchor678">
     </a>
     <span class="koboSpan" id="kobo.343.1">
      ables strict
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.344.1">
       error handling
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.345.1">
      Prevents word splitting issues with filenames
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.346.1">
       containing spaces
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.347.1">
      Variables are defined with clear names
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.348.1">
       and defaults
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.349.1">
      The script uses timestamped report names to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.350.1">
       prevent overwriting
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.351.1">
     Let’s examine the code
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.352.1">
      in depth:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.353.1">
#!/usr/bin/</span><a id="_idTextAnchor679"/><a id="_idTextAnchor680"/><span class="koboSpan" id="kobo.354.1">env bash
set</span><a id="_idTextAnchor681"/><a id="_idTextAnchor682"/><a id="_idTextAnchor683"/><span class="koboSpan" id="kobo.355.1"> -euo pipefail
IFS=$'\n\t'
SCAN_DIR=${1:-"."}
REPORT_DIR="/opt/devsecops/reports"
LOG_FILE="/var/log/security_scanner.log"
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
REPORT_NAME="secu</span><a id="_idTextAnchor684"/><a id="_idTextAnchor685"/><span class="koboSpan" id="kobo.356.1">rity_scan_${TIMESTAMP}"</span></pre>
   <p>
    <span class="koboSpan" id="kobo.357.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.358.1">
      set -euo pipefail
     </span>
    </strong>
    <span class="koboSpan" id="kobo.359.1">
     command is
    </span>
    <a id="_idIndexMarker1048">
    </a>
    <span class="koboSpan" id="kobo.360.1">
     used to enhance the robustness of shell scripts by modifying how errors
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.361.1">
      are handled:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.362.1">
       -e
      </span>
     </strong>
     <span class="koboSpan" id="kobo.363.1">
      : Causes the script to exit immediately if any command within it exits with a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.364.1">
       non-zero status
      </span>
     </span>
     <p class="list-inset">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.365.1">
        -u
       </span>
      </strong>
      <span class="koboSpan" id="kobo.366.1">
       : Treats unset variables as an error and causes the script to exit with
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.367.1">
        an error
       </span>
      </span>
     </p>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.368.1">
       -o pipefail
      </span>
     </strong>
     <span class="koboSpan" id="kobo.369.1">
      : Ensures that the script exits with a non-zero status if any command within a pipeline fails, not just the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.370.1">
       last command
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.371.1">
     These options combined help in catching errors early and making scripts
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.372.1">
      more reliable.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.373.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.374.1">
      IFS=$'\n\t'
     </span>
    </strong>
    <span class="koboSpan" id="kobo.375.1">
     line sets the IFS delimiter as newlines and tabs to prevent word splitting issues with filenames
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.376.1">
      containing spaces.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.377.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.378.1">
      SCAN_DIR=${1:-"."}
     </span>
    </strong>
    <span class="koboSpan" id="kobo.379.1">
     line assigns the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.380.1">
      SCAN_DIR
     </span>
    </strong>
    <span class="koboSpan" id="kobo.381.1">
     variable with the value of the first positional parameter (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.382.1">
      $1
     </span>
    </strong>
    <span class="koboSpan" id="kobo.383.1">
     ) if it exists.
    </span>
    <span class="koboSpan" id="kobo.383.2">
     If
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.384.1">
      $1
     </span>
    </strong>
    <span class="koboSpan" id="kobo.385.1">
     is not provided, it defaults to
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.386.1">
      "."
     </span>
    </strong>
    <span class="koboSpan" id="kobo.387.1">
     , which represents the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.388.1">
      current directory.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.389.1">
     Next, let’s examine the logging functions.
    </span>
    <span class="koboSpan" id="kobo.389.2">
     The purpose of this section is to do
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.390.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.391.1">
      Create a consistent logging format with timestamps and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.392.1">
       log levels
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.393.1">
      Write logs to both the console and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.394.1">
       log file
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.395.1">
      Implement error trapping to catch and log all
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.396.1">
       script failures
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.397.1">
      Set appropriate file permissions for the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.398.1">
       log file
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.399.1">
     Let’s
    </span>
    <a id="_idTextAnchor686">
    </a>
    <a id="_idTextAnchor687">
    </a>
    <span class="koboSpan" id="kobo.400.1">
     examine the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.401.1">
      following code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.402.1">
# Logging setup
setup_logging() {
    if [[ ! </span><span class="koboSpan" id="kobo.402.2">-f "$LOG_FILE" ]]; then
        sudo touch "$LOG_FILE"
        sudo chmod 644 "$LOG_FILE"
    fi
}
log() {
    local level=$1
    shift
    echo "[$(date +'%Y-%m-%d %H:%M:%S')] [${level}] $*" | tee -a "$LOG_FILE"
}
# Error handler
error_handler() {
    local line_num=$1
    local error_code=$2
    log "ERROR" "Error occurred in script at line: ${line_num} (Exit code: ${error_code})"
}
trap 'error_handler ${LINENO} $?' </span><span class="koboSpan" id="kobo.402.3">ERR</span></pre>
   <p>
    <span class="koboSpan" id="kobo.403.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.404.1">
      setup_logging()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.405.1">
     function
    </span>
    <a id="_idIndexMarker1049">
    </a>
    <span class="koboSpan" id="kobo.406.1">
     checks whether a log file exists, and if it doesn’t, it does
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.407.1">
      the following:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.408.1">
      Creates it using
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.409.1">
        sudo touch
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.410.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.411.1">
      Sets permissions to
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.412.1">
       644
      </span>
     </strong>
     <span class="koboSpan" id="kobo.413.1">
      (owner can read/write, others can
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.414.1">
       only read).
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.415.1">
      The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.416.1">
       [[ !
      </span>
      <span class="koboSpan" id="kobo.416.2">
       -f "$LOG_FILE" ]]
      </span>
     </strong>
     <span class="koboSpan" id="kobo.417.1">
      test checks whether the file does
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.418.1">
       not
      </span>
     </em>
     <span class="koboSpan" id="kobo.419.1">
      (
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.420.1">
       -!
      </span>
     </strong>
     <span class="koboSpan" id="kobo.421.1">
      )
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.422.1">
       exist.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.423.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.424.1">
      log()
     </span>
    </strong>
    <span class="koboSpan" id="kobo.425.1">
     function is a versatile logging utility.
    </span>
    <span class="koboSpan" id="kobo.425.2">
     This function performs the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.426.1">
      following functions:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.427.1">
      Takes a log level as the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.428.1">
       first argument.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.429.1">
      Uses
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.430.1">
       shift
      </span>
     </strong>
     <span class="koboSpan" id="kobo.431.1">
      to remove the level, leaving the remaining arguments as
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.432.1">
       the message.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.433.1">
      Creates a timestamp
     </span>
     <a id="_idIndexMarker1050">
     </a>
     <span class="koboSpan" id="kobo.434.1">
      using
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.435.1">
       date
      </span>
     </strong>
     <span class="koboSpan" id="kobo.436.1">
      with the format
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.437.1">
        YYYY-MM-DD HH:MM:SS
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.438.1">
       .
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.439.1">
      Uses
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.440.1">
       tee -a
      </span>
     </strong>
     <span class="koboSpan" id="kobo.441.1">
      to both display
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.442.1">
       and
      </span>
     </em>
     <span class="koboSpan" id="kobo.443.1">
      append to the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.444.1">
       log file.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.445.1">
       $*
      </span>
     </strong>
     <span class="koboSpan" id="kobo.446.1">
      combines all remaining arguments into
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.447.1">
       the message.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.448.1">
     The error handling setup is
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.449.1">
      explained here:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.450.1">
       error_handler
      </span>
     </strong>
     <span class="koboSpan" id="kobo.451.1">
      takes line number and error code
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.452.1">
       as arguments.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.453.1">
      Uses the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.454.1">
       log
      </span>
     </strong>
     <span class="koboSpan" id="kobo.455.1">
      function to
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.456.1">
       record errors.
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.457.1">
      The
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.458.1">
       trap
      </span>
     </strong>
     <span class="koboSpan" id="kobo.459.1">
      command catches any
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.460.1">
       ERR
      </span>
     </strong>
     <span class="koboSpan" id="kobo.461.1">
      (
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.462.1">
       error) signals.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.463.1">
       ${LINENO}
      </span>
     </strong>
     <span class="koboSpan" id="kobo.464.1">
      is a special variable containing the current
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.465.1">
       line number.
      </span>
     </span>
    </li>
    <li>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.466.1">
       $?
      </span>
     </strong>
     <span class="koboSpan" id="kobo.467.1">
      contains the last command’s
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.468.1">
       exit code.
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.469.1">
     The validation functions ensure the environment is properly configured.
    </span>
    <span class="koboSpan" id="kobo.469.2">
     The purpose of this section is to do
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.470.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.471.1">
      Check for required security tools
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.472.1">
       before starting
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.473.1">
      Validate directory permissions
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.474.1">
       and existence
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.475.1">
      Return clear error messages for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.476.1">
       missing prerequisites
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.477.1">
     Let’s examine
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.478.1">
      the code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.479.1">
# Validation functions
validate_environment() {
    local required_tools=("docker" "trivy" "dependency-check" "bandit")
    for tool in "${required_tools[@]}"; do
        if ! </span><span class="koboSpan" id="kobo.479.2">command -v "$tool" &amp;&gt; /dev/null; then
            log "ERROR" "Required tool not found: $tool"
            return 1
        fi
    done
    if [[ ! </span><span class="koboSpan" id="kobo.479.3">-d "$REPORT_DIR" ]]; then
        log "ERROR" "Report directory not found: $REPORT_DIR"
        return 1
    fi
}
validate_target() {
    if [[ ! </span><span class="koboSpan" id="kobo.479.4">-d "$SCAN_DIR" ]]; then
        log "ERROR" "Invalid target directory: $SCAN_DIR"
        return 1
    fi
    if [[ ! </span><span class="koboSpan" id="kobo.479.5">-r "$SCAN_DIR" ]]; then
        log "ERROR" "Cannot read target directory: $SCAN_DIR"
        return 1
    fi
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.480.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.481.1">
      validate_environment
     </span>
    </strong>
    <span class="koboSpan" id="kobo.482.1">
     function creates an array of
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.483.1">
      required_tools
     </span>
    </strong>
    <span class="koboSpan" id="kobo.484.1">
     and ensures they are found in the path.
    </span>
    <span class="koboSpan" id="kobo.484.2">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.485.1">
      validate_target
     </span>
    </strong>
    <span class="koboSpan" id="kobo.486.1">
     function ensures that the directory to be scanned
    </span>
    <a id="_idIndexMarker1051">
    </a>
    <span class="koboSpan" id="kobo.487.1">
     exists.
    </span>
    <span class="koboSpan" id="kobo.487.2">
     Finally, it checks permissions to ensure the scan directory can
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.488.1">
      be read.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.489.1">
     The scanning functions implement the core security checks.
    </span>
    <span class="koboSpan" id="kobo.489.2">
     The purpose of this section includes
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.490.1">
      the following:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.491.1">
      Ensuring each scan type is isolated in its
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.492.1">
       own function
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.493.1">
      Using appropriate tools from our
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.494.1">
       DevSecOps environment
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.495.1">
      Implementing proper error handling
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.496.1">
       and logging
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.497.1">
      Generating structured output files
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.498.1">
       for reporting
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.499.1">
     Let’s dive into
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.500.1">
      the code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.501.1">
perform_sast_scan() {
    log "INFO" "Starting SAST scan with Bandit"
    local output_file="${REPORT_DIR}/${REPORT_NAME}_sast.txt"</span></pre>
   <p>
    <span class="koboSpan" id="kobo.502.1">
     Here, we’re simply logging a status message and setting the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.503.1">
       output_file
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.504.1">
      variable.
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.505.1">
    if bandit -r "$SCAN_DIR" -f txt </span><a id="_idTextAnchor688"/><a id="_idTextAnchor689"/><span class="koboSpan" id="kobo.506.1">-o "$output_file"; then
        log "INFO" "SAST scan completed successfully"
  </span><a id="_idTextAnchor690"/><a id="_idTextAnchor691"/><span class="koboSpan" id="kobo.507.1">      return 0
    else
        log "ERROR" "SAST scan did not complete successfully"
        return 1
    fi
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.508.1">
     In the preceding code, we run a scan with
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.509.1">
      bandit
     </span>
    </strong>
    <span class="koboSpan" id="kobo.510.1">
     .
    </span>
    <span class="koboSpan" id="kobo.510.2">
     Bandit is a
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.511.1">
      Static Application Security Testing
     </span>
    </strong>
    <span class="koboSpan" id="kobo.512.1">
     (
    </span>
    <strong class="bold">
     <span class="koboSpan" id="kobo.513.1">
      SAST
     </span>
    </strong>
    <span class="koboSpan" id="kobo.514.1">
     ) tool that
    </span>
    <a id="_idIndexMarker1052">
    </a>
    <span class="koboSpan" id="kobo.515.1">
     checks for vulnerabilities in Python code.
    </span>
    <span class="koboSpan" id="kobo.515.2">
     Then, it sets the return code based on success or failure from the
    </span>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.516.1">
       bandit
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.517.1">
      command.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.518.1">
     In the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.519.1">
      perform_dependency_scan
     </span>
    </strong>
    <span class="koboSpan" id="kobo.520.1">
     function, we run
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.521.1">
      dependency-check
     </span>
    </strong>
    <span class="koboSpan" id="kobo.522.1">
     to test for known vulnerabilities in software
    </span>
    <a id="_idIndexMarker1053">
    </a>
    <span class="koboSpan" id="kobo.523.1">
     dependencies and log a message based on the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.524.1">
      return code:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.525.1">
perform_dependency_scan() {
    log "INFO" "Starting dependency scan"
    local output_file="${REPORT_DIR}/${REPORT_NAME}_deps"
    if dependency-check --scan "$SCAN_DIR" --out "$output_file" --format ALL; then
        log "INFO" "Dependency scan completed successfully"
        return 0
    else
        log "ERROR" "Dependency scan did not complete successfully"
        return 1
    fi
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.526.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.527.1">
      perform_container_scan
     </span>
    </strong>
    <span class="koboSpan" id="kobo.528.1">
     function scans Docker container images for security vulnerabilities.
    </span>
    <span class="koboSpan" id="kobo.528.2">
     It finds all Dockerfiles in a directory, builds container images from them, and uses Trivy (a vulnerability scanner) to check each image for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.529.1">
      security issues.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.530.1">
     The following code block is responsible for generating the report summary, and includes the main function, which con
    </span>
    <a id="_idTextAnchor692">
    </a>
    <a id="_idTextAnchor693">
    </a>
    <span class="koboSpan" id="kobo.531.1">
     trols
    </span>
    <a id="_idIndexMarker1054">
    </a>
    <span class="koboSpan" id="kobo.532.1">
     the flow of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.533.1">
      code execution:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.534.1">
perform_container_scan() {
    log "INFO" "Starting container image scan"
    local output_file="${REPORT_DIR}/${REPORT_NAME}_containers.json"
    # Find all Dockerfiles in the target directory
    while IFS= read -r -d '' dockerfile; do
        local dir_name
        dir_name=$(dirname "$dockerfile")
        local image_name
        image_name=$(basename "$dir_name")
        log "INFO" "Building container from Dockerfile: $dockerfile"
        if docker build -t "scan_target:${image_name}" "$dir_name"; then
            log "INFO" "Scanning container image: scan_target:${image_name}"
            if ! </span><span class="koboSpan" id="kobo.534.2">trivy image -f json -o "$output_file" "scan_target:${image_name}"; then
                log "WARNING" "Container vulnerabilities found"
                return 1
            fi
        else
            log "ERROR" "Failed to build container from $dockerfile"
            return 1
        fi
    done &lt; &lt;(find "$SCAN_DIR" -name "Dockerfile" -print0)
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.535.1">
     Finally, the results processing
    </span>
    <a id="_idIndexMarker1055">
    </a>
    <span class="koboSpan" id="kobo.536.1">
     function,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.537.1">
      generate_summary
     </span>
    </strong>
    <span class="koboSpan" id="kobo.538.1">
     , and
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.539.1">
      main
     </span>
    </strong>
    <span class="koboSpan" id="kobo.540.1">
     functions
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.541.1">
      are executed.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.542.1">
     The
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.543.1">
      generate_summary
     </span>
    </strong>
    <span class="koboSpan" id="kobo.544.1">
     function performs the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.545.1">
      following steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.546.1">
      Creates a Markdown-formatted
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.547.1">
       summary report
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.548.1">
      Extracts key findings from each
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.549.1">
       scan type
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.550.1">
      Uses
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.551.1">
       tail
      </span>
     </strong>
     <span class="koboSpan" id="kobo.552.1">
      to show the most recent
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.553.1">
       SAST findings
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.554.1">
      Searches for critical dependency vulnerabilities
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.555.1">
       using
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.556.1">
        grep
       </span>
      </strong>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.557.1">
      Parses container scan JSON using
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.558.1">
       jq
      </span>
     </strong>
     <span class="koboSpan" id="kobo.559.1">
      to show high and critical
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.560.1">
       severity issues
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.561.1">
      Provides fallback messages when no issues
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.562.1">
       are found
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.563.1">
      Redirects all output to a single
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.564.1">
       summary file
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.565.1">
     The following code generates the report in
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.566.1">
      Markdown format:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.567.1">
generate_summary() {
    local summary_file="${REPORT_DIR}/${REPORT_NAME}_summary.md"
    {
        echo "# Security Scan Summary"
        echo "## Scan Information"
        echo "- Date: $(date)"
        echo "- Target: $SCAN_DIR"
        echo
        echo "## Findings Summary"
        echo "### SAST Scan"
        echo "\`\`\`"
        tail -n 10 "${REPORT_DIR}/${REPORT_NAME}_sast.txt"
        echo "\`\`\`"
        echo
        echo "### Dependency Scan"
        echo "\`\`\`"
        grep -A 5 "One or more dependencies were identified with known vulnerabilities" \
            "${REPORT_DIR}/${REPORT_NAME}_deps.txt" 2&gt;/dev/null || echo "No critical dependencies found"
        echo "\`\`\`"
        echo
        echo "### Container Scan"
        echo "\`\`\`"
        jq -r '.Results[] | select(.Vulnerabilities != null) | .Vulnerabilities[] | select(.Severity == "HIGH" or .Severity == "CRITICAL") | "- \(.VulnerabilityID): \(.Title)"' \
            "${REPORT_DIR}/${REPORT_NAME}_containers.json" 2&gt;/dev/null || echo "No container vulnerabilities found"
        echo "\`\`\`"
    } &gt; "$summary_file"
    log "INFO" "Summary report generated: $summary_file"
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.568.1">
     The only thing you haven’t already seen in the preceding code is the Markdown formatting.
    </span>
    <span class="koboSpan" id="kobo.568.2">
     In Markdown, code blocks are started using a line starting with three backticks (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.569.1">
      ```
     </span>
    </strong>
    <span class="koboSpan" id="kobo.570.1">
     ), followed by lines of code, and closed out by another line starting with three backticks.
    </span>
    <span class="koboSpan" id="kobo.570.2">
     Headings are formatted
    </span>
    <a id="_idIndexMarker1056">
    </a>
    <span class="koboSpan" id="kobo.571.1">
     with one or more hash symbols (
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.572.1">
      #
     </span>
    </strong>
    <span class="koboSpan" id="kobo.573.1">
     ) preceding the heading title.
    </span>
    <span class="koboSpan" id="kobo.573.2">
     For example, an H1 header would have one,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.574.1">
      #
     </span>
    </strong>
    <span class="koboSpan" id="kobo.575.1">
     , and an H2 header would have two,
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.576.1">
      ##
     </span>
    </strong>
    <span class="koboSpan" id="kobo.577.1">
     , followed by the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.578.1">
      section title.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.579.1">
     Finally, we have the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.580.1">
      main
     </span>
    </strong>
    <span class="koboSpan" id="kobo.581.1">
     function, which calls the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.582.1">
      other functions:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.583.1">
main() {
    local exit_code=0
    setup_logging
    log "INFO" "Starting security scan of $SCAN_DIR"
    validate_environment || exit 1
    validate_target || exit 1
    # Create scan-specific report directory
    mkdir -p "${REPORT_DIR}/${REPORT_NAME}"
    # Perform scans
    perform_sast_scan || exit_code=$((exit_code + 1))
    perform_dependency_scan || exit_code=$((exit_code + 1))
    perform_container_scan || exit_code=$((exit_code + 1))
    generate_summary
    log "INFO" "Security scan completed with exit code: $exit_code"
    return $exit_code
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.584.1">
     The following are example
    </span>
    <a id="_idIndexMarker1057">
    </a>
    <span class="koboSpan" id="kobo.585.1">
     commands for executing this script in your
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.586.1">
      DevSecOps environment:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.587.1">
      For basic usage, run a scan on the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.588.1">
       current directory:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.589.1">$ ./security_scanner.sh</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.590.1">
      Scan a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.591.1">
       specific project:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.592.1">$ ./security_scanner.sh /path/to/project</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.593.1">
      Run a scan as part of the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.594.1">
       CI/CD pipeline:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.595.1">$ ./security_scanner.sh "$CI_PROJECT_DIR"</span></strong></pre>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.596.1">
     The script integrates with the GitLab CI/CD environment we set up earlier.
    </span>
    <span class="koboSpan" id="kobo.596.2">
     You can add it to your
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.597.1">
      .
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.598.1">
       gitlab-ci.yml
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.599.1">
      pipeline:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.600.1">
security_scan:
  stage: test
  script:
    - /path/to/security_scanner.sh .
</span><span class="koboSpan" id="kobo.600.2">  artifacts:
    paths:
      - /opt/devsecops/reports/</span></pre>
   <p>
    <span class="koboSpan" id="kobo.601.1">
     This script demonstrates key security principles for DevSecOps
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.602.1">
      Bash scripting:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.603.1">
      Input validation
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.604.1">
       and sanitization
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.605.1">
      Comprehensive
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.606.1">
       error handling
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.607.1">
       Detailed logging
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.608.1">
      Clear
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.609.1">
       output formatting
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.610.1">
      Integration with standard
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.611.1">
       security tools
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.612.1">
      CI/CD
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.613.1">
       pipeline compatibility
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.614.1">
     Now that we have our DevSecOps scanner script, let’s further configure our system with repositories and set up the
    </span>
    <a id="_idIndexMarker1058">
    </a>
    <span class="koboSpan" id="kobo.615.1">
     system to automatically run
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.616.1">
      the scan.
     </span>
    </span>
   </p>
   <h2 id="_idParaDest-250">
    <a id="_idTextAnchor694">
    </a>
    <span class="koboSpan" id="kobo.617.1">
     Creating vulnerable artifacts
    </span>
   </h2>
   <p>
    <span class="koboSpan" id="kobo.618.1">
     Before we run our scanner script, we
    </span>
    <a id="_idIndexMarker1059">
    </a>
    <span class="koboSpan" id="kobo.619.1">
     need to configure our system with some vulnerable code and Docker containers, which will be the target of
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.620.1">
      our scans.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.621.1">
     Let’s go through the vulnerabilities that our scanning script
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.622.1">
      will detect:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.623.1">
       SAST vulnerabilities (detectable
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.624.1">
        by Bandit)
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.625.1">
       :
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.626.1">
        Use of
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.627.1">
         subprocess.check_output
        </span>
       </strong>
       <span class="koboSpan" id="kobo.628.1">
        with
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.629.1">
         shell=True
        </span>
       </strong>
       <span class="koboSpan" id="kobo.630.1">
        (
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.631.1">
         command injection)
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.632.1">
        Unsafe YAML loading
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.633.1">
         with
        </span>
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.634.1">
          yaml.load
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.635.1">
        Unsafe
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.636.1">
         Pickle deserialization
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.637.1">
        SQL injection vulnerability in the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.638.1">
         login route
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.639.1">
        Template injection in the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.640.1">
         home route
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.641.1">
        Debug mode enabled
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.642.1">
         in Flask
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.643.1">
       Dependency vulnerabilities (detectable by
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.644.1">
        OWASP Dependency-Check)
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.645.1">
       :
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.646.1">
        Flask 2.0.1 has
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.647.1">
         known vulnerabilities
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.648.1">
        PyYAML 5.3.1 has
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.649.1">
         deserialization vulnerabilities
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.650.1">
        Werkzeug 2.0.2 has path
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.651.1">
         traversal vulnerabilities
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.652.1">
        Cryptography 3.3.2 has buffer
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.653.1">
         overflow vulnerabilities
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.654.1">
        Jinja2 2.11.2 has sandbox
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.655.1">
         escape vulnerabilities
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.656.1">
       Container vulnerabilities (detectable
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.657.1">
        by Trivy)
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.658.1">
       :
      </span>
     </span>
     <ul>
      <li>
       <span class="koboSpan" id="kobo.659.1">
        The Python
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.660.1">
         3.8-slim-buster
        </span>
       </strong>
       <span class="koboSpan" id="kobo.661.1">
        base image has
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.662.1">
         known CVEs
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.663.1">
        OpenSSL
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.664.1">
         1.1.1d
        </span>
       </strong>
       <span class="koboSpan" id="kobo.665.1">
        has
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.666.1">
         multiple CVEs
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.667.1">
        Running as the
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.668.1">
          root
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.669.1">
         user
        </span>
       </span>
      </li>
      <li>
       <span class="koboSpan" id="kobo.670.1">
        An old version of curl with
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.671.1">
         known vulnerabilities
        </span>
       </span>
      </li>
     </ul>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.672.1">
     To set this up in your GitLab
    </span>
    <a id="_idIndexMarker1060">
    </a>
    <span class="koboSpan" id="kobo.673.1">
     environment, follow
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.674.1">
      these steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.675.1">
      Authenticate
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.676.1">
       to GitLab:
      </span>
     </span>
     <ol>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.677.1">
        Execute this command to find the GitLab
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.678.1">
          root
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.679.1">
         password:
        </span>
       </span>
      </li>
     </ol>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.680.1">$ sudo docker exec -it gitlab grep 'Password:' /etc/gitlab/initial_root_password</span></strong></pre>
     <ol>
      <li class="Alphabets" value="2">
       <span class="koboSpan" id="kobo.681.1">
        Log in to GitLab at
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.682.1">
         http://localhost
        </span>
       </strong>
       <span class="koboSpan" id="kobo.683.1">
        in the DevSecOps virtual machine using
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.684.1">
         root
        </span>
       </strong>
       <span class="koboSpan" id="kobo.685.1">
        for the username and the password found from the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.686.1">
         previous command.
        </span>
       </span>
      </li>
     </ol>
    </li>
    <li>
     <span class="koboSpan" id="kobo.687.1">
      Create a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.688.1">
       new user:
      </span>
     </span>
     <ol>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.689.1">
        Click
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.690.1">
         Add people
        </span>
       </strong>
       <span class="koboSpan" id="kobo.691.1">
        .
       </span>
       <span class="koboSpan" id="kobo.691.2">
        See
       </span>
       <span class="No-Break">
        <em class="italic">
         <span class="koboSpan" id="kobo.692.1">
          Figure 16
         </span>
        </em>
       </span>
       <span class="No-Break">
        <em class="italic">
         <span class="koboSpan" id="kobo.693.1">
          .1
         </span>
        </em>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.694.1">
         :
        </span>
       </span>
      </li>
     </ol>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer223">
     <span class="koboSpan" id="kobo.695.1">
      <img alt="Figure 16.1 – Adding our first GitLab user account" src="image/B22229_16_01.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.696.1">
     Figure 16.1 – Adding our first GitLab user account
    </span>
   </p>
   <ol>
    <li class="Alphabets" value="2">
     <span class="koboSpan" id="kobo.697.1">
      Specify your new user’s name, username, and email address.
     </span>
     <span class="koboSpan" id="kobo.697.2">
      Any email address will work.
     </span>
     <span class="koboSpan" id="kobo.697.3">
      We’re not going to verify the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.698.1">
       email address.
      </span>
     </span>
    </li>
    <li class="Alphabets">
     <span class="koboSpan" id="kobo.699.1">
      Click the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.700.1">
       Create
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.701.1">
        user
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.702.1">
       button.
      </span>
     </span>
    </li>
    <li class="Alphabets">
     <span class="koboSpan" id="kobo.703.1">
      Set the user’s password: To the right of the username, click the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.704.1">
       Edit
      </span>
     </strong>
     <span class="koboSpan" id="kobo.705.1">
      button.
     </span>
     <span class="koboSpan" id="kobo.705.2">
      See
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.706.1">
        Figure 16
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.707.1">
        .2
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.708.1">
       :
      </span>
     </span>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer224">
     <span class="koboSpan" id="kobo.709.1">
      <img alt="Figure 16.2 – The location of the button is shown here" src="image/B22229_16_02.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.710.1">
     Figure 16.2 – The location of the button is shown here
    </span>
   </p>
   <ol>
    <li class="Alphabets" value="5">
     <span class="koboSpan" id="kobo.711.1">
      Set the user’s password, confirm the password, and click the
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.712.1">
       Save
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.713.1">
        Changes
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.714.1">
       button.
      </span>
     </span>
    </li>
    <li class="Alphabets">
     <span class="koboSpan" id="kobo.715.1">
      Log in as the user
     </span>
     <a id="_idIndexMarker1061">
     </a>
     <span class="koboSpan" id="kobo.716.1">
      you just created.
     </span>
     <span class="koboSpan" id="kobo.716.2">
      When you log in, you will be prompted to enter your current password and
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.717.1">
       change it.
      </span>
     </span>
    </li>
   </ol>
   <ol>
    <li value="3">
     <span class="koboSpan" id="kobo.718.1">
      Create a
     </span>
     <strong class="bold">
      <span class="koboSpan" id="kobo.719.1">
       Personal Access
      </span>
     </strong>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.720.1">
        Token
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.721.1">
       (
      </span>
     </span>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.722.1">
        PAT
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.723.1">
       ):
      </span>
     </span>
     <ol>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.724.1">
        Navigate
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.725.1">
         to
        </span>
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.726.1">
          http://localhost/-/user_settings/personal_access_tokens
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.727.1">
         .
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.728.1">
        Click
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.729.1">
         Add
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.730.1">
          new token
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.731.1">
         .
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.732.1">
        Provide a name and
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.733.1">
         expiration date.
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.734.1">
        Select all scope checkboxes and click the
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.735.1">
          Create
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.736.1">
         button.
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.737.1">
        Click the button to copy
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.738.1">
         the token:
        </span>
       </span>
      </li>
     </ol>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer225">
     <span class="koboSpan" id="kobo.739.1">
      <img alt="Figure 16.3 – Copying your token value" src="image/B22229_16_03.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.740.1">
     Figure 16.3 – Copying your token value
    </span>
   </p>
   <ol>
    <li class="Alphabets" value="6">
     <span class="koboSpan" id="kobo.741.1">
      Save your PAT to a file
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.742.1">
       before continuing.
      </span>
     </span>
    </li>
   </ol>
   <ol>
    <li value="4">
     <span class="koboSpan" id="kobo.743.1">
      Create
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.744.1">
       a repository:
      </span>
     </span>
     <ol>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.745.1">
        After logging in, click
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.746.1">
         Create
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.747.1">
          a project
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.748.1">
         .
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.749.1">
        Click
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.750.1">
         Create
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.751.1">
          blank project
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.752.1">
         .
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.753.1">
        Enter
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.754.1">
         vulnerable-flask-app
        </span>
       </strong>
       <span class="koboSpan" id="kobo.755.1">
        for the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.756.1">
         project name.
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.757.1">
        Click the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.758.1">
         Create project
        </span>
       </strong>
       <span class="koboSpan" id="kobo.759.1">
        button at
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.760.1">
         the bottom.
        </span>
       </span>
      </li>
     </ol>
    </li>
    <li>
     <span class="koboSpan" id="kobo.761.1">
      Copy project CI/CD runner
     </span>
     <a id="_idIndexMarker1062">
     </a>
     <span class="koboSpan" id="kobo.762.1">
      token (shown in
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.763.1">
        Figure 16
       </span>
      </em>
     </span>
     <span class="No-Break">
      <em class="italic">
       <span class="koboSpan" id="kobo.764.1">
        .4
       </span>
      </em>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.765.1">
       ):
      </span>
     </span>
     <ol>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.766.1">
        Navigate to the project’s
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.767.1">
         CI/CD settings.
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.768.1">
        Click the three vertical dots next to the
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.769.1">
         New project
        </span>
       </strong>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.770.1">
          runner
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.771.1">
         button.
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.772.1">
        Copy the token and save it to
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.773.1">
         the file:
        </span>
       </span>
      </li>
     </ol>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer226">
     <span class="koboSpan" id="kobo.774.1">
      <img alt="Figure 16.4 – Copying your project runner token" src="image/B22229_16_04.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.775.1">
     Figure 16.4 – Copying your project runner token
    </span>
   </p>
   <ol>
    <li value="6">
     <span class="koboSpan" id="kobo.776.1">
      Register the new runner with your token (replace
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.777.1">
       YOUR_TOKEN
      </span>
     </strong>
     <span class="koboSpan" id="kobo.778.1">
      with the actual token you copied).
     </span>
     <span class="koboSpan" id="kobo.778.2">
      You can find this command in the book’s GitHub repository as
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.779.1">
       ch16_register_runner.sh
      </span>
     </strong>
     <span class="koboSpan" id="kobo.780.1">
      .
     </span>
     <span class="koboSpan" id="kobo.780.2">
      After running the command, you’ll be prompted for values.
     </span>
     <span class="koboSpan" id="kobo.780.3">
      You’ll
     </span>
     <a id="_idIndexMarker1063">
     </a>
     <span class="koboSpan" id="kobo.781.1">
      find that the values entered in the command will be the default, so simply press the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.782.1">
       Enter
      </span>
     </em>
     <span class="koboSpan" id="kobo.783.1">
      key until complete.
     </span>
     <span class="koboSpan" id="kobo.783.2">
      Here’s the code
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.784.1">
       of
      </span>
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.785.1">
        ch16_register_runner.sh
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.786.1">
       :
      </span>
     </span>
     <pre class="source-code"><span class="koboSpan" id="kobo.787.1">
sudo gitlab-runner register \
  --url "http://localhost" \
  --registration-token "your_token_here" \
  --description "docker-runner" \
  --executor "docker" \
  --docker-image "docker:dind" \
  --docker-privileged \
  --docker-volumes "/cache" \
  --docker-volumes "/opt/devsecops:/opt/devsecops:rw" \
  --docker-volumes "/var/run/docker.sock:/var/run/docker.sock" \
  --docker-network-mode "host" \
  --clone-url "http://localhost"</span></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.788.1">
      Set up the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.789.1">
       scan script:
      </span>
     </span>
     <ol>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.790.1">
        Create a
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.791.1">
         s
        </span>
        <a id="_idTextAnchor695">
        </a>
        <a id="_idTextAnchor696">
        </a>
        <a id="_idTextAnchor697">
        </a>
        <a id="_idTextAnchor698">
        </a>
        <a id="_idTextAnchor699">
        </a>
        <a id="_idTextAnchor700">
        </a>
        <span class="koboSpan" id="kobo.792.1">
         cripts
        </span>
       </strong>
       <span class="koboSpan" id="kobo.793.1">
        directory
       </span>
       <a id="_idIndexMarker1064">
       </a>
       <span class="koboSpan" id="kobo.794.1">
        if it
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.795.1">
         doesn’t exist:
        </span>
       </span>
      </li>
     </ol>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.796.1">$ sudo mkdir -p /opt/devsecops/scripts</span></strong></pre>
     <ol>
      <li class="Alphabets" value="2">
       <span class="koboSpan" id="kobo.797.1">
        Copy the security scanner to the
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.798.1">
         scripts
        </span>
       </strong>
       <span class="koboSpan" id="kobo.799.1">
        directory: Copy the
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.800.1">
         ch16_devsecops_scanner.sh
        </span>
       </strong>
       <span class="koboSpan" id="kobo.801.1">
        file from GitHub to
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.802.1">
         the direct
        </span>
        <a id="_idTextAnchor701">
        </a>
        <a id="_idTextAnchor702">
        </a>
        <a id="_idTextAnchor703">
        </a>
        <a id="_idTextAnchor704">
        </a>
        <span class="koboSpan" id="kobo.803.1">
         ory:
        </span>
       </span>
      </li>
     </ol>
     <pre class="source-code"><strong class="bold"><span class="koboSpan" id="kobo.804.1">$ sudo cp ch16_devsecops_scanner.sh /opt/devsecops/scripts/s</span><a id="_idTextAnchor705"/><a id="_idTextAnchor706"/><a id="_idTextAnchor707"/><span class="koboSpan" id="kobo.805.1">ecurity_scanner.sh</span></strong></pre>
     <ol>
      <li class="Alphabets" value="3">
       <span class="koboSpan" id="kobo.806.1">
        Make
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.807.1">
         it executable:
        </span>
       </span>
      </li>
     </ol>
     <pre class="source-code"><strong class="bold"><span class="koboSpan" id="kobo.808.1">$ sudo chmod +x /opt/devsecops/scripts/security_scanner.sh</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.809.1">
      Set up the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.810.1">
       required permissions:
      </span>
     </span>
     <ol>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.811.1">
        Allow GitLab
       </span>
       <a id="_idTextAnchor708">
       </a>
       <a id="_idTextAnchor709">
       </a>
       <a id="_idTextAnchor710">
       </a>
       <span class="koboSpan" id="kobo.812.1">
        Runner to access
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.813.1">
         required directories:
        </span>
       </span>
      </li>
     </ol>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.814.1">$ sudo chown -R gitl</span><a id="_idTextAnchor711"/><a id="_idTextAnchor712"/><a id="_idTextAnchor713"/><span class="koboSpan" id="kobo.815.1">ab-runner:gitlab-runner /opt/devsecops</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.816.1">$ sudo chmod -R 755</span><a id="_idTextAnchor714"/><a id="_idTextAnchor715"/><a id="_idTextAnchor716"/><span class="koboSpan" id="kobo.817.1"> /opt/devsecops</span></strong></pre>
     <ol>
      <li class="Alphabets" value="2">
       <span class="No-Break">
        <span class="koboSpan" id="kobo.818.1">
         Restart
        </span>
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.819.1">
          gitlab-runner
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.820.1">
         :
        </span>
       </span>
      </li>
     </ol>
     <pre class="source-code"><strong class="bold"><span class="koboSpan" id="kobo.821.1">$ sudo systemctl restart gitlab-run</span><a id="_idTextAnchor717"/><a id="_idTextAnchor718"/><a id="_idTextAnchor719"/><a id="_idTextAnchor720"/><span class="koboSpan" id="kobo.822.1">ner</span></strong></pre>
     <ol>
      <li class="Alphabets" value="3">
       <span class="koboSpan" id="kobo.823.1">
        Allow access to the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.824.1">
         Docker socket:
        </span>
       </span>
      </li>
     </ol>
     <pre class="source-code"><strong class="bold"><span class="koboSpan" id="kobo.825.1">$ sudo usermod -aG docker gitlab-runner</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.826.1">
      Clone the repository: Run the following command, replacing
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.827.1">
       &lt;username&gt;
      </span>
     </strong>
     <span class="koboSpan" id="kobo.828.1">
      with your actual GitLab
     </span>
     <a id="_idIndexMarker1065">
     </a>
     <span class="koboSpan" id="kobo.829.1">
      username.
     </span>
     <span class="koboSpan" id="kobo.829.2">
      You’ll be prompted for your username and password.
     </span>
     <span class="koboSpan" id="kobo.829.3">
      Use your GitLab username, and paste the PAT that you copied in
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.830.1">
       Step 5
      </span>
     </em>
     <span class="koboSpan" id="kobo.831.1">
      for
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.832.1">
       the password:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.833.1">$ git clone http://localhost/&lt;username&gt;/vulnerable-flask-app.git</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.834.1">
      Add the files: Copy the following files from this chapter’s GitHub directory into the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.835.1">
        vulnerable_flask_app
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.836.1">
       directory:
      </span>
     </span>
     <ul>
      <li>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.837.1">
          app.py
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.838.1">
          requirements.txt
         </span>
        </strong>
       </span>
      </li>
      <li>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.839.1">
          Dockerfile
         </span>
        </strong>
       </span>
      </li>
      <li>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.840.1">
         .
        </span>
       </strong>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.841.1">
          gitlab-ci.yml
         </span>
        </strong>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <span class="koboSpan" id="kobo.842.1">
      Configure our
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.843.1">
       Git user:
      </span>
     </span>
     <ol>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.844.1">
        Run this command to set the Git username for this repo
       </span>
       <a id="_idTextAnchor721">
       </a>
       <a id="_idTextAnchor722">
       </a>
       <a id="_idTextAnchor723">
       </a>
       <a id="_idTextAnchor724">
       </a>
       <span class="koboSpan" id="kobo.845.1">
        sitory, using your GitLab
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.846.1">
         account name:
        </span>
       </span>
      </li>
     </ol>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.847.1">$ git config user.name "Your Name"</span></strong></pre>
     <ol>
      <li class="Alphabets" value="2">
       <span class="koboSpan" id="kobo.848.1">
        Run this command to set the Git email for this repository, using your GitLab account
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.849.1">
         email address:
        </span>
       </span>
      </li>
     </ol>
     <pre class="source-code"><strong class="bold"><span class="koboSpan" id="kobo.850.1">$ git config user.email "your.email@example.com"</span></strong></pre>
     <ol>
      <li class="Alphabets" value="3">
       <span class="koboSpan" id="kobo.851.1">
        Issue the following commands to add the
       </span>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.852.1">
         rep
        </span>
        <a id="_idTextAnchor725">
        </a>
        <a id="_idTextAnchor726">
        </a>
        <span class="koboSpan" id="kobo.853.1">
         orts
        </span>
       </strong>
       <span class="koboSpan" id="kobo.854.1">
        directory and track the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.855.1">
         new files:
        </span>
       </span>
      </li>
     </ol>
     <pre class="source-code"><strong class="bold"><span class="koboSpan" id="kobo.856.1">$ mkdir -p re</span><a id="_idTextAnchor727"/><a id="_idTextAnchor728"/><span class="koboSpan" id="kobo.857.1">por</span><a id="_idTextAnchor729"/><a id="_idTextAnchor730"/><a id="_idTextAnchor731"/><span class="koboSpan" id="kobo.858.1">ts</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.859.1">$ touch rep</span><a id="_idTextAnchor732"/><a id="_idTextAnchor733"/><span class="koboSpan" id="kobo.860.1">orts/.gitkeep</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.861.1">$ git add .</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.862.1">$ git commit -m "Initial commit of vulnerable application"</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.863.1">
      Push to GitLab: Run the following command to push the repository to GitLab, replacing
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.864.1">
       &lt;youruser&gt;
      </span>
     </strong>
     <span class="koboSpan" id="kobo.865.1">
      with the username you created in
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.866.1">
       Step 2
      </span>
     </em>
     <span class="koboSpan" id="kobo.867.1">
      .
     </span>
     <span class="koboSpan" id="kobo.867.2">
      You will be prompted for your GitLab
     </span>
     <a id="_idIndexMarker1066">
     </a>
     <span class="koboSpan" id="kobo.868.1">
      username and password.
     </span>
     <span class="koboSpan" id="kobo.868.2">
      Use the GitLab PA
     </span>
     <a id="_idTextAnchor734">
     </a>
     <a id="_idTextAnchor735">
     </a>
     <a id="_idTextAnchor736">
     </a>
     <span class="koboSpan" id="kobo.869.1">
      T you generated earlier as
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.870.1">
       the password:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.871.1">$ git remote add origin http://local</span><a id="_idTextAnchor737"/><a id="_idTextAnchor738"/><a id="_idTextAnchor739"/><span class="koboSpan" id="kobo.872.1">host/&lt;youruser&gt;/vulnerable-flask-app.git</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.873.1">$ git push -u origin main</span></strong></pre>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.874.1">
       Now, every time you push to the repository or create a merge request, the following
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.875.1">
        will happen:
       </span>
      </span>
     </p>
     <ol>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.876.1">
        GitLab CI will automatically trigger
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.877.1">
         the pipeline
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.878.1">
        The security scanner will run against the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.879.1">
         code base
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.880.1">
        Reports will be available as artifacts in the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.881.1">
         GitLab UI
        </span>
       </span>
      </li>
     </ol>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.882.1">
       To view the results, follow
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.883.1">
        these steps:
       </span>
      </span>
     </p>
     <ol>
      <li class="Alphabets" value="1">
       <span class="koboSpan" id="kobo.884.1">
        Go to your
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.885.1">
         GitLab project
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.886.1">
        Click on
       </span>
       <strong class="bold">
        <span class="koboSpan" id="kobo.887.1">
         Build
        </span>
       </strong>
       <span class="koboSpan" id="kobo.888.1">
        in the
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.889.1">
         left sidebar
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.890.1">
        Click
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.891.1">
         on
        </span>
       </span>
       <span class="No-Break">
        <strong class="bold">
         <span class="koboSpan" id="kobo.892.1">
          Jobs
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.893.1">
         .
        </span>
       </span>
      </li>
      <li class="Alphabets">
       <span class="koboSpan" id="kobo.894.1">
        View the job output and
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.895.1">
         download artifacts
        </span>
       </span>
      </li>
     </ol>
     <p class="list-inset">
      <span class="koboSpan" id="kobo.896.1">
       The following figure shows a sample of the
      </span>
      <span class="No-Break">
       <span class="koboSpan" id="kobo.897.1">
        scan output:
       </span>
      </span>
     </p>
    </li>
   </ol>
   <div>
    <div class="IMG---Figure" id="_idContainer227">
     <span class="koboSpan" id="kobo.898.1">
      <img alt="Figure 16.5: The scan report reveals security issues" src="image/B22229_16_05.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.899.1">
     Figure 16.5: The scan report reveals security issues
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.900.1">
     This section introduced you to implementing security checks into a DevSecOps pipeline.
    </span>
    <span class="koboSpan" id="kobo.900.2">
     In the next section, we’ll
    </span>
    <a id="_idIndexMarker1067">
    </a>
    <span class="koboSpan" id="kobo.901.1">
     explore automated sec
    </span>
    <a id="_idTextAnchor740">
    </a>
    <a id="_idTextAnchor741">
    </a>
    <span class="koboSpan" id="kobo.902.1">
     urity and health monitoring
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.903.1">
      for DevSecOps.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-251">
    <a id="_idTextAnchor742">
    </a>
    <span class="koboSpan" id="kobo.904.1">
     Integrating real-time security monitoring with Bash
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.905.1">
     Security monitoring is essential for detecting and responding to threats in DevSecOps environments.
    </span>
    <span class="koboSpan" id="kobo.905.2">
     While many commercial
    </span>
    <a id="_idIndexMarker1068">
    </a>
    <span class="koboSpan" id="kobo.906.1">
     monitoring solutions exist, Bash scripting provides security specialists with the flexibility to create free custom monitoring systems tailored to their specific needs.
    </span>
    <span class="koboSpan" id="kobo.906.2">
     By combining standard Linux tools with security-focused applications, you can build monitoring solutions that collect metrics, analyze logs, and alert you to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.907.1">
      suspicious activities.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.908.1">
     Let’s build a monitoring system that watches our DevSecOps environment for security ev
    </span>
    <a id="_idTextAnchor743">
    </a>
    <a id="_idTextAnchor744">
    </a>
    <span class="koboSpan" id="kobo.909.1">
     ents.
    </span>
    <span class="koboSpan" id="kobo.909.2">
     This script can be found in GitHub as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.910.1">
      ch16_sec_monitor.sh
     </span>
    </strong>
    <span class="koboSpan" id="kobo.911.1">
     .
    </span>
    <span class="koboSpan" id="kobo.911.2">
     Our script will monitor GitLab authentication logs for failed login attempts and send email alerts when a threshold is exceeded.
    </span>
    <span class="koboSpan" id="kobo.911.3">
     Let’s examine the script, section
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.912.1">
      by section.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.913.1">
     First, here is the initial setup
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.914.1">
      and configuration:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.915.1">
#!/usr/bin/env bash
if [[ $EUID -ne 0 ]]; then
    echo "This script must be run as root"
    exit 1
fi
THRESHOLD=5
CHECK_INTERVAL=300  # 5 minutes
ALERT_EMAIL="&lt;user&gt;@devsecops.local"
GITLAB_LOG="/srv/gitlab/logs/gitlab-rails/application_json.log"</span></pre>
   <p>
    <span class="koboSpan" id="kobo.916.1">
     This section verifies root privileges and sets key variables.
    </span>
    <span class="koboSpan" id="kobo.916.2">
     The script checks every five minutes for failed logins
    </span>
    <a id="_idIndexMarker1069">
    </a>
    <span class="koboSpan" id="kobo.917.1">
     exceeding a threshold of five attempts.
    </span>
    <span class="koboSpan" id="kobo.917.2">
     Be sure to change the email address username to your own before running the script.
    </span>
    <span class="koboSpan" id="kobo.917.3">
     Replace
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.918.1">
      &lt;user&gt;
     </span>
    </strong>
    <span class="koboSpan" id="kobo.919.1">
     with
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.920.1">
      your username.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.921.1">
     As shown here, the alert function handles
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.922.1">
      email notifications:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.923.1">
send_alert() {
    local failed_count=$1
    local recent_failures=$2
    echo "WARNING: $failed_count failed login attempts in the last 5 minutes
Time: $(date)
Recent failures:
$recent_failures" | mail -s "GitLab Security Alert - Failed Logins" "$ALERT_EMAIL"
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.924.1">
     This function formats and sends email alerts using the local mail system.
    </span>
    <span class="koboSpan" id="kobo.924.2">
     It includes the count of failures and details about
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.925.1">
      recent attempts.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.926.1">
     As shown here, the main monitoring logic is
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.927.1">
      as follows:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.928.1">
monitor_failed_logins() {
    if [ ! </span><span class="koboSpan" id="kobo.928.2">-f "$GITLAB_LOG" ]; then
        echo "Error: GitLab log file not found at $GITLAB_LOG"
        exit 1
    }
    local current_time=$(date +%s)
    local window_start=$((current_time - CHECK_INTERVAL))
    local window_start_iso=$(date -u -d "@$window_start" +"%Y-%m-%dT%H:%M:%S")</span></pre>
   <p>
    <span class="koboSpan" id="kobo.929.1">
     This section checks for the log file’s existence and calculates the time window for monitoring.
    </span>
    <span class="koboSpan" id="kobo.929.2">
     It converts Unix timestamps to ISO format for
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.930.1">
      log comparison.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.931.1">
     The log analysis portion is
    </span>
    <a id="_idIndexMarker1070">
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.932.1">
      demonstrated next:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.933.1">
local recent_failures=$(grep "Failed Login:" "$GITLAB_LOG" | while read -r line; do
        log_time=$(echo "$line" | jq -r '.time' | cut -d'.' </span><span class="koboSpan" id="kobo.933.2">-f1)
        if [[ "$log_time" &gt; "$window_start_iso" ]]; then
            echo "$line"
        fi
    done)
    local failed_count=$(echo "$recent_failures" | grep -c "Failed Login:")
    if [ "$failed_count" -gt "$THRESHOLD" ]; then
        send_alert "$failed_count" "$(echo "$recent_failures" | jq -r '.message')"
    fi
}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.934.1">
     This code performs the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.935.1">
      following functions:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="koboSpan" id="kobo.936.1">
      Searches for failed
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.937.1">
       login entries
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.938.1">
      Uses
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.939.1">
       jq
      </span>
     </strong>
     <span class="koboSpan" id="kobo.940.1">
      to parse the JSON
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.941.1">
       log format
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.942.1">
      Filters entries within the
     </span>
     <a id="_idIndexMarker1071">
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.943.1">
       time window
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.944.1">
      Counts failures and triggers alerts if above
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.945.1">
       the threshold
      </span>
     </span>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.946.1">
     The main loop is
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.947.1">
      shown here:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.948.1">
while true; do
    monitor_failed_logins
    sleep "$CHECK_INTERVAL"
done</span></pre>
   <p>
    <span class="koboSpan" id="kobo.949.1">
     This creates a continuous monitoring cycle, running checks every five minutes.
    </span>
    <span class="koboSpan" id="kobo.949.2">
     The script never exits unless manually stopped or an
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.950.1">
      error occurs.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.951.1">
     After repeatedly entering failed login attempts in the GitLab login at
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.952.1">
      http://localhost/
     </span>
    </strong>
    <span class="koboSpan" id="kobo.953.1">
     , I check my mail and find alerts, as shown in the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.954.1">
      following figure:
     </span>
    </span>
   </p>
   <div>
    <div class="IMG---Figure" id="_idContainer228">
     <span class="koboSpan" id="kobo.955.1">
      <img alt="Figure 16.6: An email alert reveals failed login attempts" src="image/B22229_16_06.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.956.1">
     Figure 16.6: An email alert reveals failed login attempts
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.957.1">
     This section
    </span>
    <a id="_idIndexMarker1072">
    </a>
    <span class="koboSpan" id="kobo.958.1">
     demonstrated that you don’t need expensive software to implement security features.
    </span>
    <span class="koboSpan" id="kobo.958.2">
     In the next section, we’ll explore how to make setting up a fresh Kali Linux instance quick
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.959.1">
      and painless.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-252">
    <a id="_idTextAnchor745">
    </a>
    <span class="koboSpan" id="kobo.960.1">
     Automating custom Kali Linux builds for pentesting
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.961.1">
     For pentesters who perform consulting work for external customers, every project should start with a fresh installation
    </span>
    <a id="_idIndexMarker1073">
    </a>
    <span class="koboSpan" id="kobo.962.1">
     of the operating
    </span>
    <a id="_idIndexMarker1074">
    </a>
    <span class="koboSpan" id="kobo.963.1">
     system, which is typically Kali Linux.
    </span>
    <span class="koboSpan" id="kobo.963.2">
     There are many ways to
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.964.1">
      deploy Kali:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.965.1">
       Virtual machines
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.966.1">
       Docker containers
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.967.1">
       Cloud images
      </span>
     </span>
    </li>
    <li>
     <span class="koboSpan" id="kobo.968.1">
      Bare metal installation on laptops or
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.969.1">
       other devices
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.970.1">
     This section will focus on building Kali ISO image installers using Bash scripting.
    </span>
    <span class="koboSpan" id="kobo.970.2">
     The resulting ISO image will automate the installation of Kali on virtual machines or bare metal.
    </span>
    <span class="koboSpan" id="kobo.970.3">
     The image file can be connected to a virtual machine or to a laptop or other device using USB storage.
    </span>
    <span class="koboSpan" id="kobo.970.4">
     From there, you simply boot the system, and your custom image
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.971.1">
      is installed.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.972.1">
     Your system will need a few gigabytes of free disk space to create the image.
    </span>
    <span class="koboSpan" id="kobo.972.2">
     The amount of free disk space needed depends on the options you choose and whether you choose to install all or a
    </span>
    <a id="_idIndexMarker1075">
    </a>
    <span class="koboSpan" id="kobo.973.1">
     subset of packages.
    </span>
    <span class="koboSpan" id="kobo.973.2">
     To begin building custom Kali Linux ISOs, first, install the required packages and clone the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.974.1">
      build
     </span>
    </strong>
    <span class="koboSpan" id="kobo.975.1">
     repository
    </span>
    <a id="_idIndexMarker1076">
    </a>
    <span class="koboSpan" id="kobo.976.1">
     using the
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.977.1">
      following commands:
     </span>
    </span>
   </p>
   <pre class="console"><span class="koboSpan" id="kobo.978.1">
$ sudo apt update
$ sudo apt install -y git live-build simple-cdd cdebootstrap curl
$ git clone https://gitlab.com/kalilinux/build-scripts/live-build-config.git
$ cd live-build-config</span></pre>
   <p>
    <span class="koboSpan" id="kobo.979.1">
     The build process supports two types
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.980.1">
      of images:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.981.1">
       Live images
      </span>
     </strong>
     <span class="koboSpan" id="kobo.982.1">
      : For running Kali directly from USB without installation.
     </span>
     <span class="koboSpan" id="kobo.982.2">
      Use the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.983.1">
       --live
      </span>
     </strong>
     <span class="koboSpan" id="kobo.984.1">
      command-line option
     </span>
     <a id="_idIndexMarker1077">
     </a>
     <span class="koboSpan" id="kobo.985.1">
      with the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.986.1">
        build
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.987.1">
       script.
      </span>
     </span>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.988.1">
       Installer images
      </span>
     </strong>
     <span class="koboSpan" id="kobo.989.1">
      : For performing
     </span>
     <a id="_idIndexMarker1078">
     </a>
     <span class="koboSpan" id="kobo.990.1">
      customized system installations.
     </span>
     <span class="koboSpan" id="kobo.990.2">
      Use the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.991.1">
       --installer
      </span>
     </strong>
     <span class="koboSpan" id="kobo.992.1">
      command-line option with the
     </span>
     <span class="No-Break">
      <strong class="source-inline">
       <span class="koboSpan" id="kobo.993.1">
        build
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.994.1">
       script.
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.995.1">
     To build with different desktop environments, use the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.996.1">
      --variant
     </span>
    </strong>
    <span class="koboSpan" id="kobo.997.1">
     flag.
    </span>
    <span class="koboSpan" id="kobo.997.2">
     Here are
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.998.1">
      some examples:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.999.1">
      Build with the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1000.1">
       GNOME desktop:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1001.1">$ ./build.sh --variant gnome --verbose</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1002.1">
      Build with the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1003.1">
       KDE desktop:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1004.1">$ ./build.sh --variant kde --verbose</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1005.1">
      Build with the XFCE
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1006.1">
       desktop (default):
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1007.1">$ ./build.sh --variant xfce --verbose</span></strong></pre>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.1008.1">
     You may also want to specify different architectures, for example, x86-64 for Intel/AMD CPUs, or ARM64 for running in a virtual machine on macOS.
    </span>
    <span class="koboSpan" id="kobo.1008.2">
     Specify the target architecture using the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1009.1">
      --
     </span>
    </strong>
    <span class="No-Break">
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1010.1">
       arch
      </span>
     </strong>
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1011.1">
      flag:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <span class="koboSpan" id="kobo.1012.1">
      Build
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1013.1">
       for x86-64:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1014.1">$ ./build.sh --verbose --arch amd64</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1015.1">
      Build
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1016.1">
       for ARM64:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1017.1">$ ./build.sh --verbose --arch arm64</span></strong></pre>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.1018.1">
     Here’s a complete automated build
    </span>
    <a id="_idIndexMarker1079">
    </a>
    <span class="koboSpan" id="kobo.1019.1">
     script that sets common options.
    </span>
    <span class="koboSpan" id="kobo.1019.2">
     You can
    </span>
    <a id="_idTextAnchor746">
    </a>
    <a id="_idTextAnchor747">
    </a>
    <a id="_idTextAnchor748">
    </a>
    <a id="_idTextAnchor749">
    </a>
    <span class="koboSpan" id="kobo.1020.1">
     find this in the GitHub directory for
    </span>
    <a id="_idIndexMarker1080">
    </a>
    <span class="koboSpan" id="kobo.1021.1">
     this chapter as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1022.1">
      ch16_build_kali.sh
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1023.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1023.2">
     Note that this must be run on a Kali
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1024.1">
      Linux system:
     </span>
    </span>
   </p>
   <pre class="source-code"><span class="koboSpan" id="kobo.1025.1">
#!/usr/bin/env bash
# Set build parameters
DESKTOP="gnome"  # Options: gnome, kde, xfce
ARCH="amd64"     # Options: amd64, arm64
VERSION="custom-1.0"
BUILD_TYPE="installer"  # Options: installer, live
# Create custom password configuration
mkdir -p kali-config/common/includes.chroot/etc/live/config
echo 'LIVE_USER_DEFAULT_GROUPS="audio cdrom dialout floppy video plugdev netdev powerdev scanner bluetooth kali"' &gt; kali-config/common/includes.chroot/etc/live/config/user-setup
echo 'LIVE_USER_PASSWORD=kali' &gt;&gt; kali-config/common/includes.chroot/etc/live/config/user-setup
# Launch build with all parameters
./build.sh \
  --verbose \
  --variant ${DESKTOP} \
  --arch ${ARCH} \
  --version ${VERSION} \
  --${BUILD_TYPE}</span></pre>
   <p>
    <span class="koboSpan" id="kobo.1026.1">
     The build system offers several
    </span>
    <a id="_idIndexMarker1081">
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1027.1">
      customization options:
     </span>
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1028.1">
       Package selection
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1029.1">
      : Edit package lists in
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1030.1">
       kali-config/variant-*/package-lists/kali.list.chroot
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1031.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1031.2">
      Default packages come from the
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1032.1">
       kali-linux-default
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1033.1">
      metapackage.
     </span>
     <span class="koboSpan" id="kobo.1033.2">
      I highly recommend that you review these options
     </span>
     <a id="_idIndexMarker1082">
     </a>
     <span class="koboSpan" id="kobo.1034.1">
      to customize what gets installed.
     </span>
     <span class="koboSpan" id="kobo.1034.2">
      This will affect the resulting ISO image size.
     </span>
     <span class="koboSpan" id="kobo.1034.3">
      You can simply comment or uncomment lines to achieve the desired effect, as shown in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1035.1">
       following figure:
      </span>
     </span>
    </li>
   </ul>
   <div>
    <div class="IMG---Figure" id="_idContainer229">
     <span class="koboSpan" id="kobo.1036.1">
      <img alt="Figure 16.7 – You may comment or uncomment lines to choose metapackages" src="image/B22229_16_07.jpg"/>
     </span>
    </div>
   </div>
   <p class="IMG---Caption" lang="en-US" xml:lang="en-US">
    <span class="koboSpan" id="kobo.1037.1">
     Figure 16.7 – You may comment or uncomment lines to choose metapackages
    </span>
   </p>
   <ul>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1038.1">
       File overlays
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1039.1">
      : Place custom
     </span>
     <a id="_idIndexMarker1083">
     </a>
     <span class="koboSpan" id="kobo.1040.1">
      files in
     </span>
     <strong class="source-inline">
      <span class="koboSpan" id="kobo.1041.1">
       kali-config/common/includes.chroot/
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1042.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1042.2">
      Files will be copied to corresponding locations in the
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1043.1">
       final image.
      </span>
     </span>
    </li>
    <li>
     <span class="No-Break">
      <strong class="bold">
       <span class="koboSpan" id="kobo.1044.1">
        Build parameters
       </span>
      </strong>
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1045.1">
       :
      </span>
     </span>
     <ul>
      <li>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.1046.1">
         --distribution
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1047.1">
        : Specify the
       </span>
       <a id="_idIndexMarker1084">
       </a>
       <span class="koboSpan" id="kobo.1048.1">
        Kali version (e.g.,
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.1049.1">
          kali-rolling
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1050.1">
         ,
        </span>
       </span>
       <span class="No-Break">
        <strong class="source-inline">
         <span class="koboSpan" id="kobo.1051.1">
          kali-last-snapshot
         </span>
        </strong>
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1052.1">
         )
        </span>
       </span>
      </li>
      <li>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.1053.1">
         --version
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1054.1">
        : Set a custom
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1055.1">
         version string
        </span>
       </span>
      </li>
      <li>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.1056.1">
         --subdir
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1057.1">
        : Define the output
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1058.1">
         directory structure
        </span>
       </span>
      </li>
      <li>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.1059.1">
         --verbose
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1060.1">
        : Show detailed
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1061.1">
         build output
        </span>
       </span>
      </li>
      <li>
       <strong class="source-inline">
        <span class="koboSpan" id="kobo.1062.1">
         --debug
        </span>
       </strong>
       <span class="koboSpan" id="kobo.1063.1">
        : Display maximum
       </span>
       <span class="No-Break">
        <span class="koboSpan" id="kobo.1064.1">
         debug information
        </span>
       </span>
      </li>
     </ul>
    </li>
    <li>
     <strong class="bold">
      <span class="koboSpan" id="kobo.1065.1">
       Preseeding
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1066.1">
      : You can fully customize and automate the installation process using a preseed file.
     </span>
     <span class="koboSpan" id="kobo.1066.2">
      Kali is based on Debian Linux.
     </span>
     <span class="koboSpan" id="kobo.1066.3">
      You can find Debian documentation on all preseed options at
     </span>
     <a href="https://www.debian.org/releases/stable/amd64/apbs01.en.html">
      <span class="koboSpan" id="kobo.1067.1">
       https://www.debian.org/releases/stable/amd64/apbs01.en.html
      </span>
     </a>
     <span class="koboSpan" id="kobo.1068.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1068.2">
      For guidance on how to use the preseed file for the Kali build process, see step
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.1069.1">
       0x05
      </span>
     </em>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1070.1">
       at
      </span>
     </span>
     <a href="https://www.kali.org/docs/development/dojo-mastering-live-build/">
      <span class="No-Break">
       <span class="koboSpan" id="kobo.1071.1">
        https://www.kali.org/docs/development/dojo-mastering-live-build/
       </span>
      </span>
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1072.1">
       .
      </span>
     </span>
    </li>
   </ul>
   <p>
    <span class="koboSpan" id="kobo.1073.1">
     Once you have customized the build to your needs, including editing variables at the top of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1074.1">
      ch16_build_kali.sh
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1075.1">
     script, make the script executable and
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1076.1">
      run it.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1077.1">
     Once the build is complete, you can test the built image using QEMU, provided you have at least 20 GB of free disk space.
    </span>
    <span class="koboSpan" id="kobo.1077.2">
     Otherwise, you’ll need to test it on another system.
    </span>
    <span class="koboSpan" id="kobo.1077.3">
     The build process will create an ISO file in the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1078.1">
      images/
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1079.1">
     subdirectory.
    </span>
    <span class="koboSpan" id="kobo.1079.2">
     The exact filename will depend on the
    </span>
    <a id="_idIndexMarker1085">
    </a>
    <span class="koboSpan" id="kobo.1080.1">
     build
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1081.1">
      options selected.
     </span>
    </span>
   </p>
   <p class="callout-heading">
    <span class="koboSpan" id="kobo.1082.1">
     Caution
    </span>
   </p>
   <p class="callout">
    <span class="koboSpan" id="kobo.1083.1">
     Booting a computer or virtual machine with the resulting installer image will overwrite anything on
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1084.1">
      the disk!
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1085.1">
     How can we test drive the new image using QEMU?
    </span>
    <span class="koboSpan" id="kobo.1085.2">
     Let’s take a look at
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1086.1">
      the steps:
     </span>
    </span>
   </p>
   <ol>
    <li>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1087.1">
       Install QEMU:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1088.1">$ sudo apt install -y qemu qemu-system-x86 ovmf</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1089.1">
      Create a
     </span>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1090.1">
       test disk:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1091.1">$ qemu-img create -f qcow2 /tmp/kali.img 20G</span></strong></pre>
    </li>
    <li>
     <span class="koboSpan" id="kobo.1092.1">
      Boot the image to a
     </span>
     <a id="_idIndexMarker1086">
     </a>
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1093.1">
       virtual machine:
      </span>
     </span>
     <pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1094.1">qemu-system-x86_64 -enable-kvm -drive if=virtio,aio=threads,cache=unsafe,format=qcow2,file=/tmp/kali-test.hdd.img -cdrom images/kali-custom-image.iso -boot once=d</span></strong></pre>
    </li>
   </ol>
   <p>
    <span class="koboSpan" id="kobo.1095.1">
     You can read more about the process of creating custom Kali images
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1096.1">
      at
     </span>
    </span>
    <a href="https://gitlab.com/kalilinux/build-scripts/live-build-config">
     <span class="No-Break">
      <span class="koboSpan" id="kobo.1097.1">
       https://gitlab.com/kalilinux/build-scripts/live-build-config
      </span>
     </span>
    </a>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1098.1">
      .
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1099.1">
     As a consultant, I start new projects with a different customer as often as every week.
    </span>
    <span class="koboSpan" id="kobo.1099.2">
     Each customer gets a fresh virtual machine to prevent the cross-contamination of data between customers.
    </span>
    <span class="koboSpan" id="kobo.1099.3">
     The build process outlined in this section makes it easy to quickly create a new Kali image customized for your needs and preferences.
    </span>
    <span class="koboSpan" id="kobo.1099.4">
     If you rely on different tool sets for different
    </span>
    <a id="_idIndexMarker1087">
    </a>
    <span class="koboSpan" id="kobo.1100.1">
     types of pentests, simply make a copy of the
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1101.1">
      ch16_build_kali.sh
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1102.1">
     script and customize the choice of packages and metapackages to suit
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1103.1">
      your needs.
     </span>
    </span>
   </p>
   <h1 id="_idParaDest-253">
    <a id="_idTextAnchor750">
    </a>
    <span class="koboSpan" id="kobo.1104.1">
     Summary
    </span>
   </h1>
   <p>
    <span class="koboSpan" id="kobo.1105.1">
     In this chapter, you learned how to create a simple DevSecOps environment using Bash scripting on Kali Linux.
    </span>
    <span class="koboSpan" id="kobo.1105.2">
     The Bash scripts demonstrated essential patterns for secure shell scripting including proper error handling, logging, input validation, and environment verification.
    </span>
    <span class="koboSpan" id="kobo.1105.3">
     You saw how to integrate multiple security tools including OWASP Dependency-Check and Trivy.
    </span>
    <span class="koboSpan" id="kobo.1105.4">
     You also learned how to create simple (and free) automated security monitoring
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1106.1">
      Bash scripts.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1107.1">
     Through the scripts, you learned about professional logging practices, modular function design, and proper system setup validation.
    </span>
    <span class="koboSpan" id="kobo.1107.2">
     The examples covered real-world security considerations such as running as
    </span>
    <strong class="source-inline">
     <span class="koboSpan" id="kobo.1108.1">
      root
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1109.1">
     safely, checking prerequisites, handling errors gracefully, and creating clean workspaces with
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1110.1">
      appropriate permissions.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1111.1">
     After reading this book, you should now have a thorough understanding of how to integrate Bash into your pentesting workflow.
    </span>
    <span class="koboSpan" id="kobo.1111.2">
     In Bash, there are many ways to accomplish any particular task.
    </span>
    <span class="koboSpan" id="kobo.1111.3">
     I’ve been careful to show the most straightforward way in my examples and avoided complexity as much as possible to make this subject easier to learn.
    </span>
    <span class="koboSpan" id="kobo.1111.4">
     Please create an
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1112.1">
      issue
     </span>
    </em>
    <span class="koboSpan" id="kobo.1113.1">
     in the book’s GitHub repository if any of the code isn’t working or needs
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1114.1">
      further explanation.
     </span>
    </span>
   </p>
   <p>
    <span class="koboSpan" id="kobo.1115.1">
     Thanks
    </span>
    <span class="No-Break">
     <span class="koboSpan" id="kobo.1116.1">
      for reading!
     </span>
    </span>
   </p>
  </div>
 </body></html>