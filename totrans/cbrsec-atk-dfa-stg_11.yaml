- en: Active Sensors
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Now that your network is segmented, you need to actively monitor to detect suspicious
    activities and threats, and take actions based on that. Your security posture
    won't be fully completed if you don't have a good detection system, which means
    having the right sensors distributed across the network, monitoring the activities.
    The Blue Team should take advantages of modern detection technologies that create
    a profile of the user and computer to better understand anomalies and deviations
    in normal operations, and take preventative actions.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we are going to cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Detection capabilities
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Intrusion detection systems
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Intrusion prevention systems
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Behavior analytics on-premises
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Behavior analytics in a hybrid cloud
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Detection capabilities
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The current threat landscape demands a new approach to detection systems, relying
    on the traditional complexity to fine-tuning initial rules, thresholds, baselines
    and still deal with lots of false positives is becoming unacceptable for many
    organizations. When preparing to defend against attackers, the Blue Team must
    leverage a series of techniques that include:'
  prefs: []
  type: TYPE_NORMAL
- en: Data correlation from multiple data sources
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Profiling
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Behavior analytics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Anomaly detection
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Activity evaluation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Machine learning
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It is important to emphasize that some of the traditional security controls,
    such as protocol analysis and signature-based antimalware, still have their space
    in the line of defense, but to combat legacy threats. You shouldn't uninstall
    your anti-malware software just because it doesn't have machine learning capability,
    it is still one level of protection to your host. Remember the defense in depth
    approach that we discussed in the last chapter? Think of this protection as one
    layer of defense, and now you need to aggregate the other layers to enhance your
    security posture.
  prefs: []
  type: TYPE_NORMAL
- en: 'On the other hand, the traditional defender mindset that focuses on monitoring
    only high profile users is over and you can''t have this approach anymore. Current
    threat detections must look across all user accounts, profile them, and understand
    their normal behavior. Current threat actors will be looking to compromise the
    regular user, stay dormant in the network, continue the invasion by moving laterally,
    and escalate privileges. For this reason, the Blue Team must have detection mechanisms
    in place that can identify these behaviors across all devices, locations, and
    raise alerts based on the **Data Correlation**, as shown in the following diagram:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/22ccaa38-e0f5-4462-9185-a98c6188d30d.png)'
  prefs: []
  type: TYPE_IMG
- en: When you contextualize the data, you naturally reduce the amount of false positives,
    and give a more meaningful result to the investigator.
  prefs: []
  type: TYPE_NORMAL
- en: Indicators of compromise
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When talking about detection, it is important to talk about **Indicators of
    Compromise** (**IoC**). When new threats are found in the wild, they usually have
    a pattern of behavior and they leave their footprint in the target system.
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, Petya ransomware ran the following commands in the target system
    to reschedule a restart:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'Another Petya IoC is the local network scan on ports TCP `139` and TCP `445`.
    These are important indications that there is an attack taking place on the target
    system and, based on this footprint, Petya is the one to blame. Detection systems
    will be able to gather these indicators of compromise and raise alerts when an
    attack happens. Using Azure Security Center as an example, some hours after the
    Petya outbreak, Security Center automatically updates its detection engine and
    was able to warn users that their machine was compromised, as shown in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/f1c3b520-6845-4868-80c5-980c64effdcb.png)'
  prefs: []
  type: TYPE_IMG
- en: 'You can sign up with OpenIOC ([http://openioc.org](http://openioc.org)) to
    retrieve information regarding new IoC and also contribute to the community. By
    using their IoC Editor (consult the reference section for the URL to download
    this tool), you can create your own IoC or you can review an existing IoC. The
    example that follows shows the IoC Editor showing the DUQU Trojan IoC:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/a8ed021e-cfce-400d-b484-91a470057cd1.png)'
  prefs: []
  type: TYPE_IMG
- en: If you look in the right lower pane, you will see all the indications of compromise,
    and logic operators (in this case most are AND) that compare each sequence and
    only return positive if everything is true. The Blue Team should always be aware
    of the latest threats, and IoC.
  prefs: []
  type: TYPE_NORMAL
- en: You can use the following PowerShell command to download an IoC from OpenIOC,
    for the example below you are downloading the IoC for Zeus threat: `wget "http://openioc.org/iocs/72669174-dd77-4a4e-82ed-99a96784f36e.ioc"
    -outfile "72669174-dd77-4a4e-82ed-99a96784f36e.ioc"`
  prefs: []
  type: TYPE_NORMAL
- en: Intrusion detection systems
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'As the name implies, an **intrusion detection system** (**IDS**) is responsible
    for detecting a potential intrusion and trigger an alert. What can be done with
    this alert depends on the IDS policy. When creating an IDS Policy you need to
    answer the following questions:'
  prefs: []
  type: TYPE_NORMAL
- en: Who should be monitoring the IDS?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Who should have administrative access to the IDS?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How incidents will be handled based on the alerts generated by the IDS?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What's the IDS update policy?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Where should we install the IDS?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'These are just some examples of initial questions that should help in planning
    the IDS adoption. When searching for IDS, you can also consult a list of vendors
    at ICSA Labs Certified Products ([www.icsalabs.com](http://www.icsalabs.com))
    for more vendor-specific information. Regardless of the brand, a typical **IDS**
    has the capabilities shown in the following diagram:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/5330d5c0-bee9-495e-9163-3cc06be2d846.png)'
  prefs: []
  type: TYPE_IMG
- en: While these are some core capabilities, the amount of features will really vary
    according to the vendor and the method used by the IDS. The signature-based IDS
    will query a database of previous attack's signatures (footprints) and known system
    vulnerabilities to verify what was identified is a threat and if an alert must
    be triggered. Since this is a database of signatures, it requires constant update
    in order to have the latest version. The behavior-based IDS works by creating
    a baseline of patterns based on what it learned from the system. Once it learns
    the normal behavior, it becomes easier to identify deviations from normal activity.
  prefs: []
  type: TYPE_NORMAL
- en: An IDS alert is any type of user notification to bring awareness about a potential
    intrusion activity.
  prefs: []
  type: TYPE_NORMAL
- en: 'IDS can be host-based, as known as host-based intrusion detection system (**HIDS**),
    where the IDS mechanism will only detect an intrusion''s attempt against a particular
    host, or it can be a **network-based intrusion detection**** system** (**NIDS**),
    where it detects intrusion for the network segment that the NIDS is installed.
    This means that in the NIDS case, the placement becomes critical in order to gather
    valuable traffic. This is where the Blue Team should work closely with the IT
    Infrastructure team to ensure that the IDS is installed in strategic places across
    the network. Prioritize the following network segments when planning the NIDS
    placement:'
  prefs: []
  type: TYPE_NORMAL
- en: DMZ/Perimeter
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Core corporate network
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Wireless network
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Virtualization network
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Other critical network segments
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: These sensors will be listening to the traffic, which means it won't be consuming
    too much network bandwidth.
  prefs: []
  type: TYPE_NORMAL
- en: 'The diagram that follows has an example of where to put the **IDS**:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/5d39db15-0fca-4448-ae29-b153e587ec81.png)'
  prefs: []
  type: TYPE_IMG
- en: Notice that, in this case, an **IDS** (which in reality here is a NIDS) was
    added to each segment (leveraging a SPAN port on the network switch). Is it always
    like that? Absolutely not! It will vary according to your company's needs. The
    Blue Team must be aware of the company's constraints and help identify the best
    location where these devices should be installed.
  prefs: []
  type: TYPE_NORMAL
- en: Intrusion prevention system
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: An **intrusion prevention system** (**IPS**) uses the same concept of an IDS,
    but, as the name says, it prevents the intrusion by taking a corrective action.
    This action will be customized by the IPS administrator in partnership with the
    Blue Team.
  prefs: []
  type: TYPE_NORMAL
- en: 'The same way IDS is available for hosts (HIDS) and network (NIDS), IPS is also
    available for both as HIPS and NIPS. The NIPS placement within your network is
    critical and the same guidelines that were previously mentioned, are applicable
    here. You should also consider placing the NIPS inline with traffic in order to
    be able to take corrective actions. IPS detection can usually operate in one or
    more of the following modes:'
  prefs: []
  type: TYPE_NORMAL
- en: Rule-based
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Anomaly-based
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Rule-based detection
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: While operating this mode, the IPS will compare the traffic with a set of rules
    and try to verify if the traffic matches the rule. This is very useful when you
    need to deploy a new rule to block an attempt to exploit a vulnerability. NIPS
    systems, such as **Snort**, are able to block threats by leveraging rule-based
    detection. For example, the Snort rule Sid `1-42329` is able to detect the `Win.Trojan.Doublepulsar`
    variant.
  prefs: []
  type: TYPE_NORMAL
- en: Snort rules are located under `etc/snort/rules` and you can download other rules
    from [https://www.snort.org/downloads/#rule-downloads](https://www.snort.org/downloads/#rule-downloads).
    When the Blue Team is going through an exercise with the Red Team, chances are
    that new rules must be created according to the traffic pattern and the attempts
    that the Red Team is making to infiltrate the system. Sometimes you need multiple
    rules to mitigate a threat, for example, the rules `42340` (Microsoft Windows
    SMB anonymous session IPC share access attempt), `41978` (Microsoft Windows SMB
    remote code execution attempt), and `42329-42332` (`Win.Trojan.Doublepulsar` variant)
    can be used to detect WannaCry ransomware. The same applies for other IPS, such
    as Cisco IPS that has signatures `7958/0` and `7958/1`, created to handle WannaCry.
  prefs: []
  type: TYPE_NORMAL
- en: Subscribe to the Snort blog to receive updates regarding new rules at [http://blog.snort.org](http://blog.snort.org).
  prefs: []
  type: TYPE_NORMAL
- en: The advantage of using an open source NIPS, such as Snort, is that when a new
    threat is available in the wild, the community usually responds pretty fast with
    with a new rule to detect the threat. For example, when Petya ransomware was detected,
    the community created a rule, and posted at GitHub (you can see this rule here
    [https://goo.gl/mLtnFM](https://goo.gl/mLtnFM)). Although vendors and the security
    community are really fast to publish new rules, the Blue Team should be watching
    for new IoCs, and create NIPS rules based on these IoCs.
  prefs: []
  type: TYPE_NORMAL
- en: Anomaly-based detection
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The anomaly, in this case, is based on what the IPS categorize as anomalous,
    this classification is usually based on heuristics or a set of rules. One variation
    of this is called statistical anomaly detection, which takes samples of network
    traffic at random times, and performs a comparison with a baseline. If this sample
    fits outside of the baseline, an action is taken (alert followed by action).
  prefs: []
  type: TYPE_NORMAL
- en: Behavior analytics on-premises
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: For the vast majority of the companies currently in the market, the core business
    still happens on-premises. There is where the critical data is located, the majority
    of the users are working, and the key assets are located. As you know, we covered
    attack strategies in the first part of this book; the attacker tends to silently
    infiltrate your on-premises network, move laterally, escalate privilege, and maintain
    connectivity with command and control until he is able to execute his mission.
    For this reason, having behavior analytics on-premises is imperative to quickly
    break the attack kill chain.
  prefs: []
  type: TYPE_NORMAL
- en: According to Gartner, it is primordial to understand how users behave, and by
    tracking legitimate processes, organizations can enlist **User and Entity Behavior
    Analytics** (**UEBA**) to spot security breaches. There are many advantages in
    using an UEBA to detect attacks, but one of the most important ones is the capability
    to detect attacks in the early stages and take corrective action to contain the
    attack.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following diagram shows an example of how **UEBA** looks across different
    entities in order to take a decision if an alert must be triggered or not:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/5ee46226-827a-4cb2-a4b7-4b6deedd2249.png)'
  prefs: []
  type: TYPE_IMG
- en: Without having a system that can look broadly to all data and make correlations
    not only on the traffic pattern, but also on a user's profile, the chances of
    having a false positive increase. What happens nowadays is when you use your credit
    card in a place that you ahve never been before and in a geographic location that
    you don't constantly go. If your credit card has monitoring protection, someone
    will call you to validate that transaction; this happens because the system understands
    your credit card usage pattern, it knows the places that you visited before, the
    locations that you bought, and even an average of what you usually spend. When
    you deviate from all these patterns that are interconnected, the system triggers
    an alert and the action that is taken is to have someone call you to double check
    if this is really you doing that transaction. Notice that in this scenario, you
    are acting quickly in the early stage, because the credit card company put that
    transaction on hold until they get your validation.
  prefs: []
  type: TYPE_NORMAL
- en: 'The same thing happens when you have an UEBA system on premises. The system
    knows what servers your users usually access, what shares they usually visit,
    what operating system they usually use to access these resources, and the user''s
    geo-location. The following figure shows an example of this type of detection
    coming from Microsoft **Advanced Threat Analytics** (**ATA**), which uses behavior
    analytics to detect suspicious behavior:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/3319109c-9711-4a91-a92a-4fd025a8502e.png)'
  prefs: []
  type: TYPE_IMG
- en: Notice that, in this case, the message is pretty clear, it says that the Administrator
    didn't perform these activities in the last month and not in correlation with
    other accounts within the organization. This alert is not something that can be
    ignored, because it is contextualized, which means it looks to the data that was
    collected in different angles to create a correlation and make a decision if an
    alert should be raised or not.
  prefs: []
  type: TYPE_NORMAL
- en: 'Having a UEBA system on-premises can help the Blue Team to be more proactive,
    and have more tangible data to accurately react. The UEBA system is composed of
    multiple modules and another module is the advanced threat detection, which looks
    for known vulnerabilities and attack patterns. The following figure shows Microsoft
    ATA detecting a pass-the-ticket attack:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/030c2343-bf7c-435f-b28e-577934684727.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Since there are different ways to perform this attack, advanced threat detection
    can''t look just for the signature, it needs to look for the attack pattern and
    what the attacker is trying to do; this is way more powerful than using a signature-based
    system. It also looks for suspicious behavior coming from regular users that are
    not supposed to be doing certain tasks, for example if a regular user tries to
    run `NetSess.exe` tool against the local domain, Microsoft ATA will consider this
    a SMB session enumeration, which from the attacker''s perspective, is usually
    done during the reconnaissance phase. For this reason, an alert is raised as shown
    in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/80ca1ed5-2677-4463-946e-e3ce2b7721ec.png)'
  prefs: []
  type: TYPE_IMG
- en: Attackers will not only exploit vulnerabilities, but also take advantage of
    misconfigurations in the target system, such as bad protocol implementation and
    lack of hardening. For this reason, the UEBA system will also detect systems that
    are lacking a secure configuration.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following example shows Microsoft Advanced Threat Analytics detecting a
    service that is exposing account credentials because it is using LDAP without
    encryption:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/2a3a1a4b-2261-43ab-9e85-0f766b88d8ad.png)'
  prefs: []
  type: TYPE_IMG
- en: Device placement
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Using the same principles that were previously discussed in the IDS section,
    the location where you will install your UEBA will vary according to the company's
    needs and the vendor's requirements. The Microsoft ATA that was used in the examples
    explained in the previous section requires that you use port mirroring with the
    domain controller (DC). ATA will have no impact in the network bandwidth since
    it will be only listening to the DC traffic. Other solutions might require a different
    approach; for this reason, it is important to plan according to the solution that
    you purchased for your environment.
  prefs: []
  type: TYPE_NORMAL
- en: Behavior analytics in a hybrid cloud
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When the Blue Team needs to create countermeasures to secure a hybrid environment,
    the team needs to expand their view of the current threat landscape, and perform
    an assessment in order to validate continuous connectivity with the cloud and
    check the impact on overall security posture. In a hybrid cloud, most companies
    will opt to use an IaaS model and, although IaaS adoption is growing, the security
    aspect of it is still the main concern, according to an Oracle survey on IaaS
    Adoption. According to the same report, *longer term IaaS users suggest the technology
    ultimately makes a positive impact on security*. In reality, it does have a positive
    impact and that's where the Blue Team should focus their efforts on improving
    their overall detection. The intent is to leverage hybrid cloud capabilities to
    benefit the overall security posture. The first step is to establish a good partnership
    with your cloud provider and understand what security capabilities they have,
    and how these security capabilities can be used in a hybrid environment. This
    is important, because some capabilities are only available in the cloud, and not
    on-premises.
  prefs: []
  type: TYPE_NORMAL
- en: Read the article *Cloud security can enhance your overall security posture*
    to better understand some benefits of cloud computing for security.
  prefs: []
  type: TYPE_NORMAL
- en: You can get the article from: [http://go2l.ink/SecPosture](http://go2l.ink/SecPosture).
  prefs: []
  type: TYPE_NORMAL
- en: Azure Security Center
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The reason we are using Azure Security Center to monitor hybrid environment
    is because the Security Center agent can be installed on a computer (Windows or
    Linux) on-premises, in a VM running in Azure, or in AWS. This flexibility is important
    and centralized management is important for the Blue Team. Security Center leverages
    security intelligence and advanced analytics to detect threats more quickly and
    reduce false positives. In an ideal scenario, the Blue Team will use a single
    pane of glass to visualize alerts and suspicious activities across all workloads.
    The core topology looks similar to the one shown in the following figure:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/645a3263-3ca9-4faf-9058-8c3df96bb48e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'When the Security Center is installed on these computers, it will collect **Event
    Tracing for Windows** (**ETW**) traces, operating system log events, running processes,
    machine name, IP addresses, and logged in users. These events are sent to Azure,
    and stored in your private workspace storage. Security Center will analyze this
    data using the following methods:'
  prefs: []
  type: TYPE_NORMAL
- en: Threat intelligence
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Behavioral analytics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Anomaly detection
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Once this data is evaluated, Security Center will trigger an alert based on
    priority and add in the dashboard, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/dd5f2aab-62db-425f-942d-94820ca2fe12.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Notice that the first alert has a different icon and it is called Security
    incident detected. This happens because it was identified and two or more attacks
    are part of the same attack campaign against a specific resource. This means that,
    instead of having someone from the Blue Team to scavenge the data to find correlation
    between events, Security Center does that automatically and provides the relevant
    alerts for you to analyze. When you click on this alert, you will see the following
    page:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/9f1a0533-a5a3-4bd5-89f6-c1dd341b7290.png)'
  prefs: []
  type: TYPE_IMG
- en: At the bottom of this page, you can see all three attacks (in order of occurrence)
    that took place against VM1 and the severity level assigned by Security Center.
    One important observation about the advantage of using behavior analytics to detect
    threats, is the third alert (Multiple Domain Accounts Queried). The command that
    was executed to raise this alert was a simple `*net user <username> /domain*`;
    however, to make the decision that this is a suspicious, it needs to look at the
    normal behavior for the user that executed this command and cross-reference this
    information with other data that when analyzed in context, will be categorized
    as suspicious. As you can see in this example, hackers are leveraging built-in
    system tools and native command line interface to perform their attack; for this
    reason, it is paramount to have a command line logging tool.
  prefs: []
  type: TYPE_NORMAL
- en: Security Center will also use statistical profiling to build historical baselines
    and alert on deviations that conform to a potential attack vector. This is useful
    in many scenarios; one typical example is deviations from normal activity. For
    example, let's say a host starts RDP connections three times a day, but in a certain
    day there are one hundred connections attempted. When such deviation happens,
    an alert must be triggered to warn you about that.
  prefs: []
  type: TYPE_NORMAL
- en: 'Another important aspect of working with a cloud based service is the built
    in integration with other vendors. Security Center can integrate with many other
    solutions, such as Barracuda, F5, Imperva, and Fortinet for **web application
    firewall** (**WAF**), among others for endpoint protection, vulnerability assessment,
    and next-generation firewall. The image below shows an example of this integration.
    Notice that this alert was generated by Deep Security Agent and, since it is integrated
    with Security Center, it will appear in the same dashboard as the other events
    that were detected by Security Center:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](assets/5f56addf-ea33-449b-805f-b25d01e8d4ba.png)'
  prefs: []
  type: TYPE_IMG
- en: Keep in mind that Security Center is not the only solution that will monitor
    systems and integrate with other vendors; there are many **Security Information
    and Event Management** (**SIEM**) solutions, such as **Splunk** and **LogRhythm**,
    that will perform similar type of monitoring.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Snort Rules Explanation
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[https://www.snort.org/rules_explanation](https://www.snort.org/rules_explanation)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Introduction to IoC [http://openioc.org/resources/An_Introduction_to_OpenIOC.pdf](http://openioc.org/resources/An_Introduction_to_OpenIOC.pdf)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: IoC Editor [https://www.fireeye.com/content/dam/fireeye-www/services/freeware/sdl-ioc-editor.zip](https://www.fireeye.com/content/dam/fireeye-www/services/freeware/sdl-ioc-editor.zip)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: DUQU Uses STUXNET-Like Techniques to Conduct Information Theft
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/90/duqu-uses-stuxnetlike-techniques-to-conduct-information-theft](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/90/duqu-uses-stuxnetlike-techniques-to-conduct-information-theft)'
  prefs: []
  type: TYPE_NORMAL
- en: How to Select a Network Intrusion Prevention System (IPS)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[https://www.icsalabs.com/sites/default/files/HowToSelectANetworkIPS.pdf](https://www.icsalabs.com/sites/default/files/HowToSelectANetworkIPS.pdf)'
  prefs: []
  type: TYPE_NORMAL
- en: Detect Security Breaches Early by Analyzing Behavior
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[https://www.gartner.com/smarterwithgartner/detect-security-breaches-early-by-analyzing-behavior/](https://www.gartner.com/smarterwithgartner/detect-security-breaches-early-by-analyzing-behavior/)'
  prefs: []
  type: TYPE_NORMAL
- en: Advanced Threat Analytics attack simulation playbook
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[https://docs.microsoft.com/en-us/enterprise-mobility-security/solutions/ata-attack-simulation-playbook](https://docs.microsoft.com/en-us/enterprise-mobility-security/solutions/ata-attack-simulation-playbook)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: You and IaaS - Learning from the success of early adopters
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[https://www.oracle.com/assets/pulse-survey-mini-report-3764078.pdf](https://www.oracle.com/assets/pulse-survey-mini-report-3764078.pdf)'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, you learned about the different types of detection mechanisms
    and the advantages of using them to enhance your defense strategy. You learned
    about the indications of compromise and how to query current threats. You also
    learned about IDS, how it works, the different types of IDS, and the best location
    to install IDS based on your network. Next, you learned about the benefits of
    using an IPS, how rule-based and how anomaly-based detection works. The defense
    strategy wouldn't be completed without a good behavior analytics and, in this
    section, you learned how the Blue Team can benefit from this capability. Microsoft
    ATA was used as the on-premises example for this implementation and Azure Security
    Center was used as the hybrid solution for behavior analytics.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will continue talking about defense strategies; this
    time, you will learn more about threat intelligence and how the Blue Team can
    take advantage of threat intel to enhance the overall security of the defense
    systems.
  prefs: []
  type: TYPE_NORMAL
