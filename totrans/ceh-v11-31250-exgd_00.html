<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer065">
			<h1 id="_idParaDest-67"><em class="italic"><a id="_idTextAnchor068"/>Chapter 3</em>: Reconnaissance – A Deeper Dive</h1>
			<p>Did you know that most organizations give away <em class="italic">intel</em> for free! I know, right?! During the <em class="italic">reconnaissance</em> stage, it's important to know that by virtue of the internet <em class="italic">being the internet</em>, there's so much data freely available online that it makes the job of an attack extremely easy. This type of intel is often referred to as <strong class="bold">open source intelligence</strong>, or, if you want to sound like the cool kids, you say <strong class="bold">OSINT</strong>.</p>
			<p>In this chapter, we'll cover the following topics:</p>
			<ul>
				<li>Investigating the target's website</li>
				<li>The Wayback Machine</li>
				<li>What organizations give away for free</li>
				<li>Employees – the weakest link</li>
				<li>Reconnaissance countermeasures</li>
			</ul>
			<h1 id="_idParaDest-68"><a id="_idTextAnchor069"/>Investigating the target's website</h1>
			<p>Let's look at how to conduct reconnaissance on a target's website and how we can make use <a id="_idIndexMarker262"/>of other research sites. When you're doing reconnaissance, the target website is often where you'll land after a quick online search. That's where you'll learn the business's exact functions, location, contact information, clients, who the leadership team is, and sometimes, way more than that. You'll want to pay close attention to everything on the website.</p>
			<div>
				<div id="_idContainer035" class="IMG---Figure">
					<img src="Images/B17486_03_01.jpg" alt="Figure 3.1 – Investigating a website" width="1533" height="904"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.1 – Investigating a website</p>
			<p>In <em class="italic">Figure 3.1</em>, we can see a couple of pieces of information on this main page. First, on the left side, they've <a id="_idIndexMarker263"/>provided information on <a id="_idIndexMarker264"/>how to set up <strong class="bold">Microsoft</strong> <strong class="bold">Outlook</strong> with their particular email product. I already clicked through and saw how to set up via <strong class="bold">Microsoft</strong> <strong class="bold">Exchange 2003</strong>, where <a id="_idIndexMarker265"/>they also gave me the <strong class="bold">Simple Mail Transfer Protocol</strong> (<strong class="bold">SMTP</strong>) servers they utilize. Later, I'll describe how we can <a id="_idIndexMarker266"/>use that information to do banner grabs to identify the email server.</p>
			<p>We can also see that they use remote assistance software. When you see that an organization utilizes third-party software, it's a good idea to do some vulnerability research to find out whether there are any issues with that product that could get you into the target's system. There are also links everywhere on the page – for example, the <strong class="bold">Help for Sending Email</strong> link highlighted in <em class="italic">Figure 3.1</em>. Explore all the links. They may have helpful information.</p>
			<p>This company got bought out by another company (you can see that they've linked to the letter they mailed to all their current customers). Read that letter – it may discuss any new platforms they're utilizing.</p>
			<p>Let's look at another target site in <em class="italic">Figure 3.2</em>. First, look at all the posts they've linked to – for example, <strong class="bold">Business Connectivity: Big Data is Everywhere</strong>. Some of their additional posts might be valuable to us; they might discuss details about the history of the company <a id="_idIndexMarker267"/>and other information we want to know. Even if it's historical, it may give us a clue for how we approach the phases after reconnaissance.</p>
			<div>
				<div id="_idContainer036" class="IMG---Figure">
					<img src="Images/B17486_03_02.jpg" alt="Figure 3.2 – Investigating another target site" width="1076" height="716"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.2 – Investigating another target site</p>
			<p>This company has given us a lot of valuable information. They provided direct links to their <strong class="bold">Facebook</strong> and <strong class="bold">Twitter</strong> accounts. They have a chat service listed here. If you see something like that, find out what chat service they're utilizing and do vulnerability research on it.</p>
			<p>Check the bottom of the page – and I mean the <em class="italic">very bottom</em>. People tend to overlook the legal imprint and privacy policy, but you should take note of it if it's there. Websites also typically name their web designer at the bottom, as we see in <em class="italic">Figure 3.2</em>. Do some research on that company because they could be hosting multiple targets we may want to exploit.</p>
			<p>Look at links to form-based pages, like a <em class="italic">contact</em> or <em class="italic">support</em> page. In <em class="italic">Figure 3.3</em>, since this is an email-based form, it could show the information they don't intend for anyone to see. View <a id="_idIndexMarker268"/>the page's source information/code to see the HTML, ASPX, or whatever it is they're using:</p>
			<div>
				<div id="_idContainer037" class="IMG---Figure">
					<img src="Images/B17486_03_03.jpg" alt="Figure 3.3 – Email-based page" width="571" height="528"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.3 – Email-based page</p>
			<p>Inside that code, we might see some identifying comments that developers typically insert for their own memory. You'd be amazed at what we find inside of the page source code, as you don't see it in the web page itself. It's hidden – at least, hidden to the average user.</p>
			<p>Many companies post things they think are completely innocuous, but a hacker looks at information differently from how a consumer does. For example, most companies have a page titled <em class="italic">About our staff</em>. Sometimes, they have links to their employees' emails, or they have photos of them and links to their social media accounts. Social media accounts will be particularly important because sometimes people share too much when they think no one is looking. They might even share details about their work projects. Therefore, it is important to do your due diligence when looking into employees (I'll show you how to do that later).</p>
			<p>Some sites have dedicated forums or even <strong class="bold">internet relay chat</strong> (<strong class="bold">IRC</strong>) (especially if we're looking <a id="_idIndexMarker269"/>at an organization with a lot of nerds, as you see on <strong class="source-inline">HackThisSite.org</strong>). Look at what people are talking about. If they have IRC statistics or quotes, look at those. We could start a social engineering attack by contacting somebody in this company and saying something like, "<em class="italic">Hey, what's it like working there? I'm thinking about applying.</em>"</p>
			<p>To really dig <a id="_idIndexMarker270"/>into the website, ethical hackers often use a program called <strong class="bold">HTTrack</strong> (<a href="https://www.httrack.com/">https://www.httrack.com/</a>). It downloads a copy of any given website to your hard drive, including some of the backend code. Just think about the possibilities there. Using HTTrack, we can see exactly how this page is laid out, which might give us more information, such <a id="_idIndexMarker271"/>as whether they're saving their images to a different location. This is a very easy program to run. Simply create a project, categorize it, and assign a folder on your hard drive for it to download to.</p>
			<div>
				<div id="_idContainer038" class="IMG---Figure">
					<img src="Images/B17486_03_04.jpg" alt="Figure 3.4 – HTTrack website copier" width="818" height="495"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.4 – HTTrack website copier</p>
			<p>As you can see in <em class="italic">Figure 3.5</em>, you have the option to <strong class="bold">Download web site</strong>(<strong class="bold">s</strong>), as well as the option to <strong class="bold">Download web site</strong>(<strong class="bold">s</strong>) + <strong class="bold">questions</strong>, which means you get to decide whether to download its associated links. Or, you could download the site into separate files. There is even an option that finds and downloads all ZIP files on a site:</p>
			<div>
				<div id="_idContainer039" class="IMG---Figure">
					<img src="Images/B17486_03_05.jpg" alt="Figure 3.5 – HTTrack, downloading the site" width="855" height="485"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.5 – HTTrack, downloading the site</p>
			<p>There are <a id="_idIndexMarker272"/>plenty of options that we can configure to get exactly the information we need (just click <strong class="bold">Set options…</strong>). For example, what do we want to scan for? By default, the program looks for images and CSS pages. Note that we're probably not interested in advertisements, so we can exclude them from the download.</p>
			<p>Another thing that's important to remember is to change your browser ID and accept cookies.</p>
			<p>Make them think a different browser is hitting their server (this option is under <strong class="bold">Browser ID</strong>). Throw them off the trail. Make it seem like you're using a <strong class="bold">Linux</strong> box even though you're running a <strong class="bold">Microsoft</strong> box. If you're going through this with me, download the site (<strong class="source-inline">HackThisSite.org</strong>).</p>
			<p>In the past, I've found <strong class="bold">Microsoft</strong> <strong class="bold">Excel</strong> spreadsheets on a site. I have even found password files. Regardless of whether you find those kinds of files, it's important to have a good understanding of how the target's site is laid out.</p>
			<p>Another tool <a id="_idIndexMarker273"/>we can use to map out this system and possibly even expose things is a <strong class="bold">link extractor</strong> utility. This utility usually goes through a given website and tries to extract both internal and external URLs for it. To find one that works for you, you can just search <strong class="bold">Google</strong> for <strong class="source-inline">link extractor</strong>. In <em class="italic">Figure 3.6</em>, I'm using the <a id="_idIndexMarker274"/>one at <strong class="bold">Webmaster-Toolkit</strong> (<a href="https://webmasterstoolkit.com/">https://webmasterstoolkit.com/</a>). All you have to do is type in the web address of the site you're targeting and hit <strong class="bold">Extract the Links</strong>. Seeing all the different links used on this website <a id="_idIndexMarker275"/>could help us figure out the server infrastructure. Some of the links could even provide other ways into the environment.</p>
			<div>
				<div id="_idContainer040" class="IMG---Figure">
					<img src="Images/B17486_03_06.jpg" alt="Figure 3.6 – Using the Link Extractor tool from the webmaster toolkit&#13;&#10;" width="841" height="605"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.6 – Using the Link Extractor tool from the webmaster toolkit</p>
			<p>After extracting the links, the result is as follows:</p>
			<div>
				<div id="_idContainer041" class="IMG---Figure">
					<img src="Images/B17486_03_07.jpg" alt="Figure 3.7 – Result of the link search" width="1123" height="857"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.7 – Result of the link search</p>
			<p>When looking <a id="_idIndexMarker276"/>at these results, make sure to check whether they expose anything, for example, <strong class="source-inline">extranet.wayneenterprises.com</strong> or maybe <strong class="source-inline">mail.wayneenterprises.com</strong>. The famous keywords to look for are <strong class="source-inline">email</strong> or <strong class="source-inline">restricted</strong>. I'm sure you can think of a few others on your own as well.</p>
			<h2 id="_idParaDest-69"><a id="_idTextAnchor070"/>Advanced DNS tricks</h2>
			<p>Let's go a little <a id="_idIndexMarker277"/>deeper into <strong class="bold">nslookup.io</strong>. One type of DNS record is called an <strong class="bold">SOA</strong>, or <strong class="bold">Start of Authority</strong>. An SOA <a id="_idIndexMarker278"/>stores a record or information <a id="_idIndexMarker279"/>that's important about a domain or a zone containing adminstrative information that could be helpful to you.</p>
			<p>Follow these steps: </p>
			<ol>
				<li>Just like before, type <strong class="source-inline">set type=soa</strong>. This type looks for the authoritative server. </li>
				<li>Enter the target URL (in our example, this will be <strong class="source-inline">hackthissite.org</strong>).</li>
				<li>Exit nslookup. The screen should look like the following:</li>
			</ol>
			<div>
				<div id="_idContainer042" class="IMG---Figure">
					<img src="Images/B17486_03_08.jpg" alt="Figure 3.8 – nslookup, looking for the authoritative server&#13;&#10;" width="497" height="232"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.8 – nslookup, looking for the authoritative server</p>
			<ol>
				<li value="4">Ping the URL that was identified as the SOA to get the IP address (<strong class="source-inline">ns1.hackthissite.org</strong>).</li>
				<li>Once you've <a id="_idIndexMarker280"/>got the IP address, go back into nslookup and change the DNS server you're using with the <strong class="source-inline">server [IP address of SOA]</strong> command. That means that nslookup will use this DNS server to do the resolution.</li>
				<li>Next, change the type to find any address by typing <strong class="source-inline">set type=any</strong>.</li>
				<li>Type <strong class="source-inline">ls -d [target site or hackthissite.org]</strong>.</li>
			</ol>
			<div>
				<div id="_idContainer043" class="IMG---Figure">
					<img src="Images/B17486_03_09.jpg" alt="Figure 3.9 – nslookup, finding any site by type" width="622" height="342"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.9 – nslookup, finding any site by type</p>
			<ol>
				<li value="8">That final step <a id="_idIndexMarker281"/>will execute what is referred to as a <strong class="bold">zone transfer</strong>, which will tell the authoritative DNS server to send us a list of every single computer name or DNS name <a id="_idIndexMarker282"/>linked to an IP address. It shows the MX records and the <strong class="source-inline">A</strong> records. It shows whether there's a <strong class="source-inline">www</strong> or an FTP (maybe it's FTP1 or FTP2). This is a very easy way to pull all the server names out. Again, all we're doing is executing a normal, expected command against their own DNS server. Most secured DNS servers today only allow zone transfers to take place between specific IP addresses or computer names. However, don't think that will totally protect you – I could easily spoof the IP or computer name.</li>
				<li>Let's set the type back to return the mail server information (<strong class="source-inline">set type=mx</strong>). Take a look at the MX preference number. This number represents the order in which the server responds (the lower the number, the higher the priority).</li>
			</ol>
			<div>
				<div id="_idContainer044" class="IMG---Figure">
					<img src="Images/B17486_03_10.jpg" alt="Figure 3.10 – nslookup, looking for mail server information" width="1001" height="475"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.10 – nslookup, looking for mail server information</p>
			<p>In the preceding example, I am looking at MX records for <strong class="source-inline">HackThisSite.org</strong> again. From this results list, we can <a id="_idIndexMarker283"/>see that their primary mail server is <strong class="source-inline">ASPMX.L.GOOGLE.COM</strong>. We can also see that they've got a couple of redundant servers here (the lower priority <strong class="source-inline">GOOGLEMAIL</strong> servers). Often, when you perform a zone transfer, you're <a id="_idIndexMarker284"/>able to see the <strong class="bold">TTL</strong> (<strong class="bold">time to live</strong>). If the TTL is set too long, such as <strong class="source-inline">3600</strong> (which is 1 hour), we could poison their DNS.</p>
			<p>What does it mean to <em class="italic">poison</em> their DNS? It means that I change the IP address (or hostname) to direct you away from legitimate servers and toward fake ones. </p>
			<p>Let me demonstrate with an example. The equivalent in an attack scenario would be to do this to their server to infect their DNS. First, I'll play with a file on my system. </p>
			<p>Let's go into <a id="_idIndexMarker285"/>my Windows directory, <strong class="source-inline">System32\drivers\etc</strong>, and open in <strong class="bold">Windows</strong> <strong class="bold">Notepad</strong> a file in there called <strong class="source-inline">HOSTS</strong>. All computers look at this file (<strong class="source-inline">HOSTS</strong>) before they move on to sending a request to their DNS servers. I'm going to emulate a DNS poison attack using this file (technically, this is a DNS poison attack, but most of the later Windows operating systems set this file as <strong class="source-inline">read only</strong>, so it's only the administrator who can do modifications). I'm going to take the IP address of <strong class="source-inline">yahoo.com</strong> and make it equal to <strong class="source-inline">google.com</strong>. If I saved this file, every time I tried to go to <a href="http://google.com">google.com</a>, my computer would go to this IP address (Yahoo's):</p>
			<div>
				<div id="_idContainer045" class="IMG---Figure">
					<img src="Images/B17486_03_11.jpg" alt="Figure 3.11 – Changing the IP address of Yahoo to Google's" width="928" height="642"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.11 – Changing the IP address of Yahoo to Google's</p>
			<p>The concept of poisoning <a id="_idIndexMarker286"/>a DNS is to redirect any traffic to an alternate IP address (at least for a little while). For example, I would make it so that every time an employee tries to access <strong class="bold">Citibank</strong>, they go to my IP address, where I would have a website very similar to Citibank's that prompts the user to enter their username and password. Then I would forward the user to the real Citibank site after capturing their login information (insert evil laugh).</p>
			<p>All this research will be vital when you're working on a penetration test for an organization. Remember that for each of these sources, you need to look at them from a hacker's perspective – not from the perspective of a normal end user. </p>
			<h2 id="_idParaDest-70"><a id="_idTextAnchor071"/>Netcraft </h2>
			<p>There are <a id="_idIndexMarker287"/>several tools out there that can help you with reconnaissance and footprinting. <strong class="bold">Sam Spade</strong> is one <a id="_idIndexMarker288"/>that's talked about a lot:</p>
			<div>
				<div id="_idContainer046" class="IMG---Figure">
					<img src="Images/B17486_03_12.jpg" alt="Figure 3.12 – Sam Spade" width="1024" height="768"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.12 – Sam Spade</p>
			<p>It's an <a id="_idIndexMarker289"/>application that adds a <strong class="bold">graphical user interface</strong> (<strong class="bold">GUI</strong>) to a lot of the reconnaissance tools we've been talking about thus far. While people use it as a vulnerability scanner to help secure their systems, attackers also frequently use it to find vulnerabilities.</p>
			<p>While Sam Spade is an application that can be traced back to you (by IP), <strong class="bold">Netcraft</strong> is an online tool that looks at public-facing sites and helps to discover external servers. In some cases, it also looks at operating systems and even applications that are running on those servers via a banner grab. This last part is what usually scares people the most when they learn <a id="_idIndexMarker290"/>about NetCraft. Try it out for yourself at <a href="https://www.netcraft.com/">https://www.netcraft.com/</a>.</p>
			<p>A <strong class="bold">banner grab</strong> is simply <a id="_idIndexMarker291"/>identifying a system by looking at what ports are open and how the system responds to a request to said ports. A Windows server responds to a request on port <strong class="source-inline">80</strong> a little differently than a Linux box. Those differences are what help services (and some tools) to identify the target system.</p>
			<p>Netcraft is intended <a id="_idIndexMarker292"/>to secure an environment by exposing any problems or vulnerabilities and then fixing them. As an attacker, this is something I will make use of. Netcraft has a variety of services that are focused on helping you secure your environment, but its primary use for us is in finding out the web server a site is using.</p>
			<div>
				<div id="_idContainer047" class="IMG---Figure">
					<img src="Images/B17486_03_13.jpg" alt="Figure 3.13 – Finding out the web server of a site using Netcraft&#13;&#10;" width="1210" height="452"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.13 – Finding out the web server of a site using Netcraft</p>
			<p>Let's pull up Netcraft and try it on our favorite – <strong class="source-inline">HackThisSite.org</strong>. You can see they give us quite a bit of background information here:</p>
			<div>
				<div id="_idContainer048" class="IMG---Figure">
					<img src="Images/B17486_03_14.jpg" alt="Figure 3.14 – Trying Netcraft on HackThisSite.org&#13;&#10;" width="1640" height="1012"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.14 – Trying Netcraft on HackThisSite.org</p>
			<p>It has extracted <a id="_idIndexMarker293"/>some keywords that they utilize. It's given us the site's IP address, including its IPv6 address and the domain registrar. We can also see the hosting history, which shows us that they are using a load balancer based off FreeBSD, which (if not patched properly) could be a great target. Netcraft also shows us their web tracks and the server-side technologies they're using, such as PHP, SSL, JavaScript, and CSS.</p>
			<div>
				<div id="_idContainer049" class="IMG---Figure">
					<img src="Images/B17486_03_15.jpg" alt="Figure 3.15 – Web tracks shown by Netcraft&#13;&#10;" width="1489" height="850"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.15 – Web tracks shown by Netcraft</p>
			<p>More information <a id="_idIndexMarker294"/>is shown in the following screenshot:</p>
			<div>
				<div id="_idContainer050" class="IMG---Figure">
					<img src="Images/B17486_03_16.jpg" alt="Figure 3.16 – More information" width="1577" height="862"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.16 – More information</p>
			<p>What are they using to see which web browser their users are utilizing to access their website? As you can see, we can learn a lot of information with this tool.</p>
			<p>When I test it with my old site (<strong class="source-inline">utahwisp.com</strong>), it gives us the site's hosting history, including the IP address, web server, and operating system. If you are conducting a penetration test on your organization's infrastructure, this will be quite useful because it's great at pulling up what server and web server service you're using:</p>
			<div>
				<div id="_idContainer051" class="IMG---Figure">
					<img src="Images/B17486_03_17.jpg" alt="Figure 3.17 – Testing utahwisp.com" width="1633" height="840"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.17 – Testing utahwisp.com</p>
			<p>One other nice <a id="_idIndexMarker295"/>thing about Netcraft is that it shows you a <em class="italic">Netcraft risk rating</em>. Zero out of 10 is a great rating for security, but that doesn't mean it's not hackable. Obviously, them revealing this information exposes quite a bit to an attacker. There are a lot of tools created for legitimate purposes, such as Netcraft, that attackers can capitalize on just by shifting their perspective.</p>
			<h1 id="_idParaDest-71"><a id="_idTextAnchor072"/>The Wayback Machine</h1>
			<p>At this point, the <a id="_idIndexMarker296"/>internet has been around for quite some time, and <a id="_idIndexMarker297"/>there are a number of retired web pages and websites. <strong class="bold">The Wayback Machine</strong> (<a href="https://archive.org/web/web.php">https://archive.org/web/web.php</a>) allows us to view previous versions of websites that may not even exist anymore. Think of it as <em class="italic">the</em> archive of the internet. Once we find the older version of our target site, we can scan for <em class="italic">historical data</em> that people didn't mean to expose. Now, before I got my start in security, I had no idea this tool was out there, but it's really interesting to use for fun as well (you know, like showing your kids what <strong class="bold">Amazon</strong> used to look like):</p>
			<div>
				<div id="_idContainer052" class="IMG---Figure">
					<img src="Images/B17486_03_18.jpg" alt="Figure 3.18 – The Wayback Machine home page" width="1194" height="621"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.18 – The Wayback Machine home page</p>
			<p>You can <a id="_idIndexMarker298"/>see here that they have saved over <em class="italic">456 billion</em> web pages. The Wayback Machine goes through websites and detects any changes – if it detects a change, it makes a note and caches that information. As an example, I'll use my old company's website. The site is no longer being maintained, but you can see there was some activity in 2003. There is one snapshot of my site from January 10, 2003:</p>
			<div>
				<div id="_idContainer053" class="IMG---Figure">
					<img src="Images/B17486_03_19.jpg" alt="Figure 3.19 – The Wayback Machine change history of utahwisp.com&#13;&#10;" width="769" height="718"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.19 – The Wayback Machine change history of utahwisp.com</p>
			<p>In the <a id="_idIndexMarker299"/>snapshot, you can see my web development skills. My prowess was considerable. This is back in the days when we used Notepad. I think by then I'd moved up to <strong class="bold">HotDog</strong>, which was one of the first WYSIWYG environments for web design.</p>
			<p>What can we find here that would be useful for our purposes? We can find the purpose and messaging of the organization, where it's located, contact information, such as a cell phone number, and information about the email options available, including a login page. Note that this is just an example – your target will still be operational, so a lot of the infrastructure is probably still in place:</p>
			<div>
				<div id="_idContainer054" class="IMG---Figure">
					<img src="Images/B17486_03_20.jpg" alt="Figure 3.20 – More information from Wayback Machine&#13;&#10;" width="435" height="450"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.20 – More information from Wayback Machine</p>
			<p>When companies <a id="_idIndexMarker300"/>first built their web pages (especially back in the day), they listed all kinds of information. They didn't think it was a security risk. That means, if we go back and look at previous versions of their website, it could expose quite a bit, for example, employee or leadership personal information. There may even be a press release section where they announced that they're moving to <strong class="bold">Microsoft</strong> <strong class="bold">Server 2000</strong> and looking toward moving to <strong class="bold">2008</strong>. Even when people think they've removed historical information from a website, there's always a record of it somewhere.</p>
			<h1 id="_idParaDest-72"><a id="_idTextAnchor073"/>What organizations give away for free </h1>
			<p>When I was about 25 years old, there was a radio station, <em class="italic">The Q</em>, in the city where I lived that <a id="_idIndexMarker301"/>was holding a big contest that included giving away a big prize package. They would hide this big wooden Q every day, which was about a foot by a foot in depth and in height (30 x 30 cm) and about 2 inches (5 cm) thick, and give out clues for where to find it. If you found the Q, you won a prize package that could include a couple of four-wheelers, a trip to Hawaii, TVs, tons of stuff.</p>
			<p>I was tracking the clues that they gave out each day, and I thought I knew where it was, so I looked around for hours in this huge park. After about three or four hours, I gave up. It turned out that I was about 25 feet (8 meters) away from it when I gave up. I still regret that today. It's the same thing here with reconnaissance – you've got to look <em class="italic">everywhere</em>, despite the massive amounts of information that become available to you.</p>
			<p>The more you try to find out about your target, the more you're going to find. Victor Hugo, the famous author of <em class="italic">Les Miserables</em>, once said, "<em class="italic">Perseverance, secret of all triumphs</em>" – this is especially true for reconnaissance. </p>
			<p>In this section, we'll look at what else you can find out about your target. We'll look into the information they're publishing that can be useful for us as ethical hackers. That includes job sites, promotional materials, social media, and email.</p>
			<h2 id="_idParaDest-73"><a id="_idTextAnchor074"/>Job sites</h2>
			<p>Job sites give us so much information. I'm not just talking about standard job sites – we'll also <a id="_idIndexMarker302"/>get information from company-run job sites, including the career pages included on the corporate website.</p>
			<p>When we start looking at a well-known job site, we start searching by job title or technologies. Companies might inadvertently expose the different technologies they're using when they advertise for specific jobs, even if it's for a temporary project. I'll be doing these very specific searches since I'm not actually going to target a company, but you will also want to look at all the job vacancies that your target organization has advertised online.</p>
			<p>Remember that you are not looking at this as a potential employee or the employer. Look at it through the eyes of an attacker.</p>
			<p>I'll use <strong class="bold">Monster</strong> (<a href="https://www.monster.com/">https://www.monster.com/</a>) as an example. Start by looking for some technical <a id="_idIndexMarker303"/>positions, such as <strong class="bold">systems engineer</strong>. In the following example, based on the qualifications they're looking for, we can see that they're using <strong class="bold">Microsoft</strong> <strong class="bold">Active Directory</strong>, <strong class="bold">Windows</strong> <strong class="bold">Server 2008</strong>, <strong class="bold">VMware</strong>, and <strong class="bold">Hyper-V</strong>.</p>
			<p>They're also looking for someone <a id="_idIndexMarker304"/>with knowledge of <strong class="bold">Cisco</strong>, which means we can <a id="_idIndexMarker305"/>infer what kind of routers and switches they're probably <a id="_idIndexMarker306"/>utilizing. They also mention the <strong class="bold">SolarWinds</strong> and <strong class="bold">Spotlight</strong> monitoring tools, so now we know what type of monitoring tools they're using internally. Once you get this information, you'll want to investigate <a id="_idIndexMarker307"/>the architecture of each component and see whether there are any vulnerabilities, or better yet, you might see any security systems that you'll need to avoid.</p>
			<div>
				<div id="_idContainer055" class="IMG---Figure">
					<img src="Images/B17486_03_21.jpg" alt="Figure 3.21 – Job requirement for a systems engineer&#13;&#10;" width="628" height="585"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.21 – Job requirement for a systems engineer</p>
			<p>Let's try searching a different way – by keyword. Find people who are looking for someone who knows something about some outdated servers. Let's go with <strong class="source-inline">server 2003</strong>, for example.</p>
			<div>
				<div id="_idContainer056" class="IMG---Figure">
					<img src="Images/B17486_03_22.jpg" alt="Figure 3.22 – Searching with the &quot;server 2003&quot; keyword on Monster" width="640" height="238"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.22 – Searching with the "server 2003" keyword on Monster</p>
			<p>Once again, we'll <a id="_idIndexMarker308"/>look at a recruiting agency's job posting. They request experience working with <strong class="bold">Microsoft</strong> <strong class="bold">SharePoint 2010</strong> authentication <a id="_idIndexMarker309"/>and permissions models, as well as administering SQL. So, there we have information about the backend. They are also looking for someone with <a id="_idIndexMarker310"/>experience with <strong class="bold">Visual Studio .NET</strong>, and it looks like they have both intranet and internet portals that are being hosted by SharePoint. All these systems are way outdated, and it would surprise you how many organizations out there are still running systems this old. If they weren't, I wouldn't be so busy!</p>
			<div>
				<div id="_idContainer057" class="IMG---Figure">
					<img src="Images/B17486_03_23.jpg" alt="Figure 3.23 – Job requirements of a SharePoint administrator" width="703" height="608"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.23 – Job requirements of a SharePoint administrator</p>
			<p>The same <a id="_idIndexMarker311"/>thing can be done by looking at other <a id="_idIndexMarker312"/>job sites, such as <strong class="bold">DICE</strong> (<a href="https://www.dice.com/">https://www.dice.com/</a>), <strong class="bold">Indeed</strong> (<a href="https://www.indeed.com/">https://www.indeed.com/</a>), and <a id="_idIndexMarker313"/>more. Pay special attention to the jobs that your target advertises, as these will give you valuable insight into the systems they're running and their overall network architecture. You might even get a sense of what security <a id="_idIndexMarker314"/>controls they have in place. For example, what type of <strong class="bold">intrusion detection system</strong> (<strong class="bold">IDS</strong>) do they have installed? </p>
			<p>Can you see now why job sites make me all giddy inside? They can give us a plethora of information, and this makes our job so easy. </p>
			<h2 id="_idParaDest-74"><a id="_idTextAnchor075"/>Marketing and customer support</h2>
			<p>We can <a id="_idIndexMarker315"/>learn so much just by looking at the organization's social networking profile. As demonstrated in the previous section, recruiters and job sites can provide valuable information, such as the platforms or systems the target is using. We can also take note of how they support their users because that can be important for a social engineering attack. For example, I could call a random employee: "<em class="italic">Hey Jim, this is Fred in the IT department. I just reset your account, and I need to make sure that your password is going to work correctly and log you in. What's your password, really quick?</em>"</p>
			<p>If the user support is done via email, I can spoof an email and make it look like it's coming from their IT department. Or better yet, a <strong class="bold">CEO fraud email attack</strong>, where an attacker (after reconning a company) poses as an executive, creates an emergency issue, and requests money from someone in accounting or their assistant to be transferred to a specific account. We can also look at the user surveys the target puts out to <a id="_idIndexMarker316"/>collect feedback, as the questions they ask might give us an insight into their business strategies.</p>
			<p>If we start looking at the products they're promoting, that should also give us some information about their product specifications. To use this in practice, if I notice a particular target uses a given piece of software, I will backtrack and find out all I can about that software.</p>
			<p>In our culture, we are sharing way too much information, both personally and from a business perspective. Social networking environments such as <strong class="bold">Twitter</strong>, <strong class="bold">Facebook</strong>, <strong class="bold">LinkedIn</strong>, and even <strong class="bold">Google+</strong> are now used for marketing and personal purposes. This combination can expose information with very tangible consequences. Hopefully, if you're reading this, you understand that if you post something, you can't take it back, and it doesn't matter if you delete it immediately. We've seen thousands of people lose their jobs because of the things that they've posted online. Likewise, we've also seen a lot of companies lose money because of this.</p>
			<p>Let's look at some of the different methods we can use to mine these social sites for our target's data. Obviously, start by looking around (from an attacker's perspective) and see what you can find. Look at their previous posts. Look at photos being uploaded or posted. Check out employees' personal sites. It's shocking how few people put controls on their websites.</p>
			<h2 id="_idParaDest-75"><a id="_idTextAnchor076"/>Financial and competitive analysis data</h2>
			<p>Businesses often conduct competitive analyses to assess their competitors or to figure out <a id="_idIndexMarker317"/>their market strategy. As attackers, we can use services that are intended for business analysis for somewhat more nefarious purposes.</p>
			<p>There are many sites out there we could use, but I'm going to focus on some of the more popular ones, such as <strong class="bold">Yahoo</strong> <strong class="bold">Finance</strong>, <strong class="bold">Google</strong> <strong class="bold">Finance</strong>, <strong class="bold">CNN</strong>, <strong class="bold">MSNBC</strong>, <strong class="bold">MarketWatch</strong>, <strong class="bold">The Wall Street Transcript</strong>, and more. Several of them provide information such as the market value of a company's shares, the company profile, and its major competitors. All this information may be helpful in future penetration testing, especially for social engineering attacks.</p>
			<p>You can get this information through tools that allow for competitor analysis, or by setting up email alerts for updates to a specific company's profile. For example, if Microsoft posts something about the new <strong class="bold">HoloLens</strong>, or if Google posts something about ending <strong class="bold">Gmail</strong>, you obviously want to be notified about this kind of information. You'll have to register for those services, but it's a good way of monitoring what's going on with the company.</p>
			<p>Competitive analysis <a id="_idIndexMarker318"/>tools allow businesses to discover information about <em class="italic">competitors</em>.</p>
			<p>Attackers utilize these services to find out basic company information, such as when and how it was founded, or its leadership, location, and products. Many of these tools don't just provide analysis of competitors; they might also provide analyses of their products, their customer base, their suppliers, and more. They use the same techniques that we've already gone over to gather that information. They then charge money for it and give you a nice formatted report with patents, trademarks, catalogs, customers, vendor interviews, press releases, annual reports, and more. They basically go out and do all the spying for you, and there's nothing illegal about that.</p>
			<h1 id="_idParaDest-76"><a id="_idTextAnchor077"/>Employees – the weakest link</h1>
			<p>Have you ever <a id="_idIndexMarker319"/>lost something and it ended up being right in front of you? This usually happens with my glasses. I'll be looking everywhere for them and running around the house saying, "<em class="italic">Anybody seen my glasses?</em>" And my wife will turn to me and say, "<em class="italic">They're on top of your head.</em>"</p>
			<p>It's the same concept with different reconnaissance techniques. Some of the data that we gather in the reconnaissance phase is incredibly easy to find. In fact, a lot of the information can be found through online services that we're probably already using:</p>
			<div>
				<div id="_idContainer058" class="IMG---Figure">
					<img src="Images/B17486_03_24.jpg" alt="Figure 3.24 – Online services where information can be gathered&#13;&#10;" width="1256" height="380"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.24 – Online services where information can be gathered</p>
			<p>The employee side is where things get scary. For example, if an employee plays games, that may show <a id="_idIndexMarker320"/>us their interests and hobbies (not that I think that somebody sits at home with a hammer and crushes candy). This information provides us with a good sense of what people are familiar with, which could help us out with passwords in the future.</p>
			<p>To take it to the next level, you can create a fake persona and start interacting with the target. For example, if you're a big fan of a particular gaming console, you could try to get into the forums where they're talking about doing repairs. You could even ask your target a few questions to start and build a relationship. This is a small taste of what <em class="italic">social engineering</em> is – another method for us to gather information.</p>
			<p>What photos are they sharing? From these photos, we could find out some things: who their family members are; where the picture was taken; if they go to that place frequently. Today, smartphones <a id="_idIndexMarker321"/>even tag photos with <strong class="bold">GPS</strong> (<strong class="bold">Global Positioning System</strong>) coordinates, making it much easier to find out where someone is. We can glean even more information from the backgrounds of the photos – this could be their street address, a sports league they're in, or the school their kids attend. I know that's a little family-related, but it can be dangerous. I'm very protective about families and I hope you guys can recognize the problem with posting seemingly harmless information about your kids.</p>
			<p>Employees might post pictures of them at the local bar on the weekends, revealing where they go to hang out with friends. Now, we know where to go to meet people that work for that organization.</p>
			<p>Who are they connected to in their friend list? This could give us some potential additional targets. But more often, it's important for answering security questions. One of the security questions we get all the time when trying to reset a password is, <em class="italic">Who was your childhood best friend?</em> We might be able to figure that out just from interactions on social media. If that doesn't work, we could deploy a minor social engineering attack. For example, if I see that Bruce Wayne is friends with Clark Kent, I could send Bruce Wayne a spoofed email from Clark Kent asking about additional information that I might need for an attack.</p>
			<p>Does the <a id="_idIndexMarker322"/>target often post their location or what they're doing? For example, Bruce Wayne says he's going to Metropolis this week. For us, the attackers, that means he's out of Gotham City, and the banks are wide open for me to rob because he's not there to protect them. Did the target post their phone number on their profile? Do they have strict privacy settings in place?</p>
			<p>Think of security this way: I could be the safest driver in the world, but a drunk driver could still crash into me. Likewise, I can do everything I can to block people from getting to my information, but my best friend might have a profile that's wide open. If we've interacted online, that could expose some additional information about me, like my friends or hometown.</p>
			<h2 id="_idParaDest-77"><a id="_idTextAnchor078"/>Facebook</h2>
			<p>According to <strong class="bold">Tech Crunch</strong>, approximately 2 billion users log in to Facebook every month. That's <a id="_idIndexMarker323"/>around 1.3 billion logins daily:</p>
			<p><a href="https://techcrunch.com/2017/06/27/facebook-2-billion-users/">https://techcrunch.com/2017/06/27/facebook-2-billion-users/</a></p>
			<p>Over 300 million <a id="_idIndexMarker324"/>photos are uploaded daily. And when people go to Facebook, they spend 20 minutes per visit, on average. Facebook is an inextricable part of daily life. This means this site is not only valuable for reconnaissance, but is also useful for the <em class="italic">attack</em> stage. There are as many as 85 million fake profiles.</p>
			<p>Let's look at some of the information we can extrapolate out of a Facebook page – John Wayne's to be precise. I've found his Facebook page, and he's been doing some posting, which is kind of bizarre:</p>
			<div>
				<div id="_idContainer059" class="IMG---Figure">
					<img src="Images/B17486_03_25.jpg" alt="Figure 3.25 – Facebook page of John Wayne&#13;&#10;" width="1047" height="990"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.25 – Facebook page of John Wayne</p>
			<p>People will put all kinds of personal information on their Facebook pages because we're often <a id="_idIndexMarker325"/>unaware that seemingly trivial data can be very revealing in the wrong hands. From these pages, and specifically from John Wayne's page, we know his personal website, when he went on a business trip, what airline he likes, his birthday, his personal achievements, his parents' names, where he's lived, his pets' names, his high school, hobbies, and more. We can find out who his friends are based on who posts comments on his photos. When he's tagged in a photo, we can look at the buildings in the background to see whether we can identify where he is. Is his car in the picture? Can you see a license plate number? He posted a picture of him and his daughter, so now we know her name and roughly when she was born.</p>
			<p>As you can see, people tend to put a lot of information online – even for deceased celebrities. What does that say about their interest in sharing personal data on the internet?</p>
			<h2 id="_idParaDest-78"><a id="_idTextAnchor079"/>LinkedIn</h2>
			<p>LinkedIn, designed <a id="_idIndexMarker326"/>for business relationships, is also a popular social media platform. It has approximately 13 million companies currently listed and a total of 467 million users. Let's go over what we could discover with LinkedIn.</p>
			<p>The key information <a id="_idIndexMarker327"/>you should record in your <strong class="bold">Target Information Profile</strong> (<strong class="bold">TIP</strong>) from LinkedIn is as follows:</p>
			<ul>
				<li>Current and past employment data</li>
				<li>Educational information, certifications, and skills</li>
				<li>Personal interests, contact information, and location</li>
				<li>Notable connections and groups they may be a part of</li>
			</ul>
			<p>For example, you can look at the technical skills listed, see where the target got their education, and investigate that particular program for more details about their abilities. As mentioned before in the <em class="italic">Job sites</em> section, we're able to see what type of platforms the target is used to working with, which may give us a sense of what their current employer is using (if that's what we're going after). Don't ignore the groups that people join – we're often able to see what someone is struggling with because people tend to join groups to help them with specific projects or issues they've encountered.</p>
			<p>We will also be able to gather more information if we are connected to the person. In some cases, people will accept LinkedIn connection requests just to build their professional network. Because this is a professional platform where people don't generally share very personal thoughts, even fewer are concerned about the information they may expose through this site.</p>
			<p>Let me show you an example using my own profile:</p>
			<div>
				<div id="_idContainer060" class="IMG---Figure">
					<img src="Images/B17486_03_26.jpg" alt="Figure 3.26 – A LinkedIn page showing the Experience section&#13;&#10;" width="602" height="812"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.26 – A LinkedIn page showing the Experience section</p>
			<p>In some <a id="_idIndexMarker328"/>cases, you can estimate the network infrastructure of a person's current employer based on their past experiences. As we go through this profile, you can see here that I worked for <em class="italic">My Mentored Learning, Inc</em>. That's my existing company that I use when I go out and teach. We also have <em class="italic">New Horizons</em> out of Salt Lake City. There's <em class="italic">UtahWISP</em> and <em class="italic">Advanced Technical Training</em> (another training center). Look especially at the certifications that I've listed in <em class="italic">Figure 3.27</em>. I'd say right away that this person knows something about Microsoft Servers, Exchange, SharePoint, and Systems Center. In a real-life <a id="_idIndexMarker329"/>scenario, you could infer that I'm also using that experience (and potentially those specific technologies) in my current job.</p>
			<div>
				<div id="_idContainer061" class="IMG---Figure">
					<img src="Images/B17486_03_27.jpg" alt="Figure 3.27 – Licenses &amp; certifications section" width="510" height="835"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.27 – Licenses &amp; certifications section</p>
			<h2 id="_idParaDest-79"><a id="_idTextAnchor080"/>Researching people</h2>
			<p>By now, you <a id="_idIndexMarker330"/>know how employees might provide valuable information for our reconnaissance. That could be because they share too much on social media, their skills, and past employment history, or maybe one of them <em class="italic">is the vulnerability</em> we want to target with a social engineering attack.</p>
			<p>Overall, we are trying to create a profile of each person. Even seemingly innocuous information may be helpful because people often base their passwords on things that they reveal online. Look for information such as job title, hobbies, whether they're involved in any type of charitable work, or anything that may be of interest. We also want to try to collect things <a id="_idIndexMarker331"/>such as phone numbers, home addresses, email addresses, and possibly bank or credit card details.</p>
			<p>To find those things, most people will use third-party products. There are obvious sources, such as personal blogs or social media, but there are also dedicated online search products for <a id="_idIndexMarker332"/>finding this <a id="_idIndexMarker333"/>type of information. These <a id="_idIndexMarker334"/>include sites such as <strong class="bold">PeopleLookup</strong> (<a href="https://www.peoplelookup.com/">https://www.peoplelookup.com/</a>), <strong class="bold">AnyWho</strong> (<a href="https://www.anywho.com/whitepages">https://www.anywho.com/whitepages</a>), and <strong class="bold">CheckPeople</strong> (<a href="https://www.checkpeople.com/">https://www.checkpeople.com/</a>).</p>
			<div>
				<div id="_idContainer062" class="IMG---Figure">
					<img src="Images/B17486_03_28.jpg" alt="Figure 3.28 – Looking up people on PeopleSmart" width="932" height="615"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.28 – Looking up people on PeopleSmart</p>
			<p>I used myself as <a id="_idIndexMarker335"/>an example and searched with <strong class="bold">PeopleSmart</strong>. All I had to do was enter my name and the city of Salt Lake City, Utah, and hit <strong class="bold">Search</strong>. These types of websites search public records, as well as court records, and make them accessible to the average person. It's all already out there, but they've made it easy for us to get a hold of it. Note that most of these are paid services and require a little more information. But even with the free version, I can see my old phone number and address. You <a id="_idIndexMarker336"/>may want to take this to the next level by finding the addresses on <strong class="bold">Google</strong> <strong class="bold">Maps</strong> so you <a id="_idIndexMarker337"/>understand where this person lives. Again, the purpose of this is to give you some hints and details that you will add to your database of information or your TIP.</p>
			<p class="callout-heading">Pro-Tip</p>
			<p class="callout">Many of these search engines, such as Google and Yahoo, will provide notifications on updates. If someone changes something on that website, you could be notified of those updates. Trust me – attackers are already doing that to see when you post a new job. </p>
			<h2 id="_idParaDest-80"><a id="_idTextAnchor081"/>Social engineering </h2>
			<p>I define <em class="italic">hacking</em> as getting <a id="_idIndexMarker338"/>a device to do something outside of what it was <a id="_idIndexMarker339"/>designed to do. That's exactly what social engineering attacks accomplish, or, as I like to call it, <em class="italic">human hacking</em>.</p>
			<p>By default, humans are not designed to give up personal information. We know it's wrong, but we continue exposing information about ourselves because people or services convince us that we should somehow trust them (this is called <em class="italic">gaining the target's confidence</em>).</p>
			<p class="callout-heading">Information</p>
			<p class="callout">A <strong class="bold">McAfee</strong> documentary (<a href="https://www.youtube.com/watch?v=yzU82Ul96pU">https://www.youtube.com/watch?v=yzU82Ul96pU</a>) from a few years <a id="_idIndexMarker340"/>ago perfectly illustrates the power of social engineering. It describes one of the most famous social engineering attacks that targeted a woman based solely on the fact that she visited a genealogy website. A group of people pretended to be related to her and preyed on her emotions (a hallmark of social engineering). They claimed that they were trying to escape a bad situation and needed money to do so. She ended up giving them over $500,000. Ultimately, this was revealed by a gray hat hacker who investigated the extent of the damage by hacking her again to see how the attackers had targeted her (<a href="https://www.youtube.com/watch?v=F9GylhWsVc8">https://www.youtube.com/watch?v=F9GylhWsVc8</a>).</p>
			<p>So, how is this typically done? One of the most basic methods is <strong class="bold">dumpster diving</strong>. Surprisingly, this is <a id="_idIndexMarker341"/>what it sounds like. You can find a lot of information about someone in their trash can. A great example of this was back in the days when Microsoft was under investigation by the US Department of Justice about how they were implementing <strong class="bold">Internet Explorer</strong>. You can read about it at <a href="http://www.newsweek.com/diving-bills-trash-161599">http://www.newsweek.com/diving-bills-trash-161599</a>. <strong class="bold">Sun Microsystems</strong> hired people to go <a id="_idIndexMarker342"/>and dumpster dive at Microsoft's location. Because trash is not considered company property, they pulled out some reports showing some <a id="_idIndexMarker343"/>of Microsoft's questionable behavior.</p>
			<p>We can also <strong class="bold">eavesdrop</strong> on a target. Eavesdropping could include <strong class="bold">physical listening</strong> (like when you listen to the <a id="_idIndexMarker344"/>person in the cubicle next to you), <strong class="bold">digital eavesdropping</strong> (via email, for example), or so-called <strong class="bold">shoulder surfing</strong> (secretly watching what people are doing).</p>
			<p>I try to protect against the latter as much as I can. In fact, my wife thinks I'm crazy because whenever I'm out and about and have to swipe my debit card, before I type in my PIN code, I physically turn around and make sure no one is trying to shoulder surf. There are also digital methods of shoulder surfing – where people use their cell phones to capture images. I'm very suspicious of people who are on their cell phones that are right behind me in a checkout line because, even if they have the phone up to their ear, their camera could be recording my PIN. The same principle can apply to passwords, so be mindful of typing your password into your phone in a public place.</p>
			<p>Eavesdropping can also be dangerous because it may allow people to more convincingly impersonate an employee of an organization that you are legitimately involved with. Perhaps you take a phone call in your local grocery store, and you're complaining about your bank, Citibank. A scammer might hear you and then call you up and say that Citibank has an issue and is calling people up asking them to confirm their identities. In that way, they're using minor details about you to get you to reveal potentially valuable information about yourself or someone you know.</p>
			<h2 id="_idParaDest-81"><a id="_idTextAnchor082"/>You've got mail = I've got you!</h2>
			<p>Another great <a id="_idIndexMarker345"/>tool for gathering intelligence is <em class="italic">email</em>. We can track when an email has been read, if it has been forwarded, the time spent reading it, any links visited, the types of servers being used, the OS the recipient is using, and more. There's a lot of information embedded in emails. </p>
			<p>Let me give you an example:</p>
			<div>
				<div id="_idContainer063" class="IMG---Figure">
					<img src="Images/B17486_03_29.jpg" alt="Figure 3.29 – Information embedded in an email&#13;&#10;" width="1193" height="720"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.29 – Information embedded in an email</p>
			<p>This is an <a id="_idIndexMarker346"/>email header I got from <em class="italic">Thrifty Car Rental</em> – a typical email advertisement about some upcoming car rental stuff. Look at this header information – it's available for every email. Back in the old days when we didn't have Outlook, a lot of this technical information was listed at the beginning of all your emails. Now it's hidden, but you can still expose it by looking at advanced headings (typically).</p>
			<p>From the header alone, we can see who the email was sent to, the date and time that it was sent, the server it came from, the sender's IP address, and even the authentication system being used by the sender. That means if we want to obtain the name of one of Thrifty's email servers, all we have to do is sign up for emails from them.</p>
			<p>There are several tools that we can use to gather information from emails that are completely <a id="_idIndexMarker347"/>invisible to email recipients. <strong class="bold">Email Lookup</strong> (<a href="https://www.ipaddresslocation.org/">https://www.ipaddresslocation.org/</a>) by <strong class="source-inline">IPAddresslocation.org</strong> scans the headers for you. If <a id="_idIndexMarker348"/>you want to track what's going on with a particular piece of email, you can use <strong class="bold">eMailTrackerPro</strong> (<a href="http://www.emailtrackerpro.com/">http://www.emailtrackerpro.com/</a>). It will show you a map of the likely location of the sender and <a id="_idIndexMarker349"/>some WHOIS information. <strong class="bold">PoliteMail</strong> (<a href="https://www.politemail.com/">https://www.politemail.com/</a>) is a tool you can use with Outlook. It creates a map that shows all <a id="_idIndexMarker350"/>the different email servers that a particular email hopped through.</p>
			<p><strong class="bold">DidTheyReadIt</strong> (<a href="http://www.didtheyreadit.com/">http://www.didtheyreadit.com/</a>) is another application or tool that you can <a id="_idIndexMarker351"/>use to find out whether an email recipient read an email or whether they just deleted it right away. <strong class="bold">ReadNotify</strong> (<a href="https://www.readnotify.com/">https://www.readnotify.com/</a>) can tell you when your email is opened, if it was reopened, if the recipient forwarded it to somebody else, and if so, who it was forwarded to. This one also has a nice GUI. </p>
			<p>These kinds of services are especially popular in the sales and marketing sector – they want to know when you've opened a message, clicked a link in it, and even how long you spent reading it. If you're working for a company, the marketing team may already have access to these tools.</p>
			<p>Today, based on reverse lookup, most email servers drop an email if they believe a header has been forged. When an email comes in, the server asks, <em class="italic">What's the name of the email server this came from, and what's the IP address in the header</em>. Then it does a reverse lookup to see whether those are still true statements because most of the time, when someone is forging a header or spoofing the email address, that information won't match up and your email server will drop it. Using these types of tools helps security professionals to see whether their email systems are susceptible to different types of reconnaissance.</p>
			<p>A great example of this is, as I mentioned previously, countless corporations falling victim to CEO fraud emails. Attackers spoofed corporate email accounts and impersonated executives to fool employees in accounting or HR into executing unauthorized wire transfers or sending out confidential tax information, as seen in this article:</p>
			<p><a href="https://krebsonsecurity.com/2016/04/fbi-2-3-billion-lost-to-ceo-email-scams/">https://krebsonsecurity.com/2016/04/fbi-2-3-billion-lost-to-ceo-email-scams/</a></p>
			<h1 id="_idParaDest-82"><a id="_idTextAnchor083"/>Reconnaissance countermeasures</h1>
			<p>One of <a id="_idIndexMarker352"/>my favorite movies is <em class="italic">The Hunt for Red October</em>. When the torpedoes are coming in, Sean Connery yells, "<em class="italic">Release the countermeasures!</em>" And this is exactly what we need to do here. We need to understand the <em class="italic">countermeasures for reconnaissance</em> and what we need to be looking for when performing penetration tests (pen tests). You might know GI Joe's famous quote, "<em class="italic">Knowing is half the battle.</em>" This also applies to us. Knowing what you are exposing and knowing what the attacker is capable of is half the battle. </p>
			<p>In this section, I'll show you how to put your shields up and implement those countermeasures, as well as some best practices for reconnaissance. I'll also show you how to set up for a pen test and the actual workflow of what you should be tracking when doing reconnaissance.</p>
			<h2 id="_idParaDest-83"><a id="_idTextAnchor084"/>Countermeasures</h2>
			<p>So, how do you <a id="_idIndexMarker353"/>defend yourself against the kind of reconnaissance techniques we reviewed earlier?</p>
			<p>The first thing you need to do is make sure you have configured your routers to not respond to certain types of traffic. In other words, ensure they don't identify themselves.</p>
			<p>Here's a fun exercise. What's <a id="_idIndexMarker354"/>the default <strong class="bold">SSID</strong> (<strong class="bold">Service Set Identifier</strong>) on the <strong class="bold">Linksys</strong> router? Oh, that's <a id="_idIndexMarker355"/>right, it's <strong class="source-inline">Linksys</strong>. What I like to do is take that Linksys router and change the SSID to <strong class="bold">D-Link</strong> – because that's <a id="_idIndexMarker356"/>the default broadcast for a D-Link router. That's misdirection. When an attacker comes, they're going to try to launch D-Link attacks at my router and not ones for Linksys. So, please, configure your routers to not give out information they shouldn't be.</p>
			<p>Here are a few tips for protecting yourself:</p>
			<ul>
				<li>Make sure that you use some kind of IDS.</li>
				<li>When you deploy your web servers, don't leave them with the default configurations/settings. </li>
				<li>Get rid of <em class="italic">powered by… </em>because it can give away too much information (you saw that earlier when we went through Google hacking techniques). </li>
				<li>Enforce security policies. That includes training employees to adhere to the policies so they don't respond to someone calling them up and saying, "<em class="italic">Hey, this is Billy Bob down at the IT department, I need to reset your password – can you tell me what it is currently?</em>"</li>
				<li>Implement (and enforce) security policies on servers. Just having them and not enforcing them is like a parent threatening to ground a kid and not following through.</li>
				<li>Do some <a id="_idIndexMarker357"/>reconnaissance on yourself. </li>
				<li>Close unused ports, and if you do have open ports, whitelist them.</li>
				<li>Disable <a id="_idIndexMarker358"/>unnecessary services on web servers. Microsoft has a <strong class="bold">Best Practice Analyzer</strong> (<strong class="bold">BPA</strong>) tool that will go through and tell you what services aren't needed that you have turned on based on the role of that server.</li>
				<li>Prevent search engines from caching. There's a file you can create called a <strong class="source-inline">robot.txt</strong> file. This file tells Google which folders and files not to crawl or index. The only downside to this is that (you're going to laugh at this one) I can use Google to find websites that have <strong class="source-inline">robot.txt</strong> files in them.</li>
				<li>Disable directory listings in order to prevent people from learning the OS or doing directory traversal.</li>
				<li>Configure the internal and external DNS (separately):<ul><li>For example, if your public-facing site is <strong class="source-inline">gotham.com</strong>, make sure your internal DNS environment is not also <strong class="source-inline">gotham.com</strong>.</li></ul></li>
				<li>Restrict input types (such as pipes, commas, and colons). This will be even clearer if you watch videos on SQL injection, as restricting your input types is what's going to save your bacon.</li>
				<li>Avoid cross-linking on your site (linking to other pages within your website). That just helps Google.</li>
				<li>Always remember – humans are the weakest link. In fact, my favorite quote is, "<em class="italic">There is no patch for human stupidity.</em>" There was a report that the IRS started a big push to train all their employees on how to avoid social engineering attacks. Within 30 days, they pen tested them, and 65% of their employees gave up their information. Train your employees and help them set up encryption or stronger passwords. Send out updates through an organizational newsletter if you've got one. It pays off.</li>
			</ul>
			<p>Now, I know that <a id="_idIndexMarker359"/>reconnaissance can be overwhelming as far as remembering what to look for, so I've got a great solution for you. Wander <a id="_idIndexMarker360"/>over to the <strong class="bold">OSINT Framework</strong> (<a href="https://osintframework.com/">https://osintframework.com/</a>). As its name implies (<em class="italic">Open Source Intel</em>), this site will help you cover all your bases during your research by using open source (or publicly available) intel. Plus, it might give you some other ideas of where to find more intel on your target:</p>
			<div>
				<div id="_idContainer064" class="IMG---Figure">
					<img src="Images/B17486_03_30.jpg" alt="Figure 3.30 – OSINT Framework&#13;&#10;" width="982" height="787"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.30 – OSINT Framework</p>
			<p>With that, we have come to the end of this chapter. Congratulations on completing it successfully.</p>
			<h1 id="_idParaDest-84"><a id="_idTextAnchor085"/>Summary</h1>
			<p>Our quest led us to investigate how attackers gather information from their target's website to know the target's exact business functions, important contact information, clients and partners, the management team, and so on. We learned how to use WHOIS, the command-line interface, ping and DNS, and SOA to gather information. We learned about more tools that help with reconnaissance and footprinting, such as Sam Spade, Netcraft, and the Wayback Machine.</p>
			<p>We saw how what the information organizations give away for free can reveal a ton of vulnerabilities. So do job sites, marketing materials, customer support, social networking profiles, and financial and competitive analysis data.</p>
			<p>We also discussed employees as the weakest link. Their hobbies, the things they share or post online, the places they go to after work, what they buy, and more all give attackers the clues they need. We then discussed how attackers use these clues to join the groups their targets frequent, befriend them or their friends on Facebook, connect on LinkedIn, and/or find a way to socially engineer them.</p>
			<p>In the <em class="italic">People search</em> section, we learned how to profile people using third-party products such as PeopleLookUp, Anywho, and CheckPeople.</p>
			<p>Now that we've done some reconnaissance, our next step is to start scanning the networks we've discovered. We'll do this to find live targets and understand the infrastructure of the target organization. Scanning is done via various techniques – some passive, and others active.</p>
			<h1 id="_idParaDest-85"><a id="_idTextAnchor086"/>Questions</h1>
			<p>As we conclude, here is a list of questions for you to test your knowledge regarding this chapter's material. You will find the answers in the <em class="italic">Assessments</em> section of the <em class="italic">Appendix</em>:</p>
			<ol>
				<li value="1">Which information may be gathered using nslookup?<ol><li>A DNS server location</li><li>Hostnames and IP addresses</li><li>WHOIS intel</li><li>A nameserver and operating systems</li></ol></li>
				<li>Which of the following is the most accurate description of footprinting?<ol><li>Investigating a target</li><li>Enumeration of services</li><li>Discovery of services</li><li>Dialogue with people</li></ol></li>
				<li>Which record will disclose details about a domain's mail server?<ol><li>Q</li><li>MS</li><li>MX</li><li>A</li></ol></li>
				<li>What alternative options do you have if you can't collect enough information from a target directly?<ol><li>Social engineering</li><li>EDGAR</li><li>Competitive analysis</li><li>Scanning</li></ol></li>
			</ol>
		</div>
	</div></body></html>