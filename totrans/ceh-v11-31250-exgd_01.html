<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer071">
			<p><a id="_idTextAnchor087"/></p>
			<h1 id="_idParaDest-86"><em class="italic"><a id="_idTextAnchor088"/>Chapter 4</em>: Scanning Networks</h1>
			<p>As an ethical hacker, or possibly the attacker ourselves, we've gone through and completed some of the first steps of attacking networks and systems. The first step we did was our reconnaissance in the previous chapter. If you're not familiar with that phrase, or what those steps involve, you need to go back to that chapter. Reconnaissance gave us a perfect view of the network. Now, it's time to get specific. In this chapter, we're going to get a little more active and involved.</p>
			<p>In the initial stages of looking at our target, we did our footprinting and reconnaissance. Now, it's time to scan. This chapter will ensure you understand what you're doing and what scanning is.</p>
			<p>You may be thinking, <em class="italic">Wait, I thought we achieved everything we needed to achieve during the reconnaissance stage!</em> Well, we didn't get as much information as we needed. And that's the whole goal here. Again, if the attacker can find out as much information as they can before they go after the system, it makes their time getting into the system a breeze, and there's a good chance they won't get caught.</p>
			<p>In this chapter, we'll discuss the different techniques for scanning. We'll also look at some common scanning tools. However, we don't necessarily focus on the tools since there's going to be even more tools out there in no time. The goal here is to understand the concepts of what these tools can do. So, let's jump in.</p>
			<p>We will cover the following topics in this chapter:</p>
			<ul>
				<li>Grasping scanning</li>
				<li>Understanding the three-way handshake</li>
				<li>Checking for live systems and their ports</li>
				<li>Scanning by thinking outside the box</li>
				<li>Banner grabbing and OS fingerprinting</li>
				<li>Vulnerability scanning and drawing out the network</li>
				<li>Preparing proxies and other anonymizing techniques</li>
			</ul>
			<h1 id="_idParaDest-87"><a id="_idTextAnchor089"/>Grasping scanning</h1>
			<p>In this section, we will <a id="_idIndexMarker361"/>discuss the various types of scanning techniques and the goals, techniques, and tools that are used for scanning.</p>
			<h2 id="_idParaDest-88"><a id="_idTextAnchor090"/>Types of scanning</h2>
			<p>So, what are <a id="_idIndexMarker362"/>the different types of scans an attacker can use? To start, let's categorize these into three different sections. We'll discuss network scans, port scans, and vulnerability scans.</p>
			<h3>Network scans</h3>
			<p>During a network scan, the attacker simply puts a packet out onto the network to look at every <a id="_idIndexMarker363"/>device on the network and goes through them, trying to identify them. During this process, it provides us with information to help us to <a id="_idIndexMarker364"/>see which hosts are currently live. This can be done with something as simple as a ping. Unfortunately, using a ping won't give us much besides revealing if the system is up or not. We'll also be able to see what type of operating system is running on those devices. This is not just about revealing what's on the operating system for a desktop or a server, but what operating systems are currently running on the router, on a switch, or a printer.</p>
			<p>We'll also want to go through and be sure we pick up all the IP addresses. We know we have a range from the reconnaissance side, but we want to make sure we go through and look at individual IP addresses and see if we can group them in a specific order.</p>
			<p>Now, what I mean by this is that, as an attacker, I might be able to go through and see you're using an IP address of <strong class="source-inline">192.168</strong>, the first 10 IP addresses for servers, and maybe <strong class="source-inline">250</strong> through <strong class="source-inline">255</strong> for printers, or network services. This information will help me when I see a node. I can go through and say, <em class="italic">Oh wow, that particular server happens to have this IP address. I wonder if the server sitting next to it has the next IP</em>. So, this helps me go through and figure out more. If you want to think of it as adding more to your reconnaissance steps, then do.</p>
			<h3>Port scans</h3>
			<p>Now, as we <a id="_idIndexMarker365"/>hit those <a id="_idIndexMarker366"/>machines, what we want to do is discover what a port is. Typically, a port is an IP address with an attached protocol. Let's take an IP address of, for example, <strong class="source-inline">192. 168. 0. 15</strong>. We know that this is the IP address or target address, but when we add to it a protocol, such as HTTP, it becomes a port. If you want to look at it differently, here's what it would look like from a port perspective: you have the IP address followed by <strong class="source-inline">80</strong>. Port <strong class="source-inline">80</strong> is a very typical port that's associated with an IP address that displays web pages. Sometimes, you might see <strong class="source-inline">443</strong>. That's a secure port on that device.</p>
			<p>There are <a id="_idIndexMarker367"/>more than 65,535 ports out there that we can run on each machine. As we do the port scan, we want to see which ones are open and which <a id="_idIndexMarker368"/>ones are closed. We normally focus on the first 1,023 ports. We must go through and see which ones are responding and correlate that with what services use those ports, which will give us an exact footprint (an exact representation of that machine). No, you don't need to go through and memorize all 1,023 ports. Just know that there are some very common ones. We already mentioned port <strong class="source-inline">80</strong> and port <strong class="source-inline">443</strong>. We also have port <strong class="source-inline">25</strong> for email, port <strong class="source-inline">53</strong> for DNS, ports <strong class="source-inline">20</strong> and <strong class="source-inline">21</strong> for FTP, and so on. We want to scan and see which of those ports are open. In some cases, ports are specific to certain services.</p>
			<h3>Vulnerability scans</h3>
			<p>As IT professionals, we do this to identify what possible threats there are to operating systems and/or applications that have been installed in the environment. You'll also want to <a id="_idIndexMarker369"/>make sure you can identify the vulnerabilities of the OSes and <a id="_idIndexMarker370"/>their applications. In some cases, we can install a Service Pack or do an update of some sort, and this will create new vulnerabilities. This should be something every IT person does almost monthly, or at least any time there's any type of update. Why? Because an attacker will do this same type of vulnerability scan – we'll look at some vulnerability scanning software later.</p>
			<p>As we mentioned earlier, most of the software we see and think, <em class="italic">Oh, it's designed for good!</em> is anything but. Think of what an attacker can do with a particular piece of software. If an attacker can make it into your network, they'll want to do a vulnerability scan to see which systems can be compromised.</p>
			<h2 id="_idParaDest-89"><a id="_idTextAnchor091"/>What's the goal?</h2>
			<p>Scanning can <a id="_idIndexMarker371"/>have a couple of different objectives. We've talked about some of these already, but I want to make sure you grasp this, especially for your immediate future – that is, if you plan on taking the Ethical Hacking exam!</p>
			<p>The first objective is to identify live hosts. More importantly, I want to know when a host comes online. Again, if you're going to introduce a new idea system, I want to be aware, so I know I've got to be a little trickier and sneakier with you. I also want to go through and make sure I gather all the IP addresses. If an IP address changes, I want to be notified. Networks are consistently evolving and we're always changing up our IP addresses. Now, we may not be changing them from the server's perspective, but trust me – desktops are always changing IP addresses. If I've compromised a particular box and its IP addresses change, I want to be able to track that somehow. Scanning is going to help me with that.</p>
			<p>Again, once I've got the IP address, the next thing I want to do is ensure I know which ports are still <a id="_idIndexMarker372"/>open and which ones are closed. This can expose information such as the operating system or even the architecture. Again, I'm going to make a notation of the results I get from my scans.</p>
			<p>As I've mentioned previously, certain Windows boxes respond in a specific way to an open or closed port that's different than a Linux box or a UNIX box. So, looking at how it responds to us can help us identify our architecture as well. Most of those functions are built into the scanning software you'll see demonstrated later. I'll also go through and check for vulnerabilities and threats. Again, if I can identify the target, its OS, and the services that are running on it – <em class="italic">Hey, it's an Apache server! What version of Apache? Version 2. 6</em> – I want to go off and find out what vulnerabilities existed for that version of Apache.</p>
			<p>I'm typically talking about web servers because they get attacked quite a bit, but there are vulnerabilities for specific machines – one that's running Adobe Acrobat Reader, another for iTunes, and so on. I'm going to try to compromise a box, if not multiple boxes, within your environment. It doesn't have to be a server – again, my main target may not be the server, it could just be your desktop systems. I'm also going to go through and look at the security risks and services running on those machines.</p>
			<p>From the attacker's perspective, the security risk is going to involve thinking, <em class="italic">What is my risk of exposure when I attack this machine?</em> It's easy to think it's just the Windows boxes that always get attacked because they're easy to attack, but guess what? I can attack a Mac or even a Linux box – nothing is foolproof. Of course, some may be more difficult than others to go after, and some will end up exposing me.</p>
			<p>Scanning can be extremely <em class="italic">noisy</em> or <em class="italic">chatty</em> on the network, depending on the type of scanning you're doing. So, I'm going to make sure my security risks are low. I'm going to do some scans that could be very stealthy.</p>
			<p>I'll also go through and look at the services that are running – all kinds of services. Is SNMP running? Is NNTP for time running on that box? Are the file and print services running on <a id="_idIndexMarker373"/>a particular box? Again, what applications (server-based applications)? Is it an exchange box? Is it a SharePoint box? Is it a SQL box? What services are running that could give me some type of access to this system as a whole?</p>
			<h2 id="_idParaDest-90"><a id="_idTextAnchor092"/>What techniques are used?</h2>
			<p>There are different techniques for scanning different technologies. Some of the different <a id="_idIndexMarker374"/>techniques we use will include techniques for either internal or external networks. Typically, these are almost the same type of technique. Because of those pieces of software or scans that we do, they don't care if they're internal or external; it's just a different way of looking at it – if I'm attacking a public IP address range versus an internal IP address range.</p>
			<p>We'll also have a different technique for not just looking at computers – I want to be looking for printers, switches, routers, and any other devices on your network. I mean, nothing is more fun than compromising one of the network devices you have no idea someone is monitoring – your printer's OS, the OS on the switch, or the OS on the router. If I can compromise and issue my commands to my zombies on your network via one of these devices, it will be extremely hard to track because nobody ever suspects them.</p>
			<p>Another technique is Wi-Fi, which is such an open book force. As we take more and more advantage of wireless technology, I can just jump into the network. If I am visiting a location and I can hit the Wi-Fi, I'm good to go. Well, guess what? There are some specific techniques I can use on a Wi-Fi network that are different than what I would use on an internal or external network to do my scans.</p>
			<p>If I'm able to hit a server, one of the first things I'm going to do is banner grabbing. This is a very interesting technique known as operating system fingerprinting, or OS fingerprinting. Banner grabbing will help me take advantage of the way servers respond to identify themselves – a Windows box, a Linux box, and so on.</p>
			<p>What you saw in our previous course on reconnaissance was that when we used Netcraft, this entailed using banner grabbing techniques to identify those public-facing servers. We can do that internally to identify the different targets on the network.</p>
			<h2 id="_idParaDest-91"><a id="_idTextAnchor093"/>Tools used for scanning</h2>
			<p>So, what tools are used for scanning? Well, where do you want to start? I could use a standard command <a id="_idIndexMarker375"/>line to do a ping to see if there is an active or a live host or node on the network. I can also go through and use Nmap, which is probably one of the more popular scanning tools out there. It's more than just a scanning tool. We can also use an angry IP scanner, a nifty little tool that I used when I had my wireless ISP service. We assigned IP addresses to each of the antennas we'd put on our customers' homes.</p>
			<p>Initially, we went through and had them all organized, saying, <em class="italic">Here is this antenna and it has an IP address of 1, and here's the next one, which has an IP address of 2</em>. This works perfectly until you have an antenna go out. In that situation, you'd have to go through and change the IP address. We would quickly jump onto the wireless network, do a quick angry IP scan, and see which IP address we could utilize next because a host or IP address wasn't live, meaning it was usable. Interestingly, most antivirus products pick up angry IP scanners as malicious software, yet they're just ping sweepers.</p>
			<p>Luckily, SolarWinds have a plethora of utilities, especially the engineering set, which you can utilize. Some of the things it scans include Ethernet and Bluetooth. They've got all kinds of tools –and not just scanning tools – their solution is amazing. We also have Colasoft ping, Ping Scanner Pro, and Visual Ping Tester, which, after it pings, helps map out the network. There are a ton out there. You may have a favorite, but there are a couple of them you may want to pay attention to. I will not tell you which ones they are, because I shouldn't as an ethical hacker, but some are going to be focused on your immediate future if you plan on taking the Ethical Hacking exam.</p>
			<h1 id="_idParaDest-92"><a id="_idTextAnchor094"/>Understanding the three-way handshake</h1>
			<p>Let's talk about <a id="_idIndexMarker376"/>how polite computers are when it comes to communicating with each other, shall we? So, part of the scanning concept is understanding what they refer to as the three-way handshake. Again, it's very polite.</p>
			<p>Mike O'Cain, who is an American football coach and former player, once said <em class="italic">I don't remember who came up with the handshake idea, but it was a great one</em>.</p>
			<p>This is true because there are some advantages when it comes to the three-way handshake and computers.</p>
			<p>To understand the three-way handshake, you must get your geek on. You need to understand what's going on in the background. To cover this in a way that makes sense, we'll look at TCP and UDP communications. We'll also look at the different flags that a TCP header has. After that, we'll look at the extremely normal three-way handshake and ensure you understand the communication that goes on between computers as they're about to <em class="italic">talk to each other</em>. I'll whip out some Wireshark for you, and we'll discuss how it takes place.</p>
			<p>We'll start <a id="_idIndexMarker377"/>by looking at some what-ifs… what if something else happens differently than what the computer is expecting? Get your pocket protector ready, whip out your pin, and let's get learning.</p>
			<h2 id="_idParaDest-93"><a id="_idTextAnchor095"/>TCP and UDP communications</h2>
			<p>When <a id="_idIndexMarker378"/>computers want to talk to each other, they <a id="_idIndexMarker379"/>need to set up ways of communicating. There are two different ways computers can do this to make the initial connection: TCP and UDP.</p>
			<h3>TCP communications </h3>
			<p>TCP has a <a id="_idIndexMarker380"/>huge advantage over UDP because when one computer talks to another via TCP, it tries to negotiate a connection between the two computers. Again, this is very polite – <em class="italic">Hello, I would like to communicate with you, is that all right?</em> – as they communicate with each other and send data back and forth. Another advantage of TCP is that it has what's referred to as delivery acknowledgments. <em class="italic">Thank you, sir! I did receive that packet, you may continue</em>. It's very similar to when UPS delivers a package to you – you sign for it. Again, you're acknowledging you received that packet or package. It also has a little fault tolerance built into it because of error detection, which means it can retransmit packets it sees did not get delivered. <em class="italic">Oh, I see you didn't get that! Well, let me send it to you again. Once you get it, please send me back a delivery acknowledgment</em>.</p>
			<p>As the packets get delivered to the destination, it does what's referred to as in-order delivery. If we need to send over five boxes via UPS, we can mark them as boxes 1 of 5, 2 of 5, 3 of 5, 4 of 5, and 5 of 5 for easy identification. The same helps a computer reassemble data as it's received. TCP also goes through and does congestion control. If it sees that too many packets are coming to it, it'll try to slow things down.</p>
			<p>If there is a downside to TCP, it's that TCP is slower than UDP because of all this retransmission, in-order delivery, congestion control, and delivery acknowledgments going back and forth all the time.</p>
			<p>The other reason it's a little slower is because of the header size. It's about <strong class="source-inline">20</strong> bytes. In UDP, it's around <strong class="source-inline">8</strong> bytes; a little smaller. Besides having bigger headers, it also has a bigger overhead. Some of the fields that are required by TCP when it's communicated are sequence number fields in the packet. There's also an acknowledgment number, data offset, a reserved field, a checksum field, a source port, a destination port, and about 12 different fields compared to UDP, which only has four.</p>
			<p>TCP is also <a id="_idIndexMarker381"/>stream-oriented, which means data is read as a byte stream, whereas in UDP, the packets are just sent individually and are only checked for integrity if they arrive. Part of that is handled by data flow control. So, TCP does flow control, which, again – remember our three-way handshake – requires three packets to set up a socket connection before the user data can be sent, so TCP handles reliable transmissions.</p>
			<p>Again, as we mentioned previously, it has all these features. Some of the applications we see use TCP include Simple Message Transfer Protocol, File Transfer Protocol, Telnet, Hypertext Transfer Protocol, and even HTTPS.</p>
			<h3>UDP communications</h3>
			<p>The evil <a id="_idIndexMarker382"/>twin of TCP is called UDP. Now, it's not that we hate it, UDP just has some differences. For example, UDP is connectionless-based, which means that when two computers want to send data and they're going to do it via UDP, <em class="italic">I'm just going to send you the data, I don't care if you get it or not</em>, is how they communicate. </p>
			<p>A great example of seeing this is if you like streaming music. Sometimes, while streaming music, suddenly, the music will stop and then kick up again. That's because it's UDP and unlike TCP, there's no guaranteed delivery. Another analogy you could use is TCP is FedEx, where they guarantee overnight delivery, and UDP is the ordinary US mail system, not priority mail – you just put the letter in there and hope for the best.</p>
			<p>It also uses smaller packets. At just 8 bytes, it's extremely small.</p>
			<p>Again, part of this is because the header itself only has a source port, a destination port, and a checksum value associated with it. When data is transmitted, only one packet goes across at a time, and with UDP, there is no guarantee that the packet is going to hit the destination. It's extremely fast, though, and because of that, there is no error checking involved. With TCP, we were very polite; <em class="italic">Did you get it? Was it correct?</em></p>
			<p>With UDP, packets are also delivered out of sequence. When the packets are sent, they're sent individually. They're only checked for integrity if they arrive because we don't have that in-order delivery mechanism that TCP has. Again, the packets arrive out of order. Packet 5 may arrive before packet 4. So, there's no form of ordering messages or tracking connections.</p>
			<p>One of UDP's biggest advantages over TCP is that UDP is extremely fast. There's no congestion control either, which is a possible advantage. I only look at it as a disadvantage <a id="_idIndexMarker383"/>because if the network gets saturated, there's no way of stopping the packet from going across or the network adjusting on the fly, yet with TCP, we have flow control. Technically, UDP is message-oriented, meaning it's a protocol we use in message transport or transfers. However, because it's not connection-based, this means that one program can send a ton of packets to another and that it would be the end of the relationship.</p>
			<p>Some of the applications that are used by UDP include DNS, DHCP, TFTP, and SNMP. VoIP utilizes it too. All types of video conferencing tools, such as Skype, use UDP. I'm sure you've been in a video conference where, suddenly, the video stream locked up and looked as if the participants were in an old 1930s movie that was choppy. This happens because some of the packets are missing or there was no guaranteed delivery, but it eventually catches up.</p>
			<p>Now that I have described and explained how computers talk to each other and love each other, we will discuss how TCP sets up that three-way handshake.</p>
			<h3>TCP header flags</h3>
			<p>TCP uses <a id="_idIndexMarker384"/>what we refer to as flags to represent different types of communications and connections we'd like to establish. For example, one of the flags you might see is SYN, which is short for synchronization. The synchronization flag includes a sequence number. Now, sequence numbers themselves don't increase sequentially; they are linked to the source machine and the destination machine.</p>
			<p>Technically, the numbers are randomized when they're created, and they're based on the payload. That number can be anywhere from zero to over four billion. Most sniffing products out there, such as Wireshark, will display the relative sequence and acknowledgment numbers in place of the actual numbers, which makes it a little easier for us to see.</p>
			<p>Another type of flag we might see is ACK, short for acknowledgment, which simply means that I got your request, where you stated that you'd like to do something. We also have FIN, short for finish, meaning jobs done.</p>
			<p>The other flags we might see are PSH, which means I need to push data to you. There's also URG – short for urgent – <em class="italic">Excuse me, I need to send this packet to you immediately, please</em>. Finally, there's RST, which is just saying: <em class="italic">I need to reset the connection</em> (<em class="italic">Figures 4.1</em> and <em class="italic">4.2</em>).</p>
			<p>Now that <a id="_idIndexMarker385"/>we know about the different flags TCP uses to create, establish, and leave connections with other computers, let's look at them in a normal three-way handshake:</p>
			<div>
				<div id="_idContainer066" class="IMG---Figure">
					<img src="Images/B17486_04_001.jpg" alt="Figure 4.1 – Two-way handshake diagram&#13;&#10;" width="1427" height="629"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.1 – Two-way handshake diagram</p>
			<p>Let's say we've got two computers (<em class="italic">Figure 4.1</em>). The source computer on the left needs to set up a connection with the destination computer on the right. It does this by sending a SYN with a sequence number. <em class="italic">My sequence number is 101</em>. The destination computer sends back and responds to a SYN, with a SYN/ACK. <em class="italic">I got your acknowledgment and your sequence, so your next sequence number will be 102, and here is my SYN or my sequence, which is 508</em>. The source computer responds with an ACK saying, <em class="italic">You're right, my sequence number was 102 and your next sequence number will be 509</em>. See how the sequence numbers synced? This is done to help you identify that we have established a communication channel between the two systems:</p>
			<div>
				<div id="_idContainer067" class="IMG---Figure">
					<img src="Images/B17486_04_002.jpg" alt="Figure 4.2 – Three-way handshake after transfer" width="1620" height="604"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.2 – Three-way handshake after transfer</p>
			<p>Now, when <a id="_idIndexMarker386"/>the source computer has finished transferring the information (<em class="italic">Figure 4.2</em>), it starts with a FIN – <em class="italic">I'm finished. I'd like to stop now. This relationship just isn't working out</em>. The source computer responds with <em class="italic">Okay, I acknowledge that; I'm going to tell the application to stop SYN information, and when it's done, I'm done</em>. In response, the source computer sends, <em class="italic">Oh, hey, it was nice talking to you. I'll call you sometime. Maybe we could do this again!</em></p>
			<h1 id="_idParaDest-94"><a id="_idTextAnchor096"/>Checking for live systems and their ports</h1>
			<p>Scanning for <a id="_idIndexMarker387"/>live systems can be very loud or noisy on the network, but if <a id="_idIndexMarker388"/>you can do it strategically, the target might never see we're going through their network looking for targets.</p>
			<p>Now, let's look at different ways to check for live systems.</p>
			<h2 id="_idParaDest-95"><a id="_idTextAnchor097"/>ICMP sweep/ping sweep </h2>
			<p>This is the most common way to check for live systems. Like a sonar ping in a submarine, we ping <a id="_idIndexMarker389"/>and hope we get a return, which tells us how far away <a id="_idIndexMarker390"/>the target is or where the target is located. A standard ping uses the ICMP protocol, which is not only well known but also very noisy on the network – so much so that most IT professionals will block ICMP traffic as a deterrent.</p>
			<h2 id="_idParaDest-96"><a id="_idTextAnchor098"/>Port scanning </h2>
			<p>Just because <a id="_idIndexMarker391"/>a machine does not respond to a ping sweep or <a id="_idIndexMarker392"/>an ICMP sweep doesn't mean it's not there. So, we can perform port scans in various ways and specify IP addresses. We can still try to check if it responds. We'll show you how to do that next. So, let's get pinging!</p>
			<h3>Nmap</h3>
			<p>Now, in your <a id="_idIndexMarker393"/>immediate future (my way of saying in the exam), you <a id="_idIndexMarker394"/>will need to know the syntax for some Nmap commands. There are many, but I'll highlight the most important ones as we move along. When we get into some of the additional scans that we can accomplish with Nmap, I'll ensure that you see all the different options:</p>
			<div>
				<div id="_idContainer068" class="IMG---Figure">
					<img src="Images/B17486_04_Table_01.jpg" alt="" width="1566" height="1742"/>
				</div>
			</div>
			<p>Next, let's look at the hping tool.</p>
			<h3>hping3</h3>
			<p>I know <a id="_idIndexMarker395"/>what you're thinking: <em class="italic">That's cool, but what happens if a machine doesn't respond to an ICMP request or a ping sweep?</em> Oh, young Padawan, follow me now.</p>
			<p>First, you <a id="_idIndexMarker396"/>need to understand that tools such as hping3 can craft packets to work around security measures. </p>
			<p>Packet crafting is the process of adding customized data payloads to application layer protocol packets. A customized data payload refers to any arbitrary content that cannot be identified as part of the protocol. </p>
			<p>Installed by default on Kali Linux is a nifty tool that's called hping3. Using hping3, I can utilize TCP, UDP, ICMP, and even RAW protocols. The hping3 utility is a network packet generator and analyzer that can be run from the command line. hping3 can be used for TCP/IP and security testing, such as port scanning, firewall rule testing, and network performance testing, thanks to its ability to create bespoke network packets.</p>
			<p>hping3 switches can cause the tool to scan in the following ways: </p>
			<ul>
				<li>-0 (Raw IP mode)</li>
				<li>-1 (ICMP mode)</li>
				<li>-2 (UDP mode)</li>
				<li>-8 (Scan mode)</li>
				<li>-9 (Listen mode)</li>
			</ul>
			<h2 id="_idParaDest-97"><a id="_idTextAnchor099"/>What's firewalking?</h2>
			<p>The concept behind firewalking is that we can try to determine what layer 4 protocols an IP address, such as <a id="_idIndexMarker397"/>a router, will pass by. Even though we can't ping it, it may allow port <strong class="source-inline">80</strong> through.</p>
			<p>Firewalking is <a id="_idIndexMarker398"/>designed to help us get around IDS systems, firewalls, and routers. It's very similar to traceroute, but instead, it tries to determine if a particular packet via a port can pass from the attacker's system to your target through the packet filtering device.</p>
			<p>We use firewalking to help define the firewall's access control list or determine what's allowed to pass through. The firewall may not be allowing other ports to pass through, but maybe it allows port 80 to pass through – which it does by using <strong class="bold">time to live</strong> (<strong class="bold">TTL</strong>). Now, what I mean <a id="_idIndexMarker399"/>by that is that traceroute – a networking utility that allows you to see the routers a packet passes through to get to its destination – gets a list of the IP addresses of each of the routers along the way. To determine this information, traceroute uses a TTL.</p>
			<p>A TTL is implemented with an IP to prevent packets from looping indefinitely on your network. Now, as each device receives a packet, the TTL counter decreases by one. If the counter is <a id="_idIndexMarker400"/>less than or equal to 0, then the packet is dropped, and you get an ICMP <a id="_idIndexMarker401"/>error message that says that the TTL exceeded in transit. Now, this error message will typically hold the IP address of the router that dropped the packet as the originator. So, what happens to the packet when you're firewalking? It gets forwarded if the port is open and gets dropped off if the port is closed.</p>
			<p>Let's say that we have two systems, and as we do a simple ping, our packets get passed from one router to the next and then to their eventual destination. We may not see all the different routers or hops that it passes through on a ping command, but if I do a traceroute, I'll go through and start to see the IP addresses, but then I'll start seeing packets being dropped off.</p>
			<h2 id="_idParaDest-98"><a id="_idTextAnchor100"/>Mobile apps that help</h2>
			<p>We often talk about tools we can use on our laptops, but because mobile devices are becoming <a id="_idIndexMarker402"/>so influential in our lives, there's a ton of apps out there that can help us as far as network discovery is concerned. If you open your app <a id="_idIndexMarker403"/>store and type in network scanning, scanner, or network scan, you will see a plethora of different utilities.</p>
			<p>One I use quite a bit is Fing. Fing is designed to keep track of all the different devices that are currently on your network. It provides cool tools, including showing the current location. It has vulnerability tests built into it and Wi-Fi intrusion protection. You can also check your internet speed and look at your Wi-Fi's performance. Additionally, you can go through and set up different people and assign devices to them.</p>
			<p>It's also great at finding devices. It found my TP-Link switch (<em class="italic">Figure 4.3</em>), it can get my MAC address, it shows me my vendor, and I can also go through and have it notify me when it changes status, which is kind of interesting:</p>
			<div>
				<div id="_idContainer069" class="IMG---Figure">
					<img src="Images/B17486_04_003.jpg" alt="Figure 4.3 – Finding devices using Fing&#13;&#10;" width="1174" height="663"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.3 – Finding devices using Fing</p>
			<p>You can <a id="_idIndexMarker404"/>also go through and block a device. I have most of mine set up so <a id="_idIndexMarker405"/>that if a device hits my network by default, it gets blocked.</p>
			<p>There are other products out there as well – both on Android devices and iOS devices.</p>
			<h1 id="_idParaDest-99"><a id="_idTextAnchor101"/>Scanning by thinking outside the box</h1>
			<p>So, when we scan a network, we <a id="_idIndexMarker406"/>have some tricks that can be used to get a system to respond without being detected. Now, the normal three-way handshake we know about involves a SYN followed by a SYN/ACK and then an ACK. What if we change up the order of the handshake and craft packets so that we send a SYN/ACK first? Or a FIN? Using these types of methods, we can pick up targets on the network that normally wouldn't respond to an ICMP scan. Let's talk about some of these scans.</p>
			<h2 id="_idParaDest-100"><a id="_idTextAnchor102"/>Full scans</h2>
			<p>A full scan is simply the same process that we talked about previously – the three-way handshake. It's just <a id="_idIndexMarker407"/>that here, while a computer is talking to another, an <a id="_idIndexMarker408"/>attacker is going after a target. What they'll do is send a standard SYN. Attached to that SYN, we'll have a port number.</p>
			<p>As you may remember from the three-way handshake, it'll simply respond with a SYN/ACK. And now that we've seen the acknowledgment, we can finish that off by just doing an ACK and then a reset, which means that, okay, I didn't want to talk to you. Now, if it responds this way again, using a full three-way handshake, we know that the port is, at that point, open. Contrary to that, if we have the same environment and we send a SYN and we get a reset option, then we know that the port is closed.</p>
			<p>The disadvantage of a full scan is it's very noisy. Most IDS systems will pick this up and it'll be logged somewhere. But you can use it as a last resort, especially if you're a hacktivist and/or you're being hit by a hacktivist. They don't care if they're getting caught, or maybe they're just taking it on the assumption that you won't be looking heavily at your logs.</p>
			<h2 id="_idParaDest-101"><a id="_idTextAnchor103"/>Half-open scan</h2>
			<p>A half-open <a id="_idIndexMarker409"/>scan is also known as a stealth scan. Now, remember how the three-way handshake worked? What if we modified this a bit? Let's say that we have the <a id="_idIndexMarker410"/>target and the attacker, and normally we send a SYN, right? Well, if we send a SYN, its normal response is to send a SYN/ACK. Remember what the third step of the three-way handshake was? It was to do an ACK that I got your acknowledgment and your SYNC? Well, what if I set an RST instead? By sending an RST, the scan partially opens a connection but stops halfway through. Now, because it stops without having done a full connection, it stops the service of ever notifying it of an incoming connection, so, it typically doesn't get recorded anywhere. Now, if I get the SYN/ACK from my target, I know that the port is open. If I do the same thing, where I send a SYN and it responds with an RST, well, guess what – the port's closed.</p>
			<h2 id="_idParaDest-102"><a id="_idTextAnchor104"/>Xmas scans</h2>
			<p>A Xmas tree <a id="_idIndexMarker411"/>scan uses <a id="_idIndexMarker412"/>a technique that uses our ACK, RST, SYN, URG, PSH, and FIN flags to see if a particular port is open. Unfortunately, these flags only work against systems that are compliant with what is referred to as RFC 793, which means this does not work on Windows boxes because Microsoft followed their own RFC when it came to TCP/IP, so they left some of their stuff out.</p>
			<p>So, how does <a id="_idIndexMarker413"/>a Xmas tree scan work? Well, we have our attacker and our target, and the <a id="_idIndexMarker414"/>first thing that we're going to send is a combination of a FIN, an URG, and a PUSH.</p>
			<p>In response, the target machine is going to come back with nothing. If it comes back with nothing, that's because I said, <em class="italic">I'm finished</em>, and the computer goes, <em class="italic">finished</em>? We didn't even start talking, dude! So, if it comes back with nothing, then we know the port is open. Now, if I go through the same environment and I do the same FIN, URG, and PUSH and I get an RST, you guessed it – it means that the port is closed.</p>
			<p>So, as far as your immediate future is concerned, remember that Xmas (or Christmas) tree scans don't work against Windows or Microsoft products.</p>
			<h2 id="_idParaDest-103"><a id="_idTextAnchor105"/>FIN scans</h2>
			<p>Let's go back <a id="_idIndexMarker415"/>to our attacker and target again. Do you remember <a id="_idIndexMarker416"/>the three-way handshake? What do we start with? A SYN? No, let's hit them with a FIN, meaning, <em class="italic">I'm done talking to you!</em> The target machine will go, <em class="italic">Well, I don't even know how to respond to that because we haven't even started talking yet</em>. So, no response tells me that the port is open. Again, if I want to see if the port is closed, I send my FIN, and if I just get an RST/ACK, then the port is closed.</p>
			<h2 id="_idParaDest-104"><a id="_idTextAnchor106"/>NULL scans</h2>
			<p>A NULL scan is <a id="_idIndexMarker417"/>kind of unique because it typically works on UNIX and Linux <a id="_idIndexMarker418"/>systems. Again, it does not work on the Microsoft platform.</p>
			<p>Instead of sending anything, when we send the packet, it's going to go through TCP, but guess what? There's going to be no flag. It's not going to be a SYN, an ACK, or a FIN – it's just going to be nothing; the flag is empty. When the target receives that packet, it responds with nothing, which means that you're sending me information I have no idea how to handle. And because it doesn't respond, we know that the port is open.</p>
			<p>The opposite of that is true, just like we saw with the Xmas tree scan. If I send a TCP packet with no flag implemented, the kernel will drop it if it's open, or it'll send an RST/ACK back to the attacker's machine, which tells me that the port is closed.</p>
			<h2 id="_idParaDest-105"><a id="_idTextAnchor107"/>UDP scans</h2>
			<p>Do you remember the advantages and disadvantages of UDP? There's always a catch 22, right? The three-way handshake is caused by TCP and when it comes to UDP, there's no three-way <a id="_idIndexMarker419"/>handshake, there's no overhead of TCP, and that creates some advantages for us. One of the advantages is that it's a lot harder to monitor <a id="_idIndexMarker420"/>because there is no initial handshake. UDP itself is less informal as far as regarding it in an open port. The frames can be overloaded or be larger, so we can exceed the limitations of TCP frames. Again, Microsoft-based operating systems don't have any type of ICMP rate limiting built into them, so the scan is extremely efficient against Windows-based targets. The disadvantage of UDP is that we get port data only; we're unable to take advantage of some of the other options that are available to us, especially when it comes to Nmap, such as being able to identify the operating system. To see those things, we're going to have to include some additional parameters.</p>
			<p>So, let's take our target and attacking machine. If the attacking machine sends a UDP packet that says, <em class="italic">Hey, is port 31 open?</em>, and the target machine says, <em class="italic">Hi, I'm not going to talk to you</em>, that's a no response and means the port is open.</p>
			<p>The same concept applies if we go through and implement our attacking and target machine to do the same thing; is port <strong class="source-inline">31</strong> open? In this case, we will get an ICMP port unreachable error message. In that case, we know that the port is closed.</p>
			<p>I know you're thinking, <em class="italic">Let's take a look at this!</em> Well, the big challenge with UDP scanning is doing it quickly. Both ports that are filtered and open rarely send any type of response, and this leaves Nmap to time out quite often. Closed ports are an even bigger problem. They usually send back an ICMP port unreachable error. Sometimes, you do get some false positives pop up. The cool thing is that Nmap will detect rate limiting and slow down to make sure the network doesn't get flooded with a ton of useless packets. Unfortunately, the Linux style limit of 1 packet per second makes scanning 65,000 ports take about 18 hours.</p>
			<p>Now that we've gone through and looked at the different scanning techniques we can use, we'll <a id="_idIndexMarker421"/>move to those we can utilize to evade the <strong class="bold">Intrusion Detection Systems</strong> (<strong class="bold">IDSes</strong>) that are looking for the types of scans we have looked at.</p>
			<h2 id="_idParaDest-106"><a id="_idTextAnchor108"/>Idle scans</h2>
			<p>An idle scan is where you're sitting in your car on Main Street on Friday night checking out the <a id="_idIndexMarker422"/>people next to you in the car while you're idling. Just kidding… This scan is <a id="_idIndexMarker423"/>tricky and very hard to detect because of how everything works inside of the three-way handshake and how computers are designed to respond.</p>
			<p>We'll use the TCP port scanning mechanism and the regular three-way handshake, but instead, we're going to spoof the source address to the target. We're going to make the target think, it's not me scanning you, it's somebody else – <em class="italic">Look over here!</em> Now, there are some advantages to this because we get to blame somebody else. <em class="italic">It wasn't me; it was this computer over here creating the problems for us</em>. The disadvantage of this scanning mechanism is that it does require you to have a zombie – a system that I've already penetrated, compromised, or know about. I don't even need to own or pwn it. It's just going to be an IP address I know that's out there behind your existing firewall or your IDS system. It requires this because I'm going to use that zombie as the source address.</p>
			<h2 id="_idParaDest-107"><a id="_idTextAnchor109"/>Listing scanning</h2>
			<p>A list scan <a id="_idIndexMarker424"/>is fast, and it goes through and enumerates every IP address range that <a id="_idIndexMarker425"/>you give in a specific target or a block on each. Then, it does a quick reverse DNS lookup on each of those IPs. One of the advantages of a list scan is that a lot of times, the name of the system could give you a hint about what it's doing.</p>
			<h2 id="_idParaDest-108"><a id="_idTextAnchor110"/>SSDP scanning</h2>
			<p><strong class="bold">Simple Service Discovery Protocol</strong> (<strong class="bold">SSDP</strong>) is an interesting and tricky scan. It's a network <a id="_idIndexMarker426"/>protocol that generally communicates <a id="_idIndexMarker427"/>with other machines. So, when a system comes <a id="_idIndexMarker428"/>up and says, <em class="italic">Hey, I'm looking for printers or I have an available printer</em>, this service goes through and helps with universal plug and play. It generally works when the machine is not firewalled. However, there can be times where we'll work through a firewall. So, an attacker could use SSDP scanning to detect universal plug-and-play vulnerabilities that could allow them to launch a buffer flow or even a denial-of-service attack against the target.</p>
			<h2 id="_idParaDest-109"><a id="_idTextAnchor111"/>Countermeasures</h2>
			<p>So, how do we release countermeasures and what are the different countermeasures that we <a id="_idIndexMarker429"/>can implement? First, firewalls need to be configured to <a id="_idIndexMarker430"/>look for SYN scans. This is because most of the firewalls today – if they aren't updated – will have each manufacturer using different mechanisms or ways of scanning for SYN attacks.</p>
			<p>Another thing you'll want is your IDS systems to be able to detect Snort or Nmap. Snort is a product that looks at traffic and helps evaluate and determine what's going on. It's almost like a silent sniffer, hence the name Snort. Again, you'll want to check with your IDS systems to make sure they support those features.</p>
			<p>We'll also want to go through and only open the ports that are required to be open. So, if I'm doing a scan on a system and I see that no ports are open on the machine, that tells me something's up. Why is the machine on at all? It must be giving some type. I mean, a DNS server has a port open. A domain controller has certain ports open. So, you want to limit the number of ports that are opened. That's one of the things you should be doing. But going back and talking about those different scans, I would detect if I did a scan on an IP address and I had 0 ports open. At this point, I know that between me and the target, I've got some type of device that's blocking that. So, again, we only want to open the ports that are required for the services of that server.</p>
			<p>We also want to go through and make sure that we filter ICMP messages, making sure that we don't allow ICMP traffic to pass through unnecessarily. I know that takes away the ability to do some pinging, but we want to filter and record that.</p>
			<p>We'll also need to go through and test our network using the techniques I've just shown you. Again, part of our job as ethical hackers is going through and making sure we can withstand what can be discovered from the attacker using these same techniques and tools.</p>
			<p>Finally, we're going to go through and keep our firewalls and IDS systems up to date and patched. Now, I know this doesn't look like a lot as far as some people go, but that's all I can do. Again, I will go back to the analogy I use all the time: that I know I have a higher risk of getting in a car accident driving on the freeway and getting injured or killed versus flying, but I'm still a little paranoid about flying. It may be a control issue for me, but I know those risks, and I'm willing to take them just to be able to drive and live in an area where I live – outside of the big city.</p>
			<p>One of the <a id="_idIndexMarker431"/>most interesting conversations I've had was <a id="_idIndexMarker432"/>with a friend who is a white hat for Microsoft. When I was trying to open my ISP service out in my area, he said, <em class="italic">Do you really want to do this?</em> After asking what he meant by that, he said getting on the internet and becoming an ISP service will make me a target. I said, <em class="italic">Dude, but I live in this little bitty town. I mean, a population of 2,000</em>. He said, <em class="italic">It doesn't matter because on the internet you're strictly a number. They don't care about where you're located</em>. But I took that risk, and we have that risk today. We all know we can go shopping on the internet. It's convenient. However, we know that there is a chance that our identities can be stolen. Still, it's a chance we're willing to take.</p>
			<h2 id="_idParaDest-110"><a id="_idTextAnchor112"/>More IDS evasion methods</h2>
			<p>There are other ways that we can get around IDS systems. One of them is to spoof your IP, but we're <a id="_idIndexMarker433"/>going to sniff the responses out there. We can also use a proxy or a pwned machine. So, a zombie is kind of a combination of the two.</p>
			<p>Another way <a id="_idIndexMarker434"/>that we can do this is to fragment the IP packets, which I'll show you in a second. Then, if you're able to, you can use something called source routing – a method or a technique that you can use to specify the route a packet should take through the network. So, when you have a packet that has source routing specified on it, going through the network, the device that makes the routing decision, such as your router, will look at the path specified inside the network packet to determine where to forward the packet. So, we can force packets to bypass some of our IDS systems.</p>
			<p>Now, as far as IP fragmentation is concerned, or IP fragments, the concept is to get past these IDS systems. Typically, they're looking for normal-sized packets going through, and they monitor them. Anything else that's small is typically ignored. So, when a big packet goes through, it gets blocked based on its packet size and its protocol. Maybe your IDS system is blocking FTP or a specific port. Well, instead, let's break that packet into smaller packets, which will pass right through and be reassembled at the target machine.</p>
			<h1 id="_idParaDest-111"><a id="_idTextAnchor113"/>Banner grabbing and OS fingerprinting</h1>
			<p>We've gone through and found our live targets and we've scanned them to see which ports were <a id="_idIndexMarker435"/>open. Our next step is to try to identify the systems. How are we going to do that? When I say identify, I'm talking about finding what operating <a id="_idIndexMarker436"/>systems and what applications are possibly running on that machine. We're going to do that with banner grabbing and OS fingerprinting.</p>
			<p>The best way to sum up what this module is about was best phrased by the famous scholar Joey Tribbiani, who said, <em class="italic">How you doin?</em> That's exactly what we're doing here! We're trying to get to know the system. We're trying to identify the target. So, we'll go through and look at OS fingerprinting, which is the process of going through and identifying the operating system by the way that it responds to certain types of packets we're going to send to it.</p>
			<p>Now, there's something else we can do called <strong class="bold">banner grabbing</strong>. This is a very direct way of identifying the system, and it's something you can't stop as an IT professional. It's just the way operating systems are designed to work; they respond in a specific way to different requests. Eventually, we'll go through and look at our countermeasures. Again, there are some things you can't stop, but I can slow the attacker down. I can't stop them; you're going to give yourself a heart attack thinking that you can stop them, but you can't.</p>
			<h2 id="_idParaDest-112"><a id="_idTextAnchor114"/>OS fingerprinting</h2>
			<p>The reason why we do this when we're doing pen tests today is because the tester usually starts by gathering as much information about the target as possible. One of the things we want to make sure we get hold of is the operating system or trying to identify the operating system itself. We typically do this by sending specific types of packets to the target machine. Now, if we can hide this information, then we are making it more difficult for the attacker to decide what type of attacks to throw. Often, you'll discourage the attacker; not that they can't get in, but they may want to try to find something else that's a little bit easier. Therefore, the focus on the initial information you're gathering is trying to discover what OS is being used. This makes us extremely, extremely active on the network.</p>
			<p>There are several different approaches we can use to find the operating system of an unknown host without having an account or any other way of logging directly onto the machine.</p>
			<p>There are two types of fingerprinting. The first is known as <strong class="bold">active fingerprinting</strong>. Now, in active <a id="_idIndexMarker437"/>fingerprinting, I'm going to use some packets that I'm going to go through and design to help me identify the operating system. Depending on the application you're using – and I'll be using Nmap since it's one of my favorite tools – as well as the responses or the way the target machine responds to my packets, I'm going to compare it to a database of known responses, and that's going to help me identify the operating systems. Unfortunately, there's a downside to this: because it's so active, there's a high probability I'm going to be detected on the network.</p>
			<p>There's also <strong class="bold">passive fingerprinting</strong>, which involves sniffing the network and looking at the <a id="_idIndexMarker438"/>packets to see what the source IP is. You or your application will record over a certain period, and you'll gather enough information that will help you ID the target.</p>
			<p>The upside, at least from the attacker's perspective, is that it's very, very quiet in that it's very hard to detect they're doing this on your network because they're just sniffing packets. Now, granted, it would take the attacker a while to do this, which is something you don't have – time.</p>
			<h2 id="_idParaDest-113"><a id="_idTextAnchor115"/>Countermeasures</h2>
			<p>So, what are my countermeasures? How do you stop people from fingerprinting and possibly <a id="_idIndexMarker439"/>banner grabbing your servers? Well, there are a couple of things you can do. First, you can go through and misdirect by using fake banners. For example, in IIS, we can go through and change what the banner reports back as. There's a <a id="_idIndexMarker440"/>tool Microsoft has for this. It's called the <strong class="bold">IIS lockdown tool</strong> and it will help lock down an IIS box, especially the older versions of IIS.</p>
			<p>I'm a big fan of misdirection. If I buy a Linksys wireless router, what would be its default wireless SSID? It's Linksys, right? An attacker driving by who sees my Wi-Fi will throw Linksys attacks at it. To avoid that, I will take my Linksys router and change its SSID to Belkin or Netgear, to have them throw the wrong attacks. The same concept applies here. Go and fake the banners.</p>
			<p>There's also a nifty little tool out there, called ServerMask, that you can run to make the server look like it's something it's not, such as an older version of IIS, or an older version of Apache.</p>
			<p>You can also turn off services that aren't needed because these services and ports can be used to identify the operating system. If you have some Linux boxes, you also need to go through and change the <strong class="source-inline">ServerSignature</strong> entry inside the <strong class="source-inline">httpd.conf</strong> file.</p>
			<p>If you are dealing with Apache servers, you can go in and turn the <strong class="source-inline">ServerSignature</strong> line to <strong class="source-inline">ServerSignature</strong> off in the <strong class="source-inline">httpd. conf</strong> file. </p>
			<p>You can <a id="_idIndexMarker441"/>also go into the same file (the <strong class="source-inline">httpd. conf</strong> file) and look for a section called <strong class="bold">mod headers</strong>. There, you can go through and change the server's name. So, I could type in IIS version 6.0 and leave the attacker scratching their head, wondering why their attacks aren't working.</p>
			<h1 id="_idParaDest-114"><a id="_idTextAnchor116"/>Vulnerability scanning and drawing out the network</h1>
			<p>Now that we've gone out, found our live machines, footprinted the OS, or done a banner <a id="_idIndexMarker442"/>grab to identify the OS, our next step is to go through and look for vulnerabilities.</p>
			<p>Remember, our <a id="_idIndexMarker443"/>goal is discovering those targets – hopefully to find out what type of operating system and possibly what applications were running. That's exactly what vulnerability scanning and drawing out the network does for us.</p>
			<p>Some IT guys wonder if vulnerability scans are important and my answer – my favorite line from a famous character – is, <em class="italic">A man's got to know his limitations</em>.</p>
			<p>You must understand what your limitations are, what your vulnerabilities are.</p>
			<p>Now that we agree, we'll go ahead and look at some of our greatest weaknesses. We'll do that by understanding what vulnerability scanning is. After that, we'll look at how it works, the different mechanisms we can use, and how various software programs may look at your network infrastructure.</p>
			<p>We'll also look at some vulnerability scanning tools and do a little vulnerability scanning.</p>
			<p>We will then talk about drawing out the network, which we partly do to remember – as attackers – the network we were just on when we revisit it.</p>
			<p>And, of course, we'll learn about some tools associated with how we draw out the networks.</p>
			<p>As we get to this step, which is extremely active, we'll draw the line between being a black hat and a white hat because you will actively go out and try to find out what's wrong with the systems that you've identified. So, before you do this on a network, you better make sure you have permission. Okay? Now that you've gotten your permission slip signed by your parents or guardians, let's get going.</p>
			<h2 id="_idParaDest-115"><a id="_idTextAnchor117"/>What is vulnerability scanning?</h2>
			<p>A vulnerability scanner is used to go through and look at a variety of vulnerabilities across a network, and we'll go through and use a piece of software that does that.</p>
			<p>There are <a id="_idIndexMarker444"/>several vendors out there that create vulnerability scanners. Most of the tools we use are designed for good but are sometimes used for evil. So, this software is going to go through and look at information such as your network systems, switches, routers, and computers – which it'll try to identify based on the operating systems that are running and what vulnerabilities they are not patched for, including applications.</p>
			<p>When we talk about applications, we're not necessarily talking about Word or Excel. It could be a server-based application, such as SQL, Exchange, or any other type of email server. These are applications that run on a server platform. However, this can include applications at the desktop level because, again, I'm going to try to break into any target I can find. So, if you have Adobe Acrobat and it hasn't been properly patched and it's on a desktop machine, I'm going to go after that machine because I can use its resources later to maybe attack or daisy chain into other systems in your network.</p>
			<p>A commonly asked question is, <em class="italic">How are these vulnerabilities created?</em> Well, they're created as several different mechanisms and in several different ways. Some of them are done because of a user-initiated task. For example, a user goes through and shares directories to folks they shouldn't be sharing them to, fails to run an antivirus solution, or fails to keep up to date with that antivirus solution. In some cases, you may have a <em class="italic">weekend geek</em>, as I like to call people who brag <em class="italic">I build computers</em>, who know everything but deliberately load back doors on their systems while trying to hack into the system, only to open the systems for real attackers.</p>
			<p>Vendor-created vulnerabilities can sometimes be caused by software bugs, operating system patches, and services that have been turned on without any notification – and some of those services might be unnecessary, insecure default configurations, web application vulnerabilities, and even system admins.</p>
			<p>Some of these vulnerabilities are caused by lazy admins who go ahead and install an application that needs a service account. Lazily, they use the default built-in domain administrator account to run the service. Sometimes, they make configuration changes to solve a temporary situation and forget to switch it back. Some also lack password protection policies. This means they allow small password links to be used (seven or eight characters) instead of longer passwords.</p>
			<h2 id="_idParaDest-116"><a id="_idTextAnchor118"/>Types of scanners</h2>
			<p>First, we have networked-based scanners. These are designed to go out and do things such as assess <a id="_idIndexMarker445"/>possible vulnerabilities on remote web servers or even perform port scans to determine which ports may be open.</p>
			<p>You can't avoid having open ports if you're doing anything with that server to provide access to resources, but we need to make sure only the ports that are needed are open.</p>
			<p>We'll look at web app scanners here. These will go through and assess the security aspects of a web application by looking at SQL injection. Web app scanners also look for things such as cross-site scripting.</p>
			<p class="callout-heading">Tech Tip</p>
			<p class="callout">Web application scanners don't necessarily provide a comprehensive security check on every aspect of the target web application. There may be a need for doing additional manual checking, such as looking at a login account if it's locked out after so many invalid attempts. You may need to go through and look at those types of things when you're testing a web application.</p>
			<p>We also have host-based scanners, which are installed on the host that's going to be scanned. It has direct access to what's referred to as low-level data, such as services or configuration details that may be on a host operating system. Because of this level of access, it provides better insight into user activities that could be considered risky, such as using easily guessed passwords or even no password at all.</p>
			<p>It also detects signs that an attacker has already compromised the system, which would include going through and looking at suspicious filenames or unexpected system files that are showing up, or even device files. In some cases, we might see unexpected privileges being given to programs.</p>
			<p>A host-based scanner can also perform baselines or filesystem checks. Typically, network-based scanners don't do this level of security check because they don't have direct access to the filesystem on the target. A great example of a host-based scanner would be a database scanner that goes through and performs detailed security analysis of authorization, which <a id="_idIndexMarker446"/>accounts have been given authorization, the authentication mechanisms being utilized, the integrity of the database, and possibly any security loopholes that may be in the database system (weak passwords, misconfigurations, and so on).</p>
			<h2 id="_idParaDest-117"><a id="_idTextAnchor119"/>How does vulnerability scanning work?</h2>
			<p>What are the limitations? Because there are some definite drawbacks. The first is that human judgment is required. Vulnerability scanners can only report the vulnerabilities it finds according <a id="_idIndexMarker447"/>to the plugins that are installed inside the database. They are not designed to determine whether the result is a false negative or a false positive, so we always need someone to look at the data and analyze it after scanning.</p>
			<p>You should also note that it's strictly a snapshot. A vulnerability scanner only looks at a specific system at a specific time. Therefore, you can't just do one vulnerability scan and assume you're safe. You must do this continually. As new vulnerabilities emerge, or if people are making changes to configuration settings, we might introduce new security holes.</p>
			<p>Another limitation is that it only knows what it knows. A vulnerability scanner is designed to discover the specific vulnerabilities it's aware of. It's not designed to identify other security threats. So, you must keep this bad boy updated.</p>
			<p>There's one more limitation. I call it <em class="italic">parts as parts</em>, or plugins. Most vulnerability scanners rely on these plugins to determine possible issues or possible vulnerabilities. Plugins become part of the scanning database, which expands the vulnerabilities that are known by the scanner. Now, some vulnerability scanning software programs may refer to them as scanning profiles, but the term plugin is normally what most all vendors refer to them as.</p>
			<p>Again, the scanner only checks for those vulnerabilities it knows about. It can't identify what it doesn't know about. However, not all scanners need plugins. For example, a port scanner doesn't need a plugin; it'll hit a range of ports.</p>
			<p>So, what are the benefits? Well, first, a vulnerability scanner allows you to detect and handle known security issues early. As a security expert, by doing ongoing security assessments all the time using these scanners, it would be very easy to identify vulnerabilities that may be present on your network. And these vulnerabilities could be either external or internal.</p>
			<p>Another benefit is detecting new devices on the network, or rogue systems, that connect without any type of authorization or permission. This is typically what we find when we perform pen tests. I'll try to find a port that's not being utilized, and I've got a nifty little Raspberry Pi device – a tiny mini-computer that is about the size of a standard cell phone. I can hook that up to a port, walk away, and come back a couple of days later after it will be done sniffing your network. A vulnerability scanner will pick those things up.</p>
			<p>A vulnerability <a id="_idIndexMarker448"/>scanner can also help you with inventory, verifying all the devices that are supposed to be on the network are on the network. It can also help with inventory things such as operating system versions, what OSes have been patched, what software has been patched, and what hardware configurations have been used. My favorite is: <em class="italic">Hey, Billy, why does your machine only have 8 GB of RAM when we put 16 GB in it, and how's that machine running at home now?</em> Again, this type of information is extremely useful when it comes to tracking and managing your environment. One of the things you'll hear me say over and over is that your first line of defense when it comes to securing your network is understanding what's on your systems, especially when it comes to software. Well, guess what? A vulnerability scanner can help you do this.</p>
			<h2 id="_idParaDest-118"><a id="_idTextAnchor120"/>Vulnerability scanning tools</h2>
			<p>So, how do you choose a vulnerability scanner? Well, there are hundreds and hundreds out there. There are so many choices, so little time. Everyone has a preference, but if you're looking <a id="_idIndexMarker449"/>for your first vulnerability scanner, here are some things that you may want to take into consideration.</p>
			<p>How often do they update their database and plugins? Again, we will go back to the statement that vulnerability scanners only know what they know. So, it can't identify a vulnerability if its plugin isn't available or hasn't been updated for a new vulnerability. So, a reputable vendor can produce updates and new plugins daily, weekly – you choose. How safe do you feel? I'd also be looking for scanners with an auto-update feature to ensure I don't have to worry about downloading them every day. It can be a scheduled task.</p>
			<p>We'll also want to look at quality versus accuracy. If a vulnerability scanner finds a vulnerability, the question is, <em class="italic">now that I have found 300 vulnerabilities, how many of those were accurate (were not false positives)? </em>The accuracy that critical vulnerabilities are identified with is much more important than the number of vulnerabilities that have been checked. This is because the same vulnerability could be counted more than once by the same scanner.</p>
			<p>We also need to look at the quality of the reporting options that are available to us. A good vulnerability scanner should have a reporting mechanism that gives very clear and concise information about how to fix some of the problems you've discovered. A scanner that <a id="_idIndexMarker450"/>has a great reporting option or feature with a nice backend database can make an administrator's life a lot easier when they need to perform follow-up scans after doing the initial scan, if there have been configuration changes, or they a need to make comparisons between the results of a previous scan and the current one.</p>
			<p>Another thing to consider is the deployment process. Whether you put the scanner in front of the firewall or behind the firewall, it's going to influence the results you get. Scanning the internal network from outside the firewall is only going to detect the services that are available to the outside user or attacker. It will not look at the vulnerabilities from within the internal side of the network. That won't be visible to you because of the protection the firewall provides.</p>
			<p>On the other hand, scanning the machines in your DMZ from inside may not provide a complete picture of your security. So, to get a complete picture of your security, make sure you do your scans externally and internally.</p>
			<p>Now, what about port ranges? We already know that open ports could imply we have a security weakness somewhere, and port scanning is one of those we looked at earlier. Knowing that's what the attackers will use, part of your vulnerability scanning should include port scanning.</p>
			<p>Some vulnerability scanners only check the first 15,000 ports, yet there are over 65,000, so make sure that you find out how many ports are scanned in the default settings. Oftentimes, you can override these settings by changing the configuration options of the vulnerability scanner.</p>
			<h2 id="_idParaDest-119"><a id="_idTextAnchor121"/>After scanning</h2>
			<p>Now, let's talk about the post-scanning practices. What do we do afterward? When you get your <a id="_idIndexMarker451"/>reports, it's important to interpret the scanning results correctly to avoid identifying vulnerabilities that are not there.</p>
			<p>It's also important to go through and set priorities on the different vulnerabilities you're discovering. A vulnerability on a server that's exposed to the internet would have a higher priority than, for example, Billy Bob's machine down in the mailroom.</p>
			<p>Also, note that when you get service packs, or Patch Tuesday from Microsoft, or any other software vendors, any time you apply new patches, you should immediately run new scans. Make sure that your database has been updated but rescan once those patches have been applied.</p>
			<p>Again, if you make any configuration changes, you need to run a vulnerability scan once you're done. You should also do this if you plan to deploy any new software, even if that includes your desktop platforms.</p>
			<h3>The cons of vulnerability scanners</h3>
			<p>Dun-dun-dun! Beware! Vulnerability scanners create some issues. You will need to be aware of <a id="_idIndexMarker452"/>some of those issues as, well, the most important ones will be potential threats. I know I just said it's a vulnerability scanner, but yes, it's a potential threat. You can end up crashing an already vulnerable server if all the plugins, such as one that tests for a denial-of-service scan, are enabled. So, when you go through and configure your scans, initially, you need to pinpoint which portions of the scans are necessary.</p>
			<p>Normally, for preproduction systems, it's probably okay to enable all the plugins, including high-risk ones, but when it comes to the ongoing continual scans on a production system, you should be very wary. Alternatively, consider disabling certain high-risk plugins.</p>
			<p>When you're handling the results, do yourself a favor – don't post them on a website in your organization, upload them to Dropbox, or put them somewhere a hacker could find them by doing a Google hack. If you do, you can name the document something like <strong class="source-inline">howtobreakintomynetwork.pdf</strong>. Otherwise, safeguard this information and keep it in a safe place. I would recommend encrypting it because the last thing you want to do is hand a treasure map over to an attacker.</p>
			<p>We've talked about some of the cool things vulnerability scanners offer and we know that they were created for good. You also need to have some policies and actions in place in case somebody uses one of these tools against you, such as an employee, not necessarily somebody outside your company. You will find, especially in larger enterprise environments, weekend geeks who bring in a piece of software to scan because they saw something cool on YouTube.</p>
			<p>You need <a id="_idIndexMarker453"/>to make sure you have policies and procedures to specify whom, how, and when vulnerability assessment tools can be used. These policies can include notifications of when the scan is going to be done, management approval, and possibly legal clearance. No one should be allowed to conduct a vulnerability scan without prior permission!</p>
			<h3>More tools for scanning</h3>
			<p>So, what are some of the tools out there? Oh, man. I'm only going to be able to give you some highlighted tools here because there are a plethora of these tools out there for us. These tools <a id="_idIndexMarker454"/>include looking at something called Nessus, which is among the more popular ones out there. We also have tools <a id="_idIndexMarker455"/>such as Core Impact Pro, which has some cool features built into it, including an <a id="_idIndexMarker456"/>Android agent and Windows domain information gathering modules. They also have support for WMI.</p>
			<p>We also have Microsoft Baseline Security Analyzer, which goes through and provides baseline security for particular servers. Microsoft's built these features into a lot of and some of their newest server platforms where they have some best practice analyzer tools. So, if you've got some Windows servers out there, especially those that are running Server 2012, you may want to pop one of those bad boys off and see what it kicks out and says about the best practices for that server.</p>
			<p>GFI LanGuard is another great product, and it has been out there for ages.</p>
			<p>There's also Retina. I had an opportunity to play around with Retina when I had my ISP service. We used it to look at vulnerabilities. I had a friend who had an ISP service but didn't know much about the legality of security. He ran Retina on his network and would send out emails to his customers saying, <em class="italic">Hi, your machine is missing these patches</em>. At the time, his customers were grateful and would buy his service pack. That's kind of borderline because he never had any permission to hit their systems. Yes, they were on his network, and he had contracts that said he does scans on the network, but that was probably aggressive.</p>
			<p>We also <a id="_idIndexMarker457"/>have Saint (<strong class="bold">https://www.carson-saint.com</strong>/). One of the things Saint likes to advertise <a id="_idIndexMarker458"/>is that their product helps you comply with government and industry regulations such as PCI, HIPAA, SOX, NERC, FISMA, and COPPA.</p>
			<h2 id="_idParaDest-120"><a id="_idTextAnchor122"/>Why draw out the network?</h2>
			<p>Now that we've gone through and scanned for vulnerabilities, our next phase is to draw out the <a id="_idIndexMarker459"/>network. A lot of people wonder why they need to draw out the network. Well, take it from an attacker's perspective. First, you're not the only network he's tracking. He must have some way of visualizing your environment, so when he revisits it, he goes, <em class="italic">I remember they have a server box here, a Linux box; they're running XP on this machine, they're still running server 2000.</em></p>
			<p>He may also want to see if he can figure out the missing pieces because maybe he's not picking something up, such as a skip in an IP address range.</p>
			<p>Now, these pieces of software are designed to help IT personnel go through and manage their networks. Some of them will give you a live map and start showing you important things such as when a node goes down.</p>
			<p>It will also help show both the physical and logical paths.</p>
			<p>So, let me ask you, what do you see on this map? (<em class="italic">Figure 4.4</em>)</p>
			<div>
				<div id="_idContainer070" class="IMG---Figure">
					<img src="Images/B17486_04_004.jpg" alt="Figure 4.4 – VCN network diagram&#13;&#10;" width="962" height="748"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.4 – VCN network diagram</p>
			<p>Can you see <a id="_idIndexMarker460"/>operating systems? What else? I can see the devices— a Dell station, a Brother printer, and available apps. I might be able to track architecture, too.</p>
			<p>Some mapping programs will help you store additional information notes. So, here is my warning for you: you may be using something like this already in your environment, and typically, these programs save the layout as a file extension.</p>
			<p>As an attacker, one of the things I'm going to be looking for are those extensions because if I can download a map, you've already created it for me, thank you! I will store those types of files somewhere secure and, preferably, encrypt them.</p>
			<p>So, what are the tools that help us visualize? There are many of them, but one of the most used is WhatsUp Gold, which I liked using back in my old ISP days. It would tell us when an antenna went down so that we could notify the customer or dispatch somebody <a id="_idIndexMarker461"/>out to their house before they even knew that they were having an issue.</p>
			<p>There's also The Dude, which got its name from the The Big Lebowski movie. The main character is The Dude. We also have NetworkView as another great little product, as well as OpManager. Microsoft also makes a great little product called System Center Operations Manager, but it does require us to load an agent, yet others can just be done via ping and port scans. We also have LANsurveyors and FriendlyPinger – which is quick and dirty.</p>
			<h1 id="_idParaDest-121"><a id="_idTextAnchor123"/>Preparing proxies and other anonymizing techniques</h1>
			<p>Before we start attacking systems or launching our attack at a company, we need to prepare <a id="_idIndexMarker462"/>our proxies <a id="_idIndexMarker463"/>and discuss another technique called <strong class="bold">HTTP tunneling</strong>.</p>
			<p>There are other <a id="_idIndexMarker464"/>ways that we can use different anonymizing techniques to hide who we are and where we're coming from. We want to create an environment where it's almost like a magician's misdirection – look over here while I attack you from here.</p>
			<p>So, first, we'll go through and look at placing the blame on someone else. In this world, where we have hundreds of thousands of devices hooked up, why not utilize them (systems) to go through and create proxies? So, we'll look at what a proxy is, why we use a proxy, and how to use a proxy. Then, we will look at a scary technique that's being utilized today that should have you very concerned: HTTP tunneling. <em class="italic">Wait a minute, my users can do what?</em> will be your reaction when you see it. We will then close this chapter by looking at some other types of anonymizers that are out there. Let's go look at those droids, shall we?</p>
			<h2 id="_idParaDest-122"><a id="_idTextAnchor124"/>What is a proxy?</h2>
			<p>A proxy can <a id="_idIndexMarker465"/>do several things. A lot of companies will use a proxy. They'll use it to hide the identities of their systems behind their firewall, although sometimes, the firewall is their only proxy.</p>
			<p>A good example is the ISIS server by Microsoft, which acts as a proxy. It goes out and gathers the websites for you. People only see the IP address of the one machine; they don't have a clue that you have multiple machines behind it.</p>
			<p>It can also be used to filter undesirable content. A lot of companies also use this feature to keep employees focused on what they're supposed to be working on.</p>
			<p>Sometimes, it also provides anonymous IDs to websites because websites track all kinds of information. One of the things they track is what IP address you are coming from and in this case, it's going to see the IP address of your proxy. We can also utilize it to NAT the IP address from the outside world. Again, it's just acting as a frontend for us.</p>
			<p>It provides us <a id="_idIndexMarker466"/>with a little bit of protection. It's not going to fool a good hacker, but for most uses, there's not a ton of IP addresses being registered from your business going to websites.</p>
			<p>In fact, because of some of the IP addresses, and some of the ways web browsers are utilized today, some website owners can detect what operating system you're utilizing. This can be determined based on the web browser that you're using. The big thing here – for us too – is that it saves on bandwidth. Back in my day, when I had my ISP service, we implemented a proxy server to help reduce bandwidth because everyone's default page back then for Internet Explorer was to pull up <strong class="source-inline">msn.com</strong>.</p>
			<p>Instead of me having 600 employees firing up <strong class="source-inline">msn.com</strong>, eschewing the same information over and over, why not have the first request go out and have the proxy cache up that web page? And so, the second request comes to hit the proxy server, and the proxy server just quickly checks with <strong class="source-inline">msn.com</strong>, sees that there are no changes, and immediately returns across the network. Instead of doing so across our internet bandwidth, it just transfers to the page. It was very fast. It saved us almost 40% of our bandwidth.</p>
			<p>One of the biggest shockers for me was getting a list of the most popular websites that were being cached up. It was a big eye-opener for me. So, you can see there are some great benefits to using a proxy for a corporation. Now, the question is: <em class="italic">Why do attackers use proxies?</em> Well, they do it kind of for the same thing – to hide their IP address from you and place blame somewhere else. They get to mask the actual source if they want. You can even set up a proxy and still spoof the address beyond this proxy.</p>
			<p>If I was an attacker, and I wanted to, I could access internal data that's behind a firewall. If I can get someone to load up a piece of malware I've distributed and they're behind a nice firewall they fired up, it reports back to me, sets up a proxy for me, and I will be inside your environment without lifting a finger to get past your firewall.</p>
			<p>We also use them for misdirection. <em class="italic">Look over here while I'm doing this over here</em>. I can have you <a id="_idIndexMarker467"/>believe that the attack is coming from the mailroom server, or Dick Grayson's computer down in the Marketing Department, when it's actually coming from me.</p>
			<p>We also use it to help create what we refer to as a proxy chain – where multiple proxies are involved.</p>
			<h2 id="_idParaDest-123"><a id="_idTextAnchor125"/>How to use a proxy </h2>
			<p>So, how do we use a proxy? Well, as an attacker, there are several different ways I can make communications or connections to your servers and your machines. First, I can be very blunt <a id="_idIndexMarker468"/>and hit you directly. The downside of this is that any IT person worth their weight in salt would find it easy to backtrack and find out where the attack is coming from.</p>
			<p>Some attackers will go through and compromise a machine or use a machine they've compromised and be able to issue the attack. Alternatively, they will spoof the address. Again, when we look at log files and see somebody's attacking our servers, we relate it to, in this case, the server in the middle, which the attacker has control of. Now, that's a decent attacker, and this is what common attackers do. The great attackers we see in movies are difficult to trace because a simple call to their cell phone goes through a bazillion links, making it impossible for detectives to get to them in time.</p>
			<p>A proxy chain is where an attacker is going to pwn several machines to route their traffic through. You might be able to discover the first proxy IP address they are attacking you with, but just when you think you have figured out who it is, you realize that it's been hopped through from another IP address so that you can get to the second proxy server. And you could keep backtracking to the third and maybe to the fourth.</p>
			<p>A good attacker might use multiple machines within your network, but that's easy for you to go and backtrack. For even better cover, some want to have the first two machines in your network, and then outside of that (a completely different network), and then have those machines attack you because you don't have the rights to go in and look at those machines' log files. It would make it harder and harder to figure out what's going on as you back up the chain.</p>
			<p>Usually, by the time you find them, the next time they connect to you, they may take a completely different route. It is very easy to detect an attacker utilizing a proxy daisy chain because <a id="_idIndexMarker469"/>it's easy to see that source IP, but it's extremely hard to discover where the attack is coming from.</p>
			<h2 id="_idParaDest-124"><a id="_idTextAnchor126"/>Proxy o'plenty</h2>
			<p>There are <a id="_idIndexMarker470"/>several tools out there that can help with proxying or making yourself somewhat anonymous. One of <a id="_idIndexMarker471"/>them is proxifier, which allows network applications that don't normally support working through proxy servers to operate through an HTTPS proxy or chain. This allows people to surf websites that are typically restricted, especially by government or corporate organizations. It gets you past their firewall and hides your IP address. It can even use different protocols through the chain as it makes its way through your proxy chain.</p>
			<p>We also <a id="_idIndexMarker472"/>have SocksChain, a product that goes through and functions as a Sock server that transmits queries through a chain of proxies. Again, we can use this for client programs that don't support Socks but work with a TCP connection such as Telnet, HTTP, or IRC. It is designed to hide your IP address from being displayed on the targets' logs or even mail headers.</p>
			<p>Fiddler, an HTTP <a id="_idIndexMarker473"/>debugging proxy server application, also operates as a proxy server. It captures HTTP and HTTPS traffic and logs it for the user to review that information. It's a way that we can implement a man-in-the-middle attack using signed certificates.</p>
			<p>Fiddler can also be used to modify HTTP traffic for troubleshooting. Again, these tools are created for good, but they can end up in a user's hands to be used for evil.</p>
			<p>We also have <strong class="bold">The Onion Router</strong> (<strong class="bold">TOR</strong>). TOR is a combination of software and an open <a id="_idIndexMarker474"/>network that stops websites from tracking you. Because we can utilize the TOR network, I could set up some proxies – there are some programs out there that'll set up proxies in the TOR network for me – so that I can connect to new sites and instant messaging services if my company blocks those. It also encrypts and decrypts packets using public key encryption.</p>
			<p>We also <a id="_idIndexMarker475"/>have Proxy Switcher, which, as its name suggests, allows you to surf anonymously on the internet without showing your IP, allows you to go through several different proxies (you could get a list of available proxies) and IPs, and go through and select which ones you want to be routed through. So, it hides your IP, allowing you to access restricted sites.</p>
			<p>The Proxy Workbench <a id="_idIndexMarker476"/>program is also a handy product. With it, you can go through and get a list of free proxy servers out there and create a proxy chain. Plus, it's very graphical and has a nice GUI.</p>
			<p>So, again, I reiterate that this course, or all these courses, are not necessarily about learning about <a id="_idIndexMarker477"/>the different pieces of software. It's understanding what they can do because when you do your software inventory, your first line of defense is always knowing what's installed on people's machines. So, do a software inventory. Are they running TOR or are they running Proxy Workbench? Do they have Fiddler installed? Do they have Nmap installed? Those are going to be red flags for you.</p>
			<h2 id="_idParaDest-125"><a id="_idTextAnchor127"/>HTTP tunneling</h2>
			<p>Now, let me tell you about something that kind of scares me today regarding people getting around the security environments we set up or even our security appliances. It's called <strong class="bold">HTTP tunneling</strong>.</p>
			<p>HTTP tunneling is <a id="_idIndexMarker478"/>designed to create a tunnel with HTTP. This means that if a user can install this on their system, they fire up their system, and they normally go through our standard network. They hit our firewall, which then sends them out to the internet, and they're able to go out to the websites they want to go to. However, any type of restricted sites or services the security team has said we don't allow in our network infrastructure get blocked.</p>
			<p>That's the way things are supposed to work. It's not your network – it is the company's network. As an employee, you are getting paid to do a job, not things they deem unacceptable during company time.</p>
			<p>Well, we have <a id="_idIndexMarker479"/>all heard of a <strong class="bold">virtual private network</strong> (<strong class="bold">VPN</strong>) before, where we create a VPN between us and another machine. Some VPNs use certain ports, but the in-thing is creating a VPN tunnel using ports <strong class="source-inline">80</strong> and <strong class="source-inline">443</strong> and that's what scares me. Users fire up their machines, install a piece of software that does HTTP tunneling, and then make a connection to the firewall. The packets they pass to the internet that are trying to get to restricted websites go across via port <strong class="source-inline">443</strong> if they want to be secure while doing so. The problem is that your router will not block it because that's the port that we use to browse the internet. But as an attacker, I can encapsulate another protocol inside that HTTP packet because it's in a tunnel. I can submit that to an HTTP tunneling server, which then goes out as a proxy for me to that restricted site.</p>
			<p>As far as the IDS system and router are concerned, it's just passing port <strong class="source-inline">80</strong> but encapsulating it in FTP, and maybe you're not allowing FTP. Or it looks like it is using port <strong class="source-inline">80</strong> to go to your HTTP tunnel server website, which could be Billy Bob's site, yet they are being redirected so that they can go to some hacker's site or some inappropriate website.</p>
			<p>This is extremely <a id="_idIndexMarker480"/>hard to track. So, again, the best way you're going to detect these types of activities going on in your network is, I repeat, knowing what software is installed on each of your machines, and what it's designed to do. Why? Because for this to work, they must download some type of software that sets up this VPN solution for them.</p>
			<h2 id="_idParaDest-126"><a id="_idTextAnchor128"/>Anonymizers</h2>
			<p>We also <a id="_idIndexMarker481"/>have anonymizers, which is a way of hiding ourselves. Instead of being identified as Bruce Wayne, we get identified as John Smith. There are several tools or mechanisms we can use as anonymizers. We can circumvent our IDS systems and firewall rules and use an anonymizer to get to restricted content that may be either on the network or outside of our network. We can also use an anonymizer for protection against online attacks. If attackers don't know who we are, aren't we just using the same tools against the attackers? Absolutely! And finally, we can use it to afford us a little bit of privacy.</p>
			<p>One of the <a id="_idIndexMarker482"/>tools that we can use is <strong class="bold">Ultra Surf</strong> (<strong class="bold">U-Surf</strong>), which allows you to set up a proxy. It re-identifies you and allows you to route through a proxy to hide your identity.</p>
			<p>We also have G-Zapper. If you are a little paranoid about Google and how they're tracking you, you can use G-Zapper. It goes through and zaps the Google cookie that's on your machine so that when you go to Google, it doesn't automatically log you in, and you're able to do your searches without logging in and therefore not be tracked by Google.</p>
			<p>However, just because it's not tracking your search history doesn't mean you're completely anonymous. Other things are tracking your IP address unless you're using something such as a VPN.</p>
			<p>There's also one named <strong class="source-inline">Hide My IP</strong>. Its name tells you what it's going to do.</p>
			<p>Not to be outdone, another company came out with a similar tool. It's a Chrome extension you <a id="_idIndexMarker483"/>can install on your browser. I apologize for the name, but it's called Hide Your Ass. It's a plugin for your Chrome browser. You can go to a website but before you hit <em class="italic">Enter</em>, you can select the Hide Your Ass icon and it'll go through and make it look like your IP or request is coming from a different location, giving you some protection.</p>
			<h1 id="_idParaDest-127"><a id="_idTextAnchor129"/>Summary</h1>
			<p>In this chapter, we talked about various methods of scanning a target network. We talked about using both passive and active techniques. We also took the time to look at various scan types. You will want to make sure you've reviewed these types while studying for your exam. Remember, some are not viable on Windows-based systems. We also looked at how systems can end up identifying the operating systems they are running on by implementing a Banner Grab. Using vulnerability scanners can also generate a ton of intel on target systems. Finally, we discussed why it's important to map the network and how to hide by using proxies and proxy chains.</p>
			<p>In the next chapter, we'll focus on enumerating targets, which will expose things such as users, services, and other goodies.</p>
			<h1 id="_idParaDest-128"><a id="_idTextAnchor130"/>Questions</h1>
			<p>As we conclude, here is a list of questions for you to test your knowledge regarding this chapter's material. You will find the answers in the <em class="italic">Assessments</em> section of the <em class="italic">Appendix</em>:</p>
			<ol>
				<li value="1">Which of the following is an example of banner grabbing?<ol><li>Application research</li><li>Passive OS fingerprinting</li><li>Footprinting </li><li>Active OS fingerprinting</li></ol></li>
				<li>What are the three types of scanning?<ol><li>Gray, black, and white</li><li>Server, client, and network</li><li>Active, passive, and hybrid</li><li>Port, network, and vulnerability</li></ol></li>
				<li>What is the primary goal of performing port scans?<ol><li>Checking to see whether any routers have been patched</li><li>Finding system names</li><li>To determine where a ship may dock</li><li>Detecting services/applications that are listening</li></ol></li>
				<li>Your system has been hacked. The IP address indicated in your logs is from France, yet the originating IP address is from Brazil. Which of the following options did the attacker use?<ol><li>Hide My IP</li><li>TOR network</li><li>Proxy chain</li><li>WarpProxy</li></ol></li>
			</ol>
		</div>
	</div></body></html>