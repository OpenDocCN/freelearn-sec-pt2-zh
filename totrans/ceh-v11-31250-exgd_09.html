<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer115">
			<h1 id="_idParaDest-357"><em class="italic"><a id="_idTextAnchor366"/>Chapter 11</em>: Hacking Wireless Networks </h1>
			<p>This is a topic I'm passionate about and have a vast background and experience with. In 2001, right after 9/11, I became unemployed. I live in a rural community in northern Utah, and we didn't have a high-speed internet service. I saw a need so decided to start up my own ISP service. </p>
			<p>I rented space off the city water tower that can be seen for miles. Since there was no affordable high-speed internet, I decided to offer this service. So, I put two T1 lines into my garage and converted my garage from a standard garage to an office in a server room environment. I put an antenna on top of my roof, pointed it towards the water tower, and then put an array of antennas and <strong class="bold">access points</strong> (<strong class="bold">APs</strong>) on top of the water tower.</p>
			<p>The company grew quite fast; it was one of the fastest-growing ISP services in the Mountain West area. We grew it to 600 customers; we got so busy that we ended up having to expand our service and we had to find another cell tower. </p>
			<p>The thing about wireless is that a line of sight is critical for a strong signal. A lot of our customers couldn't get access to the internet because they didn't have a line of sight. In the case of the water tower in Syracuse, we put up several different sector-based antennas. We went and added tons of these as the company grew, including an omnidirectional antenna (we'll discuss why omnidirectional is technically not as powerful as sector-based antennas). As the company grew, we added that second tower and put in sector-based antennas as well. We were able to cover an 18 to 20 mile stretch of homes in this rapidly growing area. </p>
			<p>After growing this company, I sold it because I saw the writing on the wall; we were finally getting Comcast, which at the time was Qwest, but I think is now CenturyLink. They're doing quite well because we have these new subdivisions popping up and the commercial ISPs can't get out there fast enough. </p>
			<p>Kevin Mitnick, a famous hacker, says, <em class="italic">New security loopholes are constantly popping up because of wireless networking. The cat-and-mouse game between hackers and system administrators is still in full swing</em>. Just when you think it's safe to get back on the wireless network, we get another issue popping up. Hopefully, as you work your way through this chapter, you'll feel more prepared to deal with the rapidly growing wireless environment.</p>
			<p>In this chapter we will cover the following topics:</p>
			<ul>
				<li>The wireless network and its types</li>
				<li>The right encryption can help</li>
				<li><a id="_idTextAnchor367"/>A plethora of attack vectors</li>
				<li>Methodology of wireless hacking</li>
				<li>Hacking Bluetooth</li>
				<li>Countermeasures</li>
			</ul>
			<p>Let's begin by discussing insights into the wireless world.</p>
			<h1 id="_idParaDest-358"><a id="_idTextAnchor368"/>The wireless network and its types</h1>
			<p>The <a id="_idIndexMarker1622"/>wireless environment is constantly evolving. As such, let's begin by defining some key terms you will need to know. You've probably heard some of these terms before, but let's review some of them and what the acronyms stand for.</p>
			<h2 id="_idParaDest-359"><a id="_idTextAnchor369"/>Frequency hopping spread spectrum </h2>
			<p><strong class="bold">Frequency hopping spread spectrum</strong> (<strong class="bold">FHSS</strong>) was invented by Hedy Lamarr. She was not <a id="_idIndexMarker1623"/>only a famous Silver <a id="_idIndexMarker1624"/>Screen actress but also very intelligent. In fact, she was an inventor. It's kind of funny to watch the documentary about her. She was so beautiful that a lot of men—you must think of the time when she was around—didn't take her seriously as far as some of her inventions were concerned. </p>
			<p>FHSS was accomplished by manipulating radio frequencies at irregular intervals between transmissions and receptions, hence <em class="italic">hopping</em>. </p>
			<p>Her invention also formed an unbreakable code because it was hopping around so nobody could listen in, meaning that classified messages could be transmitted without being intercepted. Typically, FHSS operates within the 900 MHz to 2.4 GHz range. </p>
			<p>A variation of FHSS<a id="_idIndexMarker1625"/> is called <strong class="bold">adaptive frequency hopping</strong> (<strong class="bold">AFH</strong>), which<a id="_idIndexMarker1626"/> is also known <a id="_idIndexMarker1627"/>as <strong class="bold">Bluetooth</strong>. </p>
			<p>With any type of spread spectrum technology, if you have a lot of devices communicating on the exact same channel, that equals degradation of signal. So, what Hedy Lamarr did is create this technology that allows the channel or the transmission to jump between the different channels. You do this with a hop sequence. </p>
			<p>It's extremely <a id="_idIndexMarker1628"/>difficult for anybody to intercept this traffic. In fact, by looking at this information or looking at a frequency hopping environment with a spectrum analyzer, it just looks like interference. Obviously, the receiving and the sending antennas must be on the same hop count, so they know which channel they are hopping to and the next data packet transmission. </p>
			<p>The problem with FHSS is its speed limitation. It is limited to 3 MB. I know you're thinking… <em class="italic">That's slow!</em> Well, I know, but back in my day, we offered high-speed internet up to 512 KB and people thought that was blazing fast. They paid me $69 a month for it. It was great. My slowest speed was about 128 KB, and I charged $19.99. </p>
			<h2 id="_idParaDest-360"><a id="_idTextAnchor370"/>Direct sequence spread spectrum</h2>
			<p><strong class="bold">Direct sequence spread spectrum</strong> (<strong class="bold">DSSS</strong>) is probably the most popular one. It has the same channels and<a id="_idIndexMarker1629"/> the same frequencies, but <a id="_idIndexMarker1630"/>you must select which channel both the sending and the receiving antennas are going to be on, and they stay there, which obviously makes it easier for someone to intercept traffic. </p>
			<p>Because of how the channels overlay with each other, it can also create interference. You could also end up with interference from other wireless devices, such as cordless phones, microwaves, and even fluorescent lamps because they all cause interference. </p>
			<p>With these channels, people ask how I select a channel that won't interfere with another channel? Well, believe it or not, there are three sweet spots. Channel 1 does not interfere with Channel 6, and it's the same between 6 and 11. There's a separation. Some people might think, <em class="italic">Well, five would be okay because 5 doesn't necessarily interfere with 1</em>. Well, technically, in the<a id="_idIndexMarker1631"/> spectrum analyzer, that's<a id="_idIndexMarker1632"/> not a clean separation. </p>
			<h2 id="_idParaDest-361"><a id="_idTextAnchor371"/>Basic service set identifier</h2>
			<p>The <strong class="bold">basic service set identifier</strong> (<strong class="bold">BSSID</strong>) consists of<a id="_idIndexMarker1633"/> the MAC <a id="_idIndexMarker1634"/>address of the AP that has associated it with a <strong class="bold">basic service set</strong> (<strong class="bold">BSS</strong>). This is<a id="_idIndexMarker1635"/> often confused<a id="_idIndexMarker1636"/> with the <strong class="bold">service set identifier</strong> (<strong class="bold">SSID</strong>). Generally, users are unaware of the BSS to which they belong. When a user moves a device, the BSS used by the device could change because of a variation in the range covered by the AP, but this change may not affect the connectivity of the wireless device.</p>
			<p>Now, the BSSID, as I mentioned before, deals with the MAC address of that device. What happens is that the BSS address gets incremented, and that is broadcasted and used for communication in the air. If you've got a wireless network that is broadcasting on multiple bandwidths, such as <strong class="source-inline">g</strong>, <strong class="source-inline">n</strong>, <strong class="source-inline">ac</strong>, or <strong class="source-inline">ax</strong>, it gets incremented again and again so it can be used for each one of those bands. </p>
			<p>Even though you're connected to the same SSID that is supported by several APs, a device needs to know which AP to return its packets to. </p>
			<p>If you use some type of packet capturing tool, you should be able to see the wireless MAC address floating around in the air, which should flag your <em class="italic">hacking senses</em> as an issue for wireless networks. You can also see the APs broadcast in the BSSIDs. This is probably more information than you really need to know; it's just information that is floating around in my head. </p>
			<h2 id="_idParaDest-362"><a id="_idTextAnchor372"/>SSID</h2>
			<p>This is<a id="_idIndexMarker1637"/> what everybody's familiar with when it comes to wireless, right? It's <a id="_idIndexMarker1638"/>the network name; it can be up to 32 characters in length and it is attached to every single wireless packet that goes out onto the air. This is how you can have multiple APs transmitting data to different systems but dropping just as we see with a normal network environment. If the packet is not destined for that network, it gets dropped—it's the same concept, we just use this SSID because in the air, there's other information floating around, or maybe it's not information, just interference.</p>
			<h2 id="_idParaDest-363"><a id="_idTextAnchor373"/>Global System for Mobile Communications</h2>
			<p>The <strong class="bold">Global System for Mobile Communications</strong> (<strong class="bold">GSM</strong>) is an open and digital cellular <a id="_idIndexMarker1639"/>technology used for mobile<a id="_idIndexMarker1640"/> communication. It uses four different frequency bandwidths: 850 MHz, 900 MHz, 1,800 MHz, and 1,900 MHz.</p>
			<h2 id="_idParaDest-364"><a id="_idTextAnchor374"/>Hotspot</h2>
			<p>These <a id="_idIndexMarker1641"/>are places where<a id="_idIndexMarker1642"/> wireless networks are available for public use. Hotspots refer to areas with Wi-Fi availability, where users can enable Wi-Fi on their devices and connect to the internet.</p>
			<h2 id="_idParaDest-365"><a id="_idTextAnchor375"/>Association</h2>
			<p>This <a id="_idIndexMarker1643"/>simply <a id="_idIndexMarker1644"/>refers to the process of connecting a wireless device to an AP. </p>
			<h2 id="_idParaDest-366"><a id="_idTextAnchor376"/>MIMO-OFDM</h2>
			<p>This<a id="_idIndexMarker1645"/> method <a id="_idIndexMarker1646"/>affects the spectral efficiency of 4G and 5G wireless communication services. The use of MIMO-OFDM reduces interference and improves the reliability of the channel.</p>
			<h2 id="_idParaDest-367"><a id="_idTextAnchor377"/>The disadvantages of Wi-Fi</h2>
			<p>Let's start with the <a id="_idIndexMarker1647"/>negatives since they are the most significant concerns for us as wireless security experts. From a security perspective, the following are the biggest issues for us with Wi-Fi: </p>
			<ul>
				<li><strong class="bold">Upgrades</strong>: One disadvantage is, obviously, upgrades. When they come out with a new speed, we're upgrading equipment like crazy, not only at the AP level but also on the devices. Then, we have to worry about whether they're backward compatible, and of course, backward compatibility always means that we have a security risk involved. </li>
				<li><strong class="bold">Interference</strong>: Not interference from other APs, although that is a concern, but interference from other devices that have nothing to do with wireless networks. Electrical devices can interfere (for example, fluorescent lights, desk fans, and microwaves). Bluetooth devices can interfere, as can cordless phones and anything else that is kind of wireless itself, as well as anything that operates at the same signal level as your wireless devices. </li>
				<li><strong class="bold">Public access</strong>: Isn't <a id="_idIndexMarker1648"/>public access an advantage? Well, they want to make it seem that way because I can go down to McDonald's and jump onto the Wi-Fi. In fact, I happened to visit my local Walmart the other day and they had a sticker on the front door that said, <em class="italic">Free Wi-Fi at our store</em>. It seems like a good idea to most, but in my mind, I was thinking, <em class="italic">This is not good!</em> </li>
			</ul>
			<p>You've probably heard this before, but I'll say it again. Please, do yourself a favor: if you see an AP that says, <em class="italic">Free Wi-Fi</em>, don't get on it! Most of the time, those are rogue APs, (<em class="italic">Figure 11.1</em>), or an attacker trying to get you to hook into their AP. Once you do it, the attacker becomes a man in the middle who can attack you. Isn't that nice of them to give you free Wi-Fi and all they get in exchange is your bank account details? </p>
			<div>
				<div id="_idContainer104" class="IMG---Figure">
					<img src="Images/B17486_11_01.jpg" alt="Figure 11.1 – A Wi-Fi Pineapple from Hak5, a rogue AP&#13;&#10;" width="318" height="318"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.1 – A Wi-Fi Pineapple from Hak5, a rogue AP</p>
			<p>Okay, now that I've most likely let you down and you don't want to use Wi-Fi anymore, let's get to the shiny side of things here. </p>
			<h2 id="_idParaDest-368"><a id="_idTextAnchor378"/>The advantages of Wi-Fi </h2>
			<p>Here's a list of the <a id="_idIndexMarker1649"/>advantages Wi-Fi has to offer:</p>
			<ul>
				<li><strong class="bold">Installation</strong>: One of the biggest advantages is installation. Put a box up here and I've got access anywhere I want to go; I no longer rely on an Ethernet cable running through a wall or having to reroute cabling for somebody who wants to move their desk in the office. Or, if I buy the next building to expand our business, I don't have to worry about running cables across. </li>
				<li><strong class="bold">Easy connectivity</strong>: Almost everybody knows how to hook into a Wi-Fi access point or network, but give somebody a crimping tool and some cable and watch the confused look on their face. It's very easy to add devices.</li>
				<li><strong class="bold">Mobility</strong>: Being able to move around is one of my favorite advantages. As I said before, with installation, I don't have to worry about wanting to move from one room to another, especially in my home. If I want to go out on the back patio and just relax, I can take my laptop with me and sit wherever I want and still be connected. </li>
			</ul>
			<h2 id="_idParaDest-369"><a id="_idTextAnchor379"/>Types of Wi-Fi networks </h2>
			<p>Types of<a id="_idIndexMarker1650"/> Wi-Fi? Isn't it just all wireless? No, not really. Matter of fact, here's where we're going to play around with some terms because, today, we use terms such as APs. These are the different types of Wi-Fi:</p>
			<ul>
				<li><strong class="bold">Extension to networks</strong>: The first type of Wi-Fi is the extension to networks. What this means <a id="_idIndexMarker1651"/>initially is <em class="italic">APs</em>, which I have emphasized <a id="_idIndexMarker1652"/>because whenever we say APs, we have this tendency to think of the little Cisco or Linksys, or the D-Link product, for example. We envision these devices as not only APs but also switches and routers. But you can purchase an AP designed to be a bridge to wireless folks, so they gain access to the wired network. </li>
				<li><strong class="bold">LAN networks</strong>: Another<a id="_idIndexMarker1653"/> type is to have extension networks designed to communicate with each other. We refer to these as LAN-to-LAN networks<a id="_idIndexMarker1654"/> and often see this being done between buildings. </li>
				<li><strong class="bold">Multiple access point network</strong>: This <a id="_idIndexMarker1655"/>is where we have <a id="_idIndexMarker1656"/>multiple APs representing the same BSSID. So, no matter where you go within the building or the environment, your traffic is directed back to the same network. To appropriately deploy these, you need to make sure the APs overlap each other as far as coverage is concerned. This makes it so the user can move around or roam between the two connections, never losing connectivity. </li>
				<li><strong class="bold">Cellular access networks</strong>: This is <a id="_idIndexMarker1657"/>where we use cellular <a id="_idIndexMarker1658"/>service to provide access to the internet. Our phones become cellular hotspots and turn into full APs for us so when we're at the airport or out and about, we can turn on the <a id="_idIndexMarker1659"/>hotspot access on our phone and connect a laptop, tablet, or another type of device to it. </li>
			</ul>
			<h2 id="_idParaDest-370"><a id="_idTextAnchor380"/>Different Wi-Fi technologies</h2>
			<p>It all started with the 802.11 family, as explained here:</p>
			<ul>
				<li><strong class="bold">802.11</strong> (<strong class="bold">Wi-Fi</strong>): This <a id="_idIndexMarker1660"/>standard applies to WLANs and uses FHSS or DSSS as the frequency-hopping spectrum. It was developed to operate on the 2.4 GHz ISM band and supported speeds of 1 Mbps – 2 Mbps. Compared to the speeds we have now, it would take longer to download files and cause challenges with group video calls, online gaming, and streaming.</li>
				<li><strong class="bold">802.11a</strong>: This<a id="_idIndexMarker1661"/> was the first standard to use the 5 GHz range, which allowed faster speeds (up to 54 Mbps) but was really limited by its range. It also was the first time we saw OFDM being used. We mostly saw these used in the business world as the devices weren't cheap. </li>
				<li><strong class="bold">802.11b</strong>: This <a id="_idIndexMarker1662"/>used only DSSS on the 2.4 GHz band and could achieve speeds of 11 Mbps. It was better at penetrating obstacles for a wider coverage area, but its downside was interference caused by other devices such as microwaves, cordless phones, and Bluetooth devices.</li>
				<li><strong class="bold">802.11g</strong>: The <a id="_idIndexMarker1663"/>developers took the best qualities of 802.11a and 802.11b to create the 802.11g standard. It supports a networking bandwidth up to 54 Mbps and operates under the 2.4 GHz band. The devices using this standard are only capable of tapping into the standard under which they operate, which means an 802.11b computer connected to an 802.11g AP can only go as fast as what the <em class="italic">b</em> standard allows. On the flip side, a <em class="italic">g</em> device connected to a <em class="italic">b</em> AP will only go as fast as what the AP offers.</li>
				<li><strong class="bold">802.11n</strong>: Wireless-N <a id="_idIndexMarker1664"/>was developed in 2009 to improve speed and reliability, and extend the range of wireless transmissions. It was the first standard to <a id="_idIndexMarker1665"/>use <strong class="bold">multiple-input, multiple-output</strong> (<strong class="bold">MIMO</strong>) technology. MIMO products use a series of antennas to receive more data from one device at a <a id="_idIndexMarker1666"/>time, which results in faster data transmissions. In addition, it was the first to allow the usage of two radio frequencies – 2.4 GHz and 5 GHz. The use of both frequencies makes the 802.11n standard compatible with 802.11a/b/g devices. With all its improved functionalities, 802.11n supported bandwidth speeds up to 600 Mbps and had a theoretical range of 230 ft indoors, which is a huge upgrade from the previous standards.</li>
				<li><strong class="bold">802.11ac</strong>: The<a id="_idIndexMarker1667"/> fifth generation of Wi-Fi was developed to reduce interference in the 2.4 GHz band; it was developed to operate <a id="_idIndexMarker1668"/>under the 5 GHz band. Most of these devices are advertised as <strong class="bold">dual-band</strong> – but the real deal is that vendors incorporated Wireless-N technology to make ac products compatible with the 2.4 GHz band. It was also the first to<a id="_idIndexMarker1669"/> use <strong class="bold">downlink multi-user MIMO</strong> (<strong class="bold">DL MU-MIMO</strong>). It took Wireless-N MIMO technology one step further to increase data transmission even more. DL MU-MIMO allows wireless routers to transmit information to multiple devices at the same time, improving bandwidth speeds and reducing latency. With the help of Wireless-N technology, 802.11ac is compatible with 802.11a/b/g/n.</li>
				<li><strong class="bold">802.11ax</strong> (<strong class="bold">Wi-Fi 6</strong>): The new kid on the <a id="_idIndexMarker1670"/>block. It's designed to deliver faster speeds, support more devices simultaneously, decrease latency, improve security, and increase bandwidth. To do so, it includes technologies such as OFDM, MU-MIMO, and 1024-QAM. With all of its improvements, it has a theoretical maximum speed of 14 Gbps. In addition, it operates on the 2.4 and 5 GHz bands, which hasn't been done since 802.11n. This allows it to be compatible with 802.11a/b/g/n/ac. In 2021, Wi-Fi 6 will have a subcategory known<a id="_idIndexMarker1671"/> as <strong class="bold">Wi-Fi 6E</strong> (<strong class="bold">Wi-Fi 6 Extended</strong>). The FCC has made the 6 GHz frequency available, thanks to Facebook and Google championing the release of another frequency to be opened for public use. Wi-Fi 6E devices <a id="_idIndexMarker1672"/>will be able to operate on the 2.4, 5, and 6 GHz frequencies. As a result, compatible Wi-Fi devices will benefit from less congested frequency bands.</li>
			</ul>
			<p>There are other 802.11 technologies out there, but these are the ones you should focus on. </p>
			<h2 id="_idParaDest-371"><a id="_idTextAnchor381"/>Wi-Fi authentication modes</h2>
			<p>This has nothing to do with the type of encryption we're going to be utilizing. When IEEE released the 802.11 standards, they defined two different methods wireless devices could use to authenticate <a id="_idIndexMarker1673"/>to a <strong class="bold">wireless access point</strong> (<strong class="bold">WAP</strong>) before actual network communication would take place:</p>
			<ul>
				<li><strong class="bold">Open System Authentication</strong> (<strong class="bold">OSA</strong>): For OSA to work, the SSID of the computer<a id="_idIndexMarker1674"/> should match <a id="_idIndexMarker1675"/>the SSID of the WAP. First, the computer or the device sends out a probe request looking to see whether there's an AP out there with that SSID. The AP then responds with a probe response. Next, the system, computer, or device sends a request for authentication. The AP generates an authentication code, usually random, and sends it back in an open system authentication response. At this point, the device accepts that authentication code and sends an association request. Then, the AP responds with an association response, and the system becomes a part of the network as long as the session continues and the computer remains within the range of the original APs.</li>
				<li><strong class="bold">Shared key</strong>: To connect, a computer <a id="_idIndexMarker1676"/>sends a request for authentication to an AP. A <a id="_idIndexMarker1677"/>sequence of<a id="_idIndexMarker1678"/> characters, called a <strong class="bold">challenge text</strong>, is generated by the AP. The computer then encrypts the challenge text with <a id="_idIndexMarker1679"/>its <strong class="bold">Wired Equivalent Privacy</strong> (<strong class="bold">WEP</strong>) key and transmits the message back. The AP then decrypts the message and compares it to the result of the original challenge text. If there are no discrepancies, the AP sends an authentication code. The computer or the device is then able to hook into the network so long as the session stays open or if the device remains within range of the original AP. The shared key may look familiar to you because it's utilized primarily for WEP.</li>
			</ul>
			<p>So, guess what? It's time to play wireless threats, and the top-dollar question is, <em class="italic">which authentication process is the least secure?</em> Is it OSA or shared key? If you selected OSA, you would be wrong. Shared key is the least secure mechanism. The reason behind this is because the shared key is shared, it's transmitted. </p>
			<p>Even though OSA sounds like it's worse, we'll use other types of mechanisms to secure the network. </p>
			<h2 id="_idParaDest-372"><a id="_idTextAnchor382"/>Chalking – ways to identify Wi-Fi networks</h2>
			<p>Here are some <a id="_idIndexMarker1680"/>different ways we can identify Wi-Fi networks. To discover them, we can use one of the following methods:</p>
			<ul>
				<li><strong class="bold">Warwalking</strong>: This is <a id="_idIndexMarker1681"/>where we have a mobile device with us and we simply walk around a building, and it picks up APs and records information for us. </li>
				<li><strong class="bold">Warflying</strong>: This is a<a id="_idIndexMarker1682"/> relatively new concept and, with drones, it'll get even more popular. However, back in my day, they used model rockets, like the ones kids shoot and watch go up in the air. Well, some kids attached a WAP to one of them and shot it up. They picked up like a 15-mile range of WAPs as it went up and came back down. </li>
				<li><strong class="bold">Wardriving</strong>: Wardriving, as <a id="_idIndexMarker1683"/>the name suggests, is searching for wireless networks<a id="_idIndexMarker1684"/> while in a moving vehicle.</li>
			</ul>
			<p>So, after we've identified those networks, we want to make sure we can share this information. This is where <strong class="bold">warchalking</strong> came <a id="_idIndexMarker1685"/>into play. Again, this may be a little bit of a deprecated technology or concept because of what we've done in the digital age; most of the stuff now is online. But it got its start back in 2002 by a gentleman by the name of Matt Jones, and it was inspired by the Great Depression and the homeless community. </p>
			<p>When the homeless traveled, they communicated by leaving behind different marks that represented different things so other homeless travelers would know. For example, that it was okay to sleep someplace, that there was a doctor that would help them, or a policeman nearby who kept an eye out. They would make these marks these using chalk or coal to the Brotherhood. Well, guess what? It's still being utilized today, but with Wi-Fi networks; we use different symbols to identify them.</p>
			<p>Let's start off by showing you what an open and closed node symbol would look like. </p>
			<p>I bet you can't figure out which one's which (<em class="italic">Figure 11.2</em>):</p>
			<div>
				<div id="_idContainer105" class="IMG---Figure">
					<img src="Images/B17486_11_02.jpg" alt="Figure 11.2 – Open and closed nodes&#13;&#10;" width="461" height="166"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.2 – Open and closed nodes</p>
			<p>Open means it's typically free, while closed means it's somehow locked down. </p>
			<p>If it's locked down, we need to identify the encryption that's used. So, either it's a WEP encryption or a paid service. We typically list the speeds with the node identification at the bottom, and we would normally see the SSID above the representation of the node. If by chance they were doing any type of filtering, we would also use this symbol to identify that in this case here, it's a MAC filtered node. </p>
			<p>What's funny is that whenever I teach this concept, people say, <em class="italic">Dale, I've never seen any of these symbols around</em>. Well, the problem is you haven't been looking for them. </p>
			<p>Let me show you. So, what do you have here? You have an open node that's anywhere from 1 to 5 Mb, and its SSID is KYNANCE (<em class="italic">Figure 11.3</em>): </p>
			<div>
				<div id="_idContainer106" class="IMG---Figure">
					<img src="Images/B17486_11_03.jpg" alt="Figure 11.3 – Open node" width="228" height="270"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.3 – Open node</p>
			<p>Now, next<a id="_idIndexMarker1686"/> time you run into some kids (especially my grandkids) with laptops or tablets, you might want to be careful or pay attention to what they'<a id="_idTextAnchor383"/>re drawing (<em class="italic">Figure 11.4</em>): </p>
			<div>
				<div id="_idContainer107" class="IMG---Figure">
					<img src="Images/B17486_11_04.jpg" alt="Figure 11.4 – Kids with tablets" width="482" height="362"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.4 – Kids with tablets</p>
			<h2 id="_idParaDest-373"><a id="_idTextAnchor384"/>Antenna types</h2>
			<p>You<a id="_idIndexMarker1687"/> may be familiar with only one or two of these, so, I want to make sure you understand them. It's<a id="_idIndexMarker1688"/> amazing! After you study wireless, you'll start looking around as you drive, you'll start to see antennas that you never realized were there before, and they pop up in the strangest of places. </p>
			<p>What you're trying to accomplish will determine the type of antenna you want to use. </p>
			<h3>Omnidirectional antenna</h3>
			<p>An <a id="_idIndexMarker1689"/>omnidirectional antenna<a id="_idIndexMarker1690"/> is a traditional one; everybody knows about it. You have seen something that looks just like these (<em class="italic">Figure 11.5</em>). The one on the left is a commercial-grade AP that we install on top of a mast, and the thick one on the right is what we usually see on the back of our AP. </p>
			<div>
				<div id="_idContainer108" class="IMG---Figure">
					<img src="Images/B17486_11_05.jpg" alt="Figure 11.5 – Omnidirectional antenna&#13;&#10;" width="164" height="358"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.5 – Omnidirectional antenna</p>
			<p>Omnidirectional <a id="_idIndexMarker1691"/>means the signal is transmitted 360 degrees <a id="_idIndexMarker1692"/>and, by default, it's broadcasted out horizontally, meaning that our beam width starts at the antenna and moves in a horizontal direction (<em class="italic">Figure 11.6</em>):</p>
			<div>
				<div id="_idContainer109" class="IMG---Figure">
					<img src="Images/B17486_11_06.jpg" alt="Figure 11.6 – Omnidirectional antenna 360°&#13;&#10;" width="403" height="349"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.6 – Omnidirectional antenna 360°</p>
			<p>We know the signal goes out in a 360-degree pattern. Instead, if I take that antenna and encase it with something highly reflective, that's where we get sector-based antennas. Most of the time, it's just sheet metal. That sheet metal takes the signal that hits it, reflects it, and pushes behind the signal that's already going in that other direction and amplifies (<em class="italic">Figure 11.7</em>). It's kind of a cool concept when you think about it—something so simple.</p>
			<div>
				<div id="_idContainer110" class="IMG---Figure">
					<img src="Images/B17486_11_07.jpg" alt="Figure 11.7 – Sheet metal amplification" width="214" height="278"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.7 – Sheet metal amplification</p>
			<h3>Parabolic grid antenna</h3>
			<p>This is what a <a id="_idIndexMarker1693"/>parabolic grid antenna<a id="_idIndexMarker1694"/> looks like (<em class="italic">Figure 11.8</em>): </p>
			<div>
				<div id="_idContainer111" class="IMG---Figure">
					<img src="Images/B17486_11_08.jpg" alt="Figure 11.8 – Parabolic antenna&#13;&#10;" width="278" height="228"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.8 – Parabolic antenna</p>
			<p>You may have seen these quite often. You have your transmitting element in the center and the grid portion is pushing as well as receiving, almost like a big satellite dish receiving the signal and focusing it back to that center arm. </p>
			<p>These are also more powerful than omnidirectional antennas and they're typically used for long distances, such as 10 miles or more. </p>
			<h3>Yagi antenna</h3>
			<p>This is what a<a id="_idIndexMarker1695"/> Yagi antenna<a id="_idIndexMarker1696"/> looks like (<em class="italic">Figure 11.9</em>):</p>
			<div>
				<div id="_idContainer112" class="IMG---Figure">
					<img src="Images/B17486_11_09.jpg" alt="Figure 11.9 – Yagi antenna (by Tennen-Gas – own work, CC BY-SA 3.0)&#13;&#10;" width="515" height="206"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.9 – Yagi antenna (by Tennen-Gas – own work, CC BY-SA 3.0)</p>
			<p>This is used for extremely focused connectivity. With a parabolic antenna, you can be within a couple of degrees and pick up the <a id="_idIndexMarker1697"/>signal, but with a Yagi antenna, you must be exactly on. Again, this<a id="_idIndexMarker1698"/> type of antenna is for great distances. </p>
			<p>Now that we understand more about wireless signals, let's discuss next how to encrypt those signals more securely.</p>
			<h1 id="_idParaDest-374"><a id="_idTextAnchor385"/>The right encryption can help</h1>
			<p>Now that we've<a id="_idIndexMarker1699"/> deployed our wireless environment, how do we make sure things are still secure? Well, once we've identified our weakness, we'll have strength, and that's when we get dangerous. It's so true because knowing is half the battle. Understanding where your weaknesses are helps to strengthen you. </p>
			<h2 id="_idParaDest-375"><a id="_idTextAnchor386"/>WEP encryption</h2>
			<p>Believe it or not, WEP encryption<a id="_idIndexMarker1700"/> is still heavily used. But, let's not even pretend here, <strong class="bold">WEP</strong> stands for <strong class="bold">Wired Equivalent Privacy</strong>, but it's not. That was the initial goal, and we'll discuss why they didn't achieve it when they implemented or had this ratified. </p>
			<p>It was designed to protect us from digital eavesdropping and to help make sure our data was protected. </p>
			<p>It also was there to help make sure we prevented anybody from getting on the network via Wi-Fi without being authorized to do so. </p>
			<p>To prevent unauthorized access and eavesdropping, it uses a key. The key is the problem because it is used to encrypt the packets before transmission. However, this key is shared, making it kind of a nightmare for us. </p>
			<p>So, what happened? First, when they came up with WEP, it was not reviewed by any academia or any type of public review for any type of input, nor were any cryptologists able to review this technology. Back in the day, they were so desperate to get some type of encryption, the result was like people threw things together hoping they would work. As I just mentioned, one of its biggest downfalls is the pre-shared key issue. </p>
			<p>One of the reasons it wasn't strong was because of the issue they had with US restrictions on the export of various cryptography technologies. This led to manufacturers restricting their devices to only 64-bit encryption, but WEP only used a 40-bit key. When the restrictions were lifted, it was increased to 128-bit, but again, WEP ended up only using a 104-bit key size. And, even though they came out with 256-bit WEP encryption, which only uses a 232-bit key size, 128-bit remains one of those common implementations today. </p>
			<p>The other issue is the<a id="_idIndexMarker1701"/> fact that WEP used the RC4 algorithm for its encryption. The problem is that RC4 is designed for randomized keys to be encrypted, but WEP is not random at all. You create one shared key, and it's the same for everybody. The result is that WEP can be cracked if enough traffic can be intercepted. </p>
			<p>I'm not here to say that WEP is totally useless; I would much rather use WEP than nothing at all. But please, if you're using it anywhere, turn it off. Or, if you're not going to turn it off, let me know the address of your AP. I think I'd like to come to visit you! </p>
			<h2 id="_idParaDest-376"><a id="_idTextAnchor387"/>Wi-Fi Protected Access </h2>
			<p><strong class="bold">Wi-Fi Protected Access</strong> (<strong class="bold">WPA</strong>) is like<a id="_idIndexMarker1702"/> WEP all grown up, with its big boy pants on. Well, it has given us better protection than we experienced with WEP. It was formally adopted back in 2003, which was about a year before WEP was officially retired. So, it was designed to patch the issues we had with WEP. </p>
			<p>The most common WPA configuration is using a<a id="_idIndexMarker1703"/> WPA <strong class="bold">pre-shared key</strong> (<strong class="bold">PSK</strong>). These keys are 256 bits, which is much stronger than the 64-bit and 128-bit keys we saw with WEP. </p>
			<p>One of the biggest changes in implementing WPA included a <strong class="bold">message integrity check</strong> (<strong class="bold">MIC</strong>). What we <a id="_idIndexMarker1704"/>mean by that, in non-geek terms, is the ability to check to see if an attacker had captured or altered the packets as it was passing from the AP to the client. </p>
			<p>We do that with <a id="_idIndexMarker1705"/>the <strong class="bold">Temporal Key Integrity Protocol</strong> (<strong class="bold">TKIP</strong>). What's TKIP? Well, under TKIP, a client starts with a 128-bit temporal key that is then combined with the client's MAC address. Once the TKIP has been created, it wraps itself around WEP because that's all WPA is—fixing WEP—and then unique encryption keys are created for each wireless frame, creating a more secure network connection. </p>
			<p>However, despite the improvement WPA gives us over WEP, the ghost of WEP still haunts WPA. The <a id="_idIndexMarker1706"/>cool thing about WPA back in the day is it didn't require you to go off and buy new hardware. It was simply a firmware upgrade on the networking devices. But here's the downside to it: because it had to recycle certain elements used in WEP, it ended up creating exploits. In fact, today, WPA by itself is not considered secure, just like WEP. </p>
			<h2 id="_idParaDest-377"><a id="_idTextAnchor388"/>WPA2</h2>
			<p>Then, along came our<a id="_idIndexMarker1707"/> big brother, WPA2, which created much stronger protection for us. </p>
			<p>WPA comes in two different types. </p>
			<h3>WPA-Personal</h3>
			<p>The first type of <a id="_idIndexMarker1708"/>WPA is referred to as WPA-Personal. It uses a PSK, a 256-bit key for encryption, and the encryption is based on anywhere from 8 to 63 ASCII characters. </p>
			<p>You have probably set up an AP before where you've gone through and created a passcode or a passphrase for your wireless network. Well, it's those characters that are used to help create that 256-bit key. </p>
			<p>If you think you're safe because you are using WPA2, think again, because some of the same vulnerabilities that were the big hole in WPA armor exist with WPA2. </p>
			<p>If on your Wi-Fi routers you're<a id="_idIndexMarker1709"/> using <strong class="bold">Wi-Fi Protected Setup</strong> (<strong class="bold">WPS</strong>), it's that little button. All you must do is hit this button and you'll get your device to hook right up. WPS is burnt into the firmware, it doesn't change or rotate, and it's a code. </p>
			<p>I could still try to break into your WPA2 network by using brute force attacks and it could take anywhere from several hours to a couple of days, maybe even a week. However, if I go after your WPS, this vulnerability can be hacked by some software called Reaver. I can crack that in anywhere from 2 to 14 hours depending on my system. So, if you can, try to disable WPS.</p>
			<h3>WPA2-Enterprise</h3>
			<p>This other <em class="italic">flavor</em> of <a id="_idIndexMarker1710"/>WPA2 is referred to as WPA2-Enterprise. WPA2-Enterprise addresses the concerns regarding the distribution and management of those static passphrases. It's the control access on a per-account basis by tying into some<a id="_idIndexMarker1711"/> type of <a id="_idIndexMarker1712"/>authentication service. Those are typically handled by either the <strong class="bold">Extensible Authentication Protocol</strong> (<strong class="bold">EAP</strong>) or the <strong class="bold">Remote Authentication Dial-In User Service</strong> (<strong class="bold">RADIUS</strong>). </p>
			<p>This mode requires credentials such as a user's name, a certificate, and maybe a one-time password. The authentication occurs between the station and this centralized authenticating server. </p>
			<p>The AP or the wireless controller simply monitors the connection and directs the authentication packets to the authentication server. Typically, this is going to be a RADIUS box. </p>
			<p>This is all based on the<a id="_idIndexMarker1713"/> enterprise environment, using the <strong class="bold">Advanced Encryption Standard</strong> (<strong class="bold">AES</strong>) with the <strong class="bold">Cipher Block Chaining MAC Protocol</strong> (<strong class="bold">CCMP</strong>), which<a id="_idIndexMarker1714"/> is extremely strong compared<a id="_idIndexMarker1715"/> to <strong class="bold">Rivest Cipher 4</strong> (<strong class="bold">RC4</strong>). </p>
			<h2 id="_idParaDest-378"><a id="_idTextAnchor389"/>WPA3</h2>
			<p>Let's take a <a id="_idIndexMarker1716"/>look at advances that have been made in our newest WPA version. WPA3 has capabilities necessary to support various deployment sizes that range from large corporate network environments down to a simple home network.</p>
			<p>It uses encryption algorithms such as AES and TKIP, which help to ensure cryptographic consistency, and it has enhanced network resilience by using <strong class="bold">protected management frames</strong> (<strong class="bold">PMF</strong>) to <a id="_idIndexMarker1717"/>deliver a strong defense against eavesdropping and forging attacks. It rejects outdated legacy protocols. Some pretty cool stuff – and it's about time. </p>
			<h3>How it relates to WPA 2</h3>
			<p>First, WPA3's <a id="_idIndexMarker1718"/>encryption/authentication security protocol is stronger and builds upon the security protocols in WP2. In this new version, there have been advancements that provide cutting-edge features to simplify Wi-Fi security. One of the reasons it's stronger is that it can be used to implement a layered security strategy that can protect all aspects of a Wi-Fi network. WPA2 was not able to protect users' passwords through the use of an offline dictionary attack if someone had enough time and processing power. Attackers would have to gain access to the password through a brute force attack by checking all possible combinations. In WPA3, passwords are encrypted through an improved key handshake protocol. The Dragonfly handshake/<strong class="bold">Society of Automotive Engineers</strong> (<strong class="bold">SAE</strong>) protocol<a id="_idIndexMarker1719"/> is mandatory for WPA3 certification, and this reduces the risk of a dictionary attack. </p>
			<p>It's important to note <a id="_idIndexMarker1720"/>that the new authentication process requires devices to be in close physical proximity to the router, which means that your neighbor can't hack your wireless network if they aren't close to your house.</p>
			<p>Just like WPA2, WPA3 also comes in two operation modes (Personal and Enterprise). If you have a device that doesn't support WPA3, the network will stay in WPA2 mode. </p>
			<h2 id="_idParaDest-379"><a id="_idTextAnchor390"/>Weak initialization vectors </h2>
			<p>So, if things are<a id="_idIndexMarker1721"/> encrypted, how do we break that encryption? Well, that's going to depend on the type of encryption you're using. When it comes to WEP, one of the biggest issues we have is the feeble <strong class="bold">initialization vectors</strong> (<strong class="bold">IVs</strong>) that <a id="_idIndexMarker1722"/>are out there. </p>
			<p>First is the fact that WEP uses RC4. While RC4 itself isn't weak, the problem is how WEP uses RC4. It utilizes it using <a id="_idIndexMarker1723"/>a <strong class="bold">key scheduling algorithm</strong> (<strong class="bold">KSA</strong>) to create the IV and it is added to the base key.</p>
			<p>Unfortunately, the first few bits are clear text, so it becomes very easy to predict what the IVs are going to be. Therefore, if I intercept enough traffic with WEP, I'll be able to figure out what your key is. </p>
			<p>The other issue is the IVs are not explicit. They're reused over and over on your devices. So, if you get one key, you have everything. It's like <em class="italic">one ring to rule them all</em>. </p>
			<p>Another weakness in the IV is the IV itself is appended to the beginning of the security key, which makes it<a id="_idIndexMarker1724"/> vulnerable to <strong class="bold">Fluher, Mantin, and Shamir</strong> (<strong class="bold">FMS</strong>) attacks. It takes advantage of the weaknesses in the RC4 key scheduling algorithm to reconstruct the messages to determine what the key is, and we do this with simple scripts. It's so simple. In fact, a lot of the tools we use for hacking wireless networks, such as Aircrack-ng and AirSnort, can exploit this type of weakness. </p>
			<p>Another weakness<a id="_idIndexMarker1725"/> in the IV is the fact there's no way to detect that the message has been tampered with. There might be some other methods, such as check values, that can look at the message integrity, but they have their own drawbacks as well. </p>
			<p>One of the most critical weaknesses is probably the use of short IVs. Basically, within a few hours of traffic—I can simulate the traffic to speed the timeframe up—the same IV will repeat itself. And, I can see those repeats using sniffing tools, capture the encrypted packets with the same key, and then use a tool such as Aircrack-ng or WEPCrack to decrypt the weak IV, which would then give me the base key. Again, the base key is the base key for everyone. So, knowing that these IVs exist, it's very easy to crack WEP. </p>
			<p>Now, because WPA is basically a grownup version of WEP, it does make it a little bit tougher, but I can still brute force attack it if I'm able to capture enough packets. </p>
			<p>The same applies to doing an offline attack. To implement this, we must be near the AP—only for a matter of seconds—to capture the WPA and the WPA2 authentication handshake. By capturing the right number of packets, we can then try to crack this offline. </p>
			<p>The biggest advantage an attacker has is time. As an attacker, I don't have to sit there and be on your network consistently. </p>
			<p>If you want to get tricky, we can do something called a de-authentication attack. With this, I'll find an active client and force them off or disconnect them from the AP. I'll then use some of my tools to capture the authentication packet when the client tries to reconnect to the AP, which normally happens within just a few seconds of it being disconnected. That authentication packet includes <a id="_idIndexMarker1726"/>the <strong class="bold">Pairwise Master Key</strong> (<strong class="bold">PMK</strong>), which I can then brute force or dictionary attack to recover the WPA key. And, just like WEP, we can brute force the WPA keys. </p>
			<p>Some of the tools we utilize for this process include Aircrack-ng, KisMAC, and Reaver, which grabs the WPS. </p>
			<h2 id="_idParaDest-380"><a id="_idTextAnchor391"/>Security measures</h2>
			<p>Okay, it sounds like we<a id="_idIndexMarker1727"/> should just never use Wi-Fi now. Well, no, that's not really what I'm saying, because we can do some things to defend ourselves against cracking on wireless.</p>
			<p>Again, there is nothing that is completely secure but knowing what your risks are helps to make you stronger or safer. So, let's talk about how implementing some very basic things can beef up your security. Most people have the tendency of overlooking them, yet they can help you in securing your wireless network. </p>
			<p>If you make the <strong class="bold">passphrases</strong> in WPA complicated, make them long as well. Get a passphrase with 20 <a id="_idIndexMarker1728"/>characters, if not longer. Don't use real words that can be found in a dictionary. </p>
			<p>Lastly, look at the client settings. Use WPA2 with AES and <strong class="bold">cipher block chaining</strong> (<strong class="bold">CCM</strong>) encryption <a id="_idIndexMarker1729"/>only. Also, when it comes to the client settings for the validation server, make sure you use a specific server address. </p>
			<p>Next, let's discuss threats from wireless technology.</p>
			<h1 id="_idParaDest-381"><a id="_idTextAnchor392"/>A plethora of attack vectors </h1>
			<p>Wireless is a<a id="_idIndexMarker1730"/> great technology. So, how do we evaluate the threats, or the possibility of threats, that we expose our networks to? </p>
			<p>Let's look at some of the integrity attacks you could be a victim of. They can be summed up in several different categories. </p>
			<h2 id="_idParaDest-382"><a id="_idTextAnchor393"/>Access control attacks</h2>
			<p>These <a id="_idIndexMarker1731"/>types of attacks are designed to <a id="_idIndexMarker1732"/>gain access to your network without your wireless security solutions detecting them or being able to bypass them altogether: </p>
			<ul>
				<li><strong class="bold">Wardriving</strong> – This is basically driving <a id="_idIndexMarker1733"/>around and using a device to search for the web<a id="_idIndexMarker1734"/> beacons; these are little packets in the air that make it so your authorized devices know they're in range of your SSID. I personally use PassMark's WirelessMon, but other tools include Kismet, inSSIDer, and the classic NetStumbler.</li>
				<li><strong class="bold">Rogue APs</strong> – We'll <a id="_idIndexMarker1735"/>dive into this one a little later, but, for now, let's<a id="_idIndexMarker1736"/> just describe them as unauthorized APs that a hacker brings into your environment.</li>
				<li><strong class="bold">MAC spoofing</strong> – MAC spoofing<a id="_idIndexMarker1737"/> occurs when an attacker searches a network for<a id="_idIndexMarker1738"/> legitimate MAC addresses and then seeks to access and take control.</li>
				<li><strong class="bold">AP misconfiguration</strong> – Yep, it's an <a id="_idIndexMarker1739"/>AP that is configured incorrectly, either by <a id="_idIndexMarker1740"/>the lack of knowledge or failing to configure something, for example, by using default settings.</li>
				<li><strong class="bold">Ad-Hoc connection</strong> – This is <a id="_idIndexMarker1741"/>again a way for an attacker to connect<a id="_idIndexMarker1742"/> directly with your devices without an AP and then piggyback off your connection into your network, kind of like a NAT connection of sort.</li>
				<li><strong class="bold">Promiscuous mode client</strong> – Attackers take advantage of the fact that your device will <a id="_idIndexMarker1743"/>connect to the strongest signal, which could be their<a id="_idIndexMarker1744"/> fake AP, and then forward your requests to the real AP; this is like an evil twin attack.</li>
				<li><strong class="bold">Client misconfiguration</strong> – Remember <a id="_idIndexMarker1745"/>the AP misconfiguration we just talked about? Same <a id="_idIndexMarker1746"/>concept here, but on the client device instead.</li>
				<li><strong class="bold">Unauthorized connection</strong> – These<a id="_idIndexMarker1747"/> are unauthorized clients that <a id="_idIndexMarker1748"/>connect to your APs. An attacker can gain access to your network through your APs if the security is weak. </li>
			</ul>
			<h2 id="_idParaDest-383"><a id="_idTextAnchor394"/>Integrity attacks</h2>
			<p>Let's look at some of the <a id="_idIndexMarker1749"/>integrity attacks<a id="_idIndexMarker1750"/> you could be a victim of. They can be summed up in several different categories: </p>
			<ul>
				<li><strong class="bold">Data frame injection</strong> – This is<a id="_idIndexMarker1751"/> where we construct <a id="_idIndexMarker1752"/>and send out forged wireless frames on the network. </li>
				<li><strong class="bold">WEP injection</strong> – If <a id="_idIndexMarker1753"/>you've been around wireless at all, you probably<a id="_idIndexMarker1754"/> understand what this is. Basically, we construct and distribute forged WEP encryption keys. </li>
				<li><strong class="bold">Bit flipping attack</strong> – This is<a id="_idIndexMarker1755"/> where the attacker sniffs a frame on the<a id="_idIndexMarker1756"/> wireless network. The attacker transmits the modified frame, and the AP accepts the modified frame, but when the destination receiver goes to decapsulate the frame, the checksum fails, and the receiver generates a <a id="_idIndexMarker1757"/>predictable <strong class="bold">Internet Control Message Protocol</strong> (<strong class="bold">ICMP</strong>) error. The attacker simply sniffs the network LAN looking for the encryption error and, upon receiving the message of the error, the attacker can derive the keystream, which is the same thing we do with the IV replay attack. </li>
				<li><strong class="bold">Data replay</strong> – This is where we <a id="_idIndexMarker1758"/>simply capture the data frames and <a id="_idIndexMarker1759"/>replay the frames later.</li>
				<li><strong class="bold">RADIUS replay</strong> – This<a id="_idIndexMarker1760"/> is where we capture the communication channel<a id="_idIndexMarker1761"/> between the AP and the authentication server. Remember we talked about RADIUS servers? We can later replay that interaction to see if we can gain access. </li>
				<li><strong class="bold">Wireless network viruses</strong> – Believe it<a id="_idIndexMarker1762"/> or not, these are <a id="_idIndexMarker1763"/>wireless network viruses. These aren't viruses that target computers and nodes; they target APs. One of the most popular ones is called Chameleon. When it attacks an AP, it doesn't affect how it works. Instead, it is able to collect and report the credentials of all other Wi-Fi users who are connected to it, and it can spread to other APs outside your wireless infrastructure. So yeah, your neighbor's AP could infect your AP. </li>
			</ul>
			<h2 id="_idParaDest-384"><a id="_idTextAnchor395"/>Confidentiality attacks</h2>
			<p>These <a id="_idIndexMarker1764"/>attacks are designed to intercept <a id="_idIndexMarker1765"/>sensitive data. I told you it was going to get scary! These attacks include the following:</p>
			<ul>
				<li><strong class="bold">Eavesdropping</strong> – This is<a id="_idIndexMarker1766"/> where we're going to capture and look at <a id="_idIndexMarker1767"/>traffic to see if we can obtain any type of potentially sensitive information. </li>
				<li><strong class="bold">Traffic analysis</strong> – This <a id="_idIndexMarker1768"/>can tell us quite a bit about the network<a id="_idIndexMarker1769"/> infrastructure. </li>
				<li><strong class="bold">Cracking WEP</strong> – This is<a id="_idIndexMarker1770"/> another confidentiality attack. Just by capturing data, we <a id="_idIndexMarker1771"/>can try to recover the WEP key using either brute force or an FMS cryptanalysis.</li>
				<li><strong class="bold">Evil twin AP</strong> – This is<a id="_idIndexMarker1772"/> probably the most notorious. Here, you basically pose as an <a id="_idIndexMarker1773"/>authorized AP by using the same SSID, and hopefully, users hook into your AP mistakenly.</li>
				<li><strong class="bold">Honeypot AP</strong> – This is <a id="_idIndexMarker1774"/>simply where an AP SSID is set up to be the <a id="_idIndexMarker1775"/>same as a legitimate AP.</li>
				<li><strong class="bold">Session hijacking</strong> – This is very similar to what we see with the wired network, but<a id="_idIndexMarker1776"/> it's<a id="_idIndexMarker1777"/> where we manipulate the network, so the attacker's host appears to be the desired destination. </li>
				<li><strong class="bold">Masquerading</strong> – Is this <a id="_idIndexMarker1778"/>where we run around the office in a costume? No, this <a id="_idIndexMarker1779"/>is where you pretend to be an authorized user to gain access to a system. </li>
				<li><strong class="bold">Man-in-the-middle attack</strong> – This is <a id="_idIndexMarker1780"/>simply a network, but <a id="_idIndexMarker1781"/>instead of wires, we use wireless. If you're not familiar with the concept of man-in-the-middle, I recommend looking up the chapter on sniffing. </li>
			</ul>
			<h2 id="_idParaDest-385"><a id="_idTextAnchor396"/>Availability attacks</h2>
			<p>These<a id="_idIndexMarker1782"/> attacks<a id="_idIndexMarker1783"/> include the following:</p>
			<ul>
				<li><strong class="bold">AP theft</strong> – Yep, that <a id="_idIndexMarker1784"/>will stop you and your users from having network<a id="_idIndexMarker1785"/> access.</li>
				<li><strong class="bold">Disassociation attack</strong> – This is <a id="_idIndexMarker1786"/>another type of availability <a id="_idIndexMarker1787"/>attack, and it is where we basically go and destroy the connection between the client and the AP and make the AP totally unavailable. </li>
				<li><strong class="bold">EAP failures</strong> – In this <a id="_idIndexMarker1788"/>case, we look at valid 802.1x EAP exchanges and <a id="_idIndexMarker1789"/>then send the client a forged EAP failure message. Again, they would disassociate. </li>
				<li><strong class="bold">Beacon flooding</strong> – Here, in <a id="_idIndexMarker1790"/>order to take away the <a id="_idIndexMarker1791"/>availability of the AP, the attacker generates hundreds or thousands of counterfeit 802.11 beacons and distributes them in the air, making it harder for the client to find a legitimate AP. </li>
				<li><strong class="bold">Denial-of-Service attack</strong> (<strong class="bold">DoS</strong>) – If I <a id="_idIndexMarker1792"/>send forged <a id="_idIndexMarker1793"/>authentications or associations from random MACs, I'll end up doing an authorization flood, and you are going to have a very bad day!</li>
				<li><strong class="bold">Deauthentication flood</strong> – This is<a id="_idIndexMarker1794"/> where we flood clients<a id="_idIndexMarker1795"/> instead of the AP with forged deauthentication or deassociation to disconnect them from the AP. </li>
				<li><strong class="bold">Routing attacks</strong> – This is <a id="_idIndexMarker1796"/>where we mess up the routing tables or even try to <a id="_idIndexMarker1797"/>poison the routes and distribute that information throughout the network via the AP. </li>
				<li><strong class="bold">Authentication flood</strong> – The<a id="_idIndexMarker1798"/> attacker sends your AP so many <a id="_idIndexMarker1799"/>fake authentication packets with random MAC that your AP's association table fills up, kind of like a MAC flood. Cool, huh?</li>
				<li><strong class="bold">ARP poisoning</strong> – This is <a id="_idIndexMarker1800"/>the same thing we do on the wired network. It's also<a id="_idIndexMarker1801"/> one of our first steps in performing the man-in-the-middle attack. </li>
				<li><strong class="bold">Power saving attack</strong> – APs will <a id="_idIndexMarker1802"/>buffer all inbound data for a client <a id="_idIndexMarker1803"/>that is in sleep mode until the client pulls the AP for its data when it wakes up. By spoofing the polling message on behalf of the client, an attacker can cause the AP to discard the client's packets while it is asleep, which basically causes a DoS.</li>
				<li><strong class="bold">TKIP MIC exploit</strong> – This is <a id="_idIndexMarker1804"/>basically where we, as an attacker, generate<a id="_idIndexMarker1805"/> a bunch of TKIP data that exceeds the target's MIC error threshold. By exceeding that threshold, we shut down the AP. </li>
			</ul>
			<h2 id="_idParaDest-386"><a id="_idTextAnchor397"/>Authentication attacks</h2>
			<p>The goal <a id="_idIndexMarker1806"/>of authentication attacks<a id="_idIndexMarker1807"/> is to steal the identities of Wi-Fi clients, their personal information, and their login credentials, so that the attackers can get into network resources without permission:</p>
			<ul>
				<li><strong class="bold">PSK cracking</strong> – Using<a id="_idIndexMarker1808"/> tools such as KisMAC or coWPAtty, we can recover <a id="_idIndexMarker1809"/>WPA PSK data from the key handshake frames.</li>
				<li><strong class="bold">Lightweight EAP</strong> (<strong class="bold">LEAP</strong>) <strong class="bold">cracking</strong> – Attackers<a id="_idIndexMarker1810"/> can use <a id="_idIndexMarker1811"/>dictionary attacks to recover user credentials from LEAP packets.</li>
				<li><strong class="bold">VPN cracking</strong> – Tools <a id="_idIndexMarker1812"/>such as Anger or THC-PPTP bruter can access<a id="_idIndexMarker1813"/> users' credentials or IPSec <strong class="bold">pre-shared keys</strong> (<strong class="bold">PSK</strong>) via a <a id="_idIndexMarker1814"/>brute-force attack.</li>
				<li><strong class="bold">Domain login cracking</strong> – Here we <a id="_idIndexMarker1815"/>can use a password cracking tool <a id="_idIndexMarker1816"/>like John the Ripper to crack passwords and gain acces.</li>
				<li><strong class="bold">Key reinstallation attack</strong> – Attackers<a id="_idIndexMarker1817"/> prey on the four-way <a id="_idIndexMarker1818"/>handshake of WPA2 to gain access.</li>
				<li><strong class="bold">Identity theft</strong> – This is<a id="_idIndexMarker1819"/> one of my favorites. It is where we capture <a id="_idIndexMarker1820"/>users' identities from clear text 802.11x ID response packets.</li>
				<li><strong class="bold">Shared key guessing</strong> – Remember WEP? Well, cracking WEP using the vendor default <a id="_idIndexMarker1821"/>WEP key is a<a id="_idIndexMarker1822"/> classic example of this one, or just outright cracking the WEP key.</li>
				<li><strong class="bold">Password assumption</strong> – Here, the <a id="_idIndexMarker1823"/>attacker captures <a id="_idIndexMarker1824"/>identities; they continually attempt using 802.1X authentication to try to guess the user's password. </li>
				<li><strong class="bold">Application login theft</strong> – This is <a id="_idIndexMarker1825"/>another one of my favorites. It is <a id="_idIndexMarker1826"/>where we capture users' credentials from cleartext application protocols. Most of us use the same password for the application as our login credentials, as well as to gain access to our wireless network. You didn't think about that one, did you?</li>
			</ul>
			<h2 id="_idParaDest-387"><a id="_idTextAnchor398"/>Attacks on the APs</h2>
			<p>Let's look<a id="_idIndexMarker1827"/> at some of the <a id="_idIndexMarker1828"/>possible AP attacks:</p>
			<ul>
				<li><strong class="bold">Rogue AP attack</strong> – A rogue AP<a id="_idIndexMarker1829"/> is simply a device that isn't sanctioned by <a id="_idIndexMarker1830"/>an administrator but is operating on the network. </li>
			</ul>
			<p>Sometimes, these rogue APs are deployed by employees who just want better reception. But from the attacker's perspective, they set up a rogue AP and place it near the target network. When the user turns their computer on, the rogue AP offers up a <a id="_idIndexMarker1831"/>connection to the user's <strong class="bold">wireless network interface controller</strong> (<strong class="bold">WNIC</strong>). </p>
			<p>If the user connects to the rogue AP as the legitimate AP, it's going to try to authenticate itself, and therefore, the rogue AP picks up that whole communication channel. </p>
			<ul>
				<li><strong class="bold">Unauthorized association</strong> – The<a id="_idIndexMarker1832"/> attacker installs a soft AP, which<a id="_idIndexMarker1833"/> is an AP program that runs via software and turns the laptop into an AP. Now, if successful, other machines might hook into that AP, and the attacker would be able to capture that information. </li>
				<li><strong class="bold">Honeypot AP attacks</strong> – This is<a id="_idIndexMarker1834"/> where the attacker creates an<a id="_idIndexMarker1835"/> AP that has the same type of SSIDs as some of these retail locations, and because the signal may be stronger because I'm sitting next to you, you'll connect to me. </li>
				<li><strong class="bold">AP MAC spoofing</strong> – I'm <a id="_idIndexMarker1836"/>sure you can figure out what this is. We <a id="_idIndexMarker1837"/>have our network infrastructure, we have our wireless systems running, and the attacker just simply comes in and spoofs the MAC address of an AP in the hope that somebody hooks up to them. Now, let's see, when would this also come into play? Let's say that you're on a transportation device that flies through the air, and they happen to provide wireless internet on your transportation device. Most of these are paid services and a legitimate user might log in with their laptop, and most of the access is controlled by MAC addresses, so the AP says, <em class="italic">Oh, yes, I allow this particular MAC address onto the network</em>. </li>
			</ul>
			<p>Somebody who <a id="_idIndexMarker1838"/>may be curious—not saying I may or may not <a id="_idIndexMarker1839"/>have done this before—but an attacker could simply duplicate the MAC address and be allowed access to the network. I know you're already thinking, <em class="italic">I'd better look to see if Dale's on my flight!</em> </p>
			<h2 id="_idParaDest-388"><a id="_idTextAnchor399"/>Attacks on clients </h2>
			<p>These<a id="_idIndexMarker1840"/> are simple, and we'll start off with the most basic:</p>
			<ul>
				<li><strong class="bold">DoS</strong> – Under normal<a id="_idIndexMarker1841"/> circumstances, we<a id="_idIndexMarker1842"/> have our systems that are hooked up to our WAPs. To just totally mess up the network infrastructure, the attacker might send a deauthentication packet to the node, which basically shuts off its wireless—no longer associated with the AP. It's a simple attack. </li>
				<li><strong class="bold">Ad hoc attack</strong> – A lot of<a id="_idIndexMarker1843"/> devices, such as laptops, have both Wi-Fi and<a id="_idIndexMarker1844"/> Ethernet cabling built into them. So, a user comes in and, for better communication on the network, they click into their RJ45 connection. <em class="italic">Ad hoc</em> means a one-to-one relationship, so the attacker simply comes in and creates an ad hoc connection to your laptop and then can pass through and gain access to the network. So, Super Dale rule number 583 reads, <em class="italic">Turn off your Wi-Fi if you're hooked in through Ethernet</em>. </li>
				<li><strong class="bold">Jamming</strong> – Traffic jam? No. How<a id="_idIndexMarker1845"/> about a paper jam? No. How about jamming<a id="_idIndexMarker1846"/> with your favorite band? Yes, that's me with Collective Soul. However, the jamming we're talking about here is where we have a WAP, and we deny services. I sometimes wish I had a mobile jammer that I could turn on in the movie theater for those youngsters who talk on their phones or text during the movie. Yes, you can buy a device like this off the internet. </li>
			</ul>
			<p>Jamming is <a id="_idIndexMarker1847"/>extremely popular, especially when it comes to dealing<a id="_idIndexMarker1848"/> with criminal activities. This is a jammer that does several frequencies including, not only cell but Wi-Fi, Bluetooth—everything (<em class="italic">Figure 11.10</em>): </p>
			<div>
				<div id="_idContainer113" class="IMG---Figure">
					<img src="Images/B17486_11_10.jpg" alt="Figure 11.10 – Using a Wi-Fi Pineapple as a jammer&#13;&#10;" width="792" height="315"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.10 – Using a Wi-Fi Pineapple as a jammer</p>
			<p>Next, let's talk about the methods we use in wireless hacking.</p>
			<h1 id="_idParaDest-389"><a id="_idTextAnchor400"/>Methodology of wireless hacking</h1>
			<p>Believe it or not, there <a id="_idIndexMarker1849"/>is a methodology when it comes to hacking wireless networks. </p>
			<h2 id="_idParaDest-390"><a id="_idTextAnchor401"/>Step 1: Wi-Fi discovery</h2>
			<p>This is the <a id="_idIndexMarker1850"/>first step in the methodology of hacking wireless networks. We always look at this the same way we do with standard networks—that we need to first see what's going on around the environment itself. If you remember, one of the first steps is the process of footprinting or reconnaissance. All we're doing is looking around. </p>
			<p>I like to refer to this process as a <em class="italic">looky-loo</em>. If you're not familiar with that term, I'll give you a description. In my state it just so happens if you're driving down the freeway and there's an accident on the other side and you can't see it, you're required to slow down and see if you can see what's going on, thereby slowing down traffic on the opposite side, which is nothing but totally frustrating and creates some road rage. We refer to those folks as looky-loos. </p>
			<p>If you <a id="_idIndexMarker1851"/>remember, when it comes to footprinting, this is simply where we're trying to locate and understand the network itself. We do that in a couple of different ways: </p>
			<ul>
				<li><strong class="bold">Passive method</strong> – This is one of the ways you can use it. Passive is just sniffing the airwaves, seeing what's there. We're not hitting anybody or trying to connect with any AP, we're just looking at the airwaves themselves. </li>
				<li><strong class="bold">Active method</strong> – This is obviously a little bit more intrusive. I could send out a probe request with an SSID to see if an AP responds. </li>
			</ul>
			<p>Either way, to accomplish footprinting, you'll need a couple of things. You'll need applications, including desktop applications, and some of the newer ones based on mobile. </p>
			<p>Some of the more common desktop applications<a id="_idIndexMarker1852"/> include <strong class="bold">Insider</strong>, which is an open source, multi-platform Wi-Fi scanning software. It gives the attacker information such as the proper channeling of wireless networks, signal strength if the AP is filtered, and of course, we can export the Wi-Fi GPS data out to an XML file that we can then use inside Google Earth. </p>
			<p>Another product out there is <a id="_idIndexMarker1853"/>called <strong class="bold">NetSurveyor</strong>. This is a network discovery tool used to find WAPs in real time. It's a little bit more GUI as far as its interface is concerned, so it's a little prettier. </p>
			<p>WiGLE.net is one of my favorites. It is an open platform and a website for collecting information about different wireless hotspots around the world. It started back in 2000, and by 2013, it had over 170 million recorded Wi-Fi networks in its database. Out of that 170 million, 105 million have GPS coordinates.</p>
			<p>We also have Kismet. This is a layer 2 wireless network detector, sniffer, and IDS environment. There are probably more by now; it's like they're coming out daily.</p>
			<h2 id="_idParaDest-391"><a id="_idTextAnchor402"/>Step 2: Wireless traffic analysis</h2>
			<p>After <a id="_idIndexMarker1854"/>discovering our wireless networks, and using our GPS mapping to get their locations, the next step is doing wireless traffic analysis and determining any vulnerabilities that may be in the network. Tools such as <a id="_idIndexMarker1855"/>PRTG Network Monitor (<a href="https://www.paessler.com/howto-free-network-monitoring">https://www.paessler.com/howto-free-network-monitoring</a>) and Microsoft's Wi-Fi Analyzer and<a id="_idIndexMarker1856"/> Scanner (<a href="https://www.microsoft.com/en-us/p/wifi-analyzer-and-scanner/9nblggh5qk8q">https://www.microsoft.com/en-us/p/wifi-analyzer-and-scanner/9nblggh5qk8q</a>) are great solutions, and there are also several tools available on the mobile apps stores.</p>
			<p>We're <a id="_idIndexMarker1857"/>going to do this in a couple of different ways. The first thing we'll do is look for vulnerabilities. This can be done just like we normally do on our wired networks. Again, our whole purpose is to determine an appropriate strategy for attacking the network. </p>
			<p>The other thing you need to remember, and I've mentioned it a couple of times, is this is wireless, so traffic itself is just flowing through the air and it isn't serialized, which makes it extremely easy to sniff and analyze the packets. </p>
			<h2 id="_idParaDest-392"><a id="_idTextAnchor403"/>Step 3: In-depth reconnaissance</h2>
			<p>The next <a id="_idIndexMarker1858"/>step of the attack is doing a little bit more in-depth reconnaissance. We'll be looking for SSIDs, whether they're hidden or being broadcasted. We'll also look at APs—like how many there are, the encryption being utilized, as well as the authentication they're trying to use. </p>
			<p>Why do we need to know how many APs they have? Well, two-fold. First, it gives us a layout of the network infrastructure itself. However, more importantly, I'm going to be looking to see if all the APs have been patched. Often, when companies have multiple APs, they may do firmware upgrades for one or two, but they may forget one, and that could be my door into their network. </p>
			<p>There are more cool tools out there that will help us to determine all these reconnaissance requirements or issues. Those include things we've already seen including Wireshark; because packets are going through the network, Wireshark can sniff that out. </p>
			<p>We also have some very specific products out there for wireless including AirMagnet, OmniPeek, and AirSnort. </p>
			<h2 id="_idParaDest-393"><a id="_idTextAnchor404"/>Step 4: Launching the attack</h2>
			<p>Are you<a id="_idIndexMarker1859"/> ready to start launching the attack? Well, for us to accomplish this, we can use probably one of the most powerful tools out there, Aircrack-ng. It's not just a simple application, it's a suite of applications designed to target the wireless environment. By suite, I mean, there are several different products inside the product. It's open source, and what's cool is it's free. It's done through the GNU General Public License.</p>
			<p>As we said, Aircrack-ng<a id="_idIndexMarker1860"/> is made up of several utilities. The ones you should be aware of for your exam would be the following:</p>
			<ul>
				<li>Aircrack-ng itself. This is the standard WEP, WPA, and WPA2-PSK cracking tool. </li>
				<li>We also have Aireplay-ng, designed to <a id="_idIndexMarker1861"/>create traffic and fake authentication packets, as well as ARP request injections. </li>
				<li>There's also Easside-ng, a<a id="_idIndexMarker1862"/> nifty little tool that allows you to communicate via WEP encryption with an AP without knowing the WEP key. </li>
				<li>Other tools include Airodump-ng, a <a id="_idIndexMarker1863"/>utility used for packet capturing. It also can link in with a GPS receiver if you have one hooked up. </li>
				<li>I bet you can't guess what Airmon-ng<a id="_idIndexMarker1864"/> does? Yep, we use it to enable the wireless NIC card to start monitoring the wireless interface and looking for different APs. </li>
			</ul>
			<p>Now, you may never use some of these programs within the Aircrack-ng suite. I just want you to understand that, because it has so many utilities inside of it, you could say it's a sweet suite.</p>
			<h2 id="_idParaDest-394"><a id="_idTextAnchor405"/>Step 5: Cracking the encryption</h2>
			<p>Once we have the<a id="_idIndexMarker1865"/> SSID, the next thing we need to do is look at cracking the encryption. Now, as an attacker who may have gotten unauthorized access to the target network by doing things such as placing rogue APs, evil twins, and finding out what the hidden SSIDs are, the next step is to crack the security that's stopping us. </p>
			<p>How we achieve this totally depends on the encryption that's being utilized, and there are many tools based on our requirements. We obviously know about Aircrack-ng and its suite of tools. On the macOS platform, we have something called KisMAC that is basically a playoff of Kismet, which is designed to run on a Linux environment. </p>
			<p>We also know about Kali Linux, which has a plethora of tools. We've just talked about Aircrack-ng, but it has a ton of tools as far as wireless cracking is concerned. </p>
			<p>It also has<a id="_idIndexMarker1866"/> KillerBee, Blueport, BlueRanger, RedFang, and WiFiHoney – we could spend hours going over that information. And, of course, if you're on the Windows platform, good old Cain and Abel also can do some cracking for us. </p>
			<p>Let's discuss Bluetooth next.</p>
			<h1 id="_idParaDest-395"><a id="_idTextAnchor406"/>Hacking Bluetooth </h1>
			<p>Bluetooth is not <a id="_idIndexMarker1867"/>normally something we would consider an attack vector, but it really is. It's a technology that allows for devices to share data over somewhat short distances. We're about to look at how Bluetooth works, the security mechanisms it has, the threats it provides or creates, and, of course, it can't be complete unless we talk about tools and attacks. Cheer up and let's get going!</p>
			<p>I know by now your little brain is overloaded with tons of acronyms and terms, but you must make room for some new ones, especially when it comes to Bluetooth:</p>
			<ul>
				<li><strong class="bold">Bluejacking</strong> – This is <a id="_idIndexMarker1868"/>sending messages via Bluetooth from one device to another without the consent of the user. It's like spam. It's relatively harmless. The attacker can't access any information or intercept messages, but they can use Bluejacking as a way of social engineering a target to do something on the phone because a message told them to do it thinking it's an official thing. For example, <em class="italic">Turn on your Wi-Fi and hook into this access point</em>. It's annoying getting a ton of Bluejack messages. </li>
				<li><strong class="bold">Bluesmacking</strong> – This is a <a id="_idIndexMarker1869"/>DoS attack that causes a buffer overflow. It does it through a ping of death through ICMP packets being sent to the Bluetooth device. </li>
				<li><strong class="bold">Bluesnarfing</strong> – Bluesnarfing <a id="_idIndexMarker1870"/>is more dangerous than Bluejacking because it enables the hacker access to part of your data. The attacker uses customized software to request information from the device via Bluetooth push profile in this type of attack. The attack can be carried out in stealth mode against the device; however, this is unlikely due to the time required to determine the device's name.</li>
				<li><strong class="bold">Blueprinting</strong> – Can you<a id="_idIndexMarker1871"/> guess what it does? Hang on, I know you're thinking, <em class="italic">It has something to do with printers, right?</em> No. Blueprinting is simply a footprinting method. Now can you see the correlation between blueprinting and footprinting? This method allows the attacker to find out the model and make of the device they're going after. </li>
				<li><strong class="bold">Bluebugging</strong> – This is<a id="_idIndexMarker1872"/> when the attacker can gain remote access to the target Bluetooth-enabled device without the victim being aware of it, and it gives them full access to the 80 level commands of the device, meaning they would have read-write access to text messages and their phonebook or contacts. Bluebugging was developed after the onset of Bluejacking and Bluesnarfing. It's just on steroids. </li>
			</ul>
			<p>You might want to make sure you have a couple of these terms at your fingertips for your immediate future, particularly, Bluesmacking, Bluejacking, and Bluesnarfing.</p>
			<h2 id="_idParaDest-396"><a id="_idTextAnchor407"/>More about Bluetooth </h2>
			<p>Besides using frequency hopping as a security mechanism, remember both the master and slave must know the hop sequence; we have the PSK that's exchanged at pairing.</p>
			<p>With Bluetooth, we have three different modes: </p>
			<ul>
				<li><strong class="bold">Discoverable mode</strong> – This is the mode most people are used to. When you try to pair up <a id="_idIndexMarker1873"/>a device, you make it discoverable, which means that it will respond to any inquiries that are made to that device. This mode should only be turned on while making the connection for the first time. Upon saving the connection, the two devices will remember each other and, therefore, the discoverable mode isn't necessary at a later point.</li>
				<li><strong class="bold">Limited mode</strong> – This <a id="_idIndexMarker1874"/>mode is exactly what it sounds like—only responding for a limited time. Most of our phones today, when we make them discoverable, have a timeout. My phone has 2 minutes before it becomes non-discoverable.</li>
				<li><strong class="bold">Non-discoverable mode</strong> – This<a id="_idIndexMarker1875"/> mode prevents the device from appearing on anybody's lists of available Bluetooth devices in the area. However, it's still available or visible to devices it has paired with previously. </li>
			</ul>
			<p>There are two pairing modes that are available as well: </p>
			<ul>
				<li><strong class="bold">Non-pairing</strong> – This is<a id="_idIndexMarker1876"/> the first one and, just like the name sounds, the device itself rejects any pairing requests made by any device. </li>
				<li><strong class="bold">Pairing</strong> – With this, the <a id="_idIndexMarker1877"/>device accepts a pairing request upon receiving and establishing the connection with the pairing request device. </li>
			</ul>
			<h3>Eavesdropping and impersonation </h3>
			<p>What we mean by this is we allow an attacker to intercept or listen in or on communications between <a id="_idIndexMarker1878"/>two or more devices. Now, here's where the frequency<a id="_idIndexMarker1879"/> hopping comes into play; it makes it a little bit more difficult for us to listen in since it's hopping around. If I can figure out the frequency hopping algorithm you're using, or the hops sequence, I can simply listen in. In fact, to just circumvent the frequency hopping algorithm, all I have to do is use another Bluetooth listening device that's modified to listen to all frequencies. And I bet you'll guess that I got a tool for that, right? It turns the device into a sniffer for Bluetooth. </p>
			<h3>Person-in-the-middle attack</h3>
			<p>We need to be <a id="_idIndexMarker1880"/>concerned about <strong class="bold">person-in-the-middle</strong> (<strong class="bold">PITM</strong>) attacks. <em class="italic">Whoa, wait, I thought it was a man-in-the-middle attack?</em> Well, it's basically the same thing, where the attacker who already has the link keys of the two Bluetooth devices can intercept the communication and initiate new communications to both devices posing as each other. With Bluetooth, there must be a master and a slave. Typically, your phone would be the master, your headset would be the slave, and that creates what they refer to as a <em class="italic">piconet</em>. Did I hear you say, <em class="italic">Oh, come on, Dale, you're making things up now</em>? Well, that's what we call it, it's an ad hoc network. By doing a person-in-the-middle attack, we end up creating two piconets since both devices are considered slaves and masters. </p>
			<h2 id="_idParaDest-397"><a id="_idTextAnchor408"/>Countermeasures for Bluetooth</h2>
			<p>Now that we've<a id="_idIndexMarker1881"/> talked about the big scary wireless, let's talk about countermeasures, shall we? By now, you know why we need to have countermeasures. I think the Dalai Lama summed it up best when he said, <em class="italic">Forgiveness doesn't mean forget what happened. If something is serious, and it's necessary to take countermeasures, you have to take countermeasures</em>. Such a wise statement. </p>
			<p>The first thing you want to do includes obvious things such as not using default pins like 1234 or 1111 and making sure your Bluetooth devices are kept in the non-discoverable mode because if an attacker can't see it, they won't connect to it. Better yet, if you don't need it, turn it off. I only have my Bluetooth on when I feel like I'm in my safe zone, which is getting smaller and smaller all the time. </p>
			<p>Also, check <a id="_idIndexMarker1882"/>your paired devices to make sure there's nothing random suddenly showing up as a device that you've paired with, and don't accept any unexpected requests. If your device supports it, make sure you implement linking encryption on all connections. </p>
			<h1 id="_idParaDest-398"><a id="_idTextAnchor409"/>The six layers of wire security </h1>
			<p>Every <a id="_idIndexMarker1883"/>time I hear six layers, I always think of the <em class="italic">Six Degrees of Kevin Bacon</em> (<a href="http://oracleofbacon.org">oracleofbacon.org</a>), and I'm sure if I start with APs within six layers, I'll be able to get to Kevin Bacon, but let's talk about wireless security here: </p>
			<div>
				<div id="_idContainer114" class="IMG---Figure">
					<img src="Images/B17486_11_11.jpg" alt="Figure 11.11 – The six layers of wireless security" width="621" height="650"/>
				</div>
			</div>
			<p class="figure-caption">Figure 11.11 – The six layers of wireless security</p>
			<p>Let's briefly discuss these layers:</p>
			<ul>
				<li><strong class="bold">First layer: Wireless signals </strong></li>
			</ul>
			<p>In<a id="_idIndexMarker1884"/> wireless networks, the continuous monitoring and managing of the RF spectrum within your environment helps to identify threats and makes you aware of its capabilities. You may want to invest in something like an IDS system or even in a <strong class="bold">wireless intrusion detection system</strong> (<strong class="bold">WIDS</strong>). Previously, I discussed how to <a id="_idIndexMarker1885"/>limit the length of the transmission of your wireless network by using a reflector of some sort. </p>
			<p>I've also heard of users removing antennas from APs. Just because the antenna isn't physically attached, doesn't mean the AP doesn't continue to operate. It just gives it a stronger signal. If the signal is going too far, do yourself a favor: try taking the antenna off and looking at its transmission distance. </p>
			<ul>
				<li><strong class="bold">Second layer: Data protection </strong></li>
			</ul>
			<p>This is another layer <a id="_idIndexMarker1886"/>within wireless security. Obviously, we've talked about the use of WPA2 and, yes, these encryption algorithms should help to protect your data during transmission. Again, it's not foolproof because of weaknesses and other subsystems. </p>
			<ul>
				<li><strong class="bold">Third layer: Device security</strong></li>
			</ul>
			<p>This is another layer, not<a id="_idIndexMarker1887"/> only the physical layer of the device but also making sure that the device is up to date via patch management and scanning these devices for vulnerabilities. When I say scanning for vulnerabilities, I'm not necessarily saying hitting the device itself but doing research to see if there are any vulnerabilities that have been listed by the manufacturer or third parties.</p>
			<ul>
				<li><strong class="bold">Fourth layer: Connection security</strong></li>
			</ul>
			<p>Connection<a id="_idIndexMarker1888"/> security per frame, or packet authentication, provides protection against man-in-the-middle attacks. It makes it almost impossible to accomplish. It does not allow the attacker to sniff data when two authorized users are communicating with each other. I would also look at centralizing the encryption method. Obviously, the centralization of this encryption, like a RADIUS server, requires additional security on the backend. </p>
			<ul>
				<li><strong class="bold">Fifth layer: Network protection </strong></li>
			</ul>
			<p>This means<a id="_idIndexMarker1889"/> strong authentication ensures that only authorized users can access the network and its resources. When we say strong authentication, we're not only talking about the encryption and authentication mechanisms, but we're also talking about how long the passcodes or passphrases are. Weaknesses at that level make us extremely vulnerable. </p>
			<ul>
				<li><strong class="bold">Sixth layer: End users </strong></li>
			</ul>
			<p>I know it's hard to <a id="_idIndexMarker1890"/>wrap your head around it, but believe it or not, if an attacker is able to associate with an AP, the personal firewalls installed on the end user's system on Wi-Fi networks can prevent attackers from gaining access to files. </p>
			<p>Moving onto countermeasures next!</p>
			<h1 id="_idParaDest-399"><a id="_idTextAnchor410"/>Countermeasures </h1>
			<p>Typically, this is<a id="_idIndexMarker1891"/> where we have the most control as security professionals. </p>
			<p>When it comes to wireless, do yourself a favor and change the default SSID. In fact, this might be a great opportunity to practice something I always talk about, and that is misdirection. For example, if I have a D-Link router, I know the default SSID is called D-Link. I'll switch it to Linksys or Tsunami, a different manufacturer, because when the attacker is wardriving through my neighborhood or a business environment and he sees D-Link, he'll throw D-Link attacks or vulnerabilities at that device, which obviously won't work. </p>
			<h2 id="_idParaDest-400"><a id="_idTextAnchor411"/>Disable SSID broadcasting</h2>
			<p>Again, this will not <a id="_idIndexMarker1892"/>stop an attacker, but that's not your job because that job is impossible. Your job is to slow them down. The attacker dared to be looking for a hidden SSID. </p>
			<h2 id="_idParaDest-401"><a id="_idTextAnchor412"/>Disable remote login and wireless administration to the device</h2>
			<p>The last thing<a id="_idIndexMarker1893"/> you want is for the attacker to be able to gain access to the device<a id="_idIndexMarker1894"/> wirelessly. Let's make it a little bit harder for them. Make it so you have to be on the physical wired network to manage this device. </p>
			<h2 id="_idParaDest-402"><a id="_idTextAnchor413"/>Enable MAC filtering </h2>
			<p>This is very <a id="_idIndexMarker1895"/>similar to disabling the SSID broadcasting. It's not necessarily going to stop them, but it is going to slow them down. In fact, if I slow them down enough, I will hopefully discourage them </p>
			<h2 id="_idParaDest-403"><a id="_idTextAnchor414"/>Update drivers on Wi-Fi devices</h2>
			<p>Make <a id="_idIndexMarker1896"/>sure you update drivers on all the Wi-Fi devices. Again, I go<a id="_idIndexMarker1897"/> back to how we are all so much aware of updating our applications, especially on our mobile devices, or we update our OS on the famous <em class="italic">Patch Tuesday</em> for Microsoft, right? But, I always ask people, <em class="italic">When was the last time you updated the firmware or the drivers on the Wi-Fi devices?</em> This should be done at a minimum of at least once a year; I would preferably see this on a task list, to be done every quarter. </p>
			<h2 id="_idParaDest-404"><a id="_idTextAnchor415"/>Create a centralized authentication server</h2>
			<p>We've already talked <a id="_idIndexMarker1898"/>about creating a centralized <a id="_idIndexMarker1899"/>authentication server. Remember our RADIUS server? That's also going to require some best practices regarding locking it down. </p>
			<h2 id="_idParaDest-405"><a id="_idTextAnchor416"/>Secure Wi-Fi devices</h2>
			<p>You may not have<a id="_idIndexMarker1900"/> thought of this, but guess what? If you're not using it, turn it off, please. Just because you can be wireless doesn't mean you have to have it turned on. </p>
			<h2 id="_idParaDest-406"><a id="_idTextAnchor417"/>Best practices for the SSID settings</h2>
			<p>Let's <a id="_idIndexMarker1901"/>discuss some of the best practices<a id="_idIndexMarker1902"/> when using SSID settings.</p>
			<h3>Change and hide the SSID</h3>
			<p>We've mentioned changing the default SSID and hiding it. This is also known as <strong class="bold">SSID cloaking</strong>. I once read an <a id="_idIndexMarker1903"/>article on the internet that listed three reasons why hiding your wireless SSID was a bad idea. One of the three reasons was that hiding your wireless SSID tempts bad guys. Guess what? You're already tempting them by having a wireless network. We can also argue whether it's a waste of time because as we've seen, we can detect those, but that does require a different level of attacker. </p>
			<p>Also, when you name your SSID, please, for the love of Pete, don't use anything identifiable such as the company name, address, or your last name, for example. At that point, you're just making things almost too easy. </p>
			<h3>Use a firewall or a packet filter </h3>
			<p>As far as layout is concerned, you should also make sure you place a firewall or a packet filter between the AP and the corporate network.</p>
			<h3>Encryption</h3>
			<p>Other encryption<a id="_idIndexMarker1904"/> technologies we can use with wireless include, for<a id="_idIndexMarker1905"/> example, IPsec for wireless, or setting up VPN tunnels between wireless users and APs—anything to slow the attacker down. </p>
			<p>Now, I do need to <a id="_idIndexMarker1906"/>probably give you a caveat here and that is, every time we add additional protections to our systems, we end up affecting performance, as well as creating some complexity. And as you probably know, anytime we hear the word <em class="italic">complexity</em>, we must associate it with the possibility of additional security holes being made. It takes a very vigilant IT security professional to keep up on all of this. But hey, that's what you're here for, right? </p>
			<h1 id="_idParaDest-407"><a id="_idTextAnchor418"/>Summary</h1>
			<p>In this chapter, we discussed the various wireless network environments we experience. We shared insights into the evolution of wireless and wireless networking. We discussed the great advantages and some of the disadvantages of wireless networks. We shared insights into what makes wireless networks vulnerable to security issues and some countermeasures we can do to better protect ourselves from threats we face. We discussed the methodology of hacking wireless and Bluetooth devices.</p>
			<p>In the next chapter, we will learn about hacking mobile platforms.</p>
			<h1 id="_idParaDest-408"><a id="_idTextAnchor419"/>Questions</h1>
			<p>As we conclude, here is a list of questions for you to test your knowledge regarding this chapter's material. You will find the answers in the <em class="italic">Assessments</em> section of the <em class="italic">Appendix</em>:</p>
			<ol>
				<li value="1">Which of the following best describes a wireless hacking attack's <em class="italic">evil twin</em>?<ol><li>An attacker creates an access point for clients to connect to within a network range.</li><li>Attackers create a system with the same MAC as a legitimate target.</li><li>On a wireless network, an attacker sets up an authentication.</li><li>An attacker logs in with the same username and password as a legitimate user.</li></ol></li>
				<li>A WEP-encrypted access point has been located by a team. To crack WEP, what is required to perform a fake authentication to the AP? (Select two.)<ol><li>The access point's MAC address</li><li>The SSID</li><li>A replay of an authentication packet that was captured</li><li>The wireless access point's IP address</li></ol></li>
				<li>Which of the following statements about wireless security is correct?<ol><li>WPA2 is a superior encryption option to WEP.</li><li>WEP is a superior encryption option to WPA2.</li><li>The use of MAC filtering and cloaking the SSID eliminates the requirement for encryption.</li><li>Increasing the SSID's length to its maximum improves the system's security.</li></ol></li>
				<li>Which wireless standard uses MIMO antenna technology to reach high data transmission speeds?<ol><li>802.11g</li><li>802.11b</li><li>802.16</li><li>802.11n</li></ol></li>
			</ol>
		</div>
	</div></body></html>