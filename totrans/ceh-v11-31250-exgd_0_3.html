<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer034">
			<h1 id="_idParaDest-51"><em class="italic"><a id="_idTextAnchor051"/>Chapter 2</em>: Introduction to Reconnaissance</h1>
			<p>Reconnaissance is fundamental during the hacking process. Through reconnaissance, hackers will gather information about their target to use against them or to access a vulnerability that they can exploit. The more information hackers have on their targets before beginning any type of attack, the more likely it is for them to succeed and not get caught. </p>
			<p>So, let me ask you a question – when you're shopping for a car, do you buy the first one you come across with a <strong class="bold">For Sale</strong> sign? You probably don't. At least I know I don't.</p>
			<p>I do a lot of research before making a big purchase. I go through consumer reports and reviews to dig out as much information as I can about that specific car.</p>
			<p>Today, I have access to multiple online services to assist me in finding out everything about a car, including its history, previous owners, quality reviews, and so on. That's precisely what <strong class="bold">reconnaissance</strong> and <strong class="bold">footprinting</strong> are all about.</p>
			<p>So, what is reconnaissance and what does it have to do with hacking?</p>
			<p><strong class="bold">Reconnaissance</strong> is the <a id="_idIndexMarker165"/>process of gathering as much information about our intended target as we can to make our attacks easier.</p>
			<p>This book covers different types of recons and the information we need to collect. There is a plethora of information we can gather from the target without their knowledge.</p>
			<p>You will notice that I will flip back and forth between the points of view of a hacker and an ethical hacker. That's the job of an ethical hacker – to first think like a hacker and profile a target. Then, at other times, I must think like an ethical hacker who could perform reconnaissance as part of a penetration test to help an organization protect itself.</p>
			<p>I will mention penetration testing, or pen testing, frequently throughout this book. That's what we do as ethical hackers! We try out different attacks on systems to see how secure they are. Then, we can (sometimes) help our targets mitigate those vulnerabilities.</p>
			<p>In this chapter, we'll cover the following topics:</p>
			<ul>
				<li>Overview of reconnaissance</li>
				<li>Search engines</li>
				<li>Google hacking</li>
				<li>Using WHOIS</li>
				<li>Using ping and DNS</li>
			</ul>
			<p>Now, it's never a good geek session without playing around with some tools. So, you're going to see a lot of tools, especially in the upcoming chapters. So, get your ball cap, put it on sideways, and let's get busy!</p>
			<h1 id="_idParaDest-52"><a id="_idTextAnchor052"/>Overview of reconnaissance</h1>
			<p>In a battle, a successful attack depends on how much you know about your enemy. Knowledge <a id="_idIndexMarker166"/>of where and how many troops, their supply chain, and their equipment is vital to a strategic approach to engaging the enemy. It's very similar to why we recon before our attack.</p>
			<p>Recon is the first and most convenient way an attacker gathers information about a target. The purpose of recon is to learn as much as you can about a target. For example, does it have remote access capabilities? What ports and services are being used? What does an organization's security profile look like?</p>
			<p>Attackers spend at least 70% of their time in this phase because it's a way to get a ton of information about the target (without being discovered).</p>
			<p>First, we will collect as much <strong class="bold">elementary intel</strong> as we can about the target – and when I say elementary, I mean basic, foundational stuff, including things such as what the website looks like, where the organization's physical location is, when it was founded, who the officers of the organization are, whether they operate from one location, and whether they have any branch offices. It is even useful to review press releases and news clips about the organization. How did they start?</p>
			<p>The next step is trying to discover what <strong class="bold">operating system</strong> is running on their machines. Luckily, it's almost impossible for them to track everybody hitting their publicly visible systems. Are they running Windows? Are they running Linux? What web servers are they using? Are they using IIS, perhaps Apache? If they're running FreeBSD, can I figure out what version they're using? Are they using an older version of IIS on an old 2003 server? All this information will help me plan my attack.</p>
			<p>Next, we'll perform some queries, which entails using tools to discover things – for instance, all the DNS names out there. We might use WHOIS for this. Our goal is to discover information about the underlying network infrastructure. For example, we might find out that a particular online company is hosting our target's resources. Maybe that company <a id="_idIndexMarker167"/>has had some security issues in the past, so we will probably want to look at any other companies that are partners with our target. You don't think that's important? Go Google search <strong class="source-inline">Target Breach</strong>, and you'll see that <a id="_idIndexMarker168"/>attackers used a <strong class="bold">heating, ventilation, and air conditioning</strong> (<strong class="bold">HVAC</strong>) partner company that maintains Target's refrigeration systems to pivot into their credit card systems.</p>
			<p>Next, we must <a id="_idIndexMarker169"/>find what <strong class="bold">vulnerabilities</strong> might be available to us for our attack. We already know what to target since we know the operating system version, and we might even know the web server version. Using that information, we will start our research (or <em class="italic">reconnaissance</em>) on potential vulnerabilities. Again, our goal at this stage is to find any information that provides us with any insight into the potential target. Sometimes, even one little piece of information can come back to help you in the end.</p>
			<p>Figuring out <a id="_idIndexMarker170"/>the <strong class="bold">network architecture</strong> that's being used is crucial. During the reconnaissance stage, you should look at the systems, routers, or switches they're using because they can also be potential entry points. We also need to map out the <a id="_idIndexMarker171"/>network to know what is in the <strong class="bold">demilitarized zone</strong> (<strong class="bold">DMZ</strong>). What IP address ranges are being used? What's behind the firewalls? What IP address ranges are used internally? What type of desktop clients are they running? If we can see that visually, we will have a better idea of where we are as we get into the environment.</p>
			<p>The more we learn about the target, the more we'll understand what they're doing. We might even discover how often they look at their security. Also, when it comes to looking for information on employees, the weakest link in any computer system sits between the chair and the keyboard. Social engineering is an essential tool for ethical hackers.</p>
			<p class="callout-heading">Show Your Work!</p>
			<p class="callout">Reconnaissance is a systematic and methodical process. We go through the same steps, looking for the same information. This process gives us a complete profile of the target's security environment, which helps reduce the attack area. Instead of wondering which machine to go after, we will be able to use our understanding of the target's security posture to get very specific regarding which domains, child domains, network blocks, or IP address ranges to go after. But we don't want to go after all of them. We want to focus the attack as much as possible so that we have a clear target in mind.</p>
			<p class="callout">To keep track <a id="_idIndexMarker172"/>of all this reconnaissance, you need to bui<a id="_idTextAnchor053"/>ld up a <strong class="bold">Target Information Profile</strong> (<strong class="bold">TIP</strong>). The focus of the profile will be to note possible vulnerabilities to prioritize your attacks better. It's also crucial to keep track of where you've tried attacks. Naturally, we'll try the path of least resistance first; afterward, we'll start the footprinting phase of reconnaissance, which is mapping out the target's network.</p>
			<h2 id="_idParaDest-53"><a id="_idTextAnchor054"/>Types of reconnaissance</h2>
			<p>There are <a id="_idIndexMarker173"/>several types of recon available to us – passive, active, anonymous, and pseudonymous.</p>
			<h3>Passive reconnaissance</h3>
			<p>Passive reconnaissance is especially relevant when we talk about scanning. It requires no direct <a id="_idIndexMarker174"/>contact with the target. The type of information we gather with passive reconnaissance could include IP addresses <a id="_idIndexMarker175"/>available on the internet, operating systems, and web server software that's being utilized.</p>
			<p>We can also find out whether any services are open on those systems, UDP- or TCP-based, whether they have <a id="_idIndexMarker176"/>any access control mechanisms, whether they have an <strong class="bold">Intrusion Detection System</strong> (<strong class="bold">IDS</strong>) appliance, and so on.</p>
			<p>There's passive scanning and active scanning. Passive scanning uses publicly available sources to gather as much information as possible about a target without being detected by anyone. In contrast, active scanning is aggressive and can be traced back to a source.</p>
			<p>Passive scanning is synonymous with <em class="italic">internet reconnaissance</em>, which refers to gathering information about your target on the internet, often using an online search engine. The only difference between the two is that passive scanning could refer to information gathering from physical sources, such as newspaper or magazine articles.</p>
			<h3>Active reconnaissance</h3>
			<p>On the <a id="_idIndexMarker177"/>other hand, active reconnaissance includes touching the target by going for a job interview, asking questions <a id="_idIndexMarker178"/>about the employees, or even walking through the environment to see what you can discover. When you're gathering information on a large organization, in a large building, it's crazy how freely you can walk around and even use your social engineering skills (a method for hacking humans). For example, just walking in and acting like you're in charge is one way of testing how vulnerable the employees are to social engineering attacks.</p>
			<h3>Anonymous reconnaissance</h3>
			<p>Anonymous <a id="_idIndexMarker179"/>reconnaissance is about gathering information <a id="_idIndexMarker180"/>from sources that can't identify you, so everything you're doing can't be traced to you. This includes using a proxy or VPN solution to hide your location and identity as you access public content.</p>
			<h3>Organizational or private recon</h3>
			<p>Another <a id="_idIndexMarker181"/>type of recon is <strong class="bold">organizational</strong> or <strong class="bold">private recon</strong>. This <a id="_idIndexMarker182"/>entails going through <a id="_idIndexMarker183"/>and getting information from <a id="_idIndexMarker184"/>the organizational event calendar, email service, and more.</p>
			<p>Finally, we <a id="_idIndexMarker185"/>have <strong class="bold">pseudonymous reconnaissance</strong>. Pseudonymous recon is like <strong class="bold">anonymous reconnaissance</strong>, except <a id="_idIndexMarker186"/>the sources may not be directly published by employees or the organization (information is posted anonymously or under a false name). It could be an employee who wants to remain anonymous, such as a whistleblower, or a corporate employee or government official who doesn't want anything posted online under their name. Regardless of their reason for remaining anonymous, collecting information from those sources is referred to as being pseudonymous.</p>
			<h2 id="_idParaDest-54"><a id="_idTextAnchor055"/>Goals of recon</h2>
			<p>What are we trying to get out of this reconnaissance phase? The answer is as much as possible. We are <a id="_idIndexMarker187"/>trying to find the type of information that will help us focus our attacks.</p>
			<p>This information can be divided into system and network information, standard technical practices (source code and naming conventions), and organizational information (location, policies, and employee information).</p>
			<p>This section will review what you should be looking for. Then, I'll show you how to find it.</p>
			<h3>System and network information</h3>
			<p>System and <a id="_idIndexMarker188"/>network information includes things such as domain names (and not just whatever<strong class="source-inline">.com</strong>, we also want to know the child domains they're using). Do they have a child domain? (<em class="italic">Here's where my Batman addiction comes out.</em>) <strong class="source-inline">partners.wayneenterprises.com</strong> or <strong class="source-inline">extranet.wayneenterprises.com</strong>? This means we're going to be looking for all external-facing domains. It's helpful to find any internal domains they may be using. What did they register? Did they register both <strong class="source-inline">wayneenterprises.com</strong> and <strong class="source-inline">wayneenterprises.net</strong>? Are they both exposed? This might tell us that <strong class="source-inline">.com</strong> is their external domain, and that they may be using <strong class="source-inline">.net</strong> internally.</p>
			<p>We also want to discover addresses that are being utilized more broadly at the organization, not just for their website. They might have VPN activity, which would beg the question – who are they getting their IP addresses from? What range? What IP address block are they using?</p>
			<p>Next, we'll look at unmonitored and private websites. I don't know how many times I've come across companies that have websites a developer just put up for testing purposes. No one's monitoring them. Likewise, maybe an employee has posted a website on their internet-facing server.</p>
			<p>It's also <a id="_idIndexMarker189"/>necessary to try to discover TCP and UDP services that are open and exposed. Do they have an IDS? What access control systems are they utilizing? Are they supporting a VPN, and if so, can we discover what their VPN endpoint is? Is it a Windows box? Is it a Cisco VPN solution? Phone numbers are also important – both analog phone numbers and VoIP. </p>
			<p>We also want to gather information regarding the operating systems. We want to discover as much information as possible about users and groups.<a id="_idIndexMarker190"/> What name structure are they using for their user accounts? Is it <em class="italic">first initial, last name</em>? Is it <em class="italic">FirstName.LastName</em>?</p>
			<p><strong class="bold">Banner grabbing</strong> is another <a id="_idIndexMarker191"/>useful technique we will review later. It's a way of identifying a system; when I throw certain commands at operating systems, a Windows box will respond one way, while a Linux box will respond another way.</p>
			<p>We also want to try to gain access to any of their routing tables to see how packets are being routed.</p>
			<h3>Standard technical practices</h3>
			<p>System names <a id="_idIndexMarker192"/>can also be an important clue for us. I love when IT guys name their servers <strong class="source-inline">Thor</strong> or <strong class="source-inline">Zeus</strong> or <strong class="source-inline">Gandalf</strong>; it makes it easy to figure out what the other server names are. Better yet, sometimes, they name them after the computer's name – for example, <strong class="source-inline">Win 2012</strong> – and then they also include its purpose – <strong class="source-inline">Exchange 1</strong>, <strong class="source-inline">SharePoint 2</strong>, <strong class="source-inline">VPN 7</strong>, and so on. The same is true of desktop machines (we're not necessarily going after the server right away). They name them all something such as <strong class="source-inline">Desktop 57</strong> or <strong class="source-inline">Marketing 05</strong>.</p>
			<p>One of the more secure ways of handling system names is to use serial numbers, although that will not stop us. If we can see the computer name and recognize it as a serial number, we will go to Dell's website, type in the serial number, and find out what's in that machine. It's a hard realization to come to, but you cannot stop hackers. Your job is to slow them down.</p>
			<p>The other essential thing we need to find is passwords. It's especially fun when people have documents or spreadsheets where they save passwords to keep track of them.</p>
			<p>We'll also go through their access control systems to find out the requirements for password length. What are their complexity requirements? (Do they require uppercase, lowercase, special characters, and numbers?)</p>
			<h3>Organizational information</h3>
			<p>Never forget to dig into organizational information. Websites can expose quite a bit of crucial information. The company directory is one of the biggest resources for hackers because end <a id="_idIndexMarker193"/>users are the weakest links in any environment. You should try to pull employee details. Pick an employee, maybe somebody in the marketing department, and try to find them on social networking sites such as LinkedIn, Facebook, Twitter, and Instagram. See what their likes and dislikes are; see whether they're complaining about something being unfair at work, their cat's name, their first-grade teacher's name, or their best friend's name. All that information can be utilized. (You can see where I'm going, right? Passwords.)</p>
			<p>Location details can also tell us quite a bit about the organization. For example, what's their physical security like? Would I feel comfortable walking into that building and casing out the joint? Did they just recently move? You may not think this information comes in handy, but trust me, there are many times I've seen passwords based on street addresses, so location details are essential. Make sure you record the addresses of the main office and any branch offices.</p>
			<p>Phone numbers will come in handy if we decide to conduct a social engineering attack. For example, I might call a target up and act as if I'm looking for a job. Job sites are another treasure trove of information for us. If they have a job posting listed for an admin, I can find out what servers they're using or the technology solutions they have deployed.</p>
			<p>Look at the source code for your target's web pages. Are there any comments the developers have accidentally left in? Can we discover the security policies they've deployed? Have they had any training on how to lock down their systems? Have they trained their employees on handling social engineering attacks?</p>
			<p>Pay close attention to any links they have on their website or between servers. How are people coming into their server from other websites? This could help us determine whether they have a partner relationship with another company. That partnering company could become our target because they will likely have an established trust relationship or some type of connectivity back to our original target. Get a background on that organization, as well. Here, you'd go through the same process as we did previously with our target organization. How and when did they get started? Who are their founding members? What were the struggles of the company when they first started? Look at news articles about that company. Find press releases that the company has issued. Anything that we can find out about the organization will help us out. </p>
			<h2 id="_idParaDest-55"><a id="_idTextAnchor056"/>Overview of the tools of recon</h2>
			<p>There are hundreds of tools out there that will help you recon your target. They fall into one of <a id="_idIndexMarker194"/>the following three categories: search engines, websites, and applications. We will start with the low-hanging fruit – search engines.</p>
			<p>Most of the time, people only look at the first couple of pages on a search engine. Studies show they don't go beyond three pages of results. Do yourself a favor – don't just stick to those three pages. Look on page 10 or even page 15 of those results; there's a good chance you'll see historical information pop up. You can even try a variety of search engines because they give different results.</p>
			<p>After doing your preliminary searching on search engines, start looking at websites. Start with the target's website. Again, look for information such as contact information or other domains or subdomains (if your target is <strong class="source-inline">wayneenterprises.com</strong>, do they have a subdomain called <strong class="source-inline">mail.wayneenterprises.com</strong>?). There are also some web-based recon tools out there that have nothing to do with the organization. They're just tools that we can access via the internet to show us more information. We'll review these, particularly in <a href="B17486_04_ePub.xhtml#_idTextAnchor088"><em class="italic">Chapter 4</em></a>,<em class="italic"> Scanning Networks</em>.</p>
			<p>Finally, we have applications. You'll find hundreds of tools to gather information about your target. Some of them are designed for good; some for evil (yes, I'm rubbing my hands together now). There are also some built-in commands that we normally wouldn't suspect, such as command-line interfaces for nslookup. </p>
			<p>There are also hundreds of PowerShell commands out there that could be of benefit to you, as well as scripting languages, and I'm not just speaking from the Windows world. There could also be commands such as <strong class="source-inline">dig</strong> in Linux that we can use to recon our target.</p>
			<p>We'll go over more of these tools throughout this book – keep in mind that it's important to grasp the basics so that you know exactly what you want to get out of these tools.</p>
			<p>When you go through an organization's systems, ask yourself questions such as the following:</p>
			<ul>
				<li>Is SNMP being utilized?</li>
				<li>What system architecture are they using throughout their environment?</li>
				<li>What are their standard naming practices?</li>
				<li>Are they using all the latest and greatest by Microsoft?</li>
				<li>Do they have a little bit of Novell still out there?</li>
				<li>32-bit or 64-bit?</li>
				<li>Are they supporting remote systems and not just VPNs? Are they using Microsoft's DirectAccess (pseudo-VPN solution)?</li>
				<li>What is the physical security of the building like?</li>
				<li>Do they have a kiosk machine in the hallway?</li>
				<li>Do they have users that travel around with laptops or tablets?</li>
				<li>How are passwords stored? </li>
				<li>Are the employees on social media? </li>
				<li>What kind of security policies have they deployed? Are the users trained?</li>
				<li>Do they support <strong class="bold">Bring Your Own Device</strong> (<strong class="bold">BYOD</strong>)? <p class="callout-heading">Note</p><p class="callout">I have a love-hate relationship with BYOD because, as an administrator, it's a nightmare for me sometimes. I get why companies do it. They don't have to go off and buy the tablet for their employee. They get to use their tablet – they're already used to it – but what happens if they lose that tablet?</p></li>
			</ul>
			<p>As we discussed <a id="_idIndexMarker195"/>earlier, all this information will be stored in your TIP. This is critical because if we are targeting multiple companies, we need to keep our information straight.</p>
			<p>Once we've gathered that information, we should start drawing out a blueprint or map of the network. We may not have a complete picture yet, but we'll at least have various potential entry points. As we get into other phases of hacking (such as scanning), we want to be able to pull up a full diagram of their environment. When dealing with such a wide range of information, it's best to create a visual – and that's the footprinting part of reconnaissance.</p>
			<h1 id="_idParaDest-56"><a id="_idTextAnchor057"/>Search engines</h1>
			<p>Typically, you will start gathering information slowly. So, first, you'd start with a Google search, then <a id="_idIndexMarker196"/>you'd check out the target's website, and then you'd go deeper. For the sake of organization, I will show you what you can find out through four major categories: search engines, the organization's website, what companies give away (which is not necessarily on their website), and, finally, employees.</p>
			<p>I will show you the tools and methods you need to gather data for your TIP. We'll even use some tools you're familiar with, but we'll leverage them a little differently. Fire up your computer. Let's get going!</p>
			<h2 id="_idParaDest-57"><a id="_idTextAnchor058"/>Let's start with the basics</h2>
			<p>Here is a <a id="_idIndexMarker197"/>website that you can practice attacks on. It's called <strong class="bold">HackThisSite.org</strong> (<a href="https://hackthissite.org/">https://hackthissite.org/</a>), and it's a free site that hackers use as a training ground to test some stuff out. It also has some stuff on it – blogs, news releases, and so on.</p>
			<p>Start by pulling <a id="_idIndexMarker198"/>up your favorite search engine; in my case, it's Google. We'll start with a simple search on the target – so, type in <strong class="source-inline">hackthissite.org</strong>. The first thing it shows is the actual website, and it gives some additional information about pages on that website that we might not be aware of.</p>
			<p>Again, don't limit yourself to the first page; scroll down further. Take note of the results that come up. For example, Reddit has some reviews on it, and it appears to have a Facebook page (although that could be an impersonator).</p>
			<p>Some other companies have referenced <strong class="bold">HackThisSite.org</strong> – this can be important because some of these third-party links and reviews could give you some vital information, such as partnerships or clients that might have a trust relationship with the target.</p>
			<p>Now, let's look at a different target – my old wireless ISP service (from back in the day) called <strong class="source-inline">UtahWISP.com</strong>.</p>
			<p>Even though this company doesn't exist anymore, you will find several articles about it. Yahoo Local shows me some information, including the street address and a map to show its location (that will be important for us). It's also on Google Plus.</p>
			<p>Let's switch to Yahoo. This time, type in <strong class="source-inline">hackthissite.org</strong>. Sometimes, search engines can even help you determine the URL structure of an organization. For example, in the <strong class="bold">HackThisSite.org</strong> site search result, there's also a login directory, an information page, and a registration page.</p>
			<p>A simple search <a id="_idIndexMarker199"/>will often lead to important information because people don't always have control over what the search engines display. There are some ways around this; you can tell Google to not index your environment, but even that information can be exposed.</p>
			<p>Now that you know what to look for in your initial searches, I'll show you how you can get even more information out of Google.</p>
			<h1 id="_idParaDest-58"><a id="_idTextAnchor059"/>Google hacking</h1>
			<p><em class="italic">Note that when I say Google hacking, I'm not referring to trying to hack the Google servers</em>.</p>
			<p>First and foremost, you need to understand how Google works. Normally, what happens is you <a id="_idIndexMarker200"/>type in something such as <strong class="source-inline">how to raise baby ducks</strong>. Google quickly responds with sites telling you how to raise baby ducks.</p>
			<p>Now, how does Google do this? Their servers are designed to go out and look at every single website that's out there, even if it's a little blog site. Their servers crawl through the entire <a id="_idIndexMarker201"/>internet and index what it finds. <strong class="bold">Crawling</strong> is the process of going through and making a note of every page and word on that page; all those words are then indexed, which is how Google can pull up random websites about ducks.</p>
			<p>There are some limits to Google. I know you're saying, <em class="italic">Dale, say it's not so. Google has no limits</em>. Well, it does. The limit is 32 words in a Google query.</p>
			<p>We're going to be taking advantage of the <strong class="bold">Advanced Search</strong> section of Google. You probably have experience using this interface (you big Google nerd), but this time, we'll be using some interesting operators and their syntax to discover all kinds of fun stuff that companies don't realize is accessible. Please note that this isn't usually done when you first begin to recon a target. Start with a basic search. Then, once you have more detailed information, you can move on to Google hacking.</p>
			<p>We can tweak our search results in <strong class="bold">Advanced Search</strong>. We'll review the syntax you need to know about in the next section:</p>
			<div>
				<div id="_idContainer009" class="IMG---Figure">
					<img src="Images/B17486_02_01.jpg" alt="Figure 2.1 – Google – Advanced Search" width="1000" height="660"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.1 – Google – Advanced Search</p>
			<p>If you're <a id="_idIndexMarker202"/>looking for heaters within a specific price range, you can simply type <strong class="source-inline">$300</strong> and <strong class="source-inline">$400</strong> in the <strong class="bold">numbers ranging from</strong> field.</p>
			<h2 id="_idParaDest-59"><a id="_idTextAnchor060"/>Google operators</h2>
			<p>Google operators <a id="_idIndexMarker203"/>are the different ways that we can use syntax to refine search results within the <strong class="bold">Search</strong> bar. All of this is also possible in the <strong class="bold">Advanced Search</strong> section. It is up to you and your comfort level whether you use the symbols or the <strong class="bold">Advanced Search</strong> page to configure your Google operators.</p>
			<p>Before we <a id="_idIndexMarker204"/>start, there are a couple of rules for using Google operators:</p>
			<ul>
				<li>There should be no space between the operator and the search term itself. If you're searching for water heaters and you don't want a solar one, you can search for <strong class="source-inline">water heaters -solar</strong>. The important part to note is that there is no space between the <strong class="source-inline">–</strong> operator and <strong class="source-inline">solar</strong>.</li>
				<li>Searches are not case sensitive, so it doesn't matter if you type <strong class="source-inline">BaTmAn</strong>. It will return the same results as searching for Batman.</li>
			</ul>
			<p>The following <a id="_idIndexMarker205"/>are the three most basic methods of tailoring your Google search results:</p>
			<ul>
				<li><strong class="bold">Combining terms</strong>: Most of us, when we're searching for something, type in something along the lines of <strong class="source-inline">Batman Dark Knight</strong>. Unfortunately, by not specifying how those words should be grouped, we'll get everything about Batman, the dark, and maybe some medieval knights. One of the things we can do is to use quotation marks to associate the words. Instead of <strong class="source-inline">batman dark knight</strong>, we can type <strong class="source-inline">"Dark Knight" Batman</strong>, with <strong class="source-inline">Dark Knight</strong> in quotations. The other option is to type <strong class="source-inline">Dark.Knight</strong>, with a period in between the two terms that have a space.</li>
			</ul>
			<p>Note that the space indicates <strong class="source-inline">AND</strong>, but we are also able to change that to <strong class="source-inline">OR</strong>.</p>
			<ul>
				<li><strong class="bold">Boolean operators</strong>: The <strong class="source-inline">AND</strong> operator is assumed when you type in a string of words with <a id="_idIndexMarker206"/>only a space, but you can also indicate the <strong class="source-inline">AND</strong> operator with a plus sign (<strong class="source-inline">+</strong>) or with the word <strong class="source-inline">AND</strong>. If you'd like to use the <strong class="source-inline">OR</strong> function, you can type in <strong class="source-inline">OR</strong> or use the pipe symbol (<strong class="source-inline">|</strong>).</li>
				<li><strong class="bold">Excluding terms</strong>: If you only want to know about Batman and not the Joker, you can subtract him by typing in <strong class="source-inline">Batman -joker</strong>. The results that appear will all be pages that don't contain any normal text (there may be a link) that references the Joker.</li>
			</ul>
			<p>Now, we can <a id="_idIndexMarker207"/>get into the more sophisticated Google operators:</p>
			<ul>
				<li><strong class="source-inline">cache</strong>: By using the <strong class="source-inline">cache</strong> operator, we can specify that we want to see Google's cached version of that page. This comes in handy because a page may go offline either temporarily or permanently, yet you'd be able to see the last cached page that Google has on their servers.</li>
				<li><strong class="source-inline">link</strong>: The <strong class="source-inline">link</strong> specification shows a list of web pages that have links to your target site.</li>
				<li><strong class="source-inline">related</strong>: The <strong class="source-inline">related</strong> operator goes through and shows us pages that are similar to the target page. It shows us pages that have the same type of wording by doing a basic text comparison.</li>
				<li><strong class="source-inline">info:</strong>: By typing <strong class="source-inline">info:</strong>, followed by the page or the URL, we can view what information Google has on our target website.</li>
				<li><strong class="source-inline">site:</strong>: To find results only within a particular site, type your search terms, then <strong class="source-inline">site:</strong> and the URL of a particular site. For example, if I want to look for water heaters at Home Depot, I could type in <strong class="source-inline">water heaters site: Home Depot</strong>.</li>
				<li><strong class="source-inline">allintitle:</strong>: This limits the results to those websites that contain all the search words in the title. To find sites that have <strong class="source-inline">Batman</strong> in the title, I would type <strong class="source-inline">allintitle:Batman</strong>, and Google would find all those websites. This is commonly used in penetration testing.</li>
				<li><strong class="source-inline">inTitle:</strong>: This operator <a id="_idIndexMarker208"/>looks at documents that contain that search word in their title. You could use this to look for documents that are titled <strong class="source-inline">Passwords</strong>, for example. </li>
				<li><strong class="source-inline">allinURL:</strong>: This limits Google's results to only the pages with all your search words in the URL.</li>
				<li><strong class="source-inline">inURL:</strong>: This operator limits our results to just documents that contain the search word in the URL.</li>
			</ul>
			<p>Next, let's look at examples of using Google operators.</p>
			<h2 id="_idParaDest-60"><a id="_idTextAnchor061"/>Using Google operators</h2>
			<p>Let's go over <a id="_idIndexMarker209"/>a few useful scenarios for how to use Google operators.</p>
			<p>First, let's <a id="_idIndexMarker210"/>search for <strong class="source-inline">intitle:"index of"</strong>. This will give us a list of web pages that support directory browsing. <strong class="bold">Directory browsing</strong> (or <strong class="bold">traversal</strong>) is a hacking method that allows attackers to access restricted directories and files within the website and executes a command outside the web server's root directory:</p>
			<div>
				<div id="_idContainer010" class="IMG---Figure">
					<img src="Images/B17486_02_02.jpg" alt="Figure 2.2 – Google search using operators&#13;&#10;" width="836" height="348"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.2 – Google search using operators</p>
			<p>The first link that comes up shows us a directory structure for Linux. We could just go through this <a id="_idIndexMarker211"/>structure and find Ubuntu. This is probably where they're going to have a download of Ubuntu, as well as different projects that they're working on. You never know what you might find because some people may not know this information is being exposed.</p>
			<p>By using <strong class="source-inline">inTitle:</strong>, we're telling Google the words we're looking for, but we aren't saying that it absolutely must have <strong class="source-inline">of</strong> in the title. <strong class="source-inline">allintitle:</strong>, on the other hand, means that all the words in our search must be present in the title.</p>
			<p>As an example, let's try <strong class="source-inline">inurl:admin</strong>. This search will return sites that have <strong class="source-inline">admin</strong> or <strong class="source-inline">administrator</strong> in the URL itself; sometimes, there are associated login pages:</p>
			<div>
				<div id="_idContainer011" class="IMG---Figure">
					<img src="Images/B17486_02_03.jpg" alt="Figure 2.3 – Google search using the inurl:admin operator" width="617" height="708"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.3 – Google search using the inurl:admin operator</p>
			<p>Now, let's try <strong class="source-inline">allinURL:</strong> and add another word, such as <strong class="source-inline">index</strong>. (Type <strong class="source-inline">allinurl:admin index</strong> into Google.) This <a id="_idIndexMarker212"/>search means that we will only get results that have both <strong class="source-inline">admin</strong> and <strong class="source-inline">index</strong> in the URL. Scared yet?</p>
			<p>So, what can we find with Google operators? We can find the following:</p>
			<div>
				<div id="_idContainer012" class="IMG---Figure">
					<img src="Images/B17486_02_04.jpg" alt="Figure 2.4 – Search result of the allinurl: operator" width="1426" height="522"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.4 – Search result of the allinurl: operator</p>
			<p>We could use <strong class="source-inline">intitle:</strong> to look at specific types of files (maybe in an administrative directory). We could find log files specifically, or perhaps log files that help identify the server. We could identify which of the servers is an Apache server. We could even move around in a directory structure.</p>
			<p>Another neat thing we <a id="_idIndexMarker213"/>can do with Google operators is extension walking. <strong class="bold">Extension walking</strong> allows us to go through and change file types. For example, once I've located HTM files, I could use a substitution technique to find files with the same filename and different extensions. So, if I found <strong class="source-inline">/docs/index.htm</strong>, I could modify the URL to <strong class="source-inline">/docs/index.asp</strong> to try and locate the <strong class="source-inline">index.asp</strong> file in the <strong class="source-inline">docs</strong> directory.</p>
			<p>Speaking of which, one of my favorite things to do is use extension walking to find backup copies of web pages (because, and no offense to them, developers are lazy). They leave the backups of the old versions of the web page on the server and trust me, Google indexes those.</p>
			<p>Let's think about <a id="_idIndexMarker214"/>what we've gone over in this section from an attacker's perspective (or a pen tester's perspective). As an example, let's say that you're <a id="_idIndexMarker215"/>trying to determine the operating system of a public-facing <strong class="bold">Small Business Server</strong> (<strong class="bold">SBS</strong>) 2003. When you install SBS, it has a frontend page that says, in the title, <strong class="bold">Welcome to Windows Small Business Server</strong>. <strong class="source-inline">inTitle:</strong> will show you links about Windows Server 2003. But if we scroll down further, we will find pages that unintentionally reveal what server they're hosted on.</p>
			<p>Try a different one and search for <strong class="source-inline">intitle:"open webmail"</strong>. Google will show us some servers out there that are running Open WebMail. You can also try<strong class="source-inline"> intitle:"mvblog powered"</strong> to find blogs or websites powered by MvBlog. MvBlog is prone to several different input validation vulnerabilities, so I could just quickly go and find several targets out there that are using that technology as part of my pen testing process.</p>
			<p>Let's look at another way to use <strong class="source-inline">inTitle:</strong>. The title page of Microsoft's remote access servers contains the phrase <strong class="bold">remote desktop web connection</strong>. At the beginning of the results, most of the pages are going to be Microsoft's, but as we scroll down further, we'll find other sites that are using those servers. One time, I found a login page where you could type in your username and password, and then you could select which server you wanted to log into from a drop-down box. It listed all their servers, their email server, their SharePoint server, and so on. Sometimes, it's too easy.</p>
			<p>Now, this one will be especially important to remember: <strong class="source-inline">intitle:"root/etc/passwd" intext:"home/*:"</strong>.</p>
			<p>Surprisingly enough, this can show you the password directory for a few Linux boxes. Again, you never know what people might leave exposed.</p>
			<p>Error logs are yet another valuable source of reconnaissance information. Error logs might tell you what a server's running or their user behavior, or even the controls they've put in place.</p>
			<p>For our first example, we'll try the <strong class="source-inline">intext:"access denied for" intitle:"shopping cart"</strong> query. This can show us exactly which sites are using MySQL in the backend of their shopping carts (or checkout pages). As ethical hackers, our next question to ask is whether MySQL has any vulnerabilities. </p>
			<p>Let's take <a id="_idIndexMarker216"/>this a step further. You probably already know that you must be careful about which devices you're hooking up to the internet and with every device that has a web interface. That's because people like me, and now us, can probably find it.</p>
			<p>I'll demonstrate this with an <strong class="source-inline">inTitle:</strong> search by typing <strong class="source-inline">intitle:"bluenet video viewer"</strong>. What I get back is a list of broadcast-quality videos that are on the internet – full 30-frame per second options based on an IP.</p>
			<p>In some cases, I've been able to use this to take control of a camera on the beaches in the Caribbean, which was kind of fun. You can do this with several popular cameras; you just need to look up the specific name of the camera; for example, <strong class="source-inline">snc-rz30 home</strong>.</p>
			<p>Let's try another one. Type in <strong class="source-inline">Camera Live Image" inurl:"guestimage.html"</strong> and we'll try to find live views using live cameras. These cameras have HTTP servers on them. Look at any of these listed in the search results as an IP address:</p>
			<div>
				<div id="_idContainer013" class="IMG---Figure">
					<img src="Images/B17486_02_05.jpg" alt="Figure 2.5 – Searching for a camera IP&#13;&#10;" width="560" height="487"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.5 – Searching for a camera IP</p>
			<p>If they still <a id="_idIndexMarker217"/>use the default username and passwords, we could even get into the setup of that camera:</p>
			<div>
				<div id="_idContainer014" class="IMG---Figure">
					<img src="Images/B17486_02_06.jpg" alt="Figure 2.6 – Live feedback of the camera" width="817" height="610"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.6 – Live feedback of the camera</p>
			<p>We can do the same thing with printers, for example. Printers are typically URL-based, so our search query will be <strong class="source-inline">intitle:"Remote UI" intext:"Printer status"</strong>:</p>
			<div>
				<div id="_idContainer015" class="IMG---Figure">
					<img src="Images/B17486_02_07.jpg" alt="Figure 2.7 – Printer settings page" width="847" height="681"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.7 – Printer settings page</p>
			<p>If you <a id="_idIndexMarker218"/>want to search even deeper, try the following:</p>
			<ul>
				<li><strong class="source-inline">inurl:root.asp?acs=anon</strong>: These results would take us directly to the main page of Outlook access public folders and an Exchange address book.</li>
				<li><strong class="source-inline">ext:sql intext:"alter user" intext:"identified by"</strong>: The extension you're looking for is SQL. This query would show me files that contain SQL instructions where the administrator set a password for the database user.</li>
			</ul>
			<p>If I haven't said it enough, you must be aware of everything you are exposing to the internet. You don't think I can find out whether your router's a Cisco router or a Linksys router? Guess again.</p>
			<h2 id="_idParaDest-61"><a id="_idTextAnchor062"/>Google Hacking Database</h2>
			<p>Now, you <a id="_idIndexMarker219"/>know how to use Google operators the hard way. Guess what, script kiddies! There's something out there called <strong class="bold">Google Hacking Database</strong> (<strong class="bold">GHDB</strong>) (<a href="https://www.exploit-db.com/google-hacking-database/">https://www.exploit-db.com/google-hacking-database/</a>). A man by the name of Johnny Long created this Google database and, luckily for <a id="_idIndexMarker220"/>us, it expands daily because of the multitude of vulnerabilities that continue to pop up:</p>
			<div>
				<div id="_idContainer016" class="IMG---Figure">
					<img src="Images/B17486_02_08.jpg" alt="Figure 2.8 – The Google Hacking Database page&#13;&#10;" width="1198" height="741"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.8 – The Google Hacking Database page</p>
			<p>At the top <a id="_idIndexMarker221"/>is a list of new entries, such as a search for WordPress Flash plugins, for example:</p>
			<div>
				<div id="_idContainer017" class="IMG---Figure">
					<img src="Images/B17486_02_09.jpg" alt="Figure 2.9 – New entry&#13;&#10;" width="1239" height="708"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.9 – New entry</p>
			<p>But you could also scroll down and find tailormade lists showing common things such as web server detection, files that contain passwords, sensitive online shopping information, and pages that contain login portals, error messages, printers, video cameras, and more. In this section, I'll provide some examples of the detailed information that you can find using this resource – and there is a lot. How about getting a list of <a id="_idIndexMarker222"/>database backups that are exposed? I know, you're using the <em class="italic">palm to forehead</em> gesture right about now. </p>
			<p><em class="italic">Exploit Database</em> is available for download, which will be especially useful for those who plan to do penetration testing. There is a section dedicated to exploits – remote exploits, web application exploits, and so on:</p>
			<div>
				<div id="_idContainer018" class="IMG---Figure">
					<img src="Images/B17486_02_10.jpg" alt="Figure 2.10 – exploitdb GitHub repository page" width="923" height="896"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.10 – exploitdb GitHub repository page</p>
			<p>This was created by just using Google to aggregate all the found vulnerabilities out there. Now, it doesn't tell you how to fix them, but at least you'll know they exist. You can also find a list of web application exploits on the same page.</p>
			<p>In addition to this site, which reviews best practices (for example, privilege escalation via client management software), Johnny Long, the mastermind of GHDB, has several white papers available. His work is a fantastic resource for everyone in this field. He has written several books and runs a charity called <strong class="bold">Hackers for Charity</strong>, which takes hardware <a id="_idIndexMarker223"/>and office equipment that some companies may deem outdated and installs them in third-world countries to help set up networks in more remote areas.</p>
			<h2 id="_idParaDest-62"><a id="_idTextAnchor063"/>Other Google hacking tools</h2>
			<p>There are <a id="_idIndexMarker224"/>some other Google hacking tools that you can use to make things even easier:</p>
			<ul>
				<li><strong class="bold">Google Hack Honeypot</strong>: This tool is designed to go out and provide reconnaissance <a id="_idIndexMarker225"/>against hackers or attackers that would use these search engine techniques on you. It creates a type of honeypot for you. In other words, it's a fake Google result. </li>
				<li><strong class="bold">SearchDiggity</strong>: This is a web GUI interface for Windows that provides a framework <a id="_idIndexMarker226"/>for using Google hacking tools. You can add additional components to it such as GoogleDiggity, BingDiggity, PortScanDiggity, and MalwareDiggity. </li>
				<li><strong class="bold">Metagoofil</strong>: This tool <a id="_idIndexMarker227"/>is quite powerful. It goes out and grabs metadata on any document that's publicly exposed, whether it's a DOCX, a PPTX, a DOC, or a PDF. Then, it downloads those files from the target and extracts the metadata so that you can see what's being exposed (especially usernames and passwords). </li>
				<li><strong class="bold">SiteDigger</strong>: SiteDigger searches <a id="_idIndexMarker228"/>Google's cache for any types of errors or misconfiguration issues present on your target organization's website. </li>
			</ul>
			<p>Now, if you're starting to get concerned about your network, don't worry too much. That's the natural reaction you feel after going through some of this information. Toward the end of this book, I'll show you some reconnaissance countermeasures and what to look for during penetration testing to prevent giving away so much information to potential hackers.</p>
			<h1 id="_idParaDest-63"><a id="_idTextAnchor064"/>Using WHOIS</h1>
			<p><strong class="bold">WHOIS</strong> is a huge <a id="_idIndexMarker229"/>database that contains information regarding every website <a id="_idIndexMarker230"/>on the internet. It contains common information such as who owns the website, their email address, and some other information. A website called <strong class="source-inline">domaintools.com</strong> offers a nice WHOIS interface, but all the data comes from ICANN's service. </p>
			<p class="callout-heading">Note</p>
			<p class="callout">The <strong class="bold">Internet Assigned Numbers Association</strong> (<strong class="bold">IANA</strong>) delegates the registration of domains <a id="_idIndexMarker231"/>and assignment of IP addresses <a id="_idIndexMarker232"/>to five different <strong class="bold">Regional Internet Registries</strong> (<strong class="bold">RIRs</strong>) around the world. These provide information to WHOIS about your target websites. </p>
			<p class="callout">ARIN represents the United States, Canada, the Caribbean Islands, and North Atlantic Islands. </p>
			<p class="callout">LACNIC is used for Latin America, as well as some portions of the Caribbean. </p>
			<p class="callout">RIPE is for Europe, the Middle East, and Central Asian registration. </p>
			<p class="callout">AFRINIC is the registrar for Africa and parts of the Indian Ocean. </p>
			<p class="callout">APNIC is the registrar for portions of Asia, as well as the Oceanic rim.</p>
			<p>We can <a id="_idIndexMarker233"/>use WHOIS either in the command line or through a web interface, such as the one available at <a href="http://whois.domaintools.com">whois.domaintools.com</a>. </p>
			<p>Linux has this capability built into it (the <strong class="source-inline">whois</strong> command), but you may not always have access to a Linux box, so using a website is often more convenient. </p>
			<p>Type in either a domain name or an IP address of any site out there. I'm going to review the WHOIS results for <strong class="source-inline">HackThisSite.org</strong> here: </p>
			<div>
				<div id="_idContainer019" class="IMG---Figure">
					<img src="Images/B17486_02_11.jpg" alt="Figure 2.11 – WHOIS record for HackThisSite.org" width="971" height="734"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.11 – WHOIS record for HackThisSite.org</p>
			<p>At the top, you can see that they have protected their email. But we can still see the IP address of the <a id="_idIndexMarker234"/>dedicated server, that the IP address is based out of Las Vegas, Nevada, they've maintained this site since 2003, the number of images on the page, and the number of links – both internal and external.</p>
			<p>This website also gives us the physical WHOIS record. This is what you would see from a Linux machine <a id="_idIndexMarker235"/>if you were to run the <strong class="source-inline">whois</strong> command on a <strong class="bold">command-line interface</strong> (<strong class="bold">CLI</strong>). </p>
			<p>Let's review the interesting information we obtained from WHOIS in the preceding screenshot:</p>
			<ul>
				<li>Where it was registered (Enom, Inc.). </li>
				<li>They're protecting themselves with the WHOIS privacy protection service. Many people won't use this service; <strong class="source-inline">HackThisSite.org</strong> did because they're expecting to get hacked (boy, that's weird – I wonder why they'd think that?). Sometimes you can use this tool to see the person that registered the domain name, as well as the admin, their email address, and possibly their cell phone number. You can also see the following:<ul><li>Technical contact information (this is supposed to be who you'd contact if a technical issue has occurred). </li><li>The name servers or the DNS servers that are hosting the name to IP address resolution. In this case, they're using BUDDYNS. It looks like they have their own name servers (NS1 and NS2.)</li><li>DNSSEC is unsigned. DNSSEC is a protocol that's used for encrypting DNS transfers. Since this is not encrypted, this could be a possible point for us to look at. </li></ul></li>
			</ul>
			<p>Pay very close attention to the contacts listed here if they're visible. Typically, when someone registers a domain, they use their home address. (Phone numbers and email addresses are <a id="_idIndexMarker236"/>very useful for social engineering attacks.) It's also important to note any anomalies. For example, if the website is <strong class="source-inline">widgets.com</strong> but the registrant's email is <strong class="source-inline">brucewayne@gotham.com</strong>, I know that the person who registered it is most likely not working for the target organization. They may have a third party helping them out. Usually, this is someone's nephew's, brother's, sister's, or uncle's third cousin who happens to know something about computers, who helped them out with registering their domain name.</p>
			<p>Keep track of when their domain name expires. It's very common to see someone else take someone's or an organization's domain after it has expired. Some even extort the original organization by threatening to use the domain for a different purpose that would confuse (or horrify) current customers. Their goal is to get the organization to buy the domain name back at a profit. We call these folks cyber-squatters or trolls.</p>
			<p class="callout-heading">Important</p>
			<p class="callout">Note which <a id="_idIndexMarker237"/>servers are hosting the DNS information in your TIP. In the future, you'll learn how to compromise <a id="_idIndexMarker238"/>every website on that same server by using <strong class="bold">Simulink bypassing</strong>. You can look forward to that book. To do that, you need to know the names of the servers you'll be attacking.</p>
			<h3>Command-line interface</h3>
			<p>If you want to collect a little more information than what you would get from a website, fire up <a id="_idIndexMarker239"/>a Linux box. Using WHOIS on the command line is slightly different from the web interface; you should be able to use both. </p>
			<p>Open a standard Terminal session. Type in <strong class="source-inline">whois</strong> and then whatever website you like. In this example, I'll be using <strong class="source-inline">HackThisSite.org</strong> again. Notice that it kicks back a lot of similar information that we saw through the web interface, but we have some other tools available on the command line:</p>
			<div>
				<div id="_idContainer020" class="IMG---Figure">
					<img src="Images/B17486_02_12.jpg" alt="Figure 2.12 – WHOIS through a Terminal session&#13;&#10;" width="1097" height="883"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.12 – WHOIS through a Terminal session</p>
			<p>Here, we'll often see an IP address block that shows the IP address range that it belongs to. Again, you won't see that with this website because they've protected themselves rather thoroughly. We can also select a specific registrar to search with, and we may find even more information. Using the <strong class="source-inline">whois -h whois.arin.net [IP or 198.148.81.136]</strong> command, we can find a network range, actual phone numbers, some contact information, and even an address:</p>
			<div>
				<div id="_idContainer021" class="IMG---Figure">
					<img src="Images/B17486_02_13.jpg" alt="Figure 2.13 – Finding the network range in Terminal&#13;&#10;" width="769" height="733"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.13 – Finding the network range in Terminal</p>
			<p>In the <a id="_idIndexMarker240"/>next section, we will learn how to use ping and DNS.</p>
			<h1 id="_idParaDest-64"><a id="_idTextAnchor065"/>Using ping and DNS</h1>
			<p>To gather even <a id="_idIndexMarker241"/>more information about our target website, we're going to <a id="_idIndexMarker242"/>use some <a id="_idIndexMarker243"/>common tools – <strong class="bold">ping</strong> and a DNS tool called <strong class="bold">nslookup</strong>. </p>
			<p>First, open a command prompt (on a machine with internet connectivity). Start with a simple <em class="italic">ping</em> of the website we're trying to target. In this case, we're using <a href="http://www.hackthissite.org">www.hackthissite.org</a>. Notice that it first resolves the IP address as <strong class="source-inline">198.148.81.137</strong>. Then, we can see the typical ping results – the round-trip time that it took to hit that box and come back:</p>
			<div>
				<div id="_idContainer022" class="IMG---Figure">
					<img src="Images/B17486_02_14.jpg" alt="Figure 2.14 – Using ping&#13;&#10;" width="941" height="354"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.14 – Using ping</p>
			<p>Now, we can <a id="_idIndexMarker244"/>start playing around with this by increasing the size of the packet <a id="_idIndexMarker245"/>that's going across. Right now, it's just 32 bytes. This will allow us to determine which routers allow for bigger packet sizes, which will be helpful when we start to attack the target. Change the original <strong class="source-inline">ping</strong> command so that it reads <strong class="source-inline">ping hackthissite.org -f -l 1300</strong>:</p>
			<div>
				<div id="_idContainer023" class="IMG---Figure">
					<img src="Images/B17486_02_15.jpg" alt="Figure 2.15 – Reading ping hackthissite.org -f -l 1300" width="911" height="315"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.15 – Reading ping hackthissite.org -f -l 1300</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Use the up arrow to reload a previously entered command. The letter before <strong class="source-inline">1300</strong> is a lowercase L.</p>
			<p><strong class="source-inline">-f</strong> indicates that you don't want to fragment the packet as it goes across. <strong class="source-inline">-l</strong> lets you specify the buffer size you want to use. Increase the packet size incrementally until you're notified that the packet can't be sent without being fragmented:</p>
			<div>
				<div id="_idContainer024" class="IMG---Figure">
					<img src="Images/B17486_02_16.jpg" alt="Figure 2.16 – Reading ping hackthissite.org -f -l 1500" width="941" height="285"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.16 – Reading ping hackthissite.org -f -l 1500</p>
			<p>When it says the packet needs to be fragmented, this means that <strong class="source-inline">1500</strong> bytes is too big to be passed <a id="_idIndexMarker246"/>through some of the routers; the packet will be dropped. Our next <a id="_idIndexMarker247"/>step is to try to decrease the increments to find out what the maximum acceptable packet size is. Find the threshold and make a note of it. Here, you'll see that this router's threshold is for packets that are smaller than <strong class="source-inline">1464</strong>, as <strong class="source-inline">1465</strong> won't pass through:</p>
			<div>
				<div id="_idContainer025" class="IMG---Figure">
					<img src="Images/B17486_02_17.jpg" alt="Figure 2.17 – Reading ping hackthissite.org -f -l 1464" width="923" height="605"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.17 – Reading ping hackthissite.org -f -l 1464</p>
			<p>Next, we want to see the path that the packet took to get to the target IP address. To do so, we'll use another command, <strong class="source-inline">traceroute</strong> or <strong class="source-inline">tracert</strong>, with the IP address:</p>
			<div>
				<div id="_idContainer026" class="IMG---Figure">
					<img src="Images/B17486_02_18.jpg" alt="Figure 2.18 – Using the tracert command&#13;&#10;" width="903" height="442"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.18 – Using the tracert command</p>
			<p>As you can see, traceroute displays the different hops the packet goes through (<strong class="source-inline">hops</strong> represents different routers). Note any increased response times and the address of the router that <a id="_idIndexMarker248"/>may have <a id="_idIndexMarker249"/>dropped the packet. This could be <a id="_idIndexMarker250"/>due to a router that just went down. It could also be that this router doesn't respond to <strong class="bold">Internet Control Message Protocol</strong> (<strong class="bold">ICMP</strong>) requests, which is what ping utilizes (typically, it's the latter).</p>
			<p>Finally, you could use those same ping commands to increase the packet size until it fails on each of the addresses in the list; this would tell you where the limitations are located on each device along our path.</p>
			<p>The next step is to find other IP addresses that could be associated with this domain name using <a id="_idIndexMarker251"/>another CLI tool called <strong class="bold">nslookup</strong>. nslookup compares a domain name with an IP address. It has two different modes – interactive and non-interactive.</p>
			<p class="callout-heading">nslookup Modes – Interactive and Non-Interactive</p>
			<p class="callout"><strong class="bold">Interactive</strong> mode allows <a id="_idIndexMarker252"/>you to issue multiple requests without <a id="_idIndexMarker253"/>leaving the nslookup interface, while <strong class="bold">non-interactive</strong> exits the nslookup interface and returns you to your command prompt as soon as it finishes resolving the IP.</p>
			<p>If you were to use nslookup for <a href="http://yahoo.com">yahoo.com</a>, as I did here, you would be using non-interactive mode. In this mode, it returns a couple of different IP addresses that are linked to Yahoo. It's a non-authoritative answer, which means that the DNS server I used (Google) is not authoritative for Yahoo. That makes sense, right? They're not in charge of Yahoo:</p>
			<div>
				<div id="_idContainer027" class="IMG---Figure">
					<img src="Images/B17486_02_19.jpg" alt="Figure 2.19 – Using nslookup" width="469" height="200"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.19 – Using nslookup</p>
			<p>To enter interactive <a id="_idIndexMarker254"/>mode, simply type in <strong class="source-inline">nslookup</strong> and hit <em class="italic">Enter</em> without specifying <a id="_idIndexMarker255"/> a domain name. In response, we'll get the server that we'll be using to issue queries against. Then, we can type in a URL (let's go with <a href="http://yahoo.com">yahoo.com</a> again). It will show you the IP addresses you would normally resolve to when browsing with your computer or phone:</p>
			<div>
				<div id="_idContainer028" class="IMG---Figure">
					<img src="Images/B17486_02_20.jpg" alt="Figure 2.20 – Interactive mode" width="558" height="300"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.20 – Interactive mode</p>
			<p>Let's try to find <strong class="source-inline">A</strong> records now (an <strong class="source-inline">A</strong> record simply links a computer name to its IP address). This time, we'll try <strong class="source-inline">HackThisSite.org</strong>. nslookup provides us with several different IPs, including some IPv6 addresses (the entries that start with <strong class="source-inline">2610:</strong>):</p>
			<div>
				<div id="_idContainer029" class="IMG---Figure">
					<img src="Images/B17486_02_21.jpg" alt="Figure 2.21 – Performing nslookup on HackThisSite.org&#13;&#10;" width="500" height="356"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.21 – Performing nslookup on HackThisSite.org</p>
			<p>We can use <a id="_idIndexMarker256"/>nslookup to resolve back specific name records using interactive mode. For example, we can <a id="_idIndexMarker257"/>find out what a mail server IP address is by typing in <strong class="source-inline">set type=mx</strong>, which directs nslookup to search based on a specific attribute, which is designed to identify email servers. Then, type in your target site (I used <strong class="source-inline">HackThisSite.org</strong>):</p>
			<div>
				<div id="_idContainer030" class="IMG---Figure">
					<img src="Images/B17486_02_22.jpg" alt="Figure 2.22 – Resolving specific name records using interactive mode" width="994" height="289"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.22 – Resolving specific name records using interactive mode</p>
			<p>BAM! Now, we know which machines oversee answering emails, or at least their <strong class="source-inline">A</strong> record names. Based on these results, we can tell right away that Google maintains the mail servers through Google Mail. As an attacker, the next step is to find out the IP address of this mail server. Return to the <strong class="source-inline">A</strong> record results by typing <strong class="source-inline">set type=a</strong>. Then, enter a mail server's name – for example, <strong class="source-inline">alt1.aspmx.l.google.com</strong> – to view the IP address for that box:</p>
			<div>
				<div id="_idContainer031" class="IMG---Figure">
					<img src="Images/B17486_02_23.jpg" alt="Figure 2.23 – Finding the IP address of a mail server&#13;&#10;" width="469" height="202"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.23 – Finding the IP address of a mail server</p>
			<p>We also want <a id="_idIndexMarker258"/>to figure out what the name of the server is. So, once again, change the type using <strong class="source-inline">set type=cname</strong>. A <strong class="source-inline">cname</strong> attribute is an alias for an <strong class="source-inline">A</strong> record name. Then, type in <a id="_idIndexMarker259"/>the target URL. In the results, we will see the name of the primary name server and the associated email address, which is <strong class="source-inline">admin.hackthissite.org</strong>. (I know, you're thinking that's not an email address. Where's the <strong class="source-inline">@</strong> at? Well, in nslookup land, the first dot replaces the <strong class="source-inline">@</strong> symbol, so the email address is, in fact, <strong class="source-inline">admin@hackthissite.org</strong>.) We will also see the serial number, how often it refreshes, and the default TTL:</p>
			<div>
				<div id="_idContainer032" class="IMG---Figure">
					<img src="Images/B17486_02_24.jpg" alt="Figure 2.24 – Finding out the name of the server" width="646" height="279"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.24 – Finding out the name of the server</p>
			<p>Sometimes, we're not able to resolve an IP address, particularly when it's an internal IP address. In those cases, set the type back to <strong class="source-inline">a</strong>, and then type <strong class="source-inline">server [IP address of the DNS server]</strong>. The IP address here is of the DNS server you want to use (for example, in my case, my internal DNS server is <strong class="source-inline">10.10.10.254</strong>). The returned IP addresses are non-authoritative because my DNS server is not in charge of the target site:</p>
			<div>
				<div id="_idContainer033" class="IMG---Figure">
					<img src="Images/B17486_02_25.jpg" alt="Figure 2.25 – Resolving an IP address&#13;&#10;" width="645" height="636"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.25 – Resolving an IP address</p>
			<p>This information <a id="_idIndexMarker260"/>can be extremely beneficial for finding targets that are exposed <a id="_idIndexMarker261"/>on the internet. After learning about this, a lot of people want to know how to stop this kind of information gathering. There isn't a countermeasure; to send an email, two email servers must communicate with each other. For example, if I try to send an email from <strong class="source-inline">HackThisSite.org</strong> to <a href="http://Google.com">Google.com</a>, my <strong class="source-inline">HackThisSite.org</strong> server needs to be able to <em class="italic">WHOIS</em> Google and find the <strong class="source-inline">mx</strong> record for Google to send my email messages.</p>
			<p>Once again, as you go through each of the steps here, document them in your TIP so that you have it as a reference when you move onto the more active stages of hacking.</p>
			<h1 id="_idParaDest-65"><a id="_idTextAnchor066"/>Summary</h1>
			<p>In this chapter, we started with an overview of reconnaissance, learning how attackers gather information about a target to know when and how to strike. From identifying the machine, they need to target the domains in use, the network blocks in place, and the IP addresses to go after. We looked at passive reconnaissance, active reconnaissance, anonymous reconnaissance, and pseudonymous reconnaissance. </p>
			<p>We also covered the goals of reconnaissance – to find out what attackers are looking for (system and network information, the target's standard technical practices, and their organizational information).</p>
			<p>Then, we delved into search engines as one of the four ways attackers gather information. A simple search often displays loads of information people have no control over. We discussed how the target's website, free giveaways, and what employees say help attackers during the initial search. After that, we turned our attention to Google hacking, Google operators, the Google database, and other Google hacking tools.</p>
			<p>Now, this is just the beginning. In the next chapter, we'll dive a little deeper and see what we can discover about our targets using publicly available intel and social media services.</p>
			<h1 id="_idParaDest-66"><a id="_idTextAnchor067"/>Questions</h1>
			<p>As we conclude, here is a list of questions for you to test your knowledge regarding this chapter's material. You will find the answers in the <em class="italic">Assessments</em> section of the <em class="italic">Appendix</em>:</p>
			<ol>
				<li>What is the purpose of reconnaissance?<ol><li>To discover a target</li><li>To map out the target network</li><li>Scanning a network</li><li>To avoid detection while gathering data on a target for potential vulnerabilities</li></ol></li>
				<li>When trying to obtain employee names and addresses, what is the best source to use?<ol><li>WHOIS</li><li>Tracert</li><li>Traceroute</li><li>Netcraft</li></ol></li>
				<li>What information gathering tool will provide you with information about a web server's operating system?<ol><li>DNSlookuptHE </li><li>nslookup</li><li>Netcraft</li><li>tracert</li></ol></li>
				<li>Following reconnaissance, what's the next step to be accomplished?<ol><li>Enumeration</li><li>Scanning</li><li>System hijacking</li><li>SQL injection</li></ol></li>
			</ol>
		</div>
	</div></body></html>