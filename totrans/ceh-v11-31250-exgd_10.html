<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer117">
			<h1 id="_idParaDest-409"><em class="italic"><a id="_idTextAnchor420"/>Chapter 12</em>: Hacking Mobile Platforms</h1>
			<p>Today, when we see devices on mobile platforms come out, we have this tendency – hopefully, from the hacker's perspective – of thinking, "<em class="italic">What am I going to do now?</em>" </p>
			<p>A favorite quote of mine comes from the great Star Wars character Master Yoda when he says, "<em class="italic">Size matters not. Look at me. Judge me by my size, do you?</em>" It's the same concept here with mobile devices. They're extremely small. Most of our smartphones are more powerful than the computer systems NASA used to get man on the moon in the 1970s. The rate at which mobile devices are coming out and the applications that are being supported on these devices is mind-boggling. </p>
			<p>So, buckle up – I'm about to take you through several different aspects of the mobile platform from a hacker's perspective.</p>
			<p>In this chapter, we will cover the following topics:</p>
			<ul>
				<li><a id="_idTextAnchor421"/>Vulnerabilities in mobile environments</li>
				<li>OWASP's Top 10 risks for mobile devices</li>
				<li>Hacking Android</li>
				<li>Hacking iOS</li>
				<li>Mobile device management</li>
			</ul>
			<p>Let's start by identifying the process and some keywords for attacking vulnerabilities or attack vectors in mobile devices.  </p>
			<h1 id="_idParaDest-410"><a id="_idTextAnchor422"/>Vulnerabilities in mobile environments</h1>
			<p>In addition to <a id="_idIndexMarker1907"/>the vulnerabilities that we see in our network attacks, cloud attacks, and wireless attacks, there are more vulnerabilities or attack vectors associated with mobile devices than there are with standard desktop environments. Here are some of the other vulnerabilities that affect our mobile world:</p>
			<ul>
				<li><strong class="bold">Apps and app stores</strong>: It's important to know where you're getting apps from because as an attacker, I'll take a popular application, recompile it with my malware, and try to redistribute it. </li>
				<li><strong class="bold">Viruses, worms, and rootkits</strong>: The malware we deal with in the desktop environment is the same malware we will encounter in the mobile device environment. </li>
				<li><strong class="bold">Data storage</strong>: Developers must carefully consider which data will be stored on the smartphone and how it will be secured. A mobile app should avoid storing sensitive information, such as passwords or credit card numbers, on the phone's local filesystem <a id="_idIndexMarker1908"/>since that may allow an attacker to gain access after the device has been physically acquired.</li>
			</ul>
			<p>Storing any sensitive information on the local filesystem is not recommended but doing so in a SQLite database may be marginally better… if your security senses just tingled, it should be because of what we know about SQL and injection attacks. That's why I say marginally better.</p>
			<ul>
				<li><strong class="bold">Copying information</strong>: If I get information via an email and I save it (since it came as an attachment) to <a id="_idIndexMarker1909"/>my local <strong class="bold">Secure Digital</strong> (<strong class="bold">SD</strong>) card, and then I forward it to my Dropbox, I'll be exposing my system to attackers. You may want to consider encrypting your data storage so that if somebody pulls your SD card or gets hold of your device, they must type in a pin, just like when you turn a phone on from a cold boot. </li>
				<li><strong class="bold">Social engineering</strong>: We covered this in <a href="B17486_08_ePub.xhtml#_idTextAnchor226"><em class="italic">Chapter 8</em></a>, <em class="italic">Social Engineering</em>, but to reiterate, it's a non-technical method of getting people to do things they normally wouldn't do. We can use technology to socially engineer, but manipulation is always involved at the human level, not at the device level. From a mobile perspective, most social engineering happens via email, text messages, or multimedia messages.</li>
			</ul>
			<p>You have probably been a victim of in-person social engineering – you just didn't know it. Social engineering also happens on social networking sites. Advertisement is also a way of implementing social engineering to get you to click on the link, like something, or hijack a Facebook account. Then, I can post to their friends saying, "<em class="italic">Hey, there's this new security issue out there, click on this link, I'm trying to help you out,</em>" and when they click on it, I infect them. </p>
			<p>It's also being done via video chat. For example, when I installed Skype or Zoom to be able to do video conferencing, I received eight invitations within the first 3 minutes from strangers. Listen, I know I'm popular, but come on!</p>
			<ul>
				<li><strong class="bold">Short message service (SMS) environment</strong>: There's a big increase in attacks in SMS environments, especially via SMS phishing, because most people don't know <a id="_idIndexMarker1910"/>how devices are designed to work. We get messages from what looks like our banks or one we don't even have an account with. They include links that can very easily be links to a phone number that dials a different number from what's being displayed. When you click on it, they dial a different number or route you to a different phone number. Some links take you to a fake but identical website. They tell you, "<em class="italic">Hey, your account has been locked out, follow this link to learn more</em>." </li>
				<li><strong class="bold">Drive-by</strong>: This is when an attacker delivers a piece of malware to a device when somebody browses a specific web page. A lot of times, a drive-by is software-created, or in web browsers. The software could be the operating system, Java, or any type of web plugin, but web browsers also create this big hole for us. </li>
				<li><strong class="bold">Older versions of operating systems on mobile devices</strong>: It's hard for manufacturers to keep up with this. They struggle with updating the operating system. There are vulnerabilities in most operating systems and we're not talking about older legacy stuff. It could be a second-gen iPad on the network, a first-gen iPad, Samsung S3, or iPhone 4. The real challenge is if they are still allowing updates to fix holes in security.</li>
				<li><strong class="bold">Phishing</strong>: This is done via fake emails. Sometimes, it's hard to realize that the link in an email is invalid or know if a website is fake. Of course, it's part of our social engineering environment. They get you to type in your username and password because of an email that says your Citibank credit card has been locked out <a id="_idIndexMarker1911"/>and you need to log in. They then take you to a website that's not Citibank. Luckily, it is getting harder to accomplish phishing-type attacks because many companies have separate apps. People can confirm such information quickly. </li>
				<li><strong class="bold">Connections</strong>: Is your device always connected to a cellular network, Wi-Fi network, Bluetooth, or <a id="_idIndexMarker1912"/>the scary <strong class="bold">Near Field Communication</strong> (<strong class="bold">NFC</strong>)?</li>
			</ul>
			<p>Now, let's look at what OWASP has specified as the top attack vectors for mobile.</p>
			<h1 id="_idParaDest-411"><a id="_idTextAnchor423"/>OWASP's Top 10 risks for mobile devices</h1>
			<p><strong class="bold">Open Web Application Security Project</strong> (<strong class="bold">OWASP</strong>) publishes the top 10 risks for mobile <a id="_idIndexMarker1913"/>devices each year. The M stands for Mobile, and the list is pretty similar to the OWASP Top 10 web application risks that were finalized and published in 2016. Note that OWASP is a fantastic resource for you to follow and learn from (<a href="https://owasp.org">https://owasp.org</a>). Let's take a closer look at these risks: </p>
			<ul>
				<li><strong class="bold">M1: Improper Platform Usage</strong>: This category pertains to a violation of the platform's <a id="_idIndexMarker1914"/>functionality or failure to use security features. This might be an Android intent, platform permissions, TouchID misuse, the keychain, or some other mobile system security feature that you don't utilize correctly. </li>
				<li><strong class="bold">M2: Insecure Data Storage</strong>: There is a trade-off with supporting offline functionality. Developers must carefully consider which data will be stored on the mobile <a id="_idIndexMarker1915"/>device and how it will be stored. A mobile app should avoid storing sensitive information on the local filesystem, if possible, as that could lead to an attacker gaining access after the physical acquisition of the device.</li>
			</ul>
			<p>Storing any sensitive information on the local filesystem is not recommended but doing so in a SQLite database may be marginally better.</p>
			<ul>
				<li><strong class="bold">M3: Insecure Communications</strong>: Mobile apps should avoid using non-secured <a id="_idIndexMarker1916"/>communication methods that could result in attackers sniffing or manipulating transmitted data. This includes HTTP, FTP, Telnet, WAP, and GPRS (if not over SSL). There are often cases where an HTTPS connection cannot be established due to certificate validation failures (for example, self-signed certificates). In this case, a developer may choose to accept the risk and disable HTTPS validation.</li>
				<li><strong class="bold">M4: Insecure Authentication</strong>: Mobile apps should always implement secure authentication methods. This includes using OAuth 2.0 wherever possible, as well as <a id="_idIndexMarker1917"/>implementing strong password/PIN policies to lock the device after a few failed attempts. An application that supports single sign-on should only do so with trusted sources that adhere to security best practices.</li>
				<li><strong class="bold">M5: Insufficient Cryptography</strong>: Mobile apps should always use standard cryptographic <a id="_idIndexMarker1918"/>algorithms and implementations. This includes using FIPS 140 validated cryptography for any operations that require strong cryptography. Weak cryptography increases the risk of a data breach, whether it's intentional or not.</li>
				<li><strong class="bold">M6: Insecure Authorization</strong>: Insecure authorization exposes data, allows attackers <a id="_idIndexMarker1919"/>to perform actions as authenticated users, and facilitates attacks such as Insecure Direct Object Reference.</li>
				<li><strong class="bold">M7: Client Code Quality</strong>: Mobile app client code should never be trusted. Malicious <a id="_idIndexMarker1920"/>mobile apps can easily exploit client-side vulnerabilities by modifying how the application functions using reflection, changing the flow of execution, injecting commands into the command stream, or even executing native machine code. Developers need to verify that mobile app clients are valid before accepting them. A mobile app scanner, such as Drozer, can be used to test for these vulnerabilities.</li>
				<li><strong class="bold">M8: Code Tampering</strong>: Malicious mobile apps can leverage dynamic code loading to <a id="_idIndexMarker1921"/>tamper with the original app. Several commercial and open source dynamic code loading frameworks are commonly used for legitimate purposes but also leave developers vulnerable to abuse.</li>
				<li><strong class="bold">M9: Reverse Engineering</strong>: Mobile apps may be reverse-engineered using automated <a id="_idIndexMarker1922"/>tools or manually by examining application binaries after being decompiled.</li>
				<li><strong class="bold">M10: Extraneous Functionality</strong>: An attacker will download and inspect the mobile <a id="_idIndexMarker1923"/>app in their environment. They'll look at the log files, configuration files, and perhaps the binary itself to see whether any hidden switches or test code was left behind by the developers. They will utilize these switches and covert functions on the backend system to execute an assault.</li>
			</ul>
			<p>Now, let's talk about hacking Android.</p>
			<h1 id="_idParaDest-412"><a id="_idTextAnchor424"/>Hacking Android</h1>
			<p>To begin, it's important <a id="_idIndexMarker1924"/>to understand the bigger picture about what we're dealing with when it comes to hacking mobile platforms. So, let's start by understanding the Android security environment.</p>
			<h2 id="_idParaDest-413"><a id="_idTextAnchor425"/>Android security</h2>
			<p>To understand <a id="_idIndexMarker1925"/>any type of security, you need to know the architecture that lies underneath the platform, because it can show you where the holes are on that device. </p>
			<p>Android security is layered like an onion. Let's look at each layer one by one.</p>
			<h3>Linux kernel layer</h3>
			<p>Like Windows, macOS, and others, Android has a Linux kernel as its first layer. </p>
			<p>Android used it because it's stable – it has a proven driver set. The Linux kernel creates an interface <a id="_idIndexMarker1926"/>between the hardware that may be installed <a id="_idIndexMarker1927"/>on the device, be it the display, the camera on the device, USB ports, networking ports, the keypad on the screen, Bluetooth, Wi-Fi, sound, and the power features. All these devices are supported directly by the operating system via this layer of the architecture. </p>
			<h3>Libraries layer </h3>
			<p>This <a id="_idIndexMarker1928"/>layer has <a id="_idIndexMarker1929"/>some built-in libraries, including the following: </p>
			<ul>
				<li><strong class="bold">The Surface Manager</strong>: This is <a id="_idIndexMarker1930"/>simply there to compose the windows you see displayed on the screen. </li>
				<li><strong class="bold">Open Graphics Library</strong> (<strong class="bold">OpenGL</strong>) <strong class="bold">and Graphics Library Kit </strong>(<strong class="bold">GLKit</strong>): These <a id="_idIndexMarker1931"/>oversee both 2D and <a id="_idIndexMarker1932"/>3D displays. What's cool about this infrastructure is that an application can switch from 2D to 3D almost seamlessly. </li>
				<li><strong class="bold">Media framework</strong>: This allows you to play back and record multimedia (audio, video, or pictures) back on the display. For example, most of our codex is built into this <a id="_idIndexMarker1933"/>framework, such as MP3. So, when you power on a brand-new phone, you can take a picture and look at it immediately. That's because it's in JPEG format. You can also download an MP3 file and listen to it immediately; you don't have to download and install any additional codex. </li>
				<li><strong class="bold">FreeType</strong>: This <a id="_idIndexMarker1934"/>component is there to render our fonts. You can change the fonts that are being displayed throughout the system, including their size and type. Some applications will also pull on this free type so that you can change the font within the application itself. </li>
				<li><strong class="bold">Open SSL</strong>: This <a id="_idIndexMarker1935"/>gives us security when we're communicating with other devices.</li>
				<li><strong class="bold">SQLite</strong>: This is <a id="_idIndexMarker1936"/>a database engine. However, it can create vulnerabilities on Android devices. The same type of vulnerabilities that we see <a id="_idIndexMarker1937"/>in a standard <strong class="bold">Structured Query Language</strong> (<strong class="bold">SQL</strong>) database server can be implemented in some cases against these mobile devices. </li>
				<li><strong class="bold">WebKit</strong>: This is <a id="_idIndexMarker1938"/>an open browser. It's the same engine that Apple's Safari uses. </li>
			</ul>
			<p>Next, let's talk about the runtime layer. </p>
			<h3>Runtime layer</h3>
			<p>At this <a id="_idIndexMarker1939"/>layer, we have the core libraries and the Dalvik virtual <a id="_idIndexMarker1940"/>machines. It is simply a runtime layer that includes a set of core Java libraries. This allows application programmers to build their apps using the standard Java programming language. </p>
			<p>Here is a list of the most common runtime layers: </p>
			<ul>
				<li><strong class="bold">The Dalvik VM</strong>: This is an open source software that was named after a fishing village in <a id="_idIndexMarker1941"/>Iceland where the creator's ancestors hailed from. It's a virtual machine and it's been streamlined for mobile devices so that multiple virtual machines can be running to support multiple apps. In the Android world, we sandbox each of our apps. It has a low memory requirement, and it relies on the underlying OS for process isolation, memory management, and thread support. </li>
				<li><strong class="bold">Framework layer</strong>: This is <a id="_idIndexMarker1942"/>where we see the core applications that come with our device. For example, T-Mobile may load some default applications that are proprietary to their environment, such as TouchWiz, the interface they load on top of Android. </li>
				<li><strong class="bold">Activity manager</strong>: This <a id="_idIndexMarker1943"/>simply manages the life cycle of applications. This includes starting and running an application. It also manages a pause state if an application is paused because we switch out to a different app. There's a stop state if the application hasn't been used in a while, as well <a id="_idIndexMarker1944"/>as a destroy state, which removes things out of the resources when the activity manager decides there's no more use for that activity. </li>
				<li><strong class="bold">Window manager</strong>: This is <a id="_idIndexMarker1945"/>what we see on the screen itself. So, there's a component that's managing that for us. </li>
				<li><strong class="bold">Package manager</strong>: This <a id="_idIndexMarker1946"/>keeps track of which applications we have installed when it comes to updates or how to uninstall a particular application. </li>
				<li><strong class="bold">Telephony manager</strong>: This oversees managing your phone calls. If you've built an <a id="_idIndexMarker1947"/>application in which when you click on a contact, you see their phone number, and when you click on it, you need to fire off and have it dial that phone number, the application is calling on the telephony manager. </li>
				<li><strong class="bold">Resource manager</strong>: This <a id="_idIndexMarker1948"/>manages the resources that your application may use. </li>
				<li><strong class="bold">Content providers</strong>: This manages the data that's shared between applications, so we get that seamless feeling in the environment itself. For example, a couple <a id="_idIndexMarker1949"/>of our default content providers include the call log, which provides our missed calls, call details, and the time of the calls. The address book or the user dictionary is also a content provider. As you start to type things in, the default user dictionary may not recognize the word, but you know that it's a correct word and you sometimes hit the check that says, "<em class="italic">This is the correct spelling.</em>" Another example would be when you install, say, Facebook – the Facebook wall is an activity. When you click on the photo button, you may pull up the content provider into the Photoshop gallery so that you can share photos via the Facebook application. </li>
				<li><strong class="bold">Location manager</strong>: This is the framework that's used by your GPS and possibly your <a id="_idIndexMarker1950"/>cell phone towers to determine where someone is located. For example, I can pull this up via an application and see where my kids are. They don't have to have GPS on – it triangulates through the cell towers. </li>
				<li><strong class="bold">The view system</strong>: This is simply what it sounds like; the different views we have of <a id="_idIndexMarker1951"/>applications and windows. It does a lot of communication through the windows manager. </li>
				<li><strong class="bold">Notification manager</strong>: This <a id="_idIndexMarker1952"/>application simply notifies us when we've missed a call or a text message. </li>
			</ul>
			<p>Next, let's look at the apps layer.</p>
			<h3>Apps layer</h3>
			<p>This is <a id="_idIndexMarker1953"/>where we see things such as the home screen or our contacts, the built-in applications, the phone, and the browser. As you add additional applications to your device, it adds them here at this level. It uses the framework, the libraries, and the runtime to interact with the devices to do what we want our device to do. </p>
			<p>Now, let's <a id="_idIndexMarker1954"/>look at <strong class="bold">near-field communication</strong> (<strong class="bold">NFC</strong>) attacks next.</p>
			<h3>NFC attacks </h3>
			<p>I love NFCs. As an attacker, I might be looking out for legitimate NFC tags. I may create a tag and <a id="_idIndexMarker1955"/>place it on top of one on a sign in a mall or a grocery store or tear it off and replace it with mine. Usually, the user simply tags or taps to get information. I could then send them off to a website that has an exploit to a vulnerability in WebKit, such as <strong class="source-inline">1759</strong>. Any user who scans the tag will end up with a rooted and compromised device. </p>
			<h3>Relay attack</h3>
			<p>All the <a id="_idIndexMarker1956"/>attacker needs to execute a relay attack are two devices that act as a token and a reader. They create a connection via a proxy channel. This is typically Bluetooth, but it could also be Wi-Fi. This allows us to relay the information over a greater distance. The proxy reader is then used to communicate with the real token while the proxy token is placed near a real reader. The token assumes it's talking to <a id="_idIndexMarker1957"/>the reader and responds accordingly. That response is then relayed back to the token proxy, which will transmit the information back to the reader.</p>
			<h2 id="_idParaDest-414"><a id="_idTextAnchor426"/>Hacking techniques</h2>
			<p>Let's discuss <a id="_idIndexMarker1958"/>some of the techniques as an ethical hacker you can gain access to devices, networks, and systems.</p>
			<h3>Rooting</h3>
			<p>When it comes to rooting, we escalate our privileges to gain root access to the device. Rooting allows <a id="_idIndexMarker1959"/>you to make all kinds of customizations, including tweaking settings, loading custom OSs, and even improving performance. I root my devices so that I can get rid of bloatware that comes with most phones, but I do understand the risk that I take by doing so.</p>
			<p>When it comes to applications, they are restricted by the security model so that an application can only access its own files, the external storage, or the external SD cards and only has access to resources and features that it requested during installation. By rooting, we're allowing certain applications to run as the root user. When this happens, the security model breaks down because we're bypassing the default permissions. </p>
			<p>Not all applications will automatically use root-level access. Facebook, for instance, will still use the resources and information that it needs.</p>
			<p>Rooting shouldn't be done by the weak-hearted or someone that doesn't understand what they're doing as you can <em class="italic">brick</em> a device or open you and your company to added risks.</p>
			<p>Tools such as KingoRoot, TunesGo Root Android Tool, and One Click Root can be used to open things <a id="_idIndexMarker1960"/>up a bit for you. Other options include rooting via the <strong class="bold">Android Debug Bridge</strong> (<strong class="bold">ADB</strong>) and tools such as Phonesploit.</p>
			<h3>Man-in-the-disk attack </h3>
			<p>When an attacker has physical access to a device and can install a harmful program on it, this <a id="_idIndexMarker1961"/>attack can be performed. The app does not need to be downloaded via the official app store; malware may be installed in any way, including through a USB connection or over a wireless network. Once the app has been installed, it can exploit vulnerabilities in the Android operating system to gain access to sensitive data.</p>
			<p>The Android OS consists of two types of storage: internal and external. In general, the internal storage for Android apps is sandboxed, whereas the external storage is intended to enable file sharing between applications, making it vulnerable to MITD assaults.</p>
			<p>When a genuine program attempts to perform a typical upgrade, an attacker watches the data stored on the external storage and tries to modify, delete, or replace the application data by editing the source code of the upgrade. When the legitimate app update is successfully injected by malware, the user application downloads and executes the malicious code, allowing an attacker to install a fake app.</p>
			<h3>Speakerphone attack</h3>
			<p>Android applications may capture speakerphone traffic without any need for permission. Sniffing speakerphone voice conversations between remote mobile users is possible <a id="_idIndexMarker1962"/>via the hardware-based motion sensor, known as the accelerometer, which attackers use to listen in on them. The accelerometer is a piece of hardware that is built into most smartphones and may be accessed by any app on the phone without requiring additional permissions. The motion sensor allows applications to monitor the device's physical movement based on changes in position and velocity. This built-in sensor may also capture speech reverberations because the speakerphone is on the same surface.</p>
			<h3>Tap 'n Ghost attack</h3>
			<p>There's a unique type of assault that may steal your PIN without you noticing it. The Tap 'n Ghost <a id="_idIndexMarker1963"/>attack exploits NFC to obtain your PIN from your phone. Here's how it works: the attacker taps their phone against yours, and then quickly removes their phone before anything happens. This sends a signal to your phone that opens up a special page where you can enter your PIN. Since the page only appears for a split second, most people would not notice it. Even if you do notice it, you won't have time to enter your PIN before the attacker puts away their phone again.</p>
			<p>This attack was demonstrated by security researchers at the Black Hat conference in Las Vegas. They showed how they could steal PINs from phones running Android. Then, not long after that, I got hit with this one at Defcon. Thank heavens I was using my burner phone so that I could take photos (this phone doesn't have any accounts or personal information <a id="_idIndexMarker1964"/>associated with it – I just carry it to take photos at Black Hat and Defcon). So, I was standing to the side minding my own business, trying to put some books I had just bought into my backpack, when an individual came up to me and tried (poor attempt) to social engineer me by saying "What books did you buy?" As I turn to look at him, I felt my phone vibrate in my pocket. I stared at him, pulled out my phone, and he got real nervous. I said "hang on a second" and he turned and walked away real fast... my screen didn't show anything (that's how this hack works), but I was curious why my phone would have vibrated since it had no SIM card in it, the wireless was turned off, Bluetooth was off.... ahhhh, I forgot about the NFC feature! So, yeah, it's a good reminder to be careful when you're using your phone near other phones. And you know my mantra... if you don't use it, TURN IT OFF!</p>
			<p>Next, let's talk about how we can lock down an Android device.</p>
			<h2 id="_idParaDest-415"><a id="_idTextAnchor427"/>Locking down Android devices</h2>
			<p>When it <a id="_idIndexMarker1965"/>comes to Android devices, there are a couple of things we need to look at. First, it's important to know about the wonder of app stores and how apps get onto their platforms.</p>
			<h3>The approval process for applications </h3>
			<p>This is going to be where Android suffers a tad because developers pay a one-time fee to upload <a id="_idIndexMarker1966"/>their application to the Google Play Store and the application appears within an hour. However, Apple does statistical analysis to detect any improper usage of their API. This causes the application to take about a week to be approved. </p>
			<p>Also, developers are required to pay a $99 developer fee, slightly raising the bar as far as entry into the App Store goes. Android supports installing apps from unknown sources. Can you see where the issue is just by that statement? We call this sideloading. What this means is a user can install an app from a third-party app store. And just because the app says it's signed doesn't necessarily mean it's signed, because Android doesn't care who signs the application. However, Apple only allows users to install iOS applications from its App Store. There's no sideloading natively, so the iOS kernel enforces this security mechanism by only executing signed code by an approved party. </p>
			<p>When it <a id="_idIndexMarker1967"/>comes to which one you should use, it's like choosing between driving a car and taking a flight. If I choose to drive, I risk getting into an accident or being affected by somebody else. A trip on a plane is much safer. Similarly, Apple's approach to its strict control gives the added benefit of a reduced target as far as malware is concerned – not that it's invulnerable. However, Google's approach allows more freedom but comes with more risks. </p>
			<h3>Other ways to secure Android devices</h3>
			<p>Here's a <a id="_idIndexMarker1968"/>great list of items we can consider to help protect <a id="_idIndexMarker1969"/>our Android devices. Note that these don't include looking at <strong class="bold">Mobile Device Management</strong> (<strong class="bold">MDM</strong>). We'll cover that in a second:</p>
			<ul>
				<li>Updates – not just the OS, but also the apps. Here's the real kicker – after a couple of years, you'll no longer have OS upgrade support from the manufacturer. Samsung just announced in 2022 that they would be expanding their OS support for new devices from 3 years to 4 years. After that time frame (or if you have an older device already), you're forced to upgrade.</li>
				<li>Add user information to your lock screen. My lock screen looks like this:</li>
			</ul>
			<div>
				<div id="_idContainer116" class="IMG---Figure">
					<img src="Images/B17486_12_01.jpg" alt="Figure 12.1 – Using a lock screen's user information&#13;&#10;" width="781" height="598"/>
				</div>
			</div>
			<p class="figure-caption">Figure 12.1 – Using a lock screen's user information</p>
			<ul>
				<li>Do I need <a id="_idIndexMarker1970"/>to speak about anti-virus or malware protection?</li>
				<li>Use multiple accounts if your device is shared with others.</li>
				<li>Don't download <strong class="source-inline">.apk</strong> files from any source. Yes, this includes torrents!</li>
				<li>Encrypt your device using the necessary option in your settings feature.</li>
				<li>Read the permissions that an app wants on your device. No game should ever have access to your contacts or phone number.</li>
				<li>Turn off Wi-Fi when you're not using it… please!</li>
				<li>My favorite trick – uninstall apps you're not using. For example, when I'm not traveling, I do not need Uber, so I uninstall it. When I need it, I just reinstall it. This will also improve the performance of the device.</li>
				<li>Use a VPN when you're not on your network. My favorite statement is, "<em class="italic">Not your network? It may no longer be your device!</em>"</li>
				<li>Use a password manager.</li>
				<li>Enable two-factor authentication on any app that supports it.</li>
			</ul>
			<p>Now, let's move on to the Apple side of things.</p>
			<h1 id="_idParaDest-416"><a id="_idTextAnchor428"/>Hacking iOS</h1>
			<p>Now that <a id="_idIndexMarker1971"/>we've covered hacking Android, let's discuss the process of hacking iOS and its products. </p>
			<h2 id="_idParaDest-417"><a id="_idTextAnchor429"/>The Apple architecture</h2>
			<p>Apple is <a id="_idIndexMarker1972"/>unique, but <a id="_idIndexMarker1973"/>like Android, it has several different layers. </p>
			<p><strong class="bold">iPhone Operating System</strong> (<strong class="bold">iOS</strong>) is the <a id="_idIndexMarker1974"/>platform Apple uses for iPhones, iPads, iPods, and other iDevices. It is an integrated system. Apple does not allow iOS to be implemented on non-Apple devices. iOS is simply an intermediary between the hardware and applications. </p>
			<p>Applications are not supposed to try to access hardware directly. Instead, they go through several different layers of the architecture. </p>
			<h3>The core OS </h3>
			<p>The system <a id="_idIndexMarker1975"/>level involves the kernel environment, the drivers, and low-level Unix interfaces of the operating system. iOS provides a set of interfaces for accessing many of the features of the operating systems. When folks create applications, those features are handled through the libSystem library. The interfaces are C-based, which gives us the ability to control things such as networking, BSD sockets, locale information, networking components, as well as filesystem access. It's also in charge of DNS services and Bonjour. </p>
			<h3>The Cocoa application </h3>
			<p>This is an <a id="_idIndexMarker1976"/>important layer. It's the main layer that most developers deal with. It's responsible for the interface we see standardized throughout the Apple platform. It's also in charge of the text kit, which is what oversees the way the text is formatted – paragraphs, columns, and pages. It's also in charge of our push notification services. So, we can push text notifications or add a badge to our icon that says, "<em class="italic">You've got a notification, you have a new text message.</em>" </p>
			<h3>The media layer </h3>
			<p>This layer oversees <a id="_idIndexMarker1977"/>several technologies that deal with media and what you see on the screen – the camera, audio, 2D, and 3D. It uses OpenGL and GLkit, which oversee both 2D and 3D rendering. </p>
			<h3>The core services layer </h3>
			<p>This layer <a id="_idIndexMarker1978"/>has different features associated with it, such as the peer-to-peer services that your device uses to connect or initiate a connection to other devices that are nearby. This is mostly used in games.</p>
			<h3>iCloud storage </h3>
			<p>This feature <a id="_idIndexMarker1979"/>allows you to write applications so that users' documents and data are pushed to the iCloud. </p>
			<p>Other architecture layers exist to support iOS, but these are the main ones you need to be concerned about for your exam.</p>
			<p>Now, let's discuss jailbreaking.</p>
			<h2 id="_idParaDest-418"><a id="_idTextAnchor430"/>Jailbreaking </h2>
			<p>Jailbreaking is <a id="_idIndexMarker1980"/>different from rooting. Jailbreaking can be compared to what Morpheus could do in The Matrix. He could bend the rules of The Matrix to <a id="_idIndexMarker1981"/>overcome some restrictions. He could leap across tall buildings but could still be killed within The Matrix. Rooting is what Neo could do. He could not only bend those rules but break them. </p>
			<p>What happens during jailbreaking? </p>
			<p>When jailbreaking, we start by removing the restrictions that Apple has placed. Most people jailbreak their devices to be able to do things such as load applications that Apple doesn't necessarily want you to utilize. Apple does this for various reasons, including marketing issues such as blocking pop-up ads because some game manufacturers or developers make their money through advertisements. </p>
			<p>We can accomplish this by loading up a custom kernel that has root access. </p>
			<p class="callout-heading">Note</p>
			<p class="callout">Root access in iOS has a different definition from root access in Android. Once the user gives themself this control, they're able to download applications and software that the app store doesn't want to allow. </p>
			<p>It also allows for customization, such as adding themes or extensions that Apple doesn't support. It also lets you unlock the phone. This is how we were able to get AT&amp;T versions of the iPhone to work on the T-Mobile network. </p>
			<p>Jailbreaking <a id="_idIndexMarker1982"/>allows you to use software Apple doesn't think you should have access to and one of the biggest ones is ad blockers. </p>
			<p>Another cool feature is being able to untether Hey Siri. This means that normally, we say, "<em class="italic">Hey Siri</em>" and iOS picks that up for hands-free operation and voice commands, but it's typically restricted when you have your device plugged into a power outlet. Well, there's an <a id="_idIndexMarker1983"/>app that allows you to recognize Siri when it's plugged in, or you want to get rid of some of the applications or interface elements. There's one out there called HideMe8, which allows you to hide apps, hide badges, get rid of certain elements, customize the date text, and change the lock screen. </p>
			<p>Activator is another nifty item that's out there. It allows you to assign custom actions to gestures and button presses. So, if you wanted to launch Facebook, you could say whenever I do a three-finger swipe, launch Facebook. You could also say that if I short hold the home button, fire up the camera. You can get crazy with customizations. When it comes to dealing with WinterBoard, you can also change your toggle settings so that you can have a toggle for your VPN or personal hotspot. You can even bypass the tethering options so that regardless of whether your carrier allows you to tether or not, you can turn your device into a hotspot, and as far as your carrier is concerned, it's the iPhone or the iDevice that's requesting the data. </p>
			<p>Remember, when jailbreaking, we are modifying the security of the device, so we must be careful. Do it if you know what you're doing. I would never jailbreak a device and hand it over to my in-laws or to a kid who doesn't understand what I've done to the device and why I did it. </p>
			<h3>Types of jailbreaking </h3>
			<p>There are different techniques for jailbreaking you can implement, as follows:</p>
			<ul>
				<li><strong class="bold">Untethered jailbreak</strong>: This <a id="_idIndexMarker1984"/>has the attribute that if a user turns the device off and <a id="_idIndexMarker1985"/>then back on, the device starts up completely, and without the assistance of a computer, the kernel will be patched.</li>
				<li><strong class="bold">Tethered jailbreak</strong>: Here, a computer is needed to turn the device on each time it's <a id="_idIndexMarker1986"/>rebooted. If the device starts up on its own, it's no <a id="_idIndexMarker1987"/>longer a patched kernel, and it gets stuck in that partially started state. By using a computer, the phone is essentially re-jailbroken each time it turns on, which sounds like a hassle. </li>
				<li><strong class="bold">Semi-tethered</strong>: When a device boots, it will no longer have a patched kernel, so it <a id="_idIndexMarker1988"/>won't be able to run any modified <a id="_idIndexMarker1989"/>code, but it's still usable for normal functions, such as placing calls or texting. To use any features that require modified code to execute, the user must use a jailbreaking tool to start the device with a patched kernel.</li>
			</ul>
			<p>Now, let's talk about the three types of jailbreaking.</p>
			<h3>The three types of jailbreaking</h3>
			<p>It's important to understand the three main ways you can jailbreak your device. We'll cover them in the following subsections.</p>
			<h4>The userland exploit </h4>
			<p>This is a <a id="_idIndexMarker1990"/>piece of software that runs on the iOS device after <a id="_idIndexMarker1991"/>the kernel has started. This exploit uses a loophole in the system application. It allows user-level access but does not allow iBoot-level access. These types of exploits cannot be tethered because nothing can cause a recovery mode loop. These types of exploits can and have been patched by Apple. </p>
			<h4>The iBoot exploit </h4>
			<p>The iBoot exploit allows for jailbreaking, user-level access, and iBoot-level access. It's an exploit that <a id="_idIndexMarker1992"/>can be semi-tethered if the device has a new boot ROM. This <a id="_idIndexMarker1993"/>exploit turns off code signing and runs a program that does all the work for us. This exploit can be patched with some firmware updates. </p>
			<h4>Boot ROM exploits </h4>
			<p>This exploit <a id="_idIndexMarker1994"/>uses a loophole in the secure ROM, which is the first bootloader. It disables the signature checks, which can be used to load a patch or firmware. Firmware updates cannot patch these types of exploits. The boot ROM exploit allows user-level access and iBoot-level access. The only way for them to patch this is for Apple to update the hardware of the boot ROM. </p>
			<h3>Locking down the Apple platform </h3>
			<p>As far as locking down the Apple platform is concerned, when it comes to the jailbreaking <a id="_idIndexMarker1995"/>device, even though you open a plethora of options <a id="_idIndexMarker1996"/>that Apple doesn't necessarily want you to have access to, you just need to know what those ramifications can include because I can now gain access to the device remotely. Think of that from the attacker's perspective. </p>
			<p>For me, the biggest issue is still at the physical level. If an attacker gets physical access to any device – Apple, Android, a PC, laptop, or server – we need to consider what risks come into play as we move around with these devices. We need to batten down the hatches: </p>
			<ul>
				<li>Passcode-lock your device. I know that's a "<em class="italic">duh Dale</em>" statement, but I needed to say it.</li>
				<li>Don't sideload apps.</li>
				<li>Disable JavaScript and add-ons from your web browser.</li>
				<li>Don't store sensitive data on any client-side databases.</li>
				<li>If you jailbreak, please change the default root password from "alpine."</li>
				<li>Configure Find My Phone to wipe if the device is lost or stolen.</li>
				<li>Update, update, update. This includes the OS, the apps, and any plugins.</li>
				<li>Disable iCloud services to stop sensitive enterprise data from being backed up to your cloud.</li>
				<li>Enable <em class="italic">Ask to Join Networks</em> so that you connect to rogue wireless networks.</li>
				<li>Enable Erase Data after 10 attempts.</li>
				<li>Turn off Siri. She doesn't <a id="_idIndexMarker1997"/>need to be listening in and logging <a id="_idIndexMarker1998"/>the things you talk about or what your company is talking about.</li>
				<li>While you're at it, turn off voice dial. Attackers can access your phone without entering your passcode if it's enabled and they have physical access to your device.</li>
				<li>Turn off some of the same protections we saw with Android. This includes turning off secure networks, two-factor authentication, encryption for the device, staying off public Wi-Fi, and stopping clicking on email links.</li>
			</ul>
			<p>Now, let's explore MDM.</p>
			<h1 id="_idParaDest-419"><a id="_idTextAnchor431"/>Mobile device management</h1>
			<p>MDM is a piece of software that monitors all your mobile devices, allowing us to deploy secure smartphones, tablets, desktops, and laptops. </p>
			<p>MDM optimizes <a id="_idIndexMarker1999"/>and automates the functionality and security of your devices throughout the enterprise in and out of the corporate network. We can control things such as allowing applications to be distributed where data is stored, how the device is configured, which patches to install, and how to handle the device that's been compromised. How about just shoot it, put it out of its misery? </p>
			<p>MDMs work with frameworks and each device manufacturer has a framework that injects into the MDM. MDM usually has policies or features that mobile device administrators can control or enforce on these devices. </p>
			<p>The combination <a id="_idIndexMarker2000"/>of these policies and features forms the framework. Android, Blackberry, and Apple provide MDM frameworks to allow administrators and MDM vendors to simply link to their devices. </p>
			<p>There are a bazillion different MDM software solutions out there, but these are the big boys:</p>
			<ul>
				<li><strong class="bold">AirWatch</strong>: This<a id="_idIndexMarker2001"/> is handled <a id="_idIndexMarker2002"/>by the same people who developed VMware. </li>
				<li><strong class="bold">System Center Configuration Manager</strong>: This is by Microsoft, and it supports <a id="_idIndexMarker2003"/>the mobile Windows platform, Android, and iOS. It requires an additional component, Intune, a monthly subscription for you to be able to manage <a id="_idIndexMarker2004"/>your devices when they're not inside of your network infrastructure. Intune acts as a proxy for you. It has a connection to the internet, your devices make a connection to it, and it relays it back to your system center configuration manager on the backend. </li>
				<li><strong class="bold">Spiceworks</strong>: This <a id="_idIndexMarker2005"/>is completely free and doesn't take up a lot of <a id="_idIndexMarker2006"/>configuration or servers. </li>
			</ul>
			<p>The overall concept here is to make sure you have some options when it comes to not only <a id="_idIndexMarker2007"/>supporting organization-issued devices but also controlling <strong class="bold">Bring Your Own Devices</strong> (<strong class="bold">BYODs</strong>). It's a fine line of controlling personal devices while protecting resources, but I get it, it's a cost-saving issue for most companies as well as an annoyance issue for employees having to carry two of the same devices. Oh, I could go off about BYODs and the reasons to not utilize them, but that would be another book in itself.</p>
			<p>Now, let's talk about the importance of guidelines and some cool tools you can use.</p>
			<h2 id="_idParaDest-420"><a id="_idTextAnchor432"/>Guidelines and cool tools </h2>
			<p>When it <a id="_idIndexMarker2008"/>comes to guidelines, I can't think <a id="_idIndexMarker2009"/>of a better phrase than Pirates of the Caribbean's Captain Barbosa's words, "<em class="italic">The code is more what you'd call "guidelines" than actual rules.</em>"</p>
			<p>There are some good guidelines when it comes to mobile devices. Let's discuss some of them: </p>
			<ul>
				<li><strong class="bold">Apps</strong>: One of the biggest issues I see out there right now with the mobile platform is that people load up too many apps. </li>
				<li><strong class="bold">Photos</strong>: Try to be careful about automatically uploading photos to social networks. When I do presentations for communities, specifically for parents, I talk about how we're sharing way too much information. Sometimes, we don't even realize it. We post photos on Facebook without looking at the photo. What's in the background? Are you exposing your address or other personal or family information? Be careful not to put up too much information. </li>
				<li><strong class="bold">Control</strong>: Can you maintain control of these devices? If you lose control of them, it's time to get them back in the office and reassociate. </li>
				<li><strong class="bold">Security assessment</strong>: Do security assessments on the devices, the application, and its architecture. </li>
				<li><strong class="bold">Trusted applications</strong>: Only install applications from trusted locations. I sideload all the time to make some useful applications available on my tablet. </li>
				<li><strong class="bold">Location</strong>: Don't add any location-based features unless there's a component that supports the application. Don't load Google Maps if you don't need it. I know most Android devices come with those applications pre-installed but you also need to be careful of applications that want to look at your location. Only allow it if it's important. </li>
				<li><strong class="bold">Bluetooth</strong>: Turn your Bluetooth off if you don't need it, especially while traveling. You'll get a little bit of extra battery life too. </li>
				<li><strong class="bold">Connecting to separate networks</strong>: Don't connect to two networks at the same time, such as Wi-Fi and Bluetooth, as an attacker can use one network to pull information from the other. </li>
				<li><strong class="bold">Backup</strong>: Do backups and check how often your devices are synchronizing, especially if they're synchronizing outside of your network. </li>
				<li><strong class="bold">Passwords</strong>: Use strong passwords. </li>
				<li><strong class="bold">Idle timeout</strong>: Set the <a id="_idIndexMarker2010"/>idle timeout to automatically lock when the phone is not in use. My phone locks automatically when I hit the power button. </li>
				<li><strong class="bold">Lockout and wipe features</strong>: Take advantage of the lockout and wipe features. If somebody types in my code incorrectly four times, my device gets wiped. </li>
				<li><strong class="bold">Jailbreaking and rooting</strong>: A best practice by EC Council is to never allow rooted or jailbroken devices. However, I enjoy rooting my devices because when Stagefright came out for the Android, if I hadn't rooted my device, I would have waited until Samsung came out with a fix. However, because I run a custom ROM, it took the author of that ROM 2 days to come out with the patch and I was able to redeploy and be locked down.</li>
				<li><strong class="bold">Updates</strong>: Keep all applications and the OS itself up to date. However, review the changes all the updates want to accomplish – don't hit <strong class="bold">Apply all</strong>; you could be lowering the security profile of your device because the application could sneak in a new game, for example, and the new patch gives them access to all your contacts. </li>
				<li><strong class="bold">Hardware encryption</strong>: This is like encrypting the hard drive on a PC. If somebody steals your PC and they don't know the encryption key to type in when they boot up, they're not getting the data. </li>
				<li><strong class="bold">MDM</strong>: Review your MDM policies. This comes down the road of change management because when you come up with these policies, you need to make sure there's complete agreement across departments on what is allowed and what's not allowed. </li>
				<li><strong class="bold">Emails</strong>: Filter email forwarding barriers because most of our malware is coming across via email. Do we want those heading out to our devices? Some newer email servers <a id="_idIndexMarker2011"/>make filtering easy. You can set a filter to only allow emails that are generated internally to be forwarded to mobile devices – don't forward emails from advertisers. </li>
				<li><strong class="bold">Browsers</strong>: Harden up the browsers on these devices. This includes permission rules to ensure when somebody visits a page on these devices, they're not getting injected with some code that's going to jailbreak them or root them. </li>
				<li><strong class="bold">Signed applications</strong>: Only use signed applications, meaning they've been signed by the app stores, or have been signed for internal use.</li>
				<li><strong class="bold">Erase data</strong>: Set up to erase data to keep people from guessing passwords on the devices.</li>
				<li><strong class="bold">Auto-lock</strong>: Ensure you have auto-locking turned on. </li>
				<li><strong class="bold">Backup location</strong>: Make backups and locate them in a secure location. </li>
				<li><strong class="bold">Password</strong>: Require a passcode. Studies show that people use patterns after the alphabet, giving attackers an easy time. They need a few guesses, starting with the initials.</li>
				<li><strong class="bold">Software maintenance</strong>: Have a software maintenance plan in place. If there's an app you haven't used in 90 days, you probably don't need it. </li>
				<li><strong class="bold">Sandbox data and the app</strong>: If you're a developer, sandbox data and the apps to avoid cross-infection. </li>
				<li><strong class="bold">Wi-Fi</strong>: Always make sure someone must ask to join. Windows 10 allows devices to automatically join known Wi-Fi access points – not the ones you know but the ones Microsoft is aware of. That's risky. </li>
				<li><strong class="bold">Emails</strong>: Don't allow emails to be cached. Even though you've deleted the email, it's still in the cache. If I get that device, I'll be able to read that information. </li>
				<li><strong class="bold">Data</strong>: As a company, decide whether data can leave the environment. Do we allow people to send the payroll spreadsheet via email so that Bruce Wayne can open the <a id="_idIndexMarker2012"/>spreadsheet on his device? Why not use the newer technologies, such as Share File Options, where I don't send you a copy of the file? Instead, I give you a URL link back to our SharePoint server or maybe back to a Dropbox location. That way, I don't have files leaving the environment.</li>
				<li><strong class="bold">Google</strong>: When it comes to Android, watch what Google is backing up, what they're storing, what they're cashing, and all the data that they're collecting.</li>
				<li><strong class="bold">Notifications</strong>: Turn off notifications on the lock screen so that someone must unlock it to see them.</li>
				<li><strong class="bold">Turn off autofill</strong>: This is about convenience. The challenge with this is that if an attacker gets access to the computer, it becomes a liability as an attacker could easily get significant access to many things. </li>
				<li><strong class="bold">Users</strong>: One of the best things you could ever do is train your users on how to use these devices, as well as what's acceptable and what's not acceptable. Make sure there are written policies in place so that they understand what the consequences are, and hold them to those consequences if they break them. </li>
				<li><strong class="bold">Timeout</strong>: If users are getting in remotely, how long do you allow them to stay inactive before the session times out? It's annoying to keep typing in a username and password but don't cache domain passwords. That's as reckless as posting all your passwords on Facebook, Twitter, and Google Plus.</li>
			</ul>
			<p>Okay, so who here is now thinking a little differently about mobile devices?</p>
			<h1 id="_idParaDest-421"><a id="_idTextAnchor433"/>Summary</h1>
			<p>It's important to remember the shift we are experiencing as more and more is being done and transacted on mobile devices and less on desktops and laptops. Because of the mobility of these devices, we must prepare ourselves and how to best deal with the unique challenges and vulnerabilities that mobile platforms present to us. In this chapter, we provided an overview of how we can prepare to attack and protect ourselves on a mobile platform. We reviewed the key terms we must know when it comes to hacking mobile platforms. We also discussed hacking iOS, Android, and other mobile platforms before covering the importance of MDM. </p>
			<p>In the next chapter, we will cover hacking web servers and web apps.</p>
			<h1 id="_idParaDest-422"><a id="_idTextAnchor434"/>Questions</h1>
			<p>As we conclude, here is a list of questions for you to test your knowledge regarding this chapter's material. You will find the answers in the <em class="italic">Assessments</em> section of the <em class="italic">Appendix</em>:</p>
			<ol>
				<li value="1">What are the advantages of encrypting mobile devices?<ol><li>Data sent to websites is protected</li><li>Malware protection</li><li>Protection against gadgets that have been stolen</li><li>Data security on <a id="_idTextAnchor435"/>lost or stolen devices</li></ol></li>
				<li>What does it mean to <em class="italic">jailbreak</em> a phone?<ol><li>Removing DRM from a system</li><li>Getting rid of ransomware from a computer</li><li>Removing a device from a network</li><li>Taking control of a device by gaining root access</li></ol></li>
				<li>Which operating system is Android based on?<ol><li>Windows</li><li>Linux</li><li>OS X</li><li>macOS</li></ol></li>
				<li>What is the impact of rooting a device on security?<ol><li>It improves it.</li><li>It is hardened.</li><li>It diminishes it.</li><li>No change.</li></ol></li>
			</ol>
		</div>
	</div></body></html>