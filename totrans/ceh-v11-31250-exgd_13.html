<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer127">
			<h1 id="_idParaDest-442"><em class="italic"><a id="_idTextAnchor457"/>Chapter 14</em>: Hacking IoT and OT</h1>
			<p>Wow, what a world we live in. The past few years have seen an explosion in devices connecting us to the internet. It's important to understand these <strong class="bold">Internet of Things</strong> (<strong class="bold">IoT</strong>) and <strong class="bold">Operational Technology</strong> (<strong class="bold">OT</strong>) devices, what they can do, and why security is so important to us with these devices. Seriously – we need to grasp this technology. Don't believe me? Ask the casino in Las Vegas that got hacked via a thermostat… on a fish tank! (<a href="https://mashable.com/article/casino-smart-thermometer-hacked">https://mashable.com/article/casino-smart-thermometer-hacked</a>)</p>
			<p>In this chapter, we'll cover the following topics:</p>
			<ul>
				<li>Understanding IoT</li>
				<li>IoT hacking</li>
				<li>Methods used for IoT</li>
				<li>OT and methods used to hack it</li>
			</ul>
			<p>So, let's start by understanding IoT.</p>
			<h1 id="_idParaDest-443"><a id="_idTextAnchor458"/>Understanding IoT</h1>
			<p>You must be thinking – <em class="italic">Dale, Internet of Things, is it that big of a deal? I mean, isn't it just mostly in homes?</em> Well, it's in more places<a id="_idIndexMarker2133"/> than you might think. What we're starting to see, and why it's such an issue for us, is that we're seeing it in things such as <strong class="bold">Heating, Ventilation, and Air Conditioning</strong> (<strong class="bold">HVAC</strong>) systems. The famous Target breach<a id="_idIndexMarker2134"/> was all handled through an HVAC system. We're seeing it in fire and safety systems, lighting, and transport, and this could include office buildings, retail locations, education, hospitality, airports, and even stadiums. </p>
			<p>We're seeing it emerge in the energy sector, such as windmills or turbines, batteries, generators, drills, and other energy-related machines that may be used to switch off electricity or slow it down. We also see it within the consumer and home sector. It just surprises me every day when I see a new device or appliance that has internet access. Again, whether it's gaming systems, alarm systems, speaker systems, or even lights or locks, chances are the device has access to the internet. I didn't even know this, but the dishwasher I purchased can contact the manufacturer for troubleshooting. </p>
			<p>We're also seeing this phenomenon<a id="_idIndexMarker2135"/> show up in the industrial sector. In mining, for example, you can use automation for resources, such as real-time asset tracking, predictive and preventative maintenance, and monitoring, which can detect excessive vibrations or temperature increases and forecast time to failure and what needs to be fixed. There are automation resources for agricultural and irrigation systems. I had an opportunity to work with a local city municipality where I live. We took the water that comes down the mountains and stored it, and we used it for what's called secondary water. It's stored, and then we distribute it throughout the communities and use that water to water our grass so that we're not using our drinking water to water our grass. All of this is controlled through automated valves. Automation helps us with cost-saving, and that's why it's so attractive. </p>
			<p>We also have automation making its way inside the security and public safety sector – whether it be surveillance, tracking, or even emergency services. IoT is infiltrating quite fast, and of course, we're also seeing it pop up inside IT and network sectors, both at the public and enterprise levels.</p>
			<p>An attacker that can access medical equipment could be a real issue for us. Let's look at an example. My wife happens to work for a large retail electronics store. They are partnering with several medical sector-based companies to provide monitoring for elderly people, either via a monitoring service or their adult children. Automation can provide real-time monitoring for bed pressure sensors, which would let me know if my dad may not be out of bed yet. This would help me figure out if he might be feeling ill. Being able to communicate directly with the elderly is important. </p>
			<p>We're observing automation appear within medical implants as well, particularly in terms of modifying them. My son-in-law is about to have hearing surgery. The device they're going to be putting in his ear will allow him to link to baby alarms and smoke detectors so that he can hear them clearly or be notified that something's going on. So, if you weren't aware of all these sectors being affected by IoT, you can see that the landscape for attackers is growing almost daily to attack people – maybe even hourly at this point.</p>
			<p>Let's talk more about how IoT works. </p>
			<h2 id="_idParaDest-444"><a id="_idTextAnchor459"/>How does it all work?</h2>
			<p>You may be asking yourself – <em class="italic">how does IoT work?</em> Well, there are several different components<a id="_idIndexMarker2136"/> that you need to be familiar with. Let's start with what's referred to as the sensing technology of those nifty little devices. Maybe it's a doorbell or a thermostat. It could even be a valve in an industrial environment that can be turned on or off.</p>
			<div>
				<div id="_idContainer121" class="IMG---Figure">
					<img src="Images/B17486_14_01.jpg" alt="Figure 14.1 – Example of how IoT devices interoperate&#13;&#10;" width="1407" height="694"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.1 – Example of how IoT devices interoperate</p>
			<p>These devices then interface with what is referred to as an <strong class="bold">IoT gateway</strong>. These gateways are used to bridge<a id="_idIndexMarker2137"/> the gap between the IoT devices, as well as the interaction with the end user. Think of them as the middlemen with IoT. </p>
			<p>Then, we have the <strong class="bold">communication channel</strong>, which is the internet. Through this communication channel, our gateways typically talk to what we refer to as either the data storage and/or a cloud server. </p>
			<p>Here, the data is collected after it goes through the gateway and arrives at the cloud servers. That data is then stored and analyzed. Based on the application itself, that information can be sent to the end users' remote app, which could be on their smart device. So, from an attacker's perspective, you can see that there are a lot of different possibilities, as far as an <em class="italic">attack vector</em> is concerned, but we'll talk about that more later in this chapter.</p>
			<p>Now, let's talk about the architecture of IoT.</p>
			<h2 id="_idParaDest-445"><a id="_idTextAnchor460"/>The architecture of IoT</h2>
			<p>With IoT, there are different<a id="_idIndexMarker2138"/> layers – or I should say, components – that are involved in the entire IoT environment. The architecture consists of several different layers, as shown in the following diagram: </p>
			<div>
				<div id="_idContainer122" class="IMG---Figure">
					<img src="Images/B17486_14_02.jpg" alt="Figure 14.2 – The IoT architecture is made up of several layers" width="907" height="540"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.2 – The IoT architecture is made up of several layers</p>
			<p>The first layer is referred to as the <strong class="bold">edge technology layer</strong>. This layer is where all the<a id="_idIndexMarker2139"/> hardware parts, such as sensors, readers, software sensors, or the physical device itself, as well as <strong class="bold">radio frequency identification</strong> (<strong class="bold">RFID</strong>) tags, could be located. If you think<a id="_idIndexMarker2140"/> of any of the devices we deploy, these would be at the edge technology layer. These devices are designed to collect information and they're going to send that information back to the cloud servers or the data storage locations.</p>
			<p>The next layer is what we refer to as the <strong class="bold">access gateway layer</strong>. This is what bridges the connectivity <a id="_idIndexMarker2141"/>between the providers on the backend side and our edge technology layer, or our devices. </p>
			<p>Next, we have the <strong class="bold">internet layer</strong>, which is extremely important<a id="_idIndexMarker2142"/> to us because it's how we communicate. Now, depending on the manufacturer, we can have two different endpoints, such as device-to device, device-to-gateway, or even device-to-cloud. This layer is what is utilized. </p>
			<p>We also have what's referred to as the <strong class="bold">middleware layer</strong>, which is a two-way communication<a id="_idIndexMarker2143"/> channel. This layer sits between the application layer and what<a id="_idIndexMarker2144"/> we refer to as the <strong class="bold">hardware layer</strong>. Its main responsibility concerns<a id="_idIndexMarker2145"/> data management, handling issues such as data analysis, data aggregation, data management, filtering devices, discovering devices, and even access control, where we can say who has access to these devices via the application. </p>
			<p>Then, we have the <strong class="bold">application layer</strong>. This layer within IoT oversees<a id="_idIndexMarker2146"/> making sure services are delivered to users from different areas geographically and in different departments, to ensure they have access to whatever it is that they need. </p>
			<p>That wasn't too bad, was it? </p>
			<p>Now, let's talk about the protocols and technology that IoT utilizes.</p>
			<h2 id="_idParaDest-446"><a id="_idTextAnchor461"/>Protocols and technologies</h2>
			<p>Let's break these down into some<a id="_idIndexMarker2147"/> different categories. </p>
			<h3>Short-range communication</h3>
			<p>Let's look at some of the short-range communication<a id="_idIndexMarker2148"/> resources that are available to us.</p>
			<h4>Z-Wave</h4>
			<p>Z-Wave is a home automation<a id="_idIndexMarker2149"/> standard. It allows us to manage<a id="_idIndexMarker2150"/> things such as our air conditioners, HVAC systems, thermostats, and home theater rooms. We can control everything from door locks to speaker systems in this way.</p>
			<h4>ZigBee </h4>
			<p>This is another short-range communication protocol just like Z-Wave. Both these protocols can be considered mesh<a id="_idIndexMarker2151"/> networks, but the advantage with ZigBee<a id="_idIndexMarker2152"/> is that if a signal originates from a centralized hub, each device can act as a repeater. </p>
			<p>There's an issue with how far the signals can go. With ZigBee, it's limited to about 40 feet. With Z-Wave, we can go up to about 330 feet in an outdoor environment while in an indoor space, it's typically about 100 feet. Now, ZigBee does have the advantage of theoretically connecting to around 65,000 devices, whereas Z-Wave is limited to a mere 232 devices. But one of the bigger downsides, at least for me, is that ZigBee uses the standard 2.4 GHz range, which a lot of our wireless devices are already utilizing, whereas Z-Wave uses the 908.42 MHz frequency. As far as communicating<a id="_idIndexMarker2153"/> with their devices and controls is concerned, both use the <strong class="bold">Advanced Encryption Standard</strong> (<strong class="bold">AES</strong>) 128 encryption standard. It's a requirement to get certified by Z-Wave.</p>
			<h4>Wi-Fi</h4>
			<p>We know all about Wi-Fi, right? The most common standard <a id="_idIndexMarker2154"/>for Wi-Fi is 802.11n, which gives<a id="_idIndexMarker2155"/> us a speed of up to about 600 Mbps, with a signal of approximately 150 feet indoors and 300 feet outdoors if unobstructed.</p>
			<h4>Wi-Fi direct</h4>
			<p>This acts as peer-to-peer<a id="_idIndexMarker2156"/> communication between devices. Here, one device<a id="_idIndexMarker2157"/> acts as the access point, while the other one acts as the client. </p>
			<h4>Radio Frequency Identification (RFID)</h4>
			<p>RFID is extremely<a id="_idIndexMarker2158"/> popular with those little tags<a id="_idIndexMarker2159"/> that you see everywhere, where you can set your phone on the tag, and it'll look up the product that tag represents. On the attacking side, we love creating RFIDs that look like they're designed to do something, but they do something completely different. We're starting to see RFID tags being used in pets, as well as livestock, and even cars and pharmaceuticals. </p>
			<h4>Bluetooth smart or Bluetooth low energy (LE)</h4>
			<p>This is just Bluetooth<a id="_idIndexMarker2160"/> technology, but it's designed to create a <strong class="bold">Local Area Network</strong> (<strong class="bold">LAN</strong>) or a personal network. </p>
			<h4>Light fidelity or Li-Fi</h4>
			<p>It sounds like Wi-Fi, right? It's very similar<a id="_idIndexMarker2161"/> to Wi-Fi, but it does<a id="_idIndexMarker2162"/> have two major differences. One is speed (at 224 Gbps), while<a id="_idIndexMarker2163"/> the other is that it uses <strong class="bold">Visible Light Communications</strong> (<strong class="bold">VLC</strong>) (yeah, I know what some of you are thinking– <em class="italic">isn't that a media player?</em> All these acronyms we must keep track of), but basically, we're using light for communication. </p>
			<h4>Near-field communication (NFC)</h4>
			<p>This uses a magnetic field<a id="_idIndexMarker2164"/> to communicate between<a id="_idIndexMarker2165"/> two electronic devices. So, for example, when you purchase something with Apple Pay or any type of mobile payment method where you set your phone down, that typically uses NFC technology.</p>
			<h4>Quick response (QR) codes</h4>
			<p>QR codes are those square-looking barcodes<a id="_idIndexMarker2166"/> most of us have seen. They allow<a id="_idIndexMarker2167"/> you to store a little bit more information than regular barcodes, but both are going to contain information about the product itself or other products they may be attached to. </p>
			<p>Now, let's talk about mid-range communication.</p>
			<h3>Midrange communications</h3>
			<p>Let's look at a couple<a id="_idIndexMarker2168"/> of solutions we should all be aware of since they assist us with midrange communication. </p>
			<h4>HaLow</h4>
			<p>HaLow operates in frequency bands<a id="_idIndexMarker2169"/> that are just below the 1 GHz range, which means<a id="_idIndexMarker2170"/> it can transmit about twice as far as standard Wi-Fi, and it utilizes the 900 MHz band on the Wi-Fi channel. The 900 MHz band is unique because it handles going through walls or solid structures a little bit better. It doesn't require a true line of sight.</p>
			<h4>LTE-Advanced </h4>
			<p>This is a standard mobile communications<a id="_idIndexMarker2171"/> frequency that's utilized. It provides<a id="_idIndexMarker2172"/> an enhancement to the standard LTE, which means it gives us a higher capacity in terms of how fast data is transmitted, as well as how far it can be transmitted. This helps us as far as performance is concerned. </p>
			<h3>Long-range communication</h3>
			<p>Let's discuss some of the long-range communication<a id="_idIndexMarker2173"/> resources we can use.</p>
			<h4>Low-powered wide-area networks (LPWANs)</h4>
			<p>As its name suggests, this is done<a id="_idIndexMarker2174"/> through a low power, which<a id="_idIndexMarker2175"/> is great, but it's been designed to provide a long-range communication channel between two endpoints. </p>
			<h4>Low-powered wide-area networks (LoRaWANs) </h4>
			<p>This is typically<a id="_idIndexMarker2176"/> used in industrial<a id="_idIndexMarker2177"/> machine-to-machine or secure two-way communication. </p>
			<h4>SigFox and Neul</h4>
			<p>SigFox and Neul are very similar to each<a id="_idIndexMarker2178"/> other and are designed<a id="_idIndexMarker2179"/> for devices that<a id="_idIndexMarker2180"/> have very small battery lives. Both work below the 1 GHz bandh, but Neul leverages tiny slices of the TV white space spectrum to deliver highly scalable, high-coverage, low-power, and low-cost effective network switches.</p>
			<h4>Very Small Aperture Terminal (VSAT)</h4>
			<p>VSAT is another<a id="_idIndexMarker2181"/> type of communication protocol<a id="_idIndexMarker2182"/> that we use to transfer data. We typically see small satellite dishes being utilized for this type of communication</p>
			<h4>Cellular</h4>
			<p>Cellular is designed to give us high-quality<a id="_idIndexMarker2183"/> data, but there's a cost<a id="_idIndexMarker2184"/> associated with it – it's expensive and has high power consumption. </p>
			<p>Now that we have covered the wireless side of things, let's look at the wired side.</p>
			<h4>Ethernet</h4>
			<p>Most of us should be familiar<a id="_idIndexMarker2185"/> with Ethernet. It is used for connecting<a id="_idIndexMarker2186"/> different devices to a wired LAN. It is the most common type of LAN.</p>
			<h4>Multimedia over Coax Alliance (MoCA)</h4>
			<p>We're not referring<a id="_idIndexMarker2187"/> to the coffee here. This is a technology<a id="_idIndexMarker2188"/> we can use with existing coax cabling to convert Ethernet signals to run across those coax cabling. Then, you have another converter on the other side that takes it off the coax and puts it back on the Ethernet. I've used a similar device to turn Ethernet into HDMI for longer HDMI runs. </p>
			<h4>Power-line communication (PLC)</h4>
			<p>Now, this is a cool one. It runs<a id="_idIndexMarker2189"/> across our power lines<a id="_idIndexMarker2190"/> in our home/offices! I know, right? This is where electrical wires are used as data transmission and power sources.</p>
			<p>Next, let's discuss some of the available operating systems we can use for IoT.</p>
			<h2 id="_idParaDest-447"><a id="_idTextAnchor462"/>Operating systems for IoT</h2>
			<p>In this section, we'll talk about the operating systems<a id="_idIndexMarker2191"/> that IoT typically uses.</p>
			<h3>ARM Mbed</h3>
			<p>Yeah, you can<a id="_idIndexMarker2192"/> tell it's short for embedded, and no, I didn't misspell it. This<a id="_idIndexMarker2193"/> is one of the most used low-power device operating systems available. It's typically used in our wearable devices. </p>
			<h3>Zephyr</h3>
			<p>Zephyr is an operating<a id="_idIndexMarker2194"/> system that's used in devices<a id="_idIndexMarker2195"/> that are low in resources or constrained by resources, as well as low powered. </p>
			<h3>Ubuntu Core</h3>
			<p>Ubuntu<a id="_idIndexMarker2196"/> is also known as Snappy, and we see<a id="_idIndexMarker2197"/> this used<a id="_idIndexMarker2198"/> in drones, as well as gateways. These can be found in IoT and robots. </p>
			<h3>Apache Mynewt</h3>
			<p>This is an operating system<a id="_idIndexMarker2199"/> that's designed<a id="_idIndexMarker2200"/> to run on devices utilizing low-energy Bluetooth protocols. </p>
			<h3>RIOT</h3>
			<p>We see this operating system<a id="_idIndexMarker2201"/> on a lot of actuator boards, sensors, and even embedded<a id="_idIndexMarker2202"/> systems. Typically, this operating system is extremely quiet, so it's a quiet riot. See what I did there? If you're not familiar, that's a famous 1980s rock, heavy metal band, so again, you can Google that one too, but don't <em class="italic">bang your head</em> over finding it. Okay? I won't give up my<a id="_idIndexMarker2203"/> day job. I'll stick with this book. </p>
			<h3>Brillo</h3>
			<p>This is an operating system that's based<a id="_idIndexMarker2204"/> on Android, and it's considered <a id="_idIndexMarker2205"/>an embedded operating system. Again, we're going to use this on low-end devices, such as our thermostats. </p>
			<h3>Real-time operating systems (RTOSs)</h3>
			<p>These types of operating systems run<a id="_idIndexMarker2206"/> extremely fast; we're talking<a id="_idIndexMarker2207"/> milliseconds. The reason we need those types of operating systems is when we have a situation or a scenario where interaction must be spontaneous. For example, when your airbags deploy in your car, you can't wait multiple milliseconds for the bag to deploy to save your life. </p>
			<p>Two of the most famous RTOSs include Nucleus and Integrity. The major differences between Nucleus and Integrity are that Nucleus features storage and database management, USB and networking, and multimedia<a id="_idIndexMarker2208"/> support. It also has some advanced <strong class="bold">Graphical User Interface</strong> (<strong class="bold">GUI</strong>) capabilities, whereas Integrity is designed for more multi-core computers. RTOSs are typically used within military functions, such as the <strong class="bold">Joint Strike Missile</strong> (<strong class="bold">JSM</strong>), which is being developed initially<a id="_idIndexMarker2209"/> for the Royal Norwegian Airforce. Lockheed Martin is using it in conjunction with the F-35 fighter, where this operating system is running internally on a bomb bay door so that it can open instantaneously as missiles are being launched. Again, when the pilot pushes a button, it needs to happen then, not a couple of seconds from when they push the button. </p>
			<h3>Zephyr</h3>
			<p>We identified Zephyr<a id="_idIndexMarker2210"/> as an operating system previously, but it's also a real-time operating system that<a id="_idIndexMarker2211"/> can be used on all sorts of devices, whether it's a wearable device, an IoT router, or robotics.</p>
			<h3>Windows 10/11 IoT</h3>
			<p>Both Windows 10 and 11 IoT are editions <a id="_idIndexMarker2212"/>of Windows that run on <em class="italic">headless</em> devices (that is, with no keyboard or mouse attached). It's designed<a id="_idIndexMarker2213"/> to run without a display and offers integration for IoT devices, high security, and updates directly from Microsoft.</p>
			<h3>Amazon FreeRTOS</h3>
			<p>This RTOS is small. It's designed<a id="_idIndexMarker2214"/> for microcontrollers<a id="_idIndexMarker2215"/> that make small, low-power, edge devices easy to program, deploy, secure, and manage.</p>
			<p>Next, let's discuss the challenges IoT presents to us.</p>
			<h2 id="_idParaDest-448"><a id="_idTextAnchor463"/>The challenges that IoT presents</h2>
			<p>As you've seen so far, we've got some big issues<a id="_idIndexMarker2216"/> when it comes to the different attack vectors that can be presented to an attacker regarding IoT. Here are some of the challenges that create a lot of vulnerabilities for us: </p>
			<ul>
				<li>One is the interoperability standards we have, or the lack thereof. There are so many products that come with IoT built into them that no one's following a real standard at this point. Some manufacturers aren't concerned about the security of their devices. Now, this is a problem because several of these manufacturers aren't looking at how their devices<a id="_idIndexMarker2217"/> are used, especially when it comes to testing their <strong class="bold">application programming interfaces</strong> (<strong class="bold">APIs</strong>) or their inability to secure their devices. So, whether it's from the end user or a third party, a security hole is opened. For example, let's say that my SmartThings (<a href="https://www.samsung.com/us/smartthings">https://www.samsung.com/us/smartthings</a>) hub is interoperable with several different products, but to make that connection, it must issue an API. If that API is utilized and, for example, I've got wireless speakers in my house, if the product is flawed security-wise, an attacker could gain access to the Samsung Hub if they wanted to. </li>
				<li>We also have the issue of – believe it or not – clear text and open ports still being utilized. A lot of these devices are being sold without any encryption techniques being<a id="_idIndexMarker2218"/> used to transmit data back and forth between either the device and the gateway or between the gateway and the cloud services. This can also happen with open ports because somebody may have forgotten to turn them off. We also have the issue of basic security and privacy issues not being followed. Again, a company that makes refrigerators may not have anybody on staff that's worried about security or privacy. </li>
				<li>We also have the issue of support being available for firmware and operating system updates. Sometimes, it can be difficult to update the firmware. Let's look at an example. I have a little computer on my bike, which I ride almost every day, and it tracks how far I've gone, my altitude, how much I'm climbing, my speed, my heart rate, and even my cadence. Well, this product shocked me quite a bit because I downloaded the application for it and after running the application for a couple of days, I started thinking about the firmware. Well, how do I update the firmware? After doing a little research, I found out that I had to download a separate application to update it, which I wasn't warned about, and I wasn't told that there was a separate app that I should download. Now, remember, we update the firmware in our operating system to patch holes or counter the vulnerabilities in a device, and in some cases, the manufacturer's updates could end up breaking some of the functionality of the device. So, in some cases, we have manufacturers who are refusing to allow firmware or operating system updates because it will stop things from working.</li>
				<li>Finally, we have storage issues. Nowadays, these devices are getting smaller and smaller as far as their physical size is concerned – for example, a water bottle that's going to remind me to drink water every day. There's not a lot of space there for a lot of hardware, so we're not going to have a lot of storage space. However, transmission by that device is virtually limitless, right? What this ends up doing is creating issues for us as far as data storage goes, as well as the management or protection we need to make sure we or manufacturers implement. You may have more data flowing across than you need at a particular time because there's no storage. We've got to get rid of it, right? Again, I'm speaking from the manufacturer's point of view. Yeah, can you believe this is happening? Default or weak credentials are still being used. In some cases, they're hardcoded. Often, the manufacturer doesn't even realize they're there. This is because they buy the operating system or the interface from a third party that they just want to implement within their product line.</li>
			</ul>
			<p>So, as you can see, IoT adds some challenges<a id="_idIndexMarker2219"/> we need to understand and be ready for. Now, let's talk about physical attacks.</p>
			<h2 id="_idParaDest-449"><a id="_idTextAnchor464"/>Physical issues</h2>
			<p>Physical attacks on IoT devices include an attacker<a id="_idIndexMarker2220"/> stealing the device from you, maybe modifying or tampering with it, counterfeiting it, or even injecting malicious code and then placing the device back within your network. That doesn't sound fun. </p>
			<p>We also have insecure web interfaces. What we're finding is that a lot of these devices have web interfaces built into them. Any time we talk about a web interface, we know there's got to be a web server supporting it. If it hasn't been patched, it's just getting handled through clear text, or – better yet – it's not even secured, this type of challenge can lead to a vulnerability attack on the device itself. </p>
			<p>It's a little computer, so can I do a buffer overflow? Absolutely. And since these devices are subject to buffer overflows, this means they're also subject to SQL injection or some type of an injection attack. </p>
			<p>We also have development issues. What I mean by this is that we, as security professionals, have these devices coming into our network infrastructures. Sometimes, because of the complexity of these devices or how they operate, this adds to the complexity of the different policies we must deploy and implement. In some cases, I feel for the people that must create these policies because it's adding a completely new environment to what may be your already secure network, and now we've got IoT to worry about. </p>
			<p>We also have an issue with vendor support. The device is only good so long as the vendor is there for you. In some cases, we see the vendors go out of business (especially after they've been breached). If you plan on bringing these devices into your infrastructure, the firmware and the operating systems must be upgradeable. This should be mandatory. If any company or vendor doesn't support you on that, you should look for a completely different solution because you're just asking for a door to be opened for you. </p>
			<p>We also have regulatory<a id="_idIndexMarker2221"/> and rights issues, and this is more of a <em class="italic">what can happen</em> issue. Because of all the interconnections of IoT devices, some security issues may come up where no legal law has been defined at this point. Let me give you an example. Let's go back to the example of the casino that was breached via the thermostat of a fish tank. So, who was at fault? Was it the thermostat manufacturer or was it the casino that hooked the IoT device to their internal network instead of a separated network? All these things are challenges for us, but hopefully, the field is going to clear up here soon.</p>
			<p>Next, let's talk about the IoT hacking process.</p>
			<h1 id="_idParaDest-450"><a id="_idTextAnchor465"/>IoT hacking</h1>
			<p>Let's talk about some of the vulnerabilities<a id="_idIndexMarker2222"/> and some of the hurdles that IoT presents to us. </p>
			<p>The first is what I term <strong class="bold">data value</strong>. This involves capturing data<a id="_idIndexMarker2223"/> as IoT devices communicate with each other and with the cloud behind them or their cloud providers, which increases the risk because it makes IoT more obscure. Time after time, we're starting to see where the IoT environment is allowing attackers to access other devices, as well as networks they may be connected to. So, many companies deploy their IoT environments on their production network, which kind of makes me sad and sick inside. </p>
			<p>Another issue is data aggregation. Again, we have a lot of devices here speaking with other resources that may be outside of our control. </p>
			<p>There's also something that's referred to as sensor fusion, which is the ability to combine information<a id="_idIndexMarker2224"/> from two completely disconnected sensing devices to create more complex information or a view of the environment the attacker is going after. Let me give you an example. In Boston, the city created an app that would identify potholes in the city's roads using mobile phones, accelerometers, and GPS data. This information was sent to the Public Works Department to help them find out where the worst potholes were. But if you think about it from an attacker's point of view, if I'm able to gain access to that environment, couldn't the attacker use this application or its information to possibly divert the city services away from the areas that need the most attention?</p>
			<p>We also have the issue<a id="_idIndexMarker2225"/> of integration. Now, you may be thinking, that's great – integration, right? We typically look at that as a positive thing. But when we start allowing these devices that aren't very secure onto our existing networks and integrate them into applications that we need to be developing internally, or even into other IoT apps, we should be a bit concerned.</p>
			<p>This is a huge issue in that the healthcare industry is being inundated with hundreds and hundreds of different devices that are based on IoT environments. Imagine the complexity of thousands, if not hundreds of thousands, of these devices being deployed, and you need to make sure that a specific pump is given the right commands to update the dosage. We also need to make sure that only the physicians or the care practitioners have the authority to do so, and that nobody can hack it.</p>
			<h3>The culprits</h3>
			<p>First, it's going to be the application, right? The application can create problems by having no security updates<a id="_idIndexMarker2226"/> allowing default passwords that are in place or even passwords or backdoors that can't be changed. </p>
			<p>We also have the mobility issue and the fact that we have various communication channels. Are they encrypted? Are we using authentication? Do we lack the ability for proper storage security, even if someone's using an insecure API? </p>
			<p>We also have the cloud. Again, maybe our authentication hasn't been set up correctly with their cloud providers, or maybe there's no encryption for storage or communication to the cloud. Then, there's the web interface for the application that's hosted on the cloud environment, and then we have the network itself. Are the services running that are supposed to be running, and have they been locked down and secured? Do we have any updates being pushed out to our devices either manually, automatically, or through a third-party application? Do you even have a firewall in place for your IoT environment? Again, the best practices here are to have your IoT environment on a completely segmented network, and just like any network, you need to make sure you have the same type of security devices in place. Remember, when we introduce the cloud, we're introducing a whole new infrastructure.</p>
			<h3>Device memory challenges</h3>
			<p>Let's talk about the massive attack<a id="_idIndexMarker2227"/> surface, and when I mean massive, it is really big, folks – <strong class="bold">device memory</strong>. We're talking about how much space<a id="_idIndexMarker2228"/> there is for the device to operate. Let's talk about some of the things that are possibly being stored in the device's memory. </p>
			<p>Encryption keys? Yeah, absolutely. How about credentials from third-party vendors? Yup, and even the possibility of cleartext credentials being stored. </p>
			<p>We also have ecosystem access controls; this means any of the components that are integrated within our IoT environment. Let's say we have trusts or different types of trusts between components. For example, Samsung, by default, with their SmartThings hub, automatically trust all their components – whether it's a water sensor, motion sensor, or location sensor – so these types of implicit type trusts can be a vulnerability for us. Also, there is the aspect of enrolling a device in your environment. </p>
			<p>Let me give you an example. When I hooked up my Samsung SmartThings hub, I was shocked and amazed at how easily it worked – all I had to do was turn the motion sensors on and it automatically picked up several devices. So, not having any type of authentication taking place could allow for a malicious device to come on board. </p>
			<p>Well, what do we do? We need to have some way of decommissioning those types of devices, such as clearing the data or even just resetting the device to the factory default to make sure there's nothing left in the device's memory or storage. </p>
			<p>We also have a physical interface. The physical interface<a id="_idIndexMarker2229"/> could include both a user <strong class="bold">command-line interface</strong> (<strong class="bold">CLI</strong>), as well as an administrative CLI. Again, if we give an individual user access to the device and they have administrative rights on that device, that would be a great pivot point for me to get onto their network from an attacker's perspective, as well as the ability to go through a privileged escalation scenario. Does the device have a physical port, such as a USB port? Does it support universal Plug and Play? What happens when you plug in a Rubber Ducky? If you're not familiar with a Rubber Ducky, it's a USB thumb drive, but the system picks it up as a keyboard, which means I can type in all kinds of fun commands. When looking at IoT devices, one of the things you should look at is whether the vendors support a way of disabling these types of ports or different services that may be available on that device.</p>
			<p>The other attack surface would be the web interface itself. Just like anything else, when there's a web interface involved, we've got issues that could occur, such as some type of an injection attack or a cross-site scripting attack, or even a cross-site request forgery attack. In some cases, I might be able<a id="_idIndexMarker2230"/> to do some type of username<a id="_idIndexMarker2231"/> or user account enumeration. </p>
			<p>Now, let's talk about the various IoT attacks.</p>
			<h2 id="_idParaDest-451"><a id="_idTextAnchor466"/>Types of IoT attacks</h2>
			<p>With all the various types of IoT that are out there, we need to be aware of some of the potential types of attacks that can occur with IoT devices.</p>
			<h3>DDoS attacks</h3>
			<p>This is where an attacker<a id="_idIndexMarker2232"/> turns all your IoT devices into evil little devices<a id="_idIndexMarker2233"/> that can perform DDoS attacks or make them a member of a bigger botnet.</p>
			<h3>Rolling code attacks</h3>
			<p>Most IoT devices operate<a id="_idIndexMarker2234"/> on a rolling code. This is like the keyless entry system<a id="_idIndexMarker2235"/> for your car or garage door opener, where you must press the buttons in the right order before it will open. The attacker forces you into pairing with their device by making you try lots of codes one after another until they find the right one that opens your door. Theoretically, it should be impossible because the attacker makes a device with a matching key fob and your controller doesn't allow more than one device with a particular key to operate in your area. But most devices don't make their rolling codes truly random.</p>
			<h3>BlueBorne attacks</h3>
			<p>BlueBorne is less of a specific IoT attack<a id="_idIndexMarker2236"/> and more about IoT devices communicating<a id="_idIndexMarker2237"/> using Bluetooth, which Android and Linux have supported by default since 2012. Android has had a patch available since September 2017 when this was made public knowledge. But as we've discussed, many products won't get patched, even when the manufacturer knows about it, because they can't afford to build another device at their price points. I think they should be illegal in most cases. </p>
			<h3>Sybil attacks</h3>
			<p>Imagine someone creating dozens<a id="_idIndexMarker2238"/> of fake devices, such as baby monitors<a id="_idIndexMarker2239"/> or lightbulbs, all with different MAC addresses. They use these fake devices to communicate with your real device and learn about your network. Then, they use the real identity of one device against you by taking over that device to discover things about your network. </p>
			<h3>Jamming attacks</h3>
			<p>This has nothing<a id="_idIndexMarker2240"/> to do with toast, jam, and a knife. This is when someone<a id="_idIndexMarker2241"/> broadcasts at the same frequency as your device and confuses it or causes it to not work at all. </p>
			<h3>Hacking a smart grid with a backdoor</h3>
			<p>This is where your electric company<a id="_idIndexMarker2242"/> has a device on your home network<a id="_idIndexMarker2243"/> that allows them to turn appliances on and off remotely. So, say that cybersecurity researchers found a backdoor in many of these devices that allowed them to turn your appliances on and off. Yeah, that wouldn't cause an issue at, say, a hospital, right?</p>
			<h3>SDR-based attacks</h3>
			<p><strong class="bold">Software-defined radios</strong> (<strong class="bold">SDRs</strong>) present a new challenge for IoT<a id="_idIndexMarker2244"/> infrastructures. SDR is the method<a id="_idIndexMarker2245"/> with which radio-frequency hardware is controlled with software. This can be used for good or bad, depending on who it's being used by. SDRs are devices that can understand how to send and receive different frequencies within the radio spectrum. Attacks can be attempted at both the full-duplex (two-way communication) and half-duplex (one-way transmission) modes. </p>
			<p>You can also use DNS rebinding to alter some DNS entries on the target's router or gateway and then talk to those devices through their web interface using the default password. Crazy huh?</p>
			<p>Now, let's about the methods that are used for IoT.</p>
			<h1 id="_idParaDest-452"><a id="_idTextAnchor467"/>Methods used for IoT</h1>
			<p>The methods attackers use will normally follow a certain methodology. These methods can be broken down into sections we'll discuss next. Let's take a look. </p>
			<h2 id="_idParaDest-453"><a id="_idTextAnchor468"/>Reconnaissance</h2>
			<p>Most IoT devices are endpoints <a id="_idIndexMarker2246"/>participating in an IP network. Network reconnaissance<a id="_idIndexMarker2247"/> is the process of gathering information about these networks and systems. When we talk about IoT, this pertains to scanning for common vulnerabilities such as default passwords or hardcoded secret keys that may be publicly available. Most attackers will use specialized tools such as Metasploit or Shodan to find these targets. And depending on the type of network, a variety of tools can be used.</p>
			<p>Shodan is crazy amazing as an information-gathering tool. This search engine can find all kinds of devices, including web servers, routers, printers, IP cameras, and more. It's common to find<a id="_idIndexMarker2248"/> default passwords on devices such as <strong class="bold">wireless access points</strong> (<strong class="bold">WAPs</strong>) or IP cameras. All this information is valuable for the hacker to use later for exploitation (for example, taking advantage of a weak password).</p>
			<p>As an example, to search on Shodan for webcams on a certain street, you must enter <strong class="source-inline">webcamxp city:"GothamCity"</strong> (or your target city), which would show you publicly visible webcams in your city. Want to find Google web servers? Type in <strong class="source-inline">Server: gws" hostname:"google"</strong>. Or do you want to see something scary? How about <strong class="source-inline">password 1234</strong>? Yep, this gives you a list of devices that are using a password of 1234. Crazy, huh?</p>
			<p>If you want lots of information, head<a id="_idIndexMarker2249"/> over to the FCC's website (The Federal Communications Commission in the United States) at <a href="https://www.fcc.gov/oet/ea/fccid">https://www.fcc.gov/oet/ea/fccid</a> (see <em class="italic">Figure 14.3</em> and <em class="italic">Figure 14.4</em>). This is an organization where all devices that are distributed or manufactured in the USA must register their devices. There's a plethora of intel here.</p>
			<div>
				<div id="_idContainer123" class="IMG---Figure">
					<img src="Images/B17486_14_03.jpg" alt="Figure 14.3 – FCC website&#13;&#10;" width="401" height="324"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.3 – FCC website</p>
			<p>As shown in the following<a id="_idIndexMarker2250"/> screenshot, it can provide a lot of great information:</p>
			<div>
				<div id="_idContainer124" class="IMG---Figure">
					<img src="Images/B17486_14_04.jpg" alt="Figure 14.4 – Detailed PDF documents on an item from FCC&#13;&#10;" width="744" height="703"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.4 – Detailed PDF documents on an item from FCC</p>
			<p>If you're looking<a id="_idIndexMarker2251"/> for an actual<a id="_idIndexMarker2252"/> application, check out MultiPing (<a href="https://www.multiping.com">https://www.multiping.com</a>) or even IoTSeeker (<a href="https://github.com/rapid7/IoTSeeker">https://github.com/rapid7/IoTSeeker</a>), which will scan your devices and tell you whether they are still using the default passwords. </p>
			<div>
				<div id="_idContainer125" class="IMG---Figure">
					<img src="Images/B17486_14_05.jpg" alt="Figure 14.5 – Sample results after using an IoT seeker application&#13;&#10;" width="598" height="498"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.5 – Sample results after using an IoT seeker application</p>
			<p>Another common<a id="_idIndexMarker2253"/> approach that's used by attackers (in conjunction with network reconnaissance) is to try to tie together information that's been gathered from the device's web interface with what they know about Linux/Unix systems. Header meta-information in HTTP transactions, for example, often includes software version numbers and other clues that can reveal where vulnerabilities exist within implementations of common protocols.</p>
			<p>Once attackers have some idea of how the IoT device operates internally, it's much easier for them to find vulnerabilities in its code. This is where scanning comes into play. </p>
			<h2 id="_idParaDest-454"><a id="_idTextAnchor469"/>Vulnerability scanning</h2>
			<p>Once the attacker has found <a id="_idIndexMarker2254"/>a list of potential targets, they will start<a id="_idIndexMarker2255"/> vulnerability scanning. This entails using well-known exploits that may be available for public consumption that target specific vulnerabilities in the IoT device's software or firmware. Often, these exploits come from third-party research groups (Google Project Zero and others) who will identify and release security holes in all kinds of devices, or from vendors who may not disclose these types of vulnerabilities to their customers. Another great place to check<a id="_idIndexMarker2256"/> out for vulnerability information is the <strong class="bold">United States Computer Emergency Readiness Team</strong> (<strong class="bold">US-CERT</strong>), as they often post advisories about recently identified flaws that may affect IoT devices.</p>
			<p>Many of these vulnerabilities<a id="_idIndexMarker2257"/> are based on known<a id="_idIndexMarker2258"/> implementations, bugs, or design flaws within the protocol, which are necessary to understand before you can identify potential targets. This becomes easier as the list of protocols the device supports increases over time, as well as its ability to process what's being sent by an attacker. </p>
			<h2 id="_idParaDest-455"><a id="_idTextAnchor470"/>Launching attacks</h2>
			<p>Once the attackers have identified<a id="_idIndexMarker2259"/> a known vulnerability, they will begin<a id="_idIndexMarker2260"/> penetration testing efforts by exploiting that specific vulnerability within the IoT device's particular operational environment. We can't stress enough how important conducting this type of activity in a lab environment is!</p>
			<h2 id="_idParaDest-456"><a id="_idTextAnchor471"/>Gaining and maintaining remote access</h2>
			<p>This is where the IoT researcher (that's you!) will apply specific exploits<a id="_idIndexMarker2261"/> against a particular vulnerability<a id="_idIndexMarker2262"/> they have discovered. Then, the attacker<a id="_idIndexMarker2263"/> can run a series of tests to determine<a id="_idIndexMarker2264"/> whether a device has been successfully compromised and how it was done, as well as what user-level access is available after entering the system.</p>
			<p>After remote access has been achieved, the attacker has several ways to infiltrate and exfiltrate data from an IoT device. This can include uploading and executing scripts on the IoT device to gain persistence, establishing a remote shell for later use, or even moving laterally within devices that are connected to compromise other devices on the network.</p>
			<p>Once the attacker has gained access to the device, they employ various methods to maintain and extend access. Attackers remain hidden by deleting logs, upgrading firmware, and employing malicious applications such as backdoors, trojans, and other malware to stay on board. To exploit firmware, attackers utilize tools such as Firmware Mod Kit or Firmwalker, to name a few. </p>
			<p>Speaking of firmware, firmware is a set of instructions that tells the hardware how to function. Firmware analysis<a id="_idIndexMarker2265"/> is the process of examining<a id="_idIndexMarker2266"/> the firmware of a target loT device<a id="_idIndexMarker2267"/> to identify its underlying flaws and risks. Attackers<a id="_idIndexMarker2268"/> use firmware analysis to find passwords, API tokens, endpoints, vulnerable services running, backdoor accounts, and configuration files that are being used. With time and patience, attackers can reverse engineer the firmware and discover weaknesses and backdoors that present themselves as a means to maintain future access. Attackers don't always need to maintain all these capabilities; instead, they should be prepared for multiple contingencies by having other specialized tools at hand. For example, using malware such as Mirai or BASHLITE will maintain access for future use if or when the attackers wish to commandeer the device again.</p>
			<p>Now, let's look at some ways in which we can protect our IoT devices.</p>
			<h2 id="_idParaDest-457"><a id="_idTextAnchor472"/>Countermeasures to protect IoT devices</h2>
			<p>There is no one threat<a id="_idIndexMarker2269"/> that we can correctly protect against since there are many different kinds, and each has a way of attacking and exploiting IoT devices. Combining everything would be too cumbersome and costly for most IoT users, but IoT device manufacturers are in a unique position to implement IoT security by design.</p>
			<p>However, we have some steps we can take to protect the network. Let's take a look:</p>
			<ol>
				<li>Disable any guest or demo accounts.</li>
				<li>Utilize any <em class="italic">auto lockout</em> features for invalid login attempts.</li>
				<li>Use strong authentication mechanisms.</li>
				<li>Place your control systems and devices behind firewalls.</li>
				<li>Isolate the IoT network away from your business network.</li>
				<li>Protect IoT devices from physical access.</li>
				<li>Disable Telnet.</li>
				<li>Use end-to-end encryption and <strong class="bold">public key infrastructure</strong> (<strong class="bold">PKI</strong>).</li>
				<li>Deploy IPS and IDS devices.</li>
				<li>And you know<a id="_idIndexMarker2270"/> this one – update, update, update.</li>
			</ol>
			<p>Now, let's discuss operational technology.</p>
			<h1 id="_idParaDest-458"><a id="_idTextAnchor473"/>OT and methods used to hack it</h1>
			<p><strong class="bold">Operational technology</strong> (<strong class="bold">OT</strong>) is a term that's used to describe a variety of technologies that<a id="_idIndexMarker2271"/> work together as an integrated or homogeneous system in today's modern society. Telecommunications, for example, makes extensive use of OT to move data from the electrical grid to the wheeling station. The same communications are also utilized for financial transactions between electrical consumers and producers. OT is a network of hardware and software that is used to monitor, manage, and control industrial process assets. It's critical to grasp the fundamental principles of OT before attempting to hack it.</p>
			<h3>The Purdue model</h3>
			<p>At this point, it's a great<a id="_idIndexMarker2272"/> time to talk briefly <a id="_idIndexMarker2273"/>about the Purdue model. The Purdue model is derived from the <strong class="bold">Purdue Enterprise Reference Architecture</strong> (<strong class="bold">PERA</strong>) model, which is widely<a id="_idIndexMarker2274"/> used to describe the internal connections and dependencies of essential components in the ICS networks. It consists<a id="_idIndexMarker2275"/> of three zones: the manufacturing zone (OT) and the enterprise zone (IT), which are separated by a <strong class="bold">demilitarized zone</strong> (<strong class="bold">DMZ</strong>).  </p>
			<p>The Purdue model can be used for analyzing, designing, and securing ICS networks. It can help identify potential security risks and vulnerabilities and provide guidance on how to mitigate them. </p>
			<p>In this model, the manufacturing zone (OT) is the most critical part of the network as it includes all field devices that are responsible for process control and automation. The enterprise zone (IT) is less critical as it only provides data storage, connectivity, and other business functions. The DMZ is used to separate the manufacturing and enterprise zones, and it usually contains <a id="_idIndexMarker2276"/>security devices such as firewalls and <strong class="bold">intrusion detection systems</strong> (<strong class="bold">IDSs</strong>).</p>
			<p>We'll cover various<a id="_idIndexMarker2277"/> OT topics in greater detail later in this chapter.</p>
			<p>Let's start by answering the question, what is OT? OT, or an <strong class="bold">industrial control system</strong> (<strong class="bold">ICS</strong>), refers to a specialized<a id="_idIndexMarker2278"/> system of computerized hardware<a id="_idIndexMarker2279"/> and software that is dedicated<a id="_idIndexMarker2280"/> to managing and monitoring<a id="_idIndexMarker2281"/> physical equipment. ICSs, including <strong class="bold">Supervisory Control and Data Acquisition</strong> (<strong class="bold">SCADA</strong>), <strong class="bold">Remote Terminal Units</strong> (<strong class="bold">RTUs</strong>), <strong class="bold">Programmable Logic Controllers</strong> (<strong class="bold">PLCs</strong>), <strong class="bold">Distributed Control Systems</strong> (<strong class="bold">DCSs</strong>), and other specialized network <a id="_idIndexMarker2282"/>systems that help monitor<a id="_idIndexMarker2283"/> and manage industrial operations are part of this technology.</p>
			<div>
				<div id="_idContainer126" class="IMG---Figure">
					<img src="Images/B17486_14_06.jpg" alt="Figure 14.6 – The components of OT&#13;&#10;" width="923" height="900"/>
				</div>
			</div>
			<p class="figure-caption">Figure 14.6 – The components of OT</p>
			<p>Now, let's look at OT and the security challenges we must deal with.</p>
			<h3>OT and security – a dilemma</h3>
			<p>ICSs can monitor and control infrastructures<a id="_idIndexMarker2284"/> such as electrical grids, oil pipelines, networks of elevated transit stations, and more, but these systems have a fundamental security disadvantage – they were built to monitor and control, not necessarily to protect.</p>
			<p>This inaccuracy arises from the fact that OTs have limited access to information about what is going on inside complex infrastructures. For example, an OT control system for a manufacturing plant may provide information on the water levels in tanks, but it usually lacks access to information on water temperature or pH, which are critical parameters for the optimal operation of chemical processes.</p>
			<h2 id="_idParaDest-459"><a id="_idTextAnchor474"/>Hacking OT – a threat to critical infrastructure</h2>
			<p>Contrary to popular belief, the systems<a id="_idIndexMarker2285"/> that control infrastructures such as electrical grids, oil refineries, dams, and more are not secure. Since the sophistication of OT networks has increased, hackers have also had to increase their sophistication by learning more about the OTs they are targeting. The bad news is that it takes much less knowledge and skill to hack an OT system than, say, a traditional IT system.</p>
			<p>The success of a hack is determined by two critical factors – the vulnerability of the targeted system and the ability of the hackers to exploit that weakness. In recent years, numerous vulnerabilities have been discovered in ICSs by security researchers who have published their findings at security conferences such as Black Hat, DEFCON, CanSecWest, and others. Some of these vulnerabilities have made it easy for experienced hackers to penetrate IT networks and control OT systems.</p>
			<h3>Should we combine IT and OT?</h3>
			<p>IT/OT integration can help<a id="_idIndexMarker2286"/> a company's performance by reducing<a id="_idIndexMarker2287"/> gaps between the two domains. The convergence of IT and OT is more than just about using technologies; it's also about personnel and processes. Traditional IT/OT teams are generally kept apart, with IT staff in one department and OT workers in another. For example, IT teams keep track of internal processes such as programming, system updates, and network security. OT teams, on the other hand, are responsible for ensuring that everything runs smoothly both internally and externally. Both IT/OT teams must be familiar with each other's operations and organizational structure. This does not imply that IT experts must be converted into field or plant personnel; it simply implies connecting them so that they may collaborate<a id="_idIndexMarker2288"/> to enhance<a id="_idIndexMarker2289"/> security, efficiency, quality, and productivity.</p>
			<h3>Challenges of OT risks</h3>
			<p>As I mentioned previously, most OT systems are still running on old versions of software and using antiquated<a id="_idIndexMarker2290"/> hardware, making them susceptible to harmful exploits such as phishing, espionage, ransomware assaults, and other types of attacks. These sorts of assaults may be highly damaging to products and services. </p>
			<p>To prevent these vulnerabilities from being exploited, here are some of the risks that OT presents to us:</p>
			<ul>
				<li><strong class="bold">Physical and environmental disasters</strong>: This is one of the most well-known risks in the OT environment. An example would be a hurricane or tornado that can damage equipment and facilities.</li>
				<li><strong class="bold">Intentional attacks</strong>: Acts of terrorism, sabotage, and espionage could result in considerable damage to both property and people.</li>
				<li><strong class="bold">Malicious programs such as viruses and malware</strong>: These are some of the most common attacks that occur in OT environments. Viruses and malware can quickly spread, affecting various equipment throughout a plant.</li>
				<li><strong class="bold">Social engineering</strong>: This entails the use of human-centric attack methods to gain access to OT systems. Examples include phishing or spammy emails being sent to employees who are tricked into giving up their passwords.</li>
				<li><strong class="bold">Network complexity</strong>: OT systems use different technologies from IT, so there is a need for a clear separation of the network. However, additional entry points to networks can prove to be a security risk.</li>
				<li><strong class="bold">Lack of visibility</strong>: OT networks are not monitored properly, so threats go undetected. This can lead to a cascading effect of threats that may affect many people and equipment.</li>
				<li><strong class="bold">Poor security management</strong>: OT systems have weak security defenses, which makes them vulnerable to cyberattacks.</li>
				<li><strong class="bold">Outdated systems</strong>: A lack of updates and patches can leave OT systems open to danger. </li>
				<li><strong class="bold">Convergence with IT</strong>: As I mentioned earlier, convergence between IT and OT teams enables them to work together. However, this is not an easy task; it requires considerable effort<a id="_idIndexMarker2291"/> for both sides to learn about each other's roles and how they can contribute to their respective domains.</li>
				<li><strong class="bold">Vulnerable protocols</strong>: Protocol stacks are the foundation for all network traffic. Open and broken protocols can enable attackers to take control of OT systems.</li>
				<li><strong class="bold">Security by obscurity</strong>: This refers to when manufacturers don't share knowledge about their products with others, including competitors. When this occurs, it becomes easier for hackers to find their way into these devices.</li>
				<li><strong class="bold">Lack of training</strong>: OT personnel and teams do not get the relevant training to secure their systems. As a result, they put company equipment and data at risk.</li>
				<li><strong class="bold">Lack of security standards</strong>: There are currently no security standards for OT devices; this means that every developer may implement their own defense mechanisms. Unfortunately, such measures often lack proper testing and validation, leaving vulnerabilities that can be exploited.</li>
			</ul>
			<p>Next, we'll discuss ICSs.</p>
			<h2 id="_idParaDest-460"><a id="_idTextAnchor475"/>Introduction to industrial control systems (ICSs)</h2>
			<p>ICSs are used to control industrial processes. They're computer systems that monitor and control the operations<a id="_idIndexMarker2292"/> of equipment such as compressors, pumps, generators, motors, reactors, boilers, furnaces, ovens, turbines, conveyors, and more. These components<a id="_idIndexMarker2293"/> are what make up an ICS environment:</p>
			<ul>
				<li><strong class="bold">Supervisory Control and Data Acquisition</strong> (<strong class="bold">SCADA</strong>): These are control systems <a id="_idIndexMarker2294"/>that can monitor and control equipment via the ICS environment. </li>
				<li><strong class="bold">Distributed Control System</strong> (<strong class="bold">DCS</strong>): These are more advanced<a id="_idIndexMarker2295"/> versions of SCADA that utilize distributed computing. </li>
				<li><strong class="bold">Programmable Logic Controller</strong> (<strong class="bold">PLC</strong>): These are small computers that work<a id="_idIndexMarker2296"/> with discrete (discontinuous) signals. They can monitor and control equipment, process data, and more.</li>
				<li><strong class="bold">Human-Machine Interface</strong> (<strong class="bold">HMI</strong>): This is also known as a man-machine interface. It's used to obtain feedback<a id="_idIndexMarker2297"/> from equipment, sensors, and more. If an HMI is being monitored by the ICS environment for any abnormalities or problems, it may send <a id="_idIndexMarker2298"/>out alerts to other personnel via email, text message, and so on. </li>
				<li><strong class="bold">Business process control system</strong> (<strong class="bold">BPCS</strong>): These systems utilize specialized software <a id="_idIndexMarker2299"/>and hardware that can monitor and control industrial processes. BPCSs may be used to run the entire ICS environment or just a single component of it, such as a PLC or DCS.</li>
				<li><strong class="bold">Safety Instrumented System</strong> (<strong class="bold">SIS</strong>): These are software programs that control<a id="_idIndexMarker2300"/> the flow of (typically hazardous) materials in industrial processes. If they detect any issues, they can send out alerts to other personnel via email, text message, and more.</li>
				<li><strong class="bold">Industrial Explosive Device</strong> (<strong class="bold">IED</strong>): These are explosive devices that are used to deal <a id="_idIndexMarker2301"/>with hazardous materials. They're usually part of the SIS's functionality.</li>
			</ul>
			<p>Through the ICS environment, operators can monitor their equipment and processes anywhere in the world. However, this environment may be targeted by cyber attacks if it's not properly secured. It would be wise to practice good network security within such an environment because it controls important components that may pose a threat to people and property.</p>
			<p>Let's discuss some of the different operation modes of ICS.</p>
			<h3>Operation modes of ICS</h3>
			<p>ICS systems can be configured to run in three<a id="_idIndexMarker2302"/> different modes:</p>
			<ul>
				<li><strong class="bold">Open-loop</strong>: In open-loop control, there is no feedback <a id="_idIndexMarker2303"/>from the environment. Consider a temperature sensor placed in an oven. The oven's computer will turn on or off until it reaches the desired temperature that has been set by either a human operator or a program. </li>
				<li><strong class="bold">Closed-loop</strong>: In closed-loop control, there is feedback<a id="_idIndexMarker2304"/> from the environment. Now, let's take our oven scenario again. The temperature sensor will inform the computer to turn on or off accordingly until it reaches the desired set point. </li>
				<li><strong class="bold">Manual-moop</strong>: In manual-loop control, there is feedback from the environment, but the control loop<a id="_idIndexMarker2305"/> is under human supervision. This system won't turn on or off until a human operator intervenes in its operations.</li>
			</ul>
			<p>Next, we'll discuss the potential risks and threats associated with ICS. </p>
			<h3>ICS risks and threats</h3>
			<p>Unfortunately, ICSs<a id="_idIndexMarker2306"/> are vulnerable to cyber attacks. The following are several known risks and threats associated with ICS:</p>
			<ul>
				<li>ICS systems are susceptible to several network-related attacks (for example, network sniffing and spoofing). Attacks such as these can be launched to intercept sensitive information, modify data, and more. </li>
				<li>ICS systems are susceptible to malware attacks (for example, viruses and worms). Malware can cause physical damage to equipment and data loss, among other things. Merely looking at malware with the wrong type of equipment can cause it to go off. </li>
				<li>ICS systems are susceptible to ransomware attacks. These are malicious software programs that are used to encrypt ICS data until a ransom is paid in return for an encryption key. </li>
				<li>Attackers can use social engineering methods against personnel to gain access to ICS environments. For example, they can call up personnel pretending to be from a trusted company sending official-looking emails.</li>
				<li>ICS systems are susceptible to <strong class="bold">Denial of Service</strong> (<strong class="bold">DOS</strong>) attacks. These are used to cripple ICS environments<a id="_idIndexMarker2307"/> by flooding computers with useless data designed to overwhelm their resources so that they're unable to perform their normal operations. </li>
				<li>ICS systems are<a id="_idIndexMarker2308"/> susceptible to Trojan attacks. Trojans are used to gain backdoor access to computers. Like malware, they're capable of causing physical damage. </li>
				<li>ICS system components can be hacked to perform malicious acts. For example, a PLC or DCS could be hacked to cause process shutdowns or other issues within the ICS environment. </li>
				<li>ICS systems are susceptible to several client-side attacks (for example, cross-site scripting and cross-site request forgery). Attacks such as these can be launched against clients so hackers can gain access to the system using the victims' permission. </li>
			</ul>
			<p>Now, let's look at port use when utilizing ICS/SCADA systems.</p>
			<h3>The ports that are used by ICS/SCADA systems</h3>
			<p>ICSs that are used in SCADA<a id="_idIndexMarker2309"/> and other critical infrastructure systems typically use seven-port communications<a id="_idIndexMarker2310"/> protocols to connect end devices: </p>
			<ul>
				<li>Port <strong class="source-inline">80</strong>: HTTP (used for communications between ICS/SCADA clients and servers) </li>
				<li>Port <strong class="source-inline">88</strong>: UDP (used for communications between ISC/SCADA components for status updates, device naming, and more) </li>
				<li>Port <strong class="source-inline">21</strong>: FTP (used to transfer files between ICS/SCADA components) </li>
				<li>Port <strong class="source-inline">25</strong>: SMTP (used for sending emails) </li>
				<li>Port <strong class="source-inline">23</strong>: Telnet (used to connect to remote devices to configure them or check their status) </li>
				<li>Port <strong class="source-inline">161</strong>: SNMP (used for network management and configuring devices over IP networks) </li>
				<li>Port <strong class="source-inline">443</strong>: HTTPS (used for encrypted communications between ICS/SCADA components)</li>
			</ul>
			<p>Now, let's discuss some<a id="_idIndexMarker2311"/> of the attacks that ICS/SCADA may encounter. </p>
			<h3>Attacks on ICS/SCADA</h3>
			<p>ICS/SCADA has vulnerabilities<a id="_idIndexMarker2312"/> regarding being attacked. Here are some of the potential attacks that may be used against ICS/SCADA:</p>
			<ul>
				<li><strong class="bold">HMI-based attacks</strong>: HMI-based attacks target human-machine<a id="_idIndexMarker2313"/> interfaces, which are used to view and manipulate data on ICS/SCADA systems. These types of attacks can be launched by gaining unauthorized access to the network or tricking operators into visiting spoofed websites that launch malware onto their computers. </li>
				<li><strong class="bold">Memory corruption</strong>: A memory corruption attack<a id="_idIndexMarker2314"/> is a hack that aims to corrupt the memory of an ICS/SCADA component so that it fails to perform as expected. These types of attacks can be launched by gaining unauthorized access to the network or intercepting communication between components<a id="_idIndexMarker2315"/> to tamper with them. </li>
				<li><strong class="bold">Credential management</strong>: These aim to gain access to an ICS/SCADA environment by using<a id="_idIndexMarker2316"/> default passwords. This would also include the lack of encryption as data is in motion, which would reveal cleartext passwords and account names.</li>
				<li><strong class="bold">Code injection</strong>: These types of attacks<a id="_idIndexMarker2317"/> inject malicious code into ICS/SCADA software to cause technical issues, disrupt operations, or allow attackers to access the system. The vulnerabilities in this category include common code injections such as SQL, operating system, command, and some domain-specific injections. Gamma script, like many other domain-specific languages for HMIs, is vulnerable to code injection attacks.</li>
			</ul>
			<p>Now, let's discuss some of the specifics<a id="_idIndexMarker2318"/> of side-channel attacks.</p>
			<h3>Side-channel attacks</h3>
			<p>These types of attacks<a id="_idIndexMarker2319"/> target the physical implementation<a id="_idIndexMarker2320"/> of cryptosystems (for example, anything that processes cryptography). They exploit unintentional characteristics of the physical implementation that leak information about cryptographic keys or other sensitive data.</p>
			<p>Power analysis can be used to derive information about cryptographic keys by observing details such as the amount of time it takes for computations to occur, or by measuring electromagnetic emanations from integrated circuits. </p>
			<p>Timing analysis is another side-channel attack that's considered high-throughput, which allows attackers to perform it fast enough to be effective in most cases. Timing analysis can be used with ICS/SCADA systems because they typically run on embedded devices with RTOS. A loop approach is used by attackers to recover these passwords. They attempt one character at a time until they find the first one that works, and then they repeat for additional characters if the first was correct. If not, the loop ends. By monitoring how long it takes a device to complete one whole password authentication process, attackers can figure out how many characters that have been entered are correct.</p>
			<h3>How can you defend against OT hacking?</h3>
			<p>The best way to defend against OT hacking is with awareness and periodic audits, such as red-teaming exercises. Awareness can be achieved through regular training programs; audits should include testers who look for vulnerabilities in the network and digital filesystems of the devices. Such audits also consider what could happen if a system were hacked: how many devices could be impacted and how quickly would the business become aware of the threat?</p>
			<p>Here is a list of some options<a id="_idIndexMarker2321"/> to consider when you're trying to defend against OT hacking:</p>
			<ul>
				<li>To lower current risk exposure, conduct a risk assessment regularly.</li>
				<li>Use purpose-built sensors to discover the vulnerabilities in the network inactively.</li>
				<li>By combining threat intelligence with asset protection, you can detect threats and prioritize OT patches.</li>
				<li>Make sure your OT devices and software are always up to date.</li>
				<li>Unused ports and services should be disabled.</li>
				<li>For OT applications, use best security practices and secure coding.</li>
				<li>Continuously monitoring and detecting log data that's been generated by OT systems is required to discover real-time assaults.</li>
				<li>Raise security awareness among staff and provide them with up-to-date security measures.</li>
				<li>Use hashing to create strong and secure passwords and change the factory-preset passwords.</li>
				<li>Use two-factor authentication, VPNs, encryption, firewalls, and more to provide secure remote access through a variety of barriers.</li>
			</ul>
			<p>So, as you can see, IoT has its challenges and those challenges will increase as more and more devices<a id="_idIndexMarker2322"/> are brought into the world of IoT.</p>
			<h1 id="_idParaDest-461"><a id="_idTextAnchor476"/>Summary</h1>
			<p>In this chapter, we discussed IoT and OT. In a time when so many products are being developed with some smart aspect to them, there is a challenge of balancing functionality with security. Unfortunately, the security aspect seems to be a second thought and that presents a new host of potential security vulnerabilities. We addressed what IoT is, some ways to hack IoT, and some methods attackers can use on IoT. Finally, we discussed the role OT also plays in the security challenges of IoT.</p>
			<p>In the next chapter, we'll discuss cloud computing.</p>
			<h1 id="_idParaDest-462"><a id="_idTextAnchor477"/>Questions</h1>
			<p>As we conclude, here is a list of questions for you to test your knowledge regarding this chapter's material. You will find the answers in the <em class="italic">Assessments</em> section of the <em class="italic">Appendix</em>:</p>
			<ol>
				<li value="1">Which of the following is responsible for message routing and identification in an IoT architecture?<ol><li>The middleware layer</li><li>The edge technology layer</li><li>The access gateway layer</li><li>The internet layer</li></ol></li>
				<li>When is the Shodan search engine most likely to be employed in the IoT hacking methodology?<ol><li>Information gathering</li><li>Vulnerability scanning</li><li>Gaining access</li><li>Launching attacks</li></ol></li>
				<li>Which of the following countermeasures are effective in preventing IoT hacking? (Select all that apply.)<ol><li>Enabling lockout features for excessive login attempts</li><li>Disabling guest and demo accounts</li><li>Enabling UPnP</li><li>Disabling telnet</li></ol></li>
				<li>Of the tools listed, which is the best choice for quickly discovering the IP addresses of IoT devices on your network?<ol><li>MultiPing</li><li>IoTInspector</li><li>beSTORM</li><li>Z-Wave Sniffer</li></ol></li>
			</ol>
		</div>
	</div></body></html>