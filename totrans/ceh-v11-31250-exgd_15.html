<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer137">
			<h1 id="_idParaDest-480"><em class="italic"><a id="_idTextAnchor497"/>Chapter 16</em>: Using Cryptography</h1>
			<p>If you're new to <strong class="bold">cryptography</strong>, let's talk about its purpose. I'm going to try to make this easy to understand, because to some folks, cryptography can be overwhelming. </p>
			<p>Cryptography is all about protecting data, usually in the form of messages or files. This can be done by taking data and transforming it into an unreadable format, often called <strong class="bold">ciphertext</strong>. The only way to transform the ciphertext back into readable data is with a <strong class="bold">special key</strong>, which only the sender and recipient of the message have access to. This process is called <strong class="bold">encryption</strong>, and it's the basis of how cryptography works. </p>
			<p>When you're through with this chapter, my hope is that you'll come away with an added perspective and greater depth of understanding of the essential role cryptography plays in the guarding and protecting of information and digital communication. </p>
			<p>Here is what we'll cover in this chapter:</p>
			<ul>
				<li>Understanding cryptography</li>
				<li>Standards and protocols</li>
				<li>Countermeasures for cryptography</li>
			</ul>
			<p>Let's first discuss why cryptology is important to our security efforts.</p>
			<h1 id="_idParaDest-481"><a id="_idTextAnchor498"/>Understanding cryptography</h1>
			<p>In this section, we'll discuss why cryptology is important and some of the best cryptology tools and <a id="_idIndexMarker2445"/>resources available to us. Having knowledge of the proper tools and resources will be invaluable to you as a security professional. So, let's jump in and discuss what this is all about.</p>
			<h2 id="_idParaDest-482"><a id="_idTextAnchor499"/>Why use cryptology?</h2>
			<p>So, what does cryptography bring to the table? Well, it <a id="_idIndexMarker2446"/>brings <strong class="bold">non-repudiation</strong>. This means that <a id="_idIndexMarker2447"/>whoever sent a message can't later deny having altered the document. For example, <em class="italic">"It wasn't me, Dale, I swear,"</em> to which I'll reply, <em class="italic">"No, it was you because it was encrypted with your key."</em> </p>
			<p>Cryptography also brings <strong class="bold">authentication</strong> to the table. Sometimes we visit websites where it's important that we authenticate who we say we are, as well as obviously wanting to authenticate our credit card information, right? So, it's important to us, especially to those within our industry.</p>
			<p>And, of course, <strong class="bold">confidentiality</strong> is another major factor as far as what cryptography can do for us. As far as confidentiality is concerned, we can only make certain resources available to authorized users. Now, as far as how this process works or how cryptography works, these are at a very plain or elementary level. The process goes like this. </p>
			<p>We have <strong class="bold">plaintext</strong>; this is <a id="_idIndexMarker2448"/>the text that is formatted and that we can read. Maybe it's a Word document, maybe it's an email, but it gets encrypted using an algorithm, <a id="_idIndexMarker2449"/>such as the <strong class="bold">Data Encryption Standard</strong> (<strong class="bold">DES</strong>) or <a id="_idIndexMarker2450"/>the <strong class="bold">Advanced Encryption Standard</strong> (<strong class="bold">AES</strong>), or <a id="_idIndexMarker2451"/>even <strong class="bold">Rivest—Shamir—Adleman</strong> (<strong class="bold">RSA</strong>). After the encryption has been applied, we refer to that whole document as ciphertext. It's completely unreadable. This file is then transmitted, and on the opposite end, it just goes through the opposite process, right? The ciphertext uses the keys it's aware of to do decryption, and then it gives us the plaintext that the original sender or the resource wanted us to see.</p>
			<p>Cryptography is an important part of keeping our information safe and secure and is used in a variety of different applications. Everything from our email to our financial information is protected by cryptography, and it's important to understand how it works. </p>
			<p>See? I told you this would be easy. </p>
			<p>Next, let's talk about the types of cryptography.</p>
			<h2 id="_idParaDest-483"><a id="_idTextAnchor500"/>Types of cryptography</h2>
			<p>There's not a whole lot of talking to do on this subject because guess what? There are only two, symmetric and asymmetric:</p>
			<ul>
				<li><strong class="bold">Symmetric cryptography</strong> is all about using the same key for both encryption and decryption. So, what we have are a sender and a recipient, and they're going to <a id="_idIndexMarker2452"/>use the same key to encrypt <a id="_idIndexMarker2453"/>the message they want to send back and forth. It's very fast, it's very efficient, but it also has a couple of major <a id="_idIndexMarker2454"/>drawbacks:<ul><li>The first is, if you lose that key, then you've lost all access to the information that's been encrypted.</li><li>And second, it's very difficult to manage large-scale deployments of symmetric cryptography.</li></ul></li>
				<li><strong class="bold">Asymmetric cryptography</strong> is just about as opposite of symmetric cryptography <a id="_idIndexMarker2455"/>as you can get. Rather <a id="_idIndexMarker2456"/>than using one key to do both encryption and decryption, it uses two keys, a public key and a private key: <ol><li>The first <a id="_idIndexMarker2457"/>key is the <strong class="bold">public key</strong> and it's <a id="_idIndexMarker2458"/>a key anybody can have access to.</li><li>The second <a id="_idIndexMarker2459"/>key is the <strong class="bold">private key</strong>, and it's meant <a id="_idIndexMarker2460"/>to be known only by the owner. It should never be given to anybody else. And, the great thing about this is that, if you use a public key to encrypt information, the only way to decrypt it is by using the corresponding private key. So, even if somebody were to intercept that message, they wouldn't be able to do anything with it because they don't have access to the private key.</li></ol></li>
			</ul>
			<p>The other great thing about asymmetric cryptography is that it doesn't require a secure initial exchange of keys like symmetric cryptography does. So, it's a little bit more secure in that sense. It's not perfect, but it's definitely more secure.</p>
			<p>Asymmetric also utilizes <strong class="bold">digital signatures</strong>. Digital signatures are just a way to ensure the <a id="_idIndexMarker2461"/>message has not been tampered with in transit. And, the way that this works is the sender of the message will use their private key to encrypt it, and they'll send both the message and their public key to the recipient. The recipient can then use the sender's public key to decrypt the message and then they can compare it to the original message to ensure it hasn't been tampered with.</p>
			<p>Now, it does have some cons to it. It's a little bit slower than symmetric cryptography (we're talking about half an eyeblink versus a full eyeblink), and it also requires more bandwidth. But overall, it's a much more secure way to send information. Now, nothing is foolproof, right? If I've taught you anything through this series, it's that there's always a way. When it comes to asymmetric, it is <a id="_idIndexMarker2462"/>susceptible to <strong class="bold">man-in-the-middle</strong> (<strong class="bold">MITM</strong>) attacks, as <a id="_idIndexMarker2463"/>well as <strong class="bold">brute-force</strong> <strong class="bold">attacks</strong>. And, unfortunately, if the private key gets lost, then there's really no way to decrypt the information that's been encrypted with it.</p>
			<p>Let's discuss some other keys next.</p>
			<h3>GAK</h3>
			<p>The <strong class="bold">Government Access Key</strong> (<strong class="bold">GAK</strong>) is a <a id="_idIndexMarker2464"/>system proposed by the United States <strong class="bold">National Security Agency</strong> (<strong class="bold">NSA</strong>) to allow government <a id="_idIndexMarker2465"/>access to encrypted communications. The key would be a mathematical value that would be used to decrypt messages. The existence of such a key would make it possible for the NSA to read encrypted communications, including those between citizens and businesses, as well as between different countries.</p>
			<p>The problem with this system is that it would require a key that is incredibly complex and difficult to generate. And, of course, the NSA would need to keep this key completely secret. If the key were to get out, then anybody could use it to read encrypted communications. Has anyone seen the 1991 movie <em class="italic">Sneakers</em> starring Robert Redford? Talk about a movie that predicted the future of encryption! (<em class="italic">Homework assignment from Dale: watch this movie!</em>). </p>
			<p>Another problem with GAK is that it would be very difficult to implement. Any change to the encryption algorithms used by businesses and governments would need to be approved by the NSA. This would give the NSA a lot of power, and it's not clear that they could be trusted with such power.</p>
			<p>It's also worth noting the NSA is not the only government agency interested in reading encrypted <a id="_idIndexMarker2466"/>communications. The United Kingdom's <strong class="bold">Government Communications Headquarters</strong> (<strong class="bold">GCHQ</strong>) has also expressed an interest in a system that would allow them to read encrypted communications.</p>
			<p>Let's continue to talk further about another tool for encryption next called <strong class="bold">ciphers</strong>.</p>
			<h2 id="_idParaDest-484"><a id="_idTextAnchor501"/>Learning about ciphers</h2>
			<p>What we're talking <a id="_idIndexMarker2467"/>about when it comes to ciphers is an algorithm. You can think of it as a defined series of steps that have to be performed for the encryption and decryption process to occur. Once a message or data has been encrypted using a cipher, it is considered unreadable unless, of course, whoever's receiving the data or message knows the secret key that's required to decrypt it.</p>
			<p>Now, believe it or not, ciphers are used everywhere, not just in our emails and our data itself, but we also use them in other communication technologies, such as cell phones. This is what makes our cell phone calls more secure. </p>
			<h3>Types of ciphers</h3>
			<p>Now, I know what you're thinking: <em class="italic">"Dale, is there only one cipher?"</em> No, there are several different types of ciphers. We can categorize them into two different types, either classical or modern. I know, it sounds like we're going to talk about art, but we're not. </p>
			<p>Let's look at classical and modern ciphers.</p>
			<h4>Classical ciphers</h4>
			<p><strong class="bold">Classical ciphers</strong> are <a id="_idIndexMarker2468"/>those that were developed <a id="_idIndexMarker2469"/>before the invention of the computer. They include classical ciphers <a id="_idIndexMarker2470"/>such as the <strong class="bold">Caesar cipher</strong>, which is a simple <strong class="bold">substitution cipher</strong>, where <a id="_idIndexMarker2471"/>each letter of the alphabet is replaced with another letter according to a defined pattern. <em class="italic">Figure 16.1</em> is an example of a Caesar cipher:</p>
			<div>
				<div id="_idContainer129" class="IMG---Figure">
					<img src="Images/B17486_16_01.jpg" alt="Figure 16.1 – Example of a Caesar cipher (a simple substitution of letters)&#13;&#10;" width="1357" height="133"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.1 – Example of a Caesar cipher (a simple substitution of letters)</p>
			<p>So, in this case here, <strong class="bold">MY VOICE IS MY PASSWORD</strong>, as you can see, gets translated to <strong class="bold">DB XGOET OL DB HALLCGKR</strong>. All we're doing is basically replacing the <strong class="bold">M</strong> with another letter, in this case, <strong class="bold">D</strong>. Notice how <strong class="bold">DB</strong> represents <strong class="bold">MY</strong> in both instances. This would help me to figure out how to decrypt this message, given enough time.</p>
			<p>Another type of classical cipher <a id="_idIndexMarker2472"/>is referred to as a <strong class="bold">transposition</strong>. In a transposition, you use what they refer <a id="_idIndexMarker2473"/>to as a <strong class="bold">key</strong>. Now, depending on the transposition cipher that you're using, in this case, I'm showing you (in <em class="italic">Figure 16.2</em>) what they <a id="_idIndexMarker2474"/>refer to as a <strong class="bold">rail fence cipher</strong>:</p>
			<div>
				<div id="_idContainer130" class="IMG---Figure">
					<img src="Images/B17486_16_02.jpg" alt="Figure 16.2 – Example of a rail fence cipher&#13;&#10;" width="1228" height="323"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.2 – Example of a rail fence cipher</p>
			<p>In this case, the key is <strong class="bold">3</strong>, which means there are three spaces between characters. You see that <strong class="bold">MY VOICE IS MY PASSWORD</strong> is spelled out in this up-and-down method, and the spaces in between are kind of ignored completely. So, the first line ends up becoming just <strong class="bold">MISAO</strong> while the next line of code would be just simply <strong class="bold">YOCIMPSWR</strong>, and the third row would just simply equal <strong class="bold">VEYSD</strong>. Now, obviously, the recipient would have to know that the key is <strong class="bold">3</strong> to decrypt this. </p>
			<p>Another type of <a id="_idIndexMarker2475"/>transposition cipher is a <strong class="bold">route cipher</strong>. With the route cipher, we end up taking the same data or information we're trying to encrypt. In <em class="italic">Figure 16.3</em>, I'm going to use the text, <strong class="bold">MY VOICE IS MY PASSWORD</strong>, and I'm going to lay it out like this: </p>
			<div>
				<div id="_idContainer131" class="IMG---Figure">
					<img src="Images/B17486_16_03.jpg" alt="Figure 16.3 – Example of a route cipher&#13;&#10;" width="980" height="332"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.3 – Example of a route cipher</p>
			<p>Can you <a id="_idIndexMarker2476"/>see it all there? So, it lays the plaintext out in a grid pattern just like this, and, of course, the last two characters are just random characters. This type <a id="_idIndexMarker2477"/>of cipher is determined based on the route. </p>
			<p>Those are just some quick examples of classical ciphers. </p>
			<p>Let's look at modern ciphers next.</p>
			<h4>Modern ciphers</h4>
			<p>You can see with the classical type how easy it would be to crack those types of ciphers. With modern ciphers, they're a little bit more difficult to try to crack manually. And typically, modern <a id="_idIndexMarker2478"/>ciphers are there to provide authenticity, security, and integrity to the sender.</p>
			<p>The types of <a id="_idIndexMarker2479"/>modern ciphers you'll see are both symmetric and asymmetric. While I'm talking about it, there's a way to use both asymmetric and symmetric at the same time, but that might be going a little too deep here, so I'm just going to leave that up to you. If you want to do a little bit more research, you can look at that further.</p>
			<p>There are also ciphers that are based on the input of data. We have what they refer to as a <strong class="bold">block cipher</strong>, and <a id="_idIndexMarker2480"/>what we mean by <em class="italic">block</em> is the algorithm operates in groups of bits or a block of a fixed size. Most of the cryptography we see today, such <a id="_idIndexMarker2481"/>as DES, AES, or even the <strong class="bold">International Data Encryption Algorithm</strong> (<strong class="bold">IDEA</strong>), are all using block-based ciphers. Now, if by chance, the block size of the data coming across is less than what is used by the cipher itself, there's some padding that helps to make sure it achieves the block size that's needed.</p>
			<p>There are also <strong class="bold">stream ciphers</strong>. When <a id="_idIndexMarker2482"/>it comes to a stream cipher, we're basically talking about a symmetric key cipher, where the plaintext digit is combined with a pseudorandom cipher digit stream, which we sometimes refer to as a <strong class="bold">keystream</strong>. In a <a id="_idIndexMarker2483"/>stream cipher, each character is encrypted one at a time, and with it goes a corresponding digit of the keystream; this gives us a cyber-text digit stream.</p>
			<p>Let's look at some other types of algorithms.</p>
			<h2 id="_idParaDest-485"><a id="_idTextAnchor502"/>Using other algorithms</h2>
			<p>When it comes <a id="_idIndexMarker2484"/>to different algorithms out there, the most common we will see are going to be <strong class="bold">DES</strong>, <strong class="bold">triple DES</strong> (<strong class="bold">3DES</strong>), <strong class="bold">AES</strong>, and <strong class="bold">RC4</strong>. </p>
			<p>Let's discuss these next.</p>
			<h3>DES</h3>
			<p>This was <a id="_idIndexMarker2485"/>created back in the 1970s by <strong class="bold">IBM</strong>. It utilizes a 64-bit block. On top of that, it only uses a 56-bit key for encryption and decryption, which is not that great. In fact, in 1999, this algorithm was cracked, especially considering the computing <a id="_idIndexMarker2486"/>power we had back then was not very much. But, DES itself provided up to 72 quadrillion possible encryption keys, and we were able to crack it back in 1999. Now, because this was cracked, the US government got involved and helped. Now, obviously, to cover this vulnerability, which could be brute force-attacked very easily, we came up with triple DES, or some people might call it 3DES. The reason it's called 3DES is that it goes through and does the DES algorithm three times with three different keys. </p>
			<p>Now, as far as how these keys are used, you have a couple of different options:</p>
			<ul>
				<li>The first option is all three of the keys are completely different or independent.</li>
				<li>The second option is using the <strong class="bold">K1</strong> and <strong class="bold">K3</strong> keys, but since they're both used for encryption, they are identical.</li>
				<li>And, there's a third option, which is where all three keys are the same, but that's not very secure.</li>
			</ul>
			<p>The most secure would be the first option, which is where all three keys are independent. </p>
			<h3>AES</h3>
			<p>AES is <a id="_idIndexMarker2487"/>kind of a fully grown adult compared to DES <a id="_idIndexMarker2488"/>and 3DES. It utilizes a 128-bit block size, and its keys are 128, 192, or 256-bit in size. I bet you can't guess what they call each one of <a id="_idIndexMarker2489"/>those, right? They're <a id="_idIndexMarker2490"/>called <strong class="bold">AES128</strong>, <strong class="bold">AES192</strong>, and <strong class="bold">AES256</strong>. That <a id="_idIndexMarker2491"/>was tricky, wasn't it? AES is a symmetric-key <a id="_idIndexMarker2492"/>algorithm, created with the help of the <strong class="bold">National Institute of Standards and Technology</strong> (<strong class="bold">NIST</strong>). The government agencies use this for encrypting data that is considered unclassified. </p>
			<h3>RC4</h3>
			<p>Some folks call it <strong class="bold">Ron Rivest</strong>. Ron is <a id="_idIndexMarker2493"/>the first name of the gentleman who helped <a id="_idIndexMarker2494"/>create it, but the cipher is called Ron Rivest; it's <strong class="bold">Rivest Cipher 4</strong>. Now, this <a id="_idIndexMarker2495"/>cipher is considered a variable key size symmetric keystream cipher. And, let's be honest, it's not that great because <a id="_idIndexMarker2496"/>guess what? We use this in <strong class="bold">Wired Equivalent Privacy</strong> (<strong class="bold">WEP</strong>), which is the wireless security protocol that's been hacked very, very easily.</p>
			<p>The reason why RC4 was vulnerable to different types of attacks was that it had what they refer <a id="_idIndexMarker2497"/>to as a <strong class="bold">biased output</strong>. There is a rule that if the third byte in its original state is <em class="italic">0</em>, and if the second byte doesn't equal <em class="italic">2</em>, this means the second output byte is always <em class="italic">0</em>. Now, this may seem complicated, but trust me, once we see patterns like this, we're able to go through and reverse engineer the cipher and crack it. And, that's what happened to WEP. </p>
			<p>Two other algorithms that we should be familiar with are <strong class="bold">Blowfish</strong> and <strong class="bold">Twofish</strong>. </p>
			<h3>Blowfish and Twofish</h3>
			<p>The Blowfish algorithm <a id="_idIndexMarker2498"/>was developed back in 1993, and I know <a id="_idIndexMarker2499"/>you're thinking, <em class="italic">"Dale, that's a long time ago."</em> But it's quite a strong symmetric block cipher that we still use today. It uses the same key to encrypt and decrypt. It utilizes a 64-bit block, and its key is a variable key anywhere from 32 to 448 bits. This protocol was designed to replace DES and triple DES.</p>
			<p>Now, it may be surprising to know that a lot of people still enjoy using AES, and I guess there's nothing wrong with it, but you need to know that one of the advantages of Blowfish is its speed. It breaks things down into a 64-bit block as compared to AES, which, by using a 128-bit block, allows for faster encryption and decryption. </p>
			<p>We also have <a id="_idIndexMarker2500"/>something called Twofish. This encryption was created a <a id="_idIndexMarker2501"/>few years after Blowfish. It was introduced to us back in 1998, and it's relatively close to the Blowfish cipher. That's why we have a similar name here, but it encrypts data with a 128-bit block just like AES. In fact, Twofish is very similar to AES because it supports a 256-bit block, as well as a 192 or 128 key size. And, just like Blowfish, it uses a single key. </p>
			<p>Then, there's <strong class="bold">Threefish</strong>, which was <a id="_idIndexMarker2502"/>developed in 2008 and is a part of the Skein algorithm. It is a 12-round Feistel network cipher with a block size of 128 bits and a key length of 256 bits. Threefish is very fast and very secure, with a high degree of resistance to attack.</p>
			<p>Now, another reason why both these ciphers are extremely popular is that they haven't been patented. They're open-sourced. In fact, Twofish was the algorithm that was one of the top five finalists to replace DES for the US government but, unfortunately, it didn't win. <em class="italic">But I think it did win Ms. Congeniality. Now I'm just kidding.</em> </p>
			<p>So, now that we've got the most popular algorithms out of the way, in the next section, we'll talk about standards and protocols.</p>
			<h1 id="_idParaDest-486"><a id="_idTextAnchor503"/>Standards and protocols</h1>
			<p>Let's talk about <a id="_idIndexMarker2503"/>some of the most common standards we see out there. In this section, we'll talk about more algorithms, hashes, ciphers, and other cryptographic mechanisms that will assist you in securing the data and communication you help protect.</p>
			<h2 id="_idParaDest-487"><a id="_idTextAnchor504"/>DSA </h2>
			<p>This is a <a id="_idIndexMarker2504"/>federal information processing standard for creating <a id="_idIndexMarker2505"/>digital signatures. How this signature standard works is that it creates a 320-bit digital signature, but the signature is also accompanied by anything from 512- to 1024-bit security. It also utilizes our private and public key technology or process.</p>
			<h2 id="_idParaDest-488"><a id="_idTextAnchor505"/>RSA</h2>
			<p>Hey, you <a id="_idIndexMarker2506"/>know what? RSA are the initials of the creators. The <em class="italic">R</em> is from the same <em class="italic">Ron Rivest</em> from RC4, as well as from two other gentlemen. The <em class="italic">S</em> is after <em class="italic">Shamir,</em> and the <em class="italic">A</em> is after <em class="italic">Alderman</em>. All three of these gentlemen <a id="_idIndexMarker2507"/>worked at the <strong class="bold">Massachusetts Institute of Technology</strong> (<strong class="bold">MIT</strong>). Rivest and Shamir worked as computer scientists and Alderman was a mathematician. </p>
			<p>Now, RSA also <a id="_idIndexMarker2508"/>uses a public key encryption system and uses two large prime numbers as its basis. We see RSA as a standard in a lot of our operating systems today: Microsoft, Apple, and Sun Microsystems, as well as being utilized in networking cards, smartcards, and even what we refer to as hardware-secured phones. Now, this may make your brain hurt a little bit, but let me give you a brief synopsis of how this works:</p>
			<ol>
				<li>First, two large prime numbers are taken, and we're going to call them <em class="italic">A</em> and <em class="italic">B</em>. These two prime numbers and their product are determined by saying that <em class="italic">C</em> is equal to <em class="italic">A* B</em>, and <em class="italic">C</em> (in math, we'd see it this way: <em class="italic">C=AB</em>) and, therefore, <em class="italic">C</em> is referred to as the <strong class="bold">modulus</strong>. </li>
				<li>RSA then chooses another number called <em class="italic">E</em> that is less than <em class="italic">C</em> and relatively prime to <em class="italic">(A-1)(B-1)</em>. What this does is it makes sure that <em class="italic">E</em> and <em class="italic">A-1 x B-1</em> have no common factors with each other except for the number <em class="italic">1</em>.</li>
				<li>I know, it keeps getting better because then RSA chooses another number, <em class="italic">F</em>, and it does this so that <em class="italic">EF-1</em> is divisible by <em class="italic">A-1 x B-1</em>. </li>
				<li>Now, some of you <em class="italic">algebra folks</em> are following right along. But wait, there's more. The values of <em class="italic">E</em> and <em class="italic">F</em> are referred to as the public and private exponents. In using those exponents, the public key is paired with <em class="italic">C</em> and <em class="italic">E</em> to create that public key, and the private key is created by pairing <em class="italic">C</em> and <em class="italic">F</em> together.</li>
			</ol>
			<p>Now, the reason why this is extremely secure is that it's considered to be extremely difficult to obtain the private key from the public key. Now, obviously, if someone can factor <em class="italic">C</em> into <em class="italic">A</em> and <em class="italic">B</em>, then that person could decipher the private key, but the odds of somebody <a id="_idIndexMarker2509"/>trying to get a hold of those two prime numbers that <a id="_idIndexMarker2510"/>are taken at random are almost impossible. So, again, a lot more secure for us. </p>
			<h2 id="_idParaDest-489"><a id="_idTextAnchor506"/>Hashes</h2>
			<p>I'm getting hungry. I think hash browns or just some good cabbage and hash are delicious. I've <a id="_idIndexMarker2511"/>got to get food off my mind here!</p>
			<p>When it comes to <strong class="bold">hashes</strong>, what we're trying to do is come up with a way to verify that a particular <a id="_idIndexMarker2512"/>document hasn't changed. We want to know it's legitimate, that it has been signed, and no one has changed or tampered with it. Now, how we <a id="_idIndexMarker2513"/>do this is we take the document, and we assign a <strong class="bold">digital signature</strong> associated with it. That signature is represented by a hexadecimal code. This code tells us the document and the default for this document; if it is equal to the hexadecimal code number, we know it's legit, it's been signed, and nobody has changed it. This also applies to an executable or an email. But, if somehow the document or the executable is changed, that hash value won't work, or it won't calculate out correctly.</p>
			<h2 id="_idParaDest-490"><a id="_idTextAnchor507"/>Message digest</h2>
			<p>When we talk <a id="_idIndexMarker2514"/>about cryptography, there's something that we need to <a id="_idIndexMarker2515"/>keep in mind, and that is the <strong class="bold">message digest</strong>. The message digest is also referred to as a <strong class="bold">hash value</strong>. What it does is it takes a block of data and produces a unique fingerprint or <a id="_idIndexMarker2516"/>hash value of that data. This is important because when we're talking about authentication, we're talking about making sure the data has not been altered in any way. And so, this allows us to look at the message and be able to say, <em class="italic">"Okay, this is exactly what was sent. It hasn't been changed in any way."</em></p>
			<p>Another <a id="_idIndexMarker2517"/>hash method is referred to as <strong class="bold">Secure Hash Algorithm 1</strong> (<strong class="bold">SHA-1</strong>) and was introduced in 1993 by the NSA. Now, its function is to take the input and produce a 160-bit hash value that is then turned into hexadecimal, which is about 40 characters long once it's converte<a id="_idTextAnchor508"/>d. It's typically utilized with other <a id="_idIndexMarker2518"/>protocols or <a id="_idIndexMarker2519"/>security protocols, such as <strong class="bold">Pretty Good Privacy</strong> (<strong class="bold">PGP</strong>), <strong class="bold">Transport Layer Security</strong> (<strong class="bold">TLS</strong>), <strong class="bold">Secure Shell</strong> (<strong class="bold">SSH</strong>), and <strong class="bold">Secure Sockets Layer</strong> (<strong class="bold">SSL</strong>).</p>
			<p>Now, I know <a id="_idIndexMarker2520"/>what you <a id="_idIndexMarker2521"/>may be thinking: <em class="italic">"Dale, why'd we start with 1? Where's the SHA-0?"</em> Well, <strong class="bold">SHA-0</strong> was 160-bit, but it was so bad it was pulled for a significant flaw. Well, they then obviously came out with <strong class="bold">SHA-2</strong>. Now, SHA-2 is extremely similar to SHA-1, but it does use 256-bit, but it is stronger and larger than SHA-1. And, what I mean by that is there are two different block sizes that it can use, either <strong class="bold">SHA256</strong>, which gives you a <strong class="bold">32-bit word</strong>, and <strong class="bold">SHA256</strong>, which, double it, <strong class="bold">64-bit</strong>, right? Guess what? </p>
			<p>They then came out with <strong class="bold">SHA-3</strong>. It's unlike SHA-2, which was similar to SHA-1 (and SHA-1 was similar to SHA-0); SHA-3's only likeness is in its name. The reason behind it being a completely <a id="_idIndexMarker2522"/>different beast is that it uses what's referred <a id="_idIndexMarker2523"/>to as <strong class="bold">sponge construction</strong>. The data is absorbed, or the input is absorbed, and the output or the result is squeezed out. Now, during the <a id="_idIndexMarker2524"/>absorption process, the message blocks themselves are XORed into initial bits of state or a subset. That subset is then transformed using a permutation function. So, yeah, it's a little bit tougher. </p>
			<p>So, now that we've got our hands on these different types of ciphers, there are some ciphers that are designed for messages.</p>
			<h2 id="_idParaDest-491"><a id="_idTextAnchor509"/>Ciphers designed for messages</h2>
			<p>We first <a id="_idIndexMarker2525"/>start with <strong class="bold">hash-based message authentication code</strong> (<strong class="bold">HMAC</strong>). This algorithm includes the embedding <a id="_idIndexMarker2526"/>of the hash functions, such <a id="_idIndexMarker2527"/>as SHA-1 or the <strong class="bold">message-digest algorithm</strong> (<strong class="bold">MD5</strong>). Where its strength comes from is dependent upon the embedded hash function, key size, and the size of the hash output. </p>
			<p>How HMAC operates is there are two different stages. Now, in those stages, there's a secret key that's created. There's one for an <em class="italic">innie</em> and one for an <em class="italic">outie</em>. I know, I just made a <em class="italic">belly button</em> joke. It's <strong class="bold">inner</strong> and <strong class="bold">outer</strong>, but the concept remains the same.</p>
			<p>The first pass of the algorithm produces an internal hash derived from the message and the inner key. The second pass includes the final HMAC code derived from the inner hash result and the outer key. Now, HMAC itself doesn't encrypt the message, but instead, it takes the message whether it's encrypted or not, and it must be sent alongside the HMAC hash. This way, both parties can verify using the secret key that the message is coming from who it says it's coming from, or that its authenticity is correct. </p>
			<p>Let's discuss another authentication mechanism next.</p>
			<h3>CHAP</h3>
			<p>The <strong class="bold">Change Handshake Authentication Protocol</strong> (<strong class="bold">CHAP</strong>) is an authentication mechanism <a id="_idIndexMarker2528"/>we use via <strong class="bold">Point to Point Protocol</strong> (<strong class="bold">PPP</strong>) and a <a id="_idIndexMarker2529"/>three-way handshake. CHAP provides a way to protect yourself against what we refer to as <strong class="bold">replay attacks</strong>. Now, the <a id="_idIndexMarker2530"/>downside is that CHAP uses that shared key thing where both the client and the server must know the plaintext of the secret key. Now, the funny thing here is Microsoft came out with their own version of CHAP (called <strong class="bold">MS-CHAP</strong>) that doesn't <a id="_idIndexMarker2531"/>require either the sender or the receiver to know the plaintext, and it doesn't transmit it, but it's also been hacked.</p>
			<h3>EAP</h3>
			<p>The <strong class="bold">Extensible Authentication Protocol</strong> (<strong class="bold">EAP</strong>) was originally designed for point-to-point <a id="_idIndexMarker2532"/>communications. It is used as an alternative <a id="_idIndexMarker2533"/>to CHAP, as well as the <strong class="bold">Password Authentication Protocol</strong> (<strong class="bold">PAP</strong>). I didn't talk about PAP because it's so outdated. EAP itself is more secure and supports different authentication mechanisms, such as using either one-time passwords, standard passwords, or smart tokens. </p>
			<p>Let's talk about what <strong class="bold">public key infrastructure</strong> (<strong class="bold">PKI</strong>) is next.</p>
			<h2 id="_idParaDest-492"><a id="_idTextAnchor510"/>PKI made simple</h2>
			<p>The PKI is <a id="_idIndexMarker2534"/>asymmetric, which means we have a two-key <a id="_idIndexMarker2535"/>technology to help make sure that information is encrypted and only decrypted by the appropriate parties. Remember, in symmetric, we only use one key that is shared between both parties. In this one here, we're going to have two keys, and you've heard me talk about public keys and private keys. Next, let's see what PKI consists of. </p>
			<h3>Your certificate</h3>
			<p><em class="italic">"Hey, Dale, you keep talking about this certificate. What is this so-called certificate?"</em> So, a <strong class="bold">certificate</strong> is a way <a id="_idIndexMarker2536"/>of identifying an organization, or even <a id="_idIndexMarker2537"/>a user. Typically, certificates are based on what's referred <a id="_idIndexMarker2538"/>to as an <strong class="bold">X.509 standard</strong>, and they typically contain fields such as when the certificate is valid, when it's expired, what algorithm is used for the encryption of the public key, and who issues the certificate. </p>
			<p>In fact, let me show you something here real fast. So, here I am at the <strong class="bold">Packt</strong> website, and because we have an <strong class="bold">HTTPS</strong> connection, that means it's a secured connection.</p>
			<div>
				<div id="_idContainer132" class="IMG---Figure">
					<img src="Images/B17486_16_04.jpg" alt="Figure 16.4 – An HTTPS site will show a lock indicating a secure connection&#13;&#10;" width="665" height="152"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.4 – An HTTPS site will show a lock indicating a secure connection</p>
			<p>I'm going to just hover over the lock here, and it tells me that I can view the site information or the certificate. So, I can come down and select to look at the certificate. It tells me it's currently valid without me having to drill into it, but let's go ahead and drill into it here. You can see here that it's created for the following purpose, to verify the identity of the remote computer and to provide your identity to the remote computer.</p>
			<div>
				<div id="_idContainer133" class="IMG---Figure">
					<img src="Images/B17486_16_05.jpg" alt="Figure 16.5 – The certificate shows the purpose and valid dates&#13;&#10;" width="399" height="501"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.5 – The certificate shows the purpose and valid dates</p>
			<p>This way, Packt can make sure they know who they're talking to. It shows who it was issued to. It tells us it was issued by <strong class="bold">Cloudflare</strong> on their <strong class="bold">ECC CA-3</strong> server. And, of course, the validity period here is anywhere from <strong class="bold">6/6/2021</strong> through <strong class="bold">6/6/2022</strong>. I can go into the <strong class="bold">Details</strong> tab for the certificate, and I can see all kinds of things here.</p>
			<div>
				<div id="_idContainer134" class="IMG---Figure">
					<img src="Images/B17486_16_06.jpg" alt="Figure 16.6 – The Details tab reveals more information&#13;&#10;" width="399" height="502"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.6 – The Details tab reveals more information</p>
			<p>Again, I can see <a id="_idIndexMarker2539"/>the issuer, which is <strong class="bold">sha256</strong>. I can see, again, the validity date, and the subject, which is basically, again, to who it applies. You can see that when they issued the certificate, you must fill out an application so they can issue it, and then they verify; in this case here, Cloudflare went through and verified that it was, in fact, Packt Publishing. This way, I can't create my own certificate for Packt and put it on the web and make people think that, hey, I'm Packt Publishing. </p>
			<p>The public key, again, is <strong class="bold">ECC (256 bits)</strong>, and that's the key there. I can again scroll down and see information here about the subject alternative names, which, they've got their wildcard in here. </p>
			<div>
				<div id="_idContainer135" class="IMG---Figure">
					<img src="Images/B17486_16_07.jpg" alt="Figure 16.7 – More details of the certificate including the public key&#13;&#10;" width="401" height="503"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.7 – More details of the certificate including the public key</p>
			<p>So, everywhere <a id="_idIndexMarker2540"/>that we go, we are interacting with certificates. Sometimes, you don't even realize it. Now, when it comes to certificates, there are two different types:</p>
			<ul>
				<li>There's a <strong class="bold">signed certificate</strong> where a CA signs it, a public CA, and issues the certificate. And, again, these <a id="_idIndexMarker2541"/>certificates normally contain <a id="_idIndexMarker2542"/>the public key and the identity of the owner of that key. The private key is kept secret by the CA. </li>
				<li>There are also <strong class="bold">self-signed certificates</strong>. This is where the identity of the certificate is <a id="_idIndexMarker2543"/>signed by the same organization or the entity <a id="_idIndexMarker2544"/>that identifies that it's certified. So, for example, if I wanted to create my own certificate within my organization, I'm going to have my own CA server, and I'm going to do a self-signed certificate from that server. We don't normally use self-signed certificates. In fact, you should never use a self-signed certificate in the wild, only within your own infrastructure. </li>
			</ul>
			<p>See? I told you I'd make PKI easy to understand.</p>
			<p>Let's talk about digital signatures now.</p>
			<h3>Digital signatures</h3>
			<p>It's designed to verify that a particular email or document came from a particular source. For example, if <em class="italic">Bruce Wayne</em> was sending an email to <em class="italic">Selina Kyle</em>, they both would have a public key and a private key.</p>
			<p>Selina would <a id="_idIndexMarker2545"/>take her private key and sign her email so that Bruce Wayne can make sure that it was from her. She uses that private <a id="_idIndexMarker2546"/>key to sign the document, which isn't a physical signature, it's just a code that's attached to the email saying that it was from Selina. Again, anybody could try to fake this if they wanted. But, here's what happens. When the email gets sent over to Bruce, he grabs a copy of her public key. Remember that key? It's public and can go to anybody, and he uses that public key to run against the signature to verify that the email came from Selina. Again, what you must remember here is digital signatures do not in any way whatsoever encrypt. It's just to verify a document, an email, or even a file.</p>
			<p>Up next, we'll talk about additional ways to secure our communications over a network.</p>
			<h2 id="_idParaDest-493"><a id="_idTextAnchor511"/>SSL and TLS</h2>
			<p>SSL and TLS are <a id="_idIndexMarker2547"/>both cryptographic protocols that can be used to secure communications over an insecure network such as the internet. SSL is the <a id="_idIndexMarker2548"/>predecessor to TLS and is more commonly used today.</p>
			<p>SSL and TLS use a combination of a symmetric key cipher and an asymmetric key cipher to encrypt communications. The symmetric key cipher is used to encrypt the data, and the asymmetric key cipher is used to exchange the keys. SSL and TLS also use digital certificates to authenticate entities and prevent MITM attacks. </p>
			<p>When we look <a id="_idIndexMarker2549"/>at TLS, it goes through a handshake process:</p>
			<ol>
				<li value="1">We're going to have our server that is encrypted or has the encrypted information, and then we have our client system. We know that we have public keys and private keys associated with that server or the data source itself. </li>
				<li>What happens is the client sends another client a <em class="italic">Hello</em> message, along with a random value, and it tells the server the supported ciphers it can use.</li>
				<li>The server responds by sending, <em class="italic">"Hey, how you doing? I'm a server."</em> It's called a server <em class="italic">Hello</em> message, along with the server's random value. The server also sends, <em class="italic">"Hey, I'm done saying hello to you."</em> Now, if the server has requested a certificate from the client, the client would then send one back. </li>
				<li>The client then creates a random pre-master secret and encrypts it with the public key from the server's certificate, then sends that pre-master secret to the server, and here's what's interesting; once it's received, the server and the client will each generate a brand-new master secret and session key, which is based on the pre-master secret.</li>
				<li>Once they've both done that, the client then sends a message that says, <em class="italic">"Hey, I'm going to change the cipher spec."</em> And that cipher spec is going to be based on the new session keys that we just generated, and we're going to use those for <a id="_idIndexMarker2550"/>hashing, as well as encrypting. The client also sends a <em class="italic">"Yo, I'm done"</em> message or a <strong class="bold">client finished message</strong>. The server receives the updated cipher spec and switches over to a security state that will use a symmetric encryption using the session keys. The server also sends a <em class="italic">"Yo, I'm finished"</em> or a <strong class="bold">server finished message</strong>. </li>
				<li>Now, both the <a id="_idIndexMarker2551"/>client and the server have the new master secret, as well as the session keys; they'll both start using those session keys to exchange data back and forth over a secure channel. </li>
			</ol>
			<p>All the messages sent from the client to the server and from the server to the client are then encrypted. That's a lot, huh? </p>
			<p>When it comes <a id="_idIndexMarker2552"/>to using SSL and TLS, there are several different toolkits out there. The one I want to warn you about, it's probably one of the more popular but this is just more historical information, is one that's referred to as <strong class="bold">OpenSSL</strong>. Now, OpenSSL is <a id="_idIndexMarker2553"/>like the Swiss army knife of cryptography, and because it's an open source resource, this makes it very attractive, right?</p>
			<p>Now, there's one thing I need to warn you about and that is OpenSSL had a very big issue. It was <a id="_idIndexMarker2554"/>something called <strong class="bold">Heartbleed</strong>, which was an extremely bad vulnerability. The Heartbleed vulnerability allowed anyone on the internet to read the memory of systems protected by the vulnerable versions of OpenSSL. Now, don't worry, it's been patched. Hint… you will want to know that in preparing to take the exam.</p>
			<h3>PGP</h3>
			<p>PGP is the <a id="_idIndexMarker2555"/>understatement of the year. PGP gets its start all the way back in 1991. Now, the reason PGP is pretty good is we can use it for encrypting messages and files, as well as the digital signatures or signing documents, and, of course, deleting documents and even compression. In fact, PGP encryption uses a serial combination of hashing, then data compression, symmetric-key cryptography, and, finally, public-key cryptography. Each step uses several supported algorithms, and each of the public keys is bound to a username or an email address. </p>
			<p>Let's look at how PGP happens and operates.</p>
			<div>
				<div id="_idContainer136" class="IMG---Figure">
					<img src="Images/B17486_16_08.jpg" alt="Figure 16.8 – PGP flow&#13;&#10;" width="1052" height="441"/>
				</div>
			</div>
			<p class="figure-caption">Figure 16.8 – PGP flow</p>
			<ol>
				<li value="1">When a user encrypts data with PGP, PGP compresses that data down. This compression helps to avoid some exploits that could be used to try to crack the cipher because the patterns in the plaintext have been compressed. </li>
				<li>PGP then creates a random key that is a one-time-use-only, secret key, and it uses that key to encrypt the plaintext, which results in our ciphertext. </li>
				<li>Once it's done encrypting, the random key is encrypted using the recipient's public key. That encrypted data is sent to the recipient. Obviously, the encryption operates in a reverse manner. </li>
			</ol>
			<p>You may be thinking, <em class="italic">"But Dale, PGP is still good today. Isn't it?"</em> Yeah, it really is. In fact, the only way I'm aware they have been able to crack or attack PGP is by installing a piece of malware <a id="_idIndexMarker2556"/>that would capture keystrokes so they could capture the passwords as they type them in. Now, at the time of writing this book, <strong class="bold">Symantec</strong> owns PGP, and <a id="_idIndexMarker2557"/>they've renamed it. They call it the <strong class="bold">Symantec Encryption Desktop</strong>, and <a id="_idIndexMarker2558"/>the server <a id="_idIndexMarker2559"/>component is just referred to as the <strong class="bold">Symantec Encryption Management Server</strong>. But basically, it's still PGP.</p>
			<p>So, now that we've got that down, let's finish up talking about countermeasures.</p>
			<h1 id="_idParaDest-494"><a id="_idTextAnchor512"/>Countermeasures for cryptography</h1>
			<p>You know me, I don't want to leave you all panicking that all is lost! There are some countermeasures <a id="_idIndexMarker2560"/>that we can take to mitigate the attacks that might come our way. Let's talk about some of these countermeasures.</p>
			<p>EC-Council lists 12 countermeasures to use: </p>
			<ol>
				<li value="1">The first one is when it comes to accessing the cryptography keys, that access should only be given to users directly, as well as applications. </li>
				<li>You should <a id="_idIndexMarker2561"/>also make sure you have an <strong class="bold">intrusion detection system</strong> (<strong class="bold">IDS</strong>) that's been deployed, and you are monitoring the exchange and access of those keys, so you've got a log somewhere of what happened and when. This is just in case you must go back and take a look at those logs because something got compromised. </li>
				<li>The other thing you're going to want to do is that if you plan on storing the encryption key on a system or on a drive, you need to use passphrases and passwords.</li>
				<li>This next one's for you more advanced developers out there: under no circumstances should the keys be inside of the source code or inside of any binaries. </li>
				<li>Now, when it comes to certificates for signing the transfer of private keys, it's a major no-no. We never, ever transfer private keys. We just say no, got it? I'll be a little happier now that you're agreeing with me. </li>
				<li>When it comes to symmetric algorithms, you should make sure you use the maximum number of bits that you possibly can. You should be using at least 168 bits or 256 bits. </li>
				<li>If you're going <a id="_idIndexMarker2562"/>to implement encryption for symmetric key protocols, you've got to make sure that message authentication is performed. </li>
				<li>As far as asymmetric algorithms are concerned, you need to use the largest sizes available, either 1536 or 2048. Just say 2048, please. </li>
				<li>When it comes to your hash algorithms gain, use the highest bits possible, 168 or 256 bits, please! </li>
				<li>When creating or implementing a cryptographic environment, please don't do anything homemade. I know some of you developers might be like, <em class="italic">"Well, I can do this a little bit better."</em> Trust me, don't! Use what would be considered an industry standard. Some people will try to create self-engineered crypto algorithms as well as functions, and inevitably they're going to leave some holes open for you. </li>
				<li>I would also put a limit on the number of operations per second per key. This way, you don't have somebody trying to quickly brute force to try to discover what the key is. </li>
				<li>And finally, the output of a hash or any hash function should have the largest bit length possible, so it makes it hard to decrypt. </li>
			</ol>
			<p>Okay, see? That's how easy those 12 things are. And, this brings us to the end. So, as you can see, standards and protocols are essential for us when dealing with and protecting our data and <a id="_idIndexMarker2563"/>communications. Understanding the tools and processes is necessary for you to be an effective IT security professional.</p>
			<h1 id="_idParaDest-495"><a id="_idTextAnchor513"/>Summary</h1>
			<p>One of the major ways to protect your resources from attackers is to use encryption for data in motion or in waiting. Your job as a security professional isn't to stop attackers, that's impossible. Anything is hackable. Your job is to slow them down or discourage them, and cryptography definitely does this. </p>
			<p>This brings us to the end of this book and the beginning of your journey in cybersecurity. As you study for the <strong class="bold">CEH</strong> exam, remember that it's not an easy task to accomplish. The test is designed to make sure you know your craft. </p>
			<p>Keep in mind that if you haven't fully grasped all the concepts we've talked about in this book, review it again. Do your own research. Reach out to me via my social media channels. My passion and mission are to help everyone and every company stay safer while using technology. Please be sure to <em class="italic">tweet</em> me or post on LinkedIn when you pass your exam or that you've learned something from me. The comments I get from my students, viewers, and readers really do bring a smile to my face. And, do me a favor…Be safe!</p>
			<h1 id="_idParaDest-496"><a id="_idTextAnchor514"/>Questions</h1>
			<p>As we conclude, here is a list of questions for you to test your knowledge regarding this chapter's material. You will find the answers in the <em class="italic">Assessments</em> section of the <em class="italic">Appendix</em>:</p>
			<ol>
				<li value="1">Which of the following terms does asymmetric encryption also go by?<ol><li>A shared key</li><li>Hashing</li><li>A public key</li><li>Block</li></ol></li>
				<li>Which of the following is a mechanism for SSL?<ol><li>Authenticating data</li><li>Securing stored data</li><li>Verifying data</li><li>Securing transmitted data</li></ol></li>
				<li>A common hashing protocol is which of the following?<ol><li>RSA</li><li>MD5</li><li>DES</li><li>AES</li></ol></li>
				<li>_________ is another name for symmetric cryptography.<ol><li>Shared key cryptography</li><li>Steganography</li><li>Public key cryptography</li><li>Hashing</li></ol></li>
			</ol>
		</div>
	</div></body></html>