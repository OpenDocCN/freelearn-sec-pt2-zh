<html><head></head><body>
		<div id="_idContainer009">
			<h1 id="_idParaDest-31" class="chapter-number"><a id="_idTextAnchor030"/>2</h1>
			<h1 id="_idParaDest-32"><a id="_idTextAnchor031"/>How Are Cloud Networks Cyber Attacked?</h1>
			<p>When you begin your journey to becoming a cloud pentester, it helps to start with <span class="No-Break">the basics.</span></p>
			<p>Your job is to test cloud networks to see how they can be cyber attacked. The organization you work for can then use your discoveries to improve the cybersecurity of its <span class="No-Break">cloud networks.</span></p>
			<p>Because Amazon (AWS), Microsoft (Azure), and Google (GCP) own the infrastructure on which you’ll be testing, you won’t be allowed to do literally anything a cyber attacker may try to do in real life. But you need to understand all the kinds of cyberattacks that cloud networks deal with, even if you can’t simulate all <span class="No-Break">of them.</span></p>
			<p>The best pentesters can think like real cyber attackers. This chapter will give you a better understanding of how cloud networks are cyber attacked in order to help you conduct more <span class="No-Break">effective pentests.</span></p>
			<p>In this chapter, we’ll cover the following <span class="No-Break">main topics:</span></p>
			<ul>
				<li>Understanding <span class="No-Break">penetration testing</span></li>
				<li>External and <span class="No-Break">internal attacks</span></li>
				<li>Attacks on the confidentiality, integrity, and availability <span class="No-Break">of data</span></li>
				<li>Understanding lateral movement in <span class="No-Break">the cloud</span></li>
				<li><span class="No-Break">Zero-trust networks</span></li>
			</ul>
			<p>Let’s <span class="No-Break">get started!</span></p>
			<h1 id="_idParaDest-33"><a id="_idTextAnchor032"/>Understanding penetration testing</h1>
			<p><strong class="bold">Penetration tests</strong> (or <strong class="bold">pentests</strong> for short) are simulated cyberattacks<a id="_idIndexMarker067"/> that are designed<a id="_idIndexMarker068"/> to find vulnerabilities in computer networks and applications. The biggest difference between a pentest and an actual cyberattack is that the former is conducted with the full consent of the owner of the computer or network, whereas the <span class="No-Break">latter isn’t.</span></p>
			<p>As a pentester or red team<a id="_idIndexMarker069"/> member, not only will you need consent from the owner of the target you’re testing, but you’ll also have to sign a legal agreement that explains in detail what you’re allowed to do, what you’re forbidden from doing, and the scope of your pentest. This applies whether you’re an employee of the organization being pentested, a third-party contractor of the organization being pentested, someone who conducts simple one-off pentests, or a red team member who pentests as part of your red <span class="No-Break">team engagements.</span></p>
			<p>Whether or not an organization has a red team, it will commence pentesting after a history of vulnerability assessments. A vulnerability assessment is the first way to find security vulnerabilities. It analyzes the state of an application or network based on checklists of criteria. The criteria are most often based<a id="_idIndexMarker070"/> on a set security standard, such as the <strong class="bold">OWASP Application Security Verification Standard</strong> (<a href="https://owasp.org/www-project-application-security-verification-standard/">https://owasp.org/www-project-application-security-verification-standard/</a>) or the <strong class="bold">PCI PTS POI Modular Security Requirements</strong> (<a href="https://www.pcisecuritystandards.org/wp-content/uploads/2023/01/PTS_POI_v6.2_Bulletin.pdf">https://www.pcisecuritystandards.org/wp-content/uploads/2023/01/PTS_POI_v6.2_Bulletin.pdf</a>). There are hundreds of different security <a id="_idIndexMarker071"/>standards that could apply to the organization you work for. Vulnerability assessments are appropriate for all businesses and enterprises, at all possible security maturity levels. Security maturity is a complex concept, but in a nutshell, it’s about how well developed an organization’s security policies and <span class="No-Break">controls are.</span></p>
			<p>Once an organization has done some vulnerability assessments, security-hardened its networks based on those findings, and assembled a team of cybersecurity professionals, then it may be ready for pentesting. Pentesting is supposed to discover security vulnerabilities that can only be discovered by simulating cyberattacks. Legally and procedure-wise, pentesting is a lot different from cyber attacking, but the computers and networks you pentest don’t know the difference. Your pentests will break things, even if the effects<a id="_idIndexMarker072"/> are as temporary as taking a few computers offline for an hour in a <strong class="bold">denial-of-service</strong> (<strong class="bold">DoS</strong>) attack. That’s why only organizations with some security maturity should be pentesting, and it’s also why a specific scope is always agreed upon before starting a pentest. For instance, your organization may move its production from one network segment to another so you can pentest within a segment without interfering with its <span class="No-Break">everyday operations.</span></p>
			<p>A red team<a id="_idIndexMarker073"/> is a dedicated group of people within your organization who conduct frequent pentests according to patterns in the cyber threat landscape. As an example, if a new enterprise ransomware threat emerges, your red team may be tasked with simulating that particular new ransomware within your network and seeing <span class="No-Break">what happens.</span></p>
			<p>In order to pentest effectively, you absolutely<a id="_idIndexMarker074"/> must understand how cloud networks are cyber attacked. In this book, you will learn about a lot of tools that are often used to pentest in AWS, Azure, and GCP environments. Using these tools in the right way and in the right situations will help you pentest effectively, finding vulnerabilities that your organization must address. But the greatest tools in the world are only good if you know how to use them and why. You’ll also sometimes conduct some activities without those tools. In all scenarios, you must understand how cloud networks are cyber attacked in order to be an effective cloud pentester. That’s what this chapter is <span class="No-Break">all about!</span></p>
			<h1 id="_idParaDest-34"><a id="_idTextAnchor033"/>External and internal attacks</h1>
			<p>When your organization’s defensive security team<a id="_idIndexMarker075"/> prepares for cyberattacks, it needs<a id="_idIndexMarker076"/> to understand each and every step that threat actors take when they try to maliciously interfere with your data. No cyber intrusion is a one-step process. Ransomware may have needed an employee to accidentally execute an email attachment before it spread between poorly configured cloud instances. A data breach may have required bribing an employee and giving them a USB stick with <span class="No-Break">custom-designed spyware.</span></p>
			<p>The MITRE ATT&amp;CK database (<a href="https://attack.mitre.org/">https://attack.mitre.org/</a>) is an excellent resource to help all kinds of cybersecurity<a id="_idIndexMarker077"/> professionals understand the various steps cyber threat actors take when they engage in their crimes. I will be citing it frequently in this chapter. Especially if you’re pentesting as part of a red team, these may be the kinds of cyberattacks you’ll be simulating in <span class="No-Break">your engagements.</span></p>
			<p>Some cyberattack chains can be simple, and others are relatively complex. But they all have an origin that’s either external or internal to your organization. You will need to understand the differences between external and internal cyberattacks as a cloud pentester. You’ll likely be pentesting both kinds of scenarios over the course of your career. Business and enterprise cloud networks are a prime target for many of the most devastating <span class="No-Break">cyber exploits.</span></p>
			<p>There was a time, perhaps in the 1990s and early 2000s, when consumers were very frequently targeted by cybercriminals. Ordinary people should still be careful about the security of their phones, tablets, and PCs. They sometimes get targeted by phishing scams, digital surveillance, and malware. An ordinary person may be exploited to pay a cyber attacker a few hundred dollars’ worth of cryptocurrency in a ransomware attack. Even small businesses may have revenue in the millions of dollars, and they could be coerced into paying a cyber attacker a million-dollar cryptocurrency ransom. Also, other sorts of financially motivated cybercrime, such as data breaches, are much more profitable when businesses are targeted than when a senior citizen <span class="No-Break">is targeted.</span></p>
			<p>The companies you’ll be working for as a pentester, both as an employee and as a third-party contractor, are lucrative targets for cybercrime. And that’s why they’re hiring you to simulate these cybercrimes, so they can learn how they can improve <span class="No-Break">their defenses.</span></p>
			<p>The classic kinds of cyberattacks you’ll hear about most often in the news and in your favorite fictional entertainment media will usually be external in origin. For example, a hoodie-wearing cybercriminal working from their PC in their dark basement cracks an encrypted terminal on the network, then downloads all of the terminal’s sensitive files! A skull-and-crossbones graphic blinks on the screen... “You’ve been hacked!” The victim organization never sees the attacker. It hires a top-notch cyber investigations team to follow the attacker around the world. Eventually, the cops identify the cybercriminal at a café on another continent. The criminal is handcuffed. Everyone applauds and the <span class="No-Break">credits roll.</span></p>
			<p>Real-world cybercrime<a id="_idIndexMarker078"/> can be just as devastating, but it can look much more benign<a id="_idIndexMarker079"/> in person. Investigating it isn’t quite as quick or exciting, because you’ll be helping the company you work for prepare for real cyberattacks and it won't follow a typical movie script. Now, let’s understand the nature of these attacks and look at some <span class="No-Break">real-life examples.</span></p>
			<h2 id="_idParaDest-35"><a id="_idTextAnchor034"/>External cyberattacks</h2>
			<p>External cyberattacks<a id="_idIndexMarker080"/> originate from outside of the targeted organization. The attacker usually has to go through the internet to start the process of cyber attacking your organization’s <span class="No-Break">cloud servers.</span></p>
			<p>An external cyber attacker has to break into the organization’s network they’re attacking. Then, they’ll likely have to <span class="No-Break">privilege escalate.</span></p>
			<p class="callout-heading">Privilege escalation</p>
			<p class="callout">This is when an attacker begins with access to a user account with limited access control privileges and works their way up to using accounts with more access control privileges. Sometimes, they’ll escalate all the way up to accessing an account with full administrative privileges in the network they’re attacking... which is <span class="No-Break">especially dangerous!</span></p>
			<p>Now, let’s examine<a id="_idIndexMarker081"/> some possible vectors for external cyberattacks on <span class="No-Break">cloud networks.</span></p>
			<h3>Drive-by compromise</h3>
			<p>First, there’s “<em class="italic">drive-by compromise</em>.” According to MITRE ATT&amp;CK (<a href="https://attack.mitre.org/techniques/T1189/">https://attack.mitre.org/techniques/T1189/</a>), drive-by compromise happens when a user visits a website<a id="_idIndexMarker082"/> through their usual web browsing<a id="_idIndexMarker083"/> activities. An attacker with control<a id="_idIndexMarker084"/> of the website uses it to attack the user through their web browser. Sometimes, attackers also use this technique for malicious actions that aren’t exploits, such as acquiring application <span class="No-Break">access tokens.</span></p>
			<p>A lot of access to cloud networks is through the web, so this is a really pertinent <span class="No-Break">attack vector.</span></p>
			<h3>Exploit public-facing application</h3>
			<p>Another external attack<a id="_idIndexMarker085"/> vector that’s really relevant to cloud networks is “exploit public-facing application.” MITRE ATT&amp;CK (<a href="https://attack.mitre.org/techniques/T1190/">https://attack.mitre.org/techniques/T1190/</a>) describes it as when adversaries<a id="_idIndexMarker086"/> take advantage of internet-connected<a id="_idIndexMarker087"/> computers or applications through their vulnerabilities. Frequent means of exploitation include SQL databases, standard internet services such as SSH or SMB, network management protocols, and applications with internet-accessible open sockets such as web browsers. But other internet-connected technologies can also be used in <span class="No-Break">these exploits.</span></p>
			<p>If these exploits involve cloud infrastructure or containerized applications (such as with Kubernetes or Docker), attackers can do really catastrophic damage. They could intercept other instances or containers, and quite often acquire access to their <span class="No-Break">APIs too.</span></p>
			<h3>External remote services</h3>
			<p>The next entry point vector<a id="_idIndexMarker088"/> from MITRE ATT&amp;CK that I’m going<a id="_idIndexMarker089"/> to cover is “external remote services.” It’s another common way in which<a id="_idIndexMarker090"/> external cyberattacks begin. MITRE ATT&amp;CK (<a href="https://attack.mitre.org/techniques/T1133/">https://attack.mitre.org/techniques/T1133/</a>) describes it as when attackers target external services to acquire malicious access or maintain persistence in a network. Commonly targeted remote services include VPNs, Citrix, or similar technologies that facilitate remote access. Attackers often need access to valid accounts for their targeted service in order for this exploit to work. Access to valid accounts can be acquired by stealing credentials through already compromised networks or means such as credential pharming. Of course, in external cyberattacks, access to a valid account may be acquired by phishing an employee. Phishing attacks take many forms, but they most often use fake websites, fake emails, fake text messages, or fake social media posts to imitate a <span class="No-Break">trusted entity.</span></p>
			<h3>Valid accounts</h3>
			<p>This next MITRE ATT&amp;CK vector category<a id="_idIndexMarker091"/> is a common entry<a id="_idIndexMarker092"/> point for most internal cyberattacks, known as “valid accounts.” According to MITRE ATT&amp;CK (<a href="https://attack.mitre.org/techniques/T1078/">https://attack.mitre.org/techniques/T1078/</a>), attackers<a id="_idIndexMarker093"/> can acquire malicious access to computer systems by compromising legitimate user accounts that have privileges within them. They may also compromise privileged accounts to establish persistence, for privilege escalation, or for defense evasion. Sometimes, inactive user accounts are also exploited. Network administrators should watch the behavior of the accounts in their system and deactivate user accounts of former employees and contractors as soon <span class="No-Break">as possible.</span></p>
			<h4>Cloud accounts</h4>
			<p>I’m going to include<a id="_idIndexMarker094"/> one subcategory of attack vector<a id="_idIndexMarker095"/> here because it’s specifically<a id="_idIndexMarker096"/> relevant to cloud pentesting; it is known as “valid accounts: cloud accounts” (<a href="https://attack.mitre.org/techniques/T1078/004/">https://attack.mitre.org/techniques/T1078/004/</a>). Go ahead and read about it on MITRE ATT&amp;CK’s website. Cloud networks have lots of working parts. They can have multiple SaaS applications, containers, servers within servers, virtual machines, and so on. They can get really complicated. So, there can be a lot more user accounts and machine identities that attackers <span class="No-Break">can exploit.</span></p>
			<p>Organizations not only have to watch internal cyber attackers with active accounts but also inactive accounts, which are a common attack vector. When you work as a cloud pentester, you may need<a id="_idIndexMarker097"/> to compromise an inactive account<a id="_idIndexMarker098"/> that an organization forgot <span class="No-Break">to remove.</span></p>
			<h2 id="_idParaDest-36"><a id="_idTextAnchor035"/>Internal cyberattacks</h2>
			<p>Internal cyberattacks<a id="_idIndexMarker099"/> originate from inside the targeted organization. Either a company employee, contractor, executive, or supply chain entity is the cyber attacker, or an external cyber attacker bribes or otherwise motivates an employee, contractor, executive, or supply chain entity to help them with <span class="No-Break">their cyberattack.</span></p>
			<p>An internal cyber attacker already has their foot in the door of your network. If they work for the organization, they have a user account in your network and applications that at least has some privileges, even if they’re minimal. They very likely have physical access to the company’s computers and on-premises network. That can make it a lot easier to attack the cloud network. A supply chain entity also already has privileged access to an organization that an outsider won’t have. Your organization’s supply chain consists of the other businesses that provide products and services to your organization – for instance, companies that make metal and sell it to car manufacturers. The metal manufacturer is part of the car manufacturer’s supply chain. The web development firm that makes custom web applications for a school is a part of the school’s <span class="No-Break">supply chain.</span></p>
			<p>The following are MITRE ATT&amp;CK’s “initial access” vectors that can pertain to an <span class="No-Break">internal cyberattack.</span></p>
			<h3>Hardware additions</h3>
			<p>The first is “hardware additions.” MITRE ATT&amp;CK (<a href="https://attack.mitre.org/techniques/T1200/">https://attack.mitre.org/techniques/T1200/</a>) defines this as when<a id="_idIndexMarker100"/> adversaries use computer hardware<a id="_idIndexMarker101"/> such as networking<a id="_idIndexMarker102"/> devices as a vector to acquire malicious access. This technique often uses “more robust hardware additions” than removable media (such as USB drives) to deploy new attack functionalities and features rather than simply distributing <span class="No-Break">malicious payloads.</span></p>
			<p>Your organization’s cloud<a id="_idIndexMarker103"/> network could be attacked by a hardware device that a cybercriminal<a id="_idIndexMarker104"/> physically connects to your <span class="No-Break">on-premises network.</span></p>
			<h3>Supply chain compromise</h3>
			<p>Another technique<a id="_idIndexMarker105"/> that can be used in an internal cyberattack is “supply chain compromise.” MITRE ATT&amp;CK (<a href="https://attack.mitre.org/techniques/T1195/">https://attack.mitre.org/techniques/T1195/</a>) describes this as when attackers manipulate or intercept<a id="_idIndexMarker106"/> products or product delivery mechanisms <a id="_idIndexMarker107"/>to compromise the users and networks that are connected for data or system compromise. A company’s supply chain can include other businesses they work with, companies that provide applications and network services, and so on. In these exploits, sometimes source code repositories, development tools, open source dependencies, or software updating mechanisms <span class="No-Break">are manipulated.</span></p>
			<p>For the purposes of this book, supply chain compromises are especially relevant because AWS, Azure, and GCP services and applications can be considered to be a part of a company’s <span class="No-Break">supply chain.</span></p>
			<p>Supply chain entities often have connections to an organization’s internal network, both on-premises and in the cloud. As a cloud pentester, you may sometimes be simulating supply chain attacks. At other times, you may have to cooperate with one of your organization’s supply chain entities <span class="No-Break">while pentesting.</span></p>
			<h3>Trusted relationship</h3>
			<p>This next vector applies<a id="_idIndexMarker108"/> to a lot of internal <a id="_idIndexMarker109"/>cyberattacks, and is known as “trusted relationship” (<a href="https://attack.mitre.org/techniques/T1199/">https://attack.mitre.org/techniques/T1199/</a>). MITRE ATT&amp;CK defines this as when attackers take advantage<a id="_idIndexMarker110"/> of individuals or organizations that the target trusts in order to conduct cyberattacks. They can include people and entities such as managed service providers, IT contractors, or building <span class="No-Break">maintenance workers.</span></p>
			<p>Here’s a hypothetical scenario. The janitor asks for keys to the server room because they need to clean something in there. It’s not someone else pretending to be the janitor, but the real janitor who has worked there for months. Once the janitor gets access to the server room, they plug a USB stick with executable malware into one of the main server machines on-premises in order to infect all the client computers that are managed <span class="No-Break">through it.</span></p>
			<p>Cyber attackers will find a wide variety of ways to exploit cloud networks and applications. To acquire access, they may find vulnerabilities in internet-facing parts of applications, such as web applications and open ports. They may hijack accounts with access privileges. They may even go so far as to bribe someone who works for the company to physically place a malicious device into their targeted network. As a pentester, you’ll mainly be simulating exploits within applications and networks remotely. But it’s good to keep in mind the many other techniques that cyber attackers use when you conduct<a id="_idIndexMarker111"/> your red team engagements, even if they’re difficult<a id="_idIndexMarker112"/> <span class="No-Break">to simulate.</span></p>
			<h1 id="_idParaDest-37"><a id="_idTextAnchor036"/>Attacks on the confidentiality, integrity, and availability of cloud data</h1>
			<p>So, we’ve looked at the difference<a id="_idIndexMarker113"/> between internal cyberattacks and external cyberattacks, and some of the different entry point attack vectors they can use. There’s another way for you to categorize the cyberattacks you’ll be simulating as <span class="No-Break">a pentester.</span></p>
			<p>We must look at the <strong class="bold">CIA</strong> (<strong class="bold">confidentiality, integrity, and availability</strong>) <strong class="bold">Triad</strong> of cybersecurity. It’s one <a id="_idIndexMarker114"/>of the most important concepts in our area <span class="No-Break">of study.</span></p>
			<p>All cyberattacks impact one, two, or all three components of the <span class="No-Break">CIA Triad:</span></p>
			<ul>
				<li><strong class="bold">Confidentiality</strong> is all about making sure that your organization’s data is only readable to the entities that are allowed to access it. A data breach is an example of a type of cyberattack that <span class="No-Break">impacts confidentiality.</span></li>
				<li><strong class="bold">Integrity</strong> is all about making sure that only authorized entities can alter or modify your organization’s data. If a cyber attacker replaces a legitimate component of your organization’s cloud application with malware, that’s an example of a cyberattack that <span class="No-Break">impacts integrity.</span></li>
				<li><strong class="bold">Availability</strong> is all about making sure that your organization’s data, servers, and applications are available whenever authorized entities need it. If a cyber attacker performs a <strong class="bold">distributed denial-of-service</strong> (<strong class="bold">DDoS</strong>) attack on your organization’s cloud web servers<a id="_idIndexMarker115"/> and customers cannot use your web application, that’s an example of a cyberattack that <span class="No-Break">impacts availability.</span></li>
			</ul>
			<p>Some cyberattacks impact more than one component of the CIA Triad. For example, enterprise ransomware these days often not only maliciously encrypts your organization’s data with a decryption key you cannot access without paying a ransom, but also often breaches your organization’s data. So, that’s availability and confidentiality harmed in one malware attack. If the ransomware infection establishes persistence by altering some<a id="_idIndexMarker116"/> of the data on your cloud servers, that’s integrity <span class="No-Break">harmed too!</span></p>
			<h2 id="_idParaDest-38"><a id="_idTextAnchor037"/>Confidentiality</h2>
			<p>Let’s look at a cyberattack from the news that impacted<a id="_idIndexMarker117"/> the confidentiality of data in <span class="No-Break">cloud networks.</span></p>
			<p>DC Health Link tweeted in March 2023 that sensitive data from its system was data breached. DC Health Link helps to provide health insurance to many people who work for the American government. It definitely has at least a large component of its network hosted by a cloud provider. The tweet (<a href="https://twitter.com/DCHealthLink/status/1634342617235312640">https://twitter.com/DCHealthLink/status/1634342617235312640</a>) said <span class="No-Break">the following:</span></p>
			<p class="author-quote">“The DC Health Benefit Exchange Authority takes the data breach of enrollee information very seriously. On Monday, March 6, 2023, upon becoming aware of the incident, we immediately launched an investigation, began working with law enforcement, and engaged a third-party forensics firm-Mandiant. While our investigation is ongoing, we’d like to provide an update on the current situation. There are 56,415 customers impacted. The data fields include the following, although not all data fields were necessarily included for each enrollee: name, Social Security number, date of birth, gender, health plan information (e.g. plan name, carrier name, premium amounts, employer contribution, and coverage dates), employer information, enrollee information (e.g. address, email, phone number, race, ethnicity, and citizenship status).”</p>
			<p>Just because the breach was reported in March 2023, that doesn’t mean that it occurred in March 2023! Data breaches often go months without being reported. Either the organization knew about the breach much earlier and only publicized the information months later, or it took months for the organization to discover it in the <span class="No-Break">first place.</span></p>
			<p>What we do know is that 56,415 customers were impacted, and it can be safely assumed that much of the network is on the cloud. We don’t know how the data breach occurred, but we can make educated<a id="_idIndexMarker118"/> guesses. “Data from cloud storage” is a recognized attack vector in the MITRE ATT&amp;CK database (<a href="https://attack.mitre.org/techniques/T1530/">https://attack.mitre.org/techniques/T1530/</a>). It says <span class="No-Break">the following:</span></p>
			<p class="author-quote">“Many cloud service providers offer solutions for online data object storage such as Amazon S3, Azure Storage, and Google Cloud Storage. These solutions differ from other storage solutions (such as SQL or Elasticsearch) in that there is no overarching application. Data from these solutions can be retrieved directly using the cloud provider’s APIs. In other cases, SaaS application providers such as Slack, Confluence, and Salesforce also provide cloud storage solutions as a peripheral use case of their platform. These cloud objects can be extracted directly from their associated application. Adversaries may collect sensitive data from these cloud storage solutions. Providers typically offer security guides to help end users configure systems, though misconfigurations are a common problem. There have been numerous incidents where cloud storage has been improperly secured, typically by unintentionally allowing public access to unauthenticated users, overly-broad access by all users, or even access for any anonymous person outside the control of the Identity Access Management system without even needing basic user permissions.”</p>
			<p>Later in this book, I will show<a id="_idIndexMarker119"/> you how to use tools and techniques to conduct pentests that involve unauthorized access to <span class="No-Break">cloud storage.</span></p>
			<h2 id="_idParaDest-39"><a id="_idTextAnchor038"/>Integrity</h2>
			<p>Let’s look at cyberattacks<a id="_idIndexMarker120"/> on the integrity of cloud data. The following is a story that <em class="italic">Ravie Lakshmanan</em> of <em class="italic">The Hacker News</em> (<a href="https://thehackernews.com/2023/03/large-scale-cyber-attack-hijacks-east.html">https://thehackernews.com/2023/03/large-scale-cyber-attack-hijacks-east.html</a>) reported regarding the targeting of adult <span class="No-Break">entertainment websites:</span></p>
			<p class="author-quote">“A widespread malicious cyber operation has hijacked thousands of websites aimed at East Asian audiences to redirect visitors to adult-themed content since early September 2022. The ongoing campaign entails injecting malicious JavaScript code to the hacked websites, often connecting to the target web server using legitimate FTP credentials the threat actor previously obtained via an unknown method. ‘In many cases, these were highly secure auto-generated FTP credentials which the attacker was somehow able to acquire and leverage for website hijacking,’ Wiz said in a report published this month. The fact that the breached websites – owned by both small firms and multinational corporations – utilize different tech stacks and hosting service providers has made it difficult to trace a common attack vector, the cloud security company noted.”</p>
			<p>As a cloud pentester, you may have to conduct a pentest that involves injecting malicious code into a web application that’s run from a multi-cloud environment. This is the sort of attack that very clever attackers may succeed at, and takes very skilled cloud pentesters <span class="No-Break">to simulate.</span></p>
			<p>Integrity attacks <a id="_idIndexMarker121"/>can involve malicious code injection, man-in-the-middle attacks, or maliciously acquiring<a id="_idIndexMarker122"/> user and machine identities, such as <strong class="bold">Transport Layer Security</strong> (<span class="No-Break"><strong class="bold">TLS</strong></span><span class="No-Break">) certificates.</span></p>
			<p class="callout-heading">TLS</p>
			<p class="callout">TLS certificates are used to grant users and machines access to services that are encrypted with TLS, such as encrypted web applications deployed through the <span class="No-Break">HTTPS protocol.</span></p>
			<h2 id="_idParaDest-40"><a id="_idTextAnchor039"/>Availability</h2>
			<p>Finally, there are attacks<a id="_idIndexMarker123"/> on the availability of <span class="No-Break">cloud data.</span></p>
			<p>In August 2022, the official Google Cloud blog reported one of the biggest DDoS attacks they’ve ever detected on one of their <span class="No-Break">GCP services.</span></p>
			<p>The corporate customer was using <strong class="bold">Google Cloud Armor</strong>. Google Cloud Armor is a cybersecurity service<a id="_idIndexMarker124"/> that GCP customers (such as enterprises) can use to protect GCP-hosted applications and networks from a few common sorts of security exploits. Some of the common attacks<a id="_idIndexMarker125"/> Google Cloud Armor is designed to detect and prevent include DDoS attacks, <strong class="bold">cross-site scripting</strong> (<strong class="bold">XSS</strong>) attacks, and SQL <span class="No-Break">injection attacks.</span></p>
			<p>We’ll get into XSS and SQL injection later in this book, but we’ll cover DDoS <span class="No-Break">attacks here.</span></p>
			<p class="callout-heading">What’s a DDoS attack?</p>
			<p class="callout">A DDoS attack<a id="_idIndexMarker126"/> is when a cyber attacker uses a distributed collection of computers to overwhelm a network target with more data than it can handle. Overwhelming a target with data can cause it to shut down or go offline temporarily. Web servers and cloud instances are some of the most common targets of <span class="No-Break">DDoS attacks.</span></p>
			<p>Most DDoS attacks are conducted with a botnet. A botnet is a network of computers that a cyber attacker controls through a command-and-control server in order to execute cyberattacks. Computers get infected with zombie malware that makes them controllable by the attacker and part of the botnet. PCs, mobile devices, servers, and networking devices such as routers are often infected with zombie malware and used in a botnet. An ordinary person’s phone could be part of a botnet and they don’t even <span class="No-Break">know it!</span></p>
			<p>When an attacker can use a little bit<a id="_idIndexMarker127"/> of the computing power of a large collection of devices in their botnet, they can execute more destructive cyberattacks. In a botnet-driven DDoS attack, thousands of devices can be synchronized to overwhelm one network cyberattack target with an immense amount of <span class="No-Break">data packets.</span></p>
			<p>The DDoS attack didn’t target Google Cloud Armor directly. Rather, Google Cloud Armor was able to detect the DDoS attack. It was reported on the official Google Cloud blog (<a href="https://cloud.google.com/blog/products/identity-security/how-google-cloud-blocked-largest-layer-7-ddos-attack-at-46-million-rps">https://cloud.google.com/blog/products/identity-security/how-google-cloud-blocked-largest-layer-7-ddos-attack-at-46-million-rps</a>) <span class="No-Break">as follows:</span></p>
			<p class="author-quote">“On June 1 (2022), a Google Cloud Armor customer was targeted with a series of HTTPS DDoS attacks which peaked at 46 million requests per second. This is the largest Layer 7 DDoS reported to date—at least 76% larger than the previously reported record. To give a sense of the scale of the attack, that is like receiving all the daily requests to Wikipedia (one of the top 10 trafficked websites in the world) in just 10 seconds.</p>
			<p class="author-quote">Cloud Armor Adaptive Protection was able to detect and analyze the traffic early in the attack lifecycle. Cloud Armor alerted the customer with a recommended protective rule which was then deployed before the attack ramped up to its full magnitude. Cloud Armor blocked the attack ensuring the customer’s service stayed online and continued serving their end-users.”</p>
			<p>It’s great that Google Cloud Armor was able to mitigate such a massive DDoS attack on a customer’s GCP-hosted servers. As a cloud pentester, you might be challenged to find a way around Google <span class="No-Break">Cloud Armor!</span></p>
			<p>All cyberattacks impact at least one part of the CIA Triad – confidentiality, integrity, or availability. Confidentiality is about protecting data from unpermitted access. Integrity is about making sure that only authorized users and entities can make changes to data. And availability is about making sure that data can be accessed by authorized users when they need it. Some attacks<a id="_idIndexMarker128"/> may impact more than one part of the CIA Triad, such as ransomware (availability) that also breaches the public’s <span class="No-Break">data (confidentiality).</span></p>
			<h1 id="_idParaDest-41"><a id="_idTextAnchor040"/>Understanding lateral movement in the cloud</h1>
			<p>Cyberattacks on cloud applications<a id="_idIndexMarker129"/> can be external or internal. They can impact the confidentiality, integrity, and availability of data. Here are some more cloud cyberattack concepts <span class="No-Break">to understand.</span></p>
			<p>Cyberattacks against complicated enterprise systems such as cloud networks are seldom simple. Attacks don’t just break in, enter, and leave. Many attacks strike one part of a complex system and then move on to other parts of a <span class="No-Break">complex system.</span></p>
			<p>A cloud network can include multiple cloud platforms (AWS, Azure, and GCP) with several different services and applications on each platform. They can also contain multiple containerization systems through orchestration platforms such as Docker and Kubernetes, integrating numerous services and applications within each one. All of the components of cloud networks can communicate with each other through shared credentials such as cryptography keys and machine identities (such as <span class="No-Break">TLS certificates).</span></p>
			<p>As a cloud pentester, you may be asked to simulate these more complex lateral <span class="No-Break">exploit techniques.</span></p>
			<p>MITRE ATT&amp;CK has a whole category for lateral movement exploits. It’s all about when an attacker moves within a computer system. The attacker could be moving between different entities within your organization’s cloud instance on one cloud platform. They could be moving between different instances or services on the same cloud platform. They could even be moving from your organization’s services on one cloud platform to another if you have a <span class="No-Break">multi-cloud </span><span class="No-Break"><a id="_idIndexMarker130"/></span><span class="No-Break">network.</span></p>
			<p>Here’s MITRE ATT&amp;CK’s list of lateral <span class="No-Break">movement exploits.</span></p>
			<h2 id="_idParaDest-42"><a id="_idTextAnchor041"/>Exploitation of remote services</h2>
			<p>As cloud networks <a id="_idIndexMarker131"/>often contain entities in multiple geographic locations, this can be a common cloud cyberattack technique. When it comes to networks, “internal” and “external” pertain to access control, not to physical location per se. If a hybrid multi-cloud network has one on-premises location and components in AWS, Azure, and GCP data centers in different parts of the world, it’s all a part of an internal network if the access control is configured so that the public is <span class="No-Break">forbidden access.</span></p>
			<p>MITRE ATT&amp;CK defines<a id="_idIndexMarker132"/> the exploitation of remote services (<a href="https://attack.mitre.org/tactics/TA0008/">https://attack.mitre.org/tactics/TA0008/</a>) <span class="No-Break">as follows:</span></p>
			<p class="author-quote">“Adversaries may exploit remote services to gain unauthorized access to internal systems once inside of a network. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code.”</p>
			<h2 id="_idParaDest-43"><a id="_idTextAnchor042"/>Internal spearphishing</h2>
			<p>In a phishing attack, adversaries <a id="_idIndexMarker133"/>pose as trustworthy<a id="_idIndexMarker134"/> entities by replicating their websites, emails, text messages, or social media communications. Phishing attacks can be random. For example, I’ve received phishing text messages from an attacker pretending to be from a major Canadian bank that I don’t have an account with. The attacker only knew that I was in Canada, and Canada only has a handful of major banks, each of them having 5 million customers or more. I wasn’t specifically targeted; the attacker sent massive amounts of phishing text messages to Canadians, hoping that some who have accounts with that bank would fall for <span class="No-Break">the scam.</span></p>
			<p>Spearphishing is different. Spearphishing targets a specific individual or entity. For instance, there could be a particular individual who works for the company the attacker is trying to break into. They could look up information about the individual on LinkedIn, and then pretend to be one of the individual’s <span class="No-Break">LinkedIn contacts.</span></p>
			<p>MITRE<a id="_idIndexMarker135"/> ATT&amp;CK defines <a id="_idIndexMarker136"/>internal spearphishing (<a href="https://attack.mitre.org/tactics/TA0008/">https://attack.mitre.org/tactics/TA0008/</a>) <span class="No-Break">as follows:</span></p>
			<p class="author-quote">“Adversaries may use internal spearphishing to gain access to additional information or exploit other users within the same organization after they already have access to accounts or systems within the environment. Internal spearphishing is multi-staged campaign where an email account is owned either by controlling the user’s device with previously installed malware or by compromising the account credentials of the user. Adversaries attempt to take advantage of a trusted internal account to increase the likelihood of tricking the target into falling for the phish attempt.”</p>
			<h2 id="_idParaDest-44"><a id="_idTextAnchor043"/>Lateral tool transfer</h2>
			<p>Within a cloud<a id="_idIndexMarker137"/> network, various applications and services can be interconnected. These applications inherently possess privileged access to one another. An attacker can exploit these interconnections and privileges for lateral movement within <span class="No-Break">the network.</span></p>
			<p>MITRE ATT&amp;CK defines<a id="_idIndexMarker138"/> lateral tool transfer (<a href="https://attack.mitre.org/techniques/T1570/">https://attack.mitre.org/techniques/T1570/</a>) <span class="No-Break">as follows:</span></p>
			<p class="author-quote">“Adversaries may transfer tools or other files between systems in a compromised environment. Once brought into the victim environment (i.e. Ingress Tool Transfer) files may then be copied from one system to another to stage adversary tools or other files over the course of an operation. Adversaries may copy files between internal victim systems to support lateral movement using inherent file sharing protocols such as file sharing over SMB/Windows Admin Shares to connected network shares or with authenticated connections via Remote Desktop Protocol.”</p>
			<h2 id="_idParaDest-45"><a id="_idTextAnchor044"/>Remote service session hijacking</h2>
			<p>Cloud networks and applications<a id="_idIndexMarker139"/> are full of services that are designed to be remotely accessed. Remote service session hijacking can help an attacker move between different nodes in a containerization orchestration, between different sessions within the same cloud service, and also between different cloud services that share credentials – even if they use different cloud platforms! For example, remote sessions can be hijacked between App Engine in GCP, App Service in Azure, and Amazon EC2 in AWS. Of course, this sort of exploit can be prevented by proper security configuration between the applications <span class="No-Break">and platforms.</span></p>
			<p>MITRE<a id="_idIndexMarker140"/> ATT&amp;CK defines<a id="_idIndexMarker141"/> remote service session hijacking (<a href="https://attack.mitre.org/tactics/TA0008/">https://attack.mitre.org/tactics/TA0008/</a>) <span class="No-Break">as follows:</span></p>
			<p class="author-quote">“Adversaries may take control of preexisting sessions with remote services to move laterally in an environment. Users may use valid credentials to log into a service specifically designed to accept remote connections, such as telnet, SSH, and RDP.”</p>
			<h2 id="_idParaDest-46"><a id="_idTextAnchor045"/>Software deployment tools</h2>
			<p>This is similar to remote<a id="_idIndexMarker142"/> service session<a id="_idIndexMarker143"/> hijacking, but instead of remote sessions being targeted, trusted third-party administrative tools are targeted. As a cloud pentester, you will likely need to simulate a lot of different types of <span class="No-Break">hijacking techniques.</span></p>
			<p>MITRE ATT&amp;CK defines<a id="_idIndexMarker144"/> software deployment tools (<a href="https://attack.mitre.org/techniques/T1195/001/">https://attack.mitre.org/techniques/T1195/001/</a>) <span class="No-Break">as follows:</span></p>
			<p class="author-quote">“Adversaries may gain access to and use third-party software suites installed within an enterprise network, such as administration, monitoring, and deployment systems, to move laterally through the network.”</p>
			<h2 id="_idParaDest-47"><a id="_idTextAnchor046"/>Tainted shared content</h2>
			<p>Think of how much shared storage<a id="_idIndexMarker145"/> cloud applications constantly<a id="_idIndexMarker146"/> use! When securing a cloud network, every single data asset must be carefully monitored <span class="No-Break">and guarded.</span></p>
			<p>MITRE ATT&amp;CK defines<a id="_idIndexMarker147"/> tainted shared content (<a href="https://attack.mitre.org/tactics/TA0008/">https://attack.mitre.org/tactics/TA0008/</a>) <span class="No-Break">as follows:</span></p>
			<p class="author-quote">“Adversaries may deliver payloads to remote systems by adding content to shared storage locations, such as network drives or internal code repositories. Content stored on network drives or in other shared locations may be tainted by adding malicious programs, scripts, or exploit code to otherwise valid files.”</p>
			<p>Cloud applications and networks can get a lot more complicated than traditional applications and networks. There’s your organization, then a cloud platform, or multiple cloud platforms. There can be several different services implemented per cloud platform. There can be an on-premises network component. A containerized application can have many virtualized containers that can each live and die within days. There can be hundreds of user accounts and many more machine identities. There are so many different attack vectors for threat<a id="_idIndexMarker148"/> actors. You may need to simulate attacks on many of these complex vectors<a id="_idIndexMarker149"/> during your red <span class="No-Break">team engagements.</span></p>
			<h1 id="_idParaDest-48"><a id="_idTextAnchor047"/>Zero-trust networks</h1>
			<p>Back in the days before cloud services<a id="_idIndexMarker150"/> were commonly used, enterprises only had networks on their own premises. Back in the 1990s and early 2000s, the network security paradigm was all <span class="No-Break">about perimeters.</span></p>
			<p>Different network segments could have different levels of security, but the internal network and all of its segments were contained within a heavily guarded perimeter. Sometimes, external traffic would be allowed into the internal network, but it’d have to pass a vector for authentication and authorization. But once that perimeter was cleared, the user could travel within the internal network without having their credentials checked again. All users were either trusted or distrusted, and existing inside the perimeter meant automatic trust. Think of a country with a heavily guarded border, but little police presence inside of <span class="No-Break">the country.</span></p>
			<p>The old perimeter model of network security has been obsolete for many years now. There are multiple <span class="No-Break">reasons why.</span></p>
			<p>First of all, the perimeter security model isn’t very resilient or robust. Cyber attackers do sometimes breach authentication barriers. So, if they breach the perimeter, there are usually no other authentication barriers that they have to breach. It’s like the way a bank robber might taunt a bank: “Your security has to succeed every single time, but I only have to <span class="No-Break">succeed once!”</span></p>
			<p>Secondly, the perimeter security model is totally incompatible with today’s more complex cloud networks. The perimeter security model couldn’t be applied to a cloud network even if someone wanted to try. The simplest possible enterprise cloud network has a few PC endpoints on-premises and connects to one cloud service on one cloud platform through the internet. The most complex hybrid multi-cloud networks entail on-premises networks and endpoints in multiple company-owned locations, remote employees and contractors working from their homes, multiple cloud services (AWS, Azure, and GCP), and several different SaaS, PaaS, and IaaS services and applications on each of the cloud platforms. Either way, users have to go through the internet to connect to their internal <span class="No-Break">corporate networks.</span></p>
			<p>Zero-trust security means that no user or machine is ever trusted automatically. A perimeter security network automatically trusts users inside of the perimeter. But in cloud networks and over the internet, there is no perimeter. So, authentication and authorization vectors and checks are implemented in as many places in the network as possible. It doesn’t matter where you come from, you must show your identification to access <span class="No-Break">this component!</span></p>
			<p>An attacker would need to compromise several authentication points to navigate within the enterprise cloud network. Having numerous authentication points can significantly reduce the likelihood of a successful cyberattack. However, if an attacker manages to capture credentials, navigating within the cloud network might become effortless for them. Grasping these nuances is essential for anyone involved in cloud <span class="No-Break">penetration testing.</span></p>
			<p>Later in this book, we’ll explore<a id="_idIndexMarker151"/> some of the most popular AWS, Azure, and GCP applications and services. We’ll get into how virtualization and containerization are implemented in cloud networks. We’ll also explore the various tools, techniques, and strategies you’ll use on your cloud red <span class="No-Break">team engagements.</span></p>
			<h1 id="_idParaDest-49"><a id="_idTextAnchor048"/>Summary</h1>
			<p>The reason why we conduct pentesting is to learn about security vulnerabilities in computer systems by <span class="No-Break">simulating cyberattacks.</span></p>
			<p>There are possibly hundreds or thousands of potential cyberattack vectors in a cloud network, both internal and external. Users, user accounts, machine identities, and vulnerabilities in internet-facing applications are just some of the <span class="No-Break">many possibilities.</span></p>
			<p>You may not be able to simulate all of the possible types of exploits. For instance, cloud providers often prohibit simulating DDoS attacks, and you also won’t be allowed to physically visit the cloud provider’s data centers to plant test devices. But it’s important to understand all the different things an attacker could do and keep them in mind when you’re conducting your red <span class="No-Break">team engagements.</span></p>
			<p>Attacks can originate internally or externally from your organization. The CIA Triad of cybersecurity is a concept to explain how cyberattacks can impact your organization’s data in terms of confidentiality, integrity, <span class="No-Break">and availability.</span></p>
			<p>As cloud networks have become a lot more common and networking technology has advanced, we now secure computer networks with zero-trust security. That means users and applications are authenticated at as many points of the network as possible, regardless of the user’s origin being either internal or external to <span class="No-Break">the network.</span></p>
			<p>In the next chapter, we’ll explore the key concepts for pentesting <span class="No-Break">cloud networks.</span></p>
			<h1 id="_idParaDest-50"><a id="_idTextAnchor049"/>Further reading</h1>
			<p>To learn more about the topics covered in this chapter, you can visit the <span class="No-Break">following links:</span></p>
			<ul>
				<li><em class="italic">MITRE </em><span class="No-Break"><em class="italic">ATT&amp;CK</em></span><span class="No-Break">: </span><a href="https://attack.mitre.org/&#13;"><span class="No-Break">https://attack.mitre.org/</span></a></li>
				<li><em class="italic">DDoS </em><span class="No-Break"><em class="italic">botnets</em></span><span class="No-Break">: </span><a href="https://www.cloudflare.com/learning/ddos/what-is-a-ddos-botnet/&#13;"><span class="No-Break">https://www.cloudflare.com/learning/ddos/what-is-a-ddos-botnet/</span></a></li>
				<li><em class="italic">Zero-trust security and the </em><span class="No-Break"><em class="italic">cloud</em></span><span class="No-Break">: </span><a href="https://www.paloaltonetworks.com/cyberpedia/what-is-a-zero-trust-for-the-cloud"><span class="No-Break">https://www.paloaltonetworks.com/cyberpedia/what-is-a-zero-trust-for-the-cloud</span></a></li>
			</ul>
		</div>
	</body></html>