<html><head></head><body>
		<div id="_idContainer014">
			<h1 id="_idParaDest-68" class="chapter-number"><a id="_idTextAnchor067"/>4</h1>
			<h1 id="_idParaDest-69"><a id="_idTextAnchor068"/>Security Features in AWS</h1>
			<p>As a cloud pentester, the likelihood of being asked to pentest AWS applications and services is very high. AWS has played a central role in the cloud computing boom of the past 20 years. So, in this chapter, I’ll introduce you to AWS. You’ll learn about the most popular AWS services, applications, and features and why they’re used. We’ll also talk about AWS’s SaaS, IaaS, and PaaS features, and explore Amazon’s own AWS security tools and third-party <span class="No-Break">security tools.</span></p>
			<p>In this chapter, we’ll cover the <span class="No-Break">following topics:</span></p>
			<ul>
				<li>Introduction <span class="No-Break">to AWS</span></li>
				<li>Frequently used AWS <span class="No-Break">SaaS features</span></li>
				<li>AWS <span class="No-Break">IaaS features</span></li>
				<li>AWS <span class="No-Break">PaaS features</span></li>
				<li>AWS security controls <span class="No-Break">and tools</span></li>
			</ul>
			<p>Let’s <span class="No-Break">get started!</span></p>
			<h1 id="_idParaDest-70"><a id="_idTextAnchor069"/>Introduction to AWS</h1>
			<p><strong class="bold">AWS</strong> stands for <strong class="bold">Amazon Web Services</strong>. It’s one of the most popular cloud platforms. Amazon<a id="_idIndexMarker248"/> started as an online book retailer in 1994, but even in those early days, Amazon founder <em class="italic">Jeff Bezos</em> said that <a href="https://Amazon.com">Amazon.com</a> was a tech company with an objective to simplify online transactions for consumers. The parts of the business akin to traditional retailers, such as maintaining warehouses of inventory and customer service, were just some of the necessary components. The infrastructure that Bezos truly values has always been Amazon’s <span class="No-Break">data centers.</span></p>
			<p>As the 1990s went on, Amazon expanded its inventory well beyond books. It started selling music, movies, apparel, home accessories, and so on. In the 21st century, Amazon sells almost everything that can be properly stored at room temperature and legally sold to consumers. They also provide<a id="_idIndexMarker249"/> a lot of different internet services<a id="_idIndexMarker250"/> for consumers, such as streaming entertainment from <strong class="bold">Amazon Prime</strong> and <span class="No-Break"><strong class="bold">Kindle eBooks</strong></span><span class="No-Break">.</span></p>
			<p>As the 2000s began, Amazon<a id="_idIndexMarker251"/> found itself with more computer networking infrastructure than most big corporations. No other company on Earth had so much success selling products through the web. So, by 2002, Amazon started to let other retail businesses use some of its infrastructure and software to deploy their own e-commerce<a id="_idIndexMarker252"/> more successfully. That’s the origin<a id="_idIndexMarker253"/> of AWS, but AWS didn’t take its current form until 2006 when it launched <strong class="bold">Elastic Compute Cloud</strong> (<strong class="bold">EC2</strong>) and <strong class="bold">Simple Storage Service</strong> (<strong class="bold">S3</strong>). EC2 rents computer processing power and S3 rents data storage to business and <span class="No-Break">enterprise customers.</span></p>
			<p>As of 2023, there’s a wide range of AWS applications to serve a variety of business needs. EC2 and S3 have improved over the years and are very commonly used services. There’s a whole collection of AWS applications and services for many SaaS, PaaS, and IaaS use cases. Ever since AWS launched about 20 years ago, it has frequently added new services <span class="No-Break">and applications.</span></p>
			<p>Whether your organization uses AWS as its sole cloud provider or has a multi-cloud network, it likely has more than one AWS service or application implemented into its network. Some organizations even use dozens of AWS <span class="No-Break">applications simultaneously.</span></p>
			<p>Describing every AWS service<a id="_idIndexMarker254"/> and application in detail is beyond the scope of this book. But when you pentest your organization’s AWS network, it’s important to understand why many of the most popular AWS services and applications exist. Let’s have <span class="No-Break">a look.</span></p>
			<h1 id="_idParaDest-71"><a id="_idTextAnchor070"/>Frequently used AWS SaaS features</h1>
			<p>AWS features, applications, and services fall<a id="_idIndexMarker255"/> into a lot of different categories. Some services are offered free of charge or with limited free trials. Most services, especially the ones that businesses are most likely to use, are provided for fees that vary depending on the service and how much a business needs to use it. For example, a cloud application that needs a small amount of bandwidth and serves a few hundred users per month will generally be a lot less expensive than a cloud application that needs a large amount of bandwidth and serves tens of thousands of users <span class="No-Break">per month.</span></p>
			<p>Of course, managing AWS service fees is your organization’s responsibility, not yours. So, I’ll explain what a pentester needs to understand: the AWS services that businesses frequently use and why they <span class="No-Break">use them.</span></p>
			<p>I’ll start with some SaaS features<a id="_idIndexMarker256"/> and applications. These applications use AWS’s infrastructure, platform, and its own software. SaaS services are the ones Amazon has the most responsibility for and control of. As a pentester, you’re not allowed to pentest them in any way<a id="_idIndexMarker257"/> whatsoever. Refer to AWS’s penetration testing policies (<a href="https://aws.amazon.com/security/penetration-testing/">https://aws.amazon.com/security/penetration-testing/</a>). However, you should still understand what these applications are, even if you’re not allowed to pentest them. It’ll help you understand how your organization uses AWS as a whole, which will help you devise more effective red team scenarios and put security testing findings <span class="No-Break">into context.</span></p>
			<p><strong class="bold">Amazon Chime</strong> is Amazon’s equivalent to Zoom <a id="_idIndexMarker258"/>or Skype, hosted through the AWS ecosystem. Chime supports pretty much all types of client computers and mobile devices, with native Windows, Mac, iOS, Android, and web applications. Your organization may use Chime to conduct video conferencing between employees and contractors. It can control who has access to its video conferencing meetings and what kind of access <span class="No-Break">they have.</span></p>
			<p><strong class="bold">Amazon WorkMail</strong> provides email services and integrated<a id="_idIndexMarker259"/> calendars. It works kind of like Gmail and Google Calendar. WorkMail can be used with the Microsoft Outlook client or pretty much any email client software that’s compatible with the <span class="No-Break">IMAP protocol.</span></p>
			<p><strong class="bold">AWS Budgets</strong> is designed for small businesses to track<a id="_idIndexMarker260"/> their spending. They can set a budget such as $5,000 per month. They can track how much employees or other stakeholders spend from the corporate bank account, and how they spend it. There are a ton of other features, such as the ability to generate highly detailed reports and trigger alerts for <span class="No-Break">spending anomalies.</span></p>
			<p>AWS SaaS services can be very user friendly, and they can help both business customers and consumers get lots of work done. Although you won’t be allowed to pentest these applications, there’s a strong likelihood that at least some AWS SaaS applications are a part of your company’s network. For instance, if a company stores a lot of its data in Amazon S3, it might as well use Amazon WorkMail for the company email servers. AWS service subscriptions make it convenient for companies to use a variety of SaaS, IaaS, and PaaS applications at the same time<a id="_idIndexMarker261"/> and pay for them with the <span class="No-Break">same billing.</span></p>
			<h1 id="_idParaDest-72"><a id="_idTextAnchor071"/>AWS IaaS features</h1>
			<p><strong class="bold">IaaS</strong> or <strong class="bold">infrastructure-as-a-service</strong> features are the parts of AWS<a id="_idIndexMarker262"/> where enterprises have the most control and the most responsibility. There’s more that pentesters are allowed to do with these components than with PaaS and SaaS. But you are still on Amazon’s infrastructure, therefore they still have rules of engagement to abide by. Refer to AWS’s pentesting policies in <em class="italic">Chapters 2</em> and <em class="italic">3</em>, or you can find them on their <span class="No-Break">website (</span><a href="https://aws.amazon.com/security/penetration-testing/"><span class="No-Break">https://aws.amazon.com/security/penetration-testing/</span></a><span class="No-Break">).</span></p>
			<p>AWS IaaS can be divided into two general categories: <em class="italic">compute</em> <span class="No-Break">and </span><span class="No-Break"><em class="italic">storage</em></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-73"><a id="_idTextAnchor072"/>Compute services</h2>
			<p>Amazon EC2 is AWS’s debut compute<a id="_idIndexMarker263"/> service. It stands for Amazon Elastic Compute Cloud. EC2 is largely used by enterprises that develop their own software but need tons and tons of computer processing power to process their databases, conduct scientific research, and <span class="No-Break">so on.</span></p>
			<p>I’ll summarize some <span class="No-Break">company testimonials.</span></p>
			<p><strong class="bold">Orangetheory Fitness</strong> is a popular gym chain in the United<a id="_idIndexMarker264"/> States and Canada. It offers its customers “high-tech group workouts that combine high-intensity interval training designed to improve strength and cardio fitness levels.” It deploys its in-house software through EC2 to analyze the fitness data it constantly gets from thousands of customers <span class="No-Break">every day.</span></p>
			<p><strong class="bold">Toyota Research Institute</strong> uses EC2 to train machine learning models. In machine learning, AI<a id="_idIndexMarker265"/> processes a large amount of data over time and makes changes to a program according to what it has learned from <span class="No-Break">the data.</span></p>
			<p><strong class="bold">Airlines</strong> were among the earliest<a id="_idIndexMarker266"/> customers of IBM mainframe computers back in the 1960s. Think of all the data an airline has to process constantly – such as ticket sales and flight data. If a flight is late, a computer has to have a record of how late the flight is, where the aircraft is, and why it’s late. That’s just an example of the kind of information an airline has to compute in its everyday business operations. Cathay Pacific is a very large Asian airline that serves “nearly 200 destinations in 49 countries and territories.” And now, using cloud services such as Amazon EC2 is a more effective 21st-century alternative to running massive <span class="No-Break">mainframes on-premises.</span></p>
			<p><strong class="bold">Netflix</strong> is another example of the sort of large<a id="_idIndexMarker267"/> corporation that uses<a id="_idIndexMarker268"/> EC2. Its testimonial says that a lot more people were watching Netflix during the beginning of the COVID-19 pandemic. Netflix called it “this unprecedented time.” Hypothetically, if 20 million people worldwide were watching Netflix concurrently at a given time and then 50 million people worldwide watched Netflix concurrently at another time, that’s a massive increase in the computing and networking resources that would be needed. Therefore, Netflix says it likes EC2 for <span class="No-Break">its scalability.</span></p>
			<p>Amazon<strong class="bold"> Elastic Container Service</strong> (<strong class="bold">ECS</strong>) is another IaaS computing solution. It is a suitable choice<a id="_idIndexMarker269"/> for companies looking for the necessary infrastructure to deploy applications that are containerized, as using containerized applications is a prevalent way to utilize <span class="No-Break">cloud infrastructure.</span></p>
			<p>At the risk of oversimplifying a complex topic, it’s a way to deploy an application with a lot of components running<a id="_idIndexMarker270"/> in virtual machines, <span class="No-Break">called containers.</span></p>
			<p class="callout-heading">What are containers?</p>
			<p class="callout">Containers <a id="_idIndexMarker271"/>are a really precise way to deploy virtualization, a way to simulate computer hardware with software. A container contains only the operating system components that are needed to run a small part of a much larger application. Individual containers can have a lifespan of just a few days or even just a <span class="No-Break">few hours.</span></p>
			<p>Containers can be launched and killed dynamically according to the current needs, a way of providing scalability. Containers often contain a virtualized operating system and a component of a more sophisticated application. But containers need a containerization orchestration solution in order to be managed and to allocate hardware resources. Amazon describes ECS as a “fully managed container orchestration service that helps organizations easily deploy, manage, and scale <span class="No-Break">containerized applications.”</span></p>
			<p><strong class="bold">Docker</strong> is a container orchestration<a id="_idIndexMarker272"/> platform. ECS is a service that can be used to deploy such platforms. Think of a company’s software as the swimmers, Docker as the water, and ECS as the swimming<a id="_idIndexMarker273"/> pool. If your company uses Kubernetes as its container orchestration platform, it can instead choose <strong class="bold">Amazon Elastic Kubernetes Service</strong> (<strong class="bold">Amazon EKS</strong>) to serve a similar purpose <span class="No-Break">to ECS.</span></p>
			<p><strong class="bold">AWS Lambda</strong> is another service that AWS permits<a id="_idIndexMarker274"/> pentesting on. It’s categorized as a compute service. It can be used to help deploy your applications on Amazon’s infrastructure as a serverless compute service while dynamically allocating resources according to whatever is needed at any given time. Developers can deploy custom logic in Lambda. For example, if a user leaves an item in their shopping cart without checking it out, send the user an email reminder in three days, and remove the item from their shopping cart in seven days. Lambda can run applications that use any third-party library, and there’s also native support for Java, Go, PowerShell, Node.js, C#, Python, <span class="No-Break">and Ruby.</span></p>
			<p><strong class="bold">Amazon CloudFront</strong> is a <strong class="bold">content delivery network</strong> (<strong class="bold">CDN</strong>). A CDN is defined as a geographically distributed<a id="_idIndexMarker275"/> network of proxy servers and their data centers. CDNs<a id="_idIndexMarker276"/> were originally created in the late 1990s to help support the rapidly expanding use of the internet. So, a CDN can dynamically allocate network resources to avoid bottlenecks – points in the transmission path that can slow down performance. So, if one part of a network is managing as much data as it can, the CDN data transmission path will use another part of the network that has room to manage more data. <strong class="bold">YouTube</strong> is an example of a very popular streaming media platform that uses a CDN. The data center and servers that are streaming videos to YouTube users can change according to demand <span class="No-Break">and capacity.</span></p>
			<p>Amazon CloudFront<a id="_idIndexMarker277"/> supports WebSocket, edge termination, Amazon EC2, Amazon S3, Elastic Load Balancing, <span class="No-Break">and Lambda.</span></p>
			<p><strong class="bold">AWS Fargate</strong> is a serverless compute solution<a id="_idIndexMarker278"/> for containers. Developers can deploy Docker applications through Amazon ECS or Kubernetes applications through Amazon EKS. All the necessary hardware and network resources are dynamically allocated. Just as much memory as is needed at any given time will be used. I’ll explain more about containerization in the <em class="italic">AWS PaaS features</em> section of this chapter and in <em class="italic">Chapters 6</em>, <em class="italic">9</em>, <span class="No-Break">and </span><span class="No-Break"><em class="italic">12</em></span><span class="No-Break">.</span></p>
			<p><strong class="bold">AWS Elastic Beanstalk</strong> uses Amazon’s compute services <a id="_idIndexMarker279"/>and infrastructure to deploy web applications. It features native support for Java, .NET, Node.js, PHP, Ruby, Python, Go, and Docker. Developers can use <strong class="bold">integrated development environments</strong> (<strong class="bold">IDEs</strong>) they’re already familiar with, such as Eclipse<a id="_idIndexMarker280"/> and Visual Studio, to deploy applications<a id="_idIndexMarker281"/> through <span class="No-Break">Elastic Beanstalk.</span></p>
			<p>Let’s look at some IaaS solutions <span class="No-Break">for storage.</span></p>
			<h2 id="_idParaDest-74"><a id="_idTextAnchor073"/>Storage services</h2>
			<p>Enterprises<a id="_idIndexMarker282"/> can generate petabytes of data. A petabyte is about 1,024 terabytes. You likely have at least a few terabytes worth of storage on your mobile devices, laptop, and external hard drive. Businesses often need petabytes of storage, and sometimes even exabytes! An exabyte is about 1,024 petabytes. Any organization with petabytes or exabytes of data would absolutely need massive data centers in order to store it. Now, it’s much more feasible for those data centers to be on the cloud, because even running a data center for several petabytes of storage can be a <span class="No-Break">big hassle.</span></p>
			<p>Amazon S3 is the debut AWS storage service. If a company has huge amounts of data that it needs to store, Amazon S3 is one of the most popular options for <span class="No-Break">that purpose.</span></p>
			<p><strong class="bold">Snap</strong>, the company that makes <strong class="bold">Snapchat</strong>, says that it stores about 2 exabytes of data through <a id="_idIndexMarker283"/>Amazon S3. Snap says that’s over 1.5 <em class="italic">trillion</em> photos and videos. So, that’s an example of how a company with a huge amount of data may use it. But companies don’t have to have anywhere near that much data to use <span class="No-Break">Amazon S3.</span></p>
			<p>Amazon promises that if customers use Amazon S3 as designed, it will keep secure the infrastructure that’s used to store their data and make sure that any of their data is easily retrievable as quickly <span class="No-Break">as possible.</span></p>
			<p>One of the more common uses for Amazon S3 is to store data lakes. A data lake is a huge, centralized repository of structured and unstructured data. For instance, all the photos in everyone’s accounts in Google Photos could be collected as one data lake in the low exabytes. Big tech companies often use data lakes to train machine <span class="No-Break">learning AI.</span></p>
			<p>Another common reason to use Amazon S3, for large and small businesses alike, is to back up data. There are multiple AWS data centers worldwide, and the data that companies store through Amazon S3 could be physically stored on multiple continents. It’s possible for a massive cyberattack, earthquake, or hurricane to destroy a lot of computers in one location. Instead of taking the risk of having all of a company’s crucial and critical data stored on its premises, the company can store it through Amazon <span class="No-Break">S3 internationally.</span></p>
			<p><strong class="bold">AWS Backup</strong> centralizes and automates data<a id="_idIndexMarker284"/> backups. It can work with Amazon S3 to store an organization’s data, and with Amazon EC2 to create on-demand backup jobs. Imagine a company with thousands of users and PCs in multiple countries. The work they do for the company each day needs to be backed up to the company’s AWS network. Most employees work between 9 a.m. and 5 p.m. but may live across a dozen different time zones. So, it may be convenient to execute a backup job at 5 p.m. each day, but 5 p.m. occurs at different moments all across the globe. These are the kinds of complex data backup needs that AWS Backup is designed to handle. AWS Backup is fully compatible with all <span class="No-Break">AWS services.</span></p>
			<p>If your organization has a lot of software<a id="_idIndexMarker285"/> developers and IT people, there’s a good chance that it can make good use of AWS’s IaaS services. AWS IaaS gives organizations a lot of control over their own custom software without the downsides of having to maintain on-premises <span class="No-Break">data centers.</span></p>
			<h1 id="_idParaDest-75"><a id="_idTextAnchor074"/>AWS PaaS features</h1>
			<p><strong class="bold">PaaS</strong> or <strong class="bold">platform-as-a-service</strong> is in the middle between IaaS <a id="_idIndexMarker286"/>and SaaS as far as security responsibilities are concerned. AWS provides the infrastructure and a platform, but it doesn’t provide all of the software as it would in SaaS. PaaS services are software developer tools most of the time. As a pentester, you generally can only pentest PaaS services under very limited conditions. A lot of what you’re permitted to do in IaaS is forbidden in PaaS. When in doubt, assume by default that you’re not allowed to do something, and consult<a id="_idIndexMarker287"/> the AWS penetration testing policy (<a href="https://aws.amazon.com/security/penetration-testing/">https://aws.amazon.com/security/penetration-testing/</a>). In some situations, such as network stress testing, you may submit a form to AWS to request permission to do something. Only proceed with your plans for your red team engagement when you’ve verified that AWS will permit you to do everything you plan to do. You may have to tweak or adjust your plans according to AWS’s response to <span class="No-Break">your inquiry.</span></p>
			<p>As with SaaS, even when you’re not allowed to pentest something, it still helps to understand how your company uses AWS PaaS. It’ll help you put your red team engagements and their impact <span class="No-Break">into perspective.</span></p>
			<p>The <strong class="bold">AWS Command-Line Interface</strong> (<strong class="bold">AWS CLI</strong>) is pretty much as it sounds. Just as you can use a command line<a id="_idIndexMarker288"/> to administrate your own computer by typing in commands and hitting <em class="italic">Enter</em>, AWS lets developers manage AWS services<a id="_idIndexMarker289"/> in a similar way. Developers often love the CLI because it gives them a lot more control than they’d get from a <strong class="bold">graphical user interface</strong> (<strong class="bold">GUI</strong>). Or, at least, they can get what they want done much more quickly and efficiently. The AWS CLI<a id="_idIndexMarker290"/> has good documentation and support for executing shell scripts (<a href="https://docs.aws.amazon.com/cli/latest/reference/">https://docs.aws.amazon.com/cli/latest/reference/</a>). You can use the AWS CLI from an application installed on Windows, Mac, or Linux. Alternatively, you can access the AWS CLI through your web browser with <span class="No-Break"><em class="italic">AWS CloudShell</em></span><span class="No-Break">.</span></p>
			<p><strong class="bold">AWS CDK</strong> is AWS’s <strong class="bold">Cloud Development Toolkit</strong>. Software developers are familiar with <strong class="bold">software development kits</strong> (<strong class="bold">SDKs</strong>). For instance, in order to create Java applications<a id="_idIndexMarker291"/> that work well in multiple operating<a id="_idIndexMarker292"/> systems, your IDE (a type of application for software development) needs Java SDKs. AWS CDK<a id="_idIndexMarker293"/> is conceptually similar, but for the cloud. When an organization develops a cloud application to deploy through AWS in-house, AWS CDK is <span class="No-Break">very useful.</span></p>
			<p>So, AWS CDK helps to support cloud features within in-house-developed cloud applications. Chances are, developers will also need AWS tools and SDKs (<a href="https://aws.amazon.com/developer/tools/">https://aws.amazon.com/developer/tools/</a>) to support the other technologies and platforms they may be using. There are AWS SDKs specific to C++, Go, Java, JavaScript, Kotlin, .NET, Node.js, PHP, Ruby, Python, Rust, <span class="No-Break">and Swift.</span></p>
			<p><strong class="bold">AWS Cloud9</strong> is Amazon’s own IDE for developing cloud applications with AWS CDK and the programming<a id="_idIndexMarker294"/> language-specific SDKs<a id="_idIndexMarker295"/> and tools that are needed. Cloud9 runs directly in the web browser and developers can use it to work on the applications they’re making wherever they happen to be, on any compatible computer they can log in to. That’s because Cloud9 stores all of their work through the cloud! <span class="No-Break">How convenient.</span></p>
			<p>What if people are making movies<a id="_idIndexMarker296"/> and cartoons instead of cloud-driven software applications? That’s what <strong class="bold">Amazon Nimble Studio</strong> is for. As with Cloud9, users can work on their projects wherever they go. They can also collaborate on projects with the rest of <span class="No-Break">their team.</span></p>
			<p>All data transmitted on the internet<a id="_idIndexMarker297"/> should be encrypted with public key cryptography. <strong class="bold">AWS Certificate Manager</strong> is a main component of the <strong class="bold">public key infrastructure</strong> (<strong class="bold">PKI</strong>) that companies need to deploy in order to encrypt the applications<a id="_idIndexMarker298"/> they deploy through AWS with SSL <span class="No-Break">or TLS.</span></p>
			<p>Users often interact with cloud-driven applications with their iPhones and Android phones as endpoints. Software developers know that they can’t be sure how well their application will run on a particular device without testing it on <span class="No-Break">that device.</span></p>
			<p>It’s a hassle to maintain a collection<a id="_idIndexMarker299"/> of iPhones and Android phones of various models. So, developers can use <strong class="bold">AWS Device Farm</strong> as an alternative. AWS Device Farm virtualizes a wide variety of phone and tablet models and developers can directly see how their applications will run. They can even interact with their applications exactly how a user would through a <span class="No-Break">touchscreen simulation.</span></p>
			<p><strong class="bold">AWS Amplify</strong> promises to help developers “build full-stack<a id="_idIndexMarker300"/> web and mobile apps in hours.” It can be an appropriate solution if the app is relatively simple. For example, luxury retailer Neiman Marcus uses AWS Amplify to create and manage its <span class="No-Break">online retailing.</span></p>
			<p>Databases are often a necessary<a id="_idIndexMarker301"/> component for many different kinds of applications. AWS has multiple PaaS database services according to the type of database that’s needed. In-depth explanations of different database technologies are beyond the scope of this book, but an experienced development team will usually know what kind of databases <span class="No-Break">they need.</span></p>
			<p><strong class="bold">Amazon Aurora</strong> supports MySQL and PostgreSQL<a id="_idIndexMarker302"/> databases. It also directly integrates with Amazon S3, AWS Backup, AWS EKS, and many other <span class="No-Break">AWS services.</span></p>
			<p>Amazon<strong class="bold"> Relational Database Service</strong> (<strong class="bold">RDS</strong>) is for relational databases. It can use Amazon Aurora<a id="_idIndexMarker303"/> as an engine. It can also use MySQL, MariaDB, PostgreSQL, Oracle, and SQL <span class="No-Break">Server directly.</span></p>
			<p><strong class="bold">Amazon Redshift</strong> is for data warehousing. Whereas<a id="_idIndexMarker304"/> data lakes can contain very large amounts of unstructured data, data warehousing is for very large amounts of carefully structured data. It uses SQL to analyze the data in your organization’s data warehouses. Deploying large-scale data analytics is a common use case for <span class="No-Break">Amazon Redshift.</span></p>
			<p><strong class="bold">Amazon Lightsail</strong> promises to help developers deploy <a id="_idIndexMarker305"/>web applications “in just a few clicks” using a series of virtual servers. It offers support for managed databases with MySQL or PostgreSQL. It facilitates CDNs on the same infrastructure as Amazon <a id="_idIndexMarker306"/>CloudFront. It also supports Docker containers through a Lightsail <span class="No-Break">container service.</span></p>
			<p><strong class="bold">AWS CodeDeploy</strong> automates code deployment through <a id="_idIndexMarker307"/>your organization’s on-premises servers, or through Amazon EC2, AWS Lambda, AWS Fargate, or AWS ECS. You can monitor and roll back your applications as needed, configure and orchestrate deployment, and maintain different application releases all at the <span class="No-Break">same time.</span></p>
			<p>AWS PaaS services are popular with software developers. They help developers create custom applications without having to build all the components from scratch. These days, applications<a id="_idIndexMarker308"/> are seldom developed from <span class="No-Break">scratch anyway.</span></p>
			<h1 id="_idParaDest-76"><a id="_idTextAnchor075"/>AWS security controls and tools</h1>
			<p>One of the most important<a id="_idIndexMarker309"/> things that you need to become familiar with as an AWS pentester is the various security controls AWS uses, and the tools you can use to conduct your pentesting. The details on how to use those tools will be explained in <em class="italic">Chapters 5</em> and <em class="italic">6</em>, but I’ll introduce the <span class="No-Break">tools here.</span></p>
			<h2 id="_idParaDest-77"><a id="_idTextAnchor076"/>Security controls</h2>
			<p>First, what are security<a id="_idIndexMarker310"/> controls, and what security controls does <span class="No-Break">AWS have?</span></p>
			<p>Security controls are components that can help to prevent or mitigate cyberattacks or other possible threats <a id="_idIndexMarker311"/>to your organization’s data. All security threats are related to the <strong class="bold">CIA</strong> (<strong class="bold">confidentiality, integrity, and availability</strong>) <strong class="bold">Triad</strong>. So, a security control is designed to help prevent breaching data confidentiality and the integrity of data, and may also be designed to help maintain the availability of data. A security control can help with one or any combination of these <span class="No-Break">three components.</span></p>
			<p>Examples of security controls include antivirus software, physical door locks to rooms that have computers in them, intrusion detection sensors, security cameras, DDoS mitigation solutions (such as Cloudflare), intrusion prevention systems, firewalls, authentication systems (usernames, passwords, or two-factor authentication), human security guards, and access cards <span class="No-Break">and tokens.</span></p>
			<p>These sorts of tools, systems, and mechanisms can help improve a company’s cybersecurity if they’re used properly, but no security control guarantees perfect security. Well-used security controls lessen the frequency and negative impact of cyberattacks. As a pentester, you’ll often be expected to test the effectiveness of how your organization implements these controls by simulating cyberattacks against them. In your pentesting report, you may have to describe how security controls reacted to your pentests and how your organization can improve their use. Sometimes, you may even work with defensive security professionals to suggest better alternatives <span class="No-Break">or upgrades.</span></p>
			<p>Amazon provides customers with a lot of different security controls that they can use in their AWS networks. As with all security controls, they only work if they use them, and use them properly! Amazon is responsible for the security of its infrastructure, and your organization is responsible for the security of your own code. But Amazon still provides tools your organization can use to help you manage your own security responsibility. I used to do research for a company that provides services for managing machine identities, such as TLS certificates. I discovered that many developers who use cloud platforms don’t use the tools those platforms provide to encrypt applications with <span class="No-Break">TLS (</span><a href="https://venafi.com/blog/want-more-secure-more-effective-cloud-watch-your-machine-identities/"><span class="No-Break">https://venafi.com/blog/want-more-secure-more-effective-cloud-watch-your-machine-identities/</span></a><span class="No-Break">).</span></p>
			<p>Not encrypting the data that’s being<a id="_idIndexMarker312"/> transmitted from a cloud application is a huge security vulnerability! The cloud platforms are doing everything right. They say, “here’s how to encrypt your applications with our tools, and documentation on how to use them.” I can’t stress enough how important it is that the organization you work for looks at all the security tools that Amazon provides for AWS services, and reads the extensive free documentation they provide on how to <span class="No-Break">use them.</span></p>
			<p>So, with that being said, let’s have a look at some of Amazon’s most important AWS <span class="No-Break">security tools.</span></p>
			<p><strong class="bold">AWS Security Hub</strong> is where all of Amazon’s native AWS security<a id="_idIndexMarker313"/> services come together. Data is aggregated from AWS IAM, Amazon Macie, AWS Health, AWS Systems Manager, Amazon Inspector, AWS Firewall Manager, Amazon GuardDuty, and <span class="No-Break">AWS Config.</span></p>
			<p>Security findings can be correlated between different AWS security services for the full picture. Amazon Detective can be launched from AWS Security Hub to further investigate security alerts and events, and <strong class="bold">security orchestration, automation, and response</strong> (<strong class="bold">SOAR</strong>) workflows can be initiated once administrators<a id="_idIndexMarker314"/> and your organization’s security team are familiar with how AWS security services work together, in order to make their work <span class="No-Break">more efficient.</span></p>
			<p>AWS <strong class="bold">Identity and Access Management</strong> (<strong class="bold">IAM</strong>) offers a console and system to manage all of the user identities<a id="_idIndexMarker315"/> and machine identities throughout an organization’s AWS account. All of the AWS services that an organization uses through the same account can be managed<a id="_idIndexMarker316"/> through the same AWS IAM application. The console is called <strong class="bold">IAM </strong><span class="No-Break"><strong class="bold">Identity Center</strong></span><span class="No-Break">.</span></p>
			<p>Some identities can remain relatively unchanged for years, such as user identities for administrators. Other identities may only be needed for a few days or a few weeks, such as machine identities for temporary cloud workloads. IAM can manage all of the different types of identities that your organization’s AWS services use. As far as the access management part is concerned, administrators can “fine-grain” customize the permissions and access each <span class="No-Break">identity has.</span></p>
			<p>IAM also supports service control policies to help provide guardrails for the access each identity has. Policies can help limit the access that identities have. Whichever rules or settings are the most restrictive win. This is connected to the principle of least privilege, a common concept in cybersecurity. The principle of least privilege means that users and other entities only have as much access as they absolutely need to do their jobs and no more. This limits not only the harm that a user can cause by their mistakes but also the possible damage that could be done if a cyber threat actor maliciously acquires access to <span class="No-Break">the account.</span></p>
			<p>Using AWS IAM effectively means<a id="_idIndexMarker317"/> there are robust logs each time a user or machine logs onto the system, and each time identities are used to access a part of an organization’s AWS services. If security professionals suspect that a threat actor may have conducted a privilege escalation attack (when an attacker acquires access to an account and increases their access from that point), AWS IAM is the first place they should check. AWS IAM also generates alerts when anomalies <span class="No-Break">are detected.</span></p>
			<p><strong class="bold">AWS Directory Service</strong> is another IAM-related<a id="_idIndexMarker318"/> tool, but it’s specifically for managing Microsoft Active Directory through <strong class="bold">Lightweight Directory Access Protocol</strong> (<strong class="bold">LDAP</strong>). Active Directory has been the default means for Windows servers to administrate Windows<a id="_idIndexMarker319"/> client computers ever since the Windows 2000 Server edition. If your organization manages Windows computers through AWS, AWS Directory Service can be used and also integrated with <span class="No-Break">AWS IAM.</span></p>
			<p><strong class="bold">Amazon GuardDuty</strong> actively monitors an organization’s AWS services<a id="_idIndexMarker320"/> for possible cyber threats. GuardDuty receives constant updates about the ever-evolving cyber threat landscape through both AWS and third-party threat intelligence feeds. The system uses a combination of machine learning, behavioral modeling, and anomaly detection to detect <span class="No-Break">possible threats.</span></p>
			<p>For example, GuardDuty may understand that a certain kind of user will transmit a certain amount of data during a session in your organization’s application. If, all of a sudden, a user downloads 30 times as much data as an average user, that would probably trigger the anomaly detection mechanisms. Then, GuardDuty would combine the anomaly data with what the system<a id="_idIndexMarker321"/> has learned through machine learning to decide whether or not it’s an <strong class="bold">indicator of compromise</strong> (<strong class="bold">IOC</strong>). Human security professionals may receive an alert. Sometimes, security professionals need to investigate alerts to determine whether a cyberattack is actually happening or whether it’s a false positive alert. Is the anti-theft alarm on that parked car triggered because of a real auto theft attempt, or because a cat jumped onto the car? Innocuous mistakes also happen in <span class="No-Break">cloud security.</span></p>
			<p>GuardDuty can continuously<a id="_idIndexMarker322"/> monitor and analyze instance and container workloads, user accounts, serverless applications, Amazon S3 resources, and databases. GuardDuty can also scan for malware and generate context for security alerts and the events associated <span class="No-Break">with them.</span></p>
			<p>When security professionals<a id="_idIndexMarker323"/> need to investigate activity related to a GuardDuty alert, they can use <strong class="bold">Amazon Detective</strong> for help. GuardDuty security findings, and logs from Amazon EKS audits, VPC Flow, and AWS CloudTrail, are all integrated into the system. Not only can GuardDuty alerts be investigated with Detective, but also alerts from AWS Security Hub and integrated security <span class="No-Break">partner products.</span></p>
			<p>Detective can be launched from the AWS Management Console, and then administrators can see visualizations and context for <span class="No-Break">their alerts.</span></p>
			<p><strong class="bold">Amazon Inspector</strong> is designed for vulnerability management. Remember when I mentioned<a id="_idIndexMarker324"/> the importance of frequent vulnerability scanning in <a href="B18672_03.xhtml#_idTextAnchor050"><span class="No-Break"><em class="italic">Chapter 3</em></span></a>? Your organization becomes ready for pentesting and red team engagements once a history of vulnerability assessments and security hardening from assessment findings has been established. Then, there should be frequent vulnerability scanning and remediation between pentests and red team engagements <span class="No-Break">as well.</span></p>
			<p>Although there are third-party tools for vulnerability scanning in AWS, Amazon Inspector is the native tool. Inspector detects new cloud workloads automatically, maintains a frequently updated vulnerability database, and scans your organization’s entire AWS services continuously. While GuardDuty is for detecting possible threats, Inspector is for detecting vulnerabilities that threat actors could exploit. GuardDuty catches a burglar in action, while Inspector detects the unlocked door that a burglar could use. But like Detective, Inspector will also provide context for the vulnerabilities <span class="No-Break">it detects.</span></p>
			<p>In <a href="B18672_03.xhtml#_idTextAnchor050"><span class="No-Break"><em class="italic">Chapter 3</em></span></a>, I discussed the CVE database, which includes records of the majority of known security vulnerabilities found in software, hardware, and networking devices. The Inspector tool utilizes the CVE database and the CVSS to identify vulnerabilities and provide recommendations on their prioritization for mitigation and remediation. For example, a vulnerability with a critical CVSS score of 9.1 should be addressed much earlier than one with a low score of 3.8. Since it is not feasible for the defensive security team to tackle all vulnerabilities at once, prioritizing them <span class="No-Break">is crucial.</span></p>
			<p>Beyond the known vulnerabilities in CVE, Inspector also uses 50 vulnerability intelligence sources to help detect zero-day vulnerabilities. None of these technologies are infallible, but Inspector’s ability to detect some zero-day vulnerabilities is a big help. Perhaps your pentesting may help your organization find other zero-day vulnerabilities <span class="No-Break">one day!</span></p>
			<p><strong class="bold">AWS CloudTrail</strong> monitors user activity and how the <strong class="bold">APIs</strong> (<strong class="bold">application programming interfaces</strong>, a way for applications to exchange data with each other) throughout<a id="_idIndexMarker325"/> an organization’s AWS<a id="_idIndexMarker326"/> services are used. Unauthorized API usage can be analyzed through “who, what, and when” information in CloudTrail events. Machine learning models are used to detect anomalies in API usage, and logs and audit reports are stored in Amazon S3 to make regulatory <span class="No-Break">compliance easier.</span></p>
			<p>There is a dedicated AWS CloudTrail console, and log files can also be analyzed through <span class="No-Break">Amazon Athena.</span></p>
			<p>Imagine how large and<a id="_idIndexMarker327"/> complex your organization’s AWS network can be. There can be so many different data assets that it can be difficult to acquire full visibility into them all without the <span class="No-Break">right tools.</span></p>
			<p><strong class="bold">Amazon Macie</strong> uses machine learning and pattern<a id="_idIndexMarker328"/> matching to find sensitive data wherever it happens to be in your organization’s AWS network. Amazon Macie continuously scans all of your organization’s Amazon S3 storage. Then, administrators don’t just get a “new sensitive data discovered” alert. Rather, Macie generates interactive data maps so administrators can find exactly where sensitive data is and how it connects with everything else in your <span class="No-Break">organization’s network.</span></p>
			<p>Beyond continuous scans, targeted full discovery scans can also be launched at any time. Macie findings are integrated into AWS Security Hub so they’re easy <span class="No-Break">to discover.</span></p>
			<p><strong class="bold">AWS Network Firewall</strong> can be configured to control how data<a id="_idIndexMarker329"/> travels through your organization’s AWS<a id="_idIndexMarker330"/> services, and in and out of them. <strong class="bold">AWS Firewall Manager</strong> is used to create policies based on network<a id="_idIndexMarker331"/> firewall rules. The same policies can be applied to any <strong class="bold">virtual private clouds</strong> (<strong class="bold">VPCs</strong>) your organization may <span class="No-Break">have connected.</span></p>
			<p>Filtering inbound traffic can prevent external cyber threats from making their way into your organization’s network. Filtering outbound traffic can prevent sensitive data leaks and malware communications (for instance, spyware reporting keylogger data to a threat actor’s command and control servers), and help with regulatory compliance. Firewall rules and policies can also be applied to client devices that connect with your organization’s <span class="No-Break">AWS services.</span></p>
			<p><strong class="bold">AWS Certificate Manager</strong> plays a specialized role in your organization’s IAM<a id="_idIndexMarker332"/> and PKI. It works with both public and private TLS and SSL certificates. From AWS Certificate Manager, certificates can be deployed <span class="No-Break">and managed.</span></p>
			<p>AWS Certificate Manager can work with any of the <strong class="bold">certificate authorities</strong> (<strong class="bold">CAs</strong>) in your AWS network, whether certificates<a id="_idIndexMarker333"/> are through Amazon Trust Services, AWS Private CA, or public and private certificates that can <span class="No-Break">be imported.</span></p>
			<p>Certificates can be monitored through Amazon CloudWatch and <span class="No-Break">Amazon EventBridge.</span></p>
			<p><strong class="bold">AWS Secrets Manager</strong> monitors the secrets all throughout<a id="_idIndexMarker334"/> your organization’s AWS services. Secrets are used for identification and authentication. Secrets include cryptographic keys of various kinds, API keys, access tokens, and other types <span class="No-Break">of credentials.</span></p>
			<p>Secrets can be rotated<a id="_idIndexMarker335"/> without disruption to limit the risk of credential breaches without impacting the uptime of your applications and services. Secrets can be integrated with your organization’s logging, monitoring, and notification services. AWS Secrets Manager fully integrates with AWS IAM to apply permissions <span class="No-Break">and policies.</span></p>
			<p>All of your organization’s secrets are stored in a centralized and highly <span class="No-Break">secured manner.</span></p>
			<p><strong class="bold">AWS Audit Manager</strong> is designed to facilitate regulatory compliance. It also helps defensive<a id="_idIndexMarker336"/> security specialists to perform risk assessments. “How likely is a bad thing to happen, and what would <span class="No-Break">it do?”</span></p>
			<p>Auditing frameworks can be chosen from a collection of prebuilt frameworks or they can be custom-made. Specific scopes can be defined and evidence is constantly collected during an assessment. From there, root causes of security problems can <span class="No-Break">be identified.</span></p>
			<p>So, as you can see, Amazon provides a lot of different security services for your organization to use. Your organization should definitely use as many of them as are applicable to what your organization does. Also, Amazon’s security services integrate with each other to manage how the various aspects of network security affect <span class="No-Break">each other.</span></p>
			<p>I strongly recommend that you and the security professionals in your organization explore the official<a id="_idIndexMarker337"/> AWS Security documentation (<a href="https://docs.aws.amazon.com/security/">https://docs.aws.amazon.com/security/</a>). It covers all of the services I’ve mentioned here, and all of the other AWS<a id="_idIndexMarker338"/> security services and features <span class="No-Break">as well.</span></p>
			<h2 id="_idParaDest-78"><a id="_idTextAnchor077"/>Security tools</h2>
			<p>There are a number of different<a id="_idIndexMarker339"/> third-party tools that can be used in your pentesting. Most of the tools I mention here are for AWS specifically. They’re also mainly open source, which means the hacker community can constantly improve these tools without having to ask for <span class="No-Break">special permission.</span></p>
			<p>Some of the tedium of your pentesting work can be automated with the right tools, but it’s important to understand that pentesting isn’t simply a matter of running some tools and then looking at the logs they generate. Some pentests are performed without any automated tools at all, and all pentests require a clever human being to approach their computer networking target the way a human cyber attacker would. That’s whether or not any automated tools <span class="No-Break">are used.</span></p>
			<p>Quite often, pentests and red team<a id="_idIndexMarker340"/> engagements include matters such as physical security testing (such as breaking physical locks) and <strong class="bold">open source intelligence</strong> (<strong class="bold">OSINT</strong>). Within the framework of penetration testing, OSINT involves the collection and analysis of publicly accessible information about your target, as well as any vulnerabilities they might possess. OSINT focuses on gathering information legally, sometimes from physical sources such as books and printed records, but predominately from online sources available on <span class="No-Break">the internet.</span></p>
			<p>Most of the concepts that pertain to pentesting computer networks in general apply to pentesting AWS, except perhaps for the shared responsibility model and how Amazon’s policies can limit what you may pentest and how. But a lot of the information about pentesting AWS specifically applies to the tools that were developed just for pentesting AWS and other <span class="No-Break">cloud platforms.</span></p>
			<p>How to use these tools will be covered in detail in <em class="italic">Chapters 5</em> and <em class="italic">6</em>, but in this section, I’ll introduce you to them and explain what <span class="No-Break">they are.</span></p>
			<p><strong class="bold">Prowler</strong> (<a href="https://github.com/prowler-cloud/prowler">https://github.com/prowler-cloud/prowler</a>) is an open source command-line utility<a id="_idIndexMarker341"/> that has a wide variety of features for pentesting AWS, Azure, and GCP (<a href="https://docs.prowler.cloud/en/latest/">https://docs.prowler.cloud/en/latest/</a>). I will walk you through using Prowler for AWS in <a href="B18672_05.xhtml#_idTextAnchor080"><span class="No-Break"><em class="italic">Chapter 5</em></span></a>, Azure in <a href="B18672_08.xhtml#_idTextAnchor141"><span class="No-Break"><em class="italic">Chapter 8</em></span></a>, and GCP in <a href="B18672_11.xhtml#_idTextAnchor197"><span class="No-Break"><em class="italic">Chapter 11</em></span></a><span class="No-Break">.</span></p>
			<p>Prowler has prebuilt tests specifically designed for assessing CIS, PCI-DSS, ISO27001, GDPR, HIPAA, FFIEC, SOC2, AWS FTR, and ENS compliance. You can also configure Prowler to work according to custom <span class="No-Break">security frameworks.</span></p>
			<p>Prowler can be executed in many different ways. It can run directly from multiple types of workstation PCs through Linux or macOS. It can also run from Windows, but Cygwin is required. Prowler can also be used from AWS CloudShell, Cloud9, Fargate, and Docker and <span class="No-Break">Kubernetes containers.</span></p>
			<p>Prowler has a multitude<a id="_idIndexMarker342"/> of libraries, which include ways to check for exposed secrets, exposed services, and whether any part of your AWS network can be discovered <span class="No-Break">on Shodan.</span></p>
			<p><strong class="bold">awspx</strong> (<a href="https://github.com/WithSecureLabs/awspx">https://github.com/WithSecureLabs/awspx</a>) is designed specifically for AWS. With<a id="_idIndexMarker343"/> this tool, you can generate a detailed visualization of your data resources all throughout your AWS network, and of all of the <span class="No-Break">access relationships.</span></p>
			<p>You can draw possible attack paths from one resource to another. You can explore in-depth which actions impact <span class="No-Break">which resources.</span></p>
			<p>awspx must be run from a Docker container with Linux or macOS, and you’ll also need access to the rest of your AWS network <span class="No-Break">from there.</span></p>
			<p><strong class="bold">Intruder</strong> (<a href="https://www.intruder.io/">https://www.intruder.io/</a>) is a commercial vulnerability scanner <a id="_idIndexMarker344"/>with monthly or annual<a id="_idIndexMarker345"/> subscription fees. It’s designed to be used with the OpenVAS and Tenable vulnerability scanning platforms. It has tools for scanning a variety of different types of networks, and it integrates with GitHub, Slack, Jira, and a number of different applications. It also includes integrations for AWS, Azure, and GCP, which is what’s relevant <span class="No-Break">to us.</span></p>
			<p>As far as AWS is concerned, Intruder can run automated scans to check for insecure AWS configuration, whether or not your AWS has exposed secrets and where, exposed services, and a frequently updated library to check for authentication and code <span class="No-Break">injection vulnerabilities.</span></p>
			<p>Intruder can perform both external and network scans, and also has tools for scanning <span class="No-Break">web applications.</span></p>
			<p><strong class="bold">Acunetix</strong> (<a href="https://www.acunetix.com/vulnerability-scanner/">https://www.acunetix.com/vulnerability-scanner/</a>) is also a full-featured vulnerability <a id="_idIndexMarker346"/>scanner, but for web<a id="_idIndexMarker347"/> applications in particular. AWS is just one of many different technologies it can <span class="No-Break">work with.</span></p>
			<p>According to its <a id="_idIndexMarker348"/>developer, Invicti, Acunetix is the first web security scanner, having been in development since 2005. Invicti claims that its proprietary Smart Scan algorithm can detect 80% of the vulnerabilities in a system in the first 20% of <span class="No-Break">a scan.</span></p>
			<p>It has a feature to scan AWS’s web application firewall. It also has project management system integration, which may be useful to <span class="No-Break">your organization.</span></p>
			<p>Unlike Intruder, Acunetix can be run as its own self-contained vulnerability scanner. It can be run natively from Linux, macOS, or Windows, but it can also be integrated into OpenVAS. Scans can be executed both internally and externally. Pricing information is available if you request <span class="No-Break">a quote.</span></p>
			<p><strong class="bold">Rhino Security Labs Buckethead</strong> (<a href="https://github.com/RhinoSecurityLabs/Security-Research/blob/master/tools/aws-pentest-tools/s3/buckethead.py">https://github.com/RhinoSecurityLabs/Security-Research/blob/master/tools/aws-pentest-tools/s3/buckethead.py</a>) is a simple, open source tool that runs<a id="_idIndexMarker349"/> as a Python script. It’s designed to scan your organization’s Amazon S3 buckets to look for exposures and whether or not files can be uploaded to them externally and <span class="No-Break">without authorization.</span></p>
			<p>I looked at the Python script (<a href="https://github.com/RhinoSecurityLabs/Security-Research/blob/master/tools/aws-pentest-tools/s3/buckethead.py">https://github.com/RhinoSecurityLabs/Security-Research/blob/master/tools/aws-pentest-tools/s3/buckethead.py</a>). It’s only 258 lines of code. So, all you need is a command-line utility, the ability to run Python, and a connection to your organization’s <span class="No-Break">AWS network.</span></p>
			<p>What’s really nice about Rhino Security Labs Buckethead is that it can find really serious vulnerabilities without leaving a trace in your network. It probably won’t trigger your organization’s <span class="No-Break">security controls.</span></p>
			<p>User toniblyx on GitHub worked on the development of Prowler. They also have a collection of other useful AWS pentesting tools on their GitHub. They didn’t develop all of these tools themselves, but they’re all part of their “arsenal.” Here are some of my favorites (found <span class="No-Break">at </span><a href="https://github.com/toniblyx/my-arsenal-of-aws-security-tools#offensive"><span class="No-Break">https://github.com/toniblyx/my-arsenal-of-aws-security-tools#offensive</span></a><span class="No-Break">):</span></p>
			<ul>
				<li><strong class="bold">WeirdAAL</strong> (<a href="https://github.com/carnal0wnage/weirdAAL">https://github.com/carnal0wnage/weirdAAL</a>) is an AWS attack library. Yes, the README<a id="_idIndexMarker350"/> file includes a reference to “Weird Al” Yankovic. It has modules for the following <span class="No-Break">AWS components:</span><ul><li><span class="No-Break">AWS Lambda</span></li><li><span class="No-Break">CloudFront</span></li><li><span class="No-Break">CloudTrail</span></li><li><span class="No-Break">CloudWatch</span></li><li><span class="No-Break">Config</span></li><li><span class="No-Break">Data Pipeline</span></li><li><span class="No-Break">Database (local)</span></li><li><span class="No-Break">DynamoDB</span></li><li><span class="No-Break">EC2</span></li><li><span class="No-Break">ECR</span></li><li><span class="No-Break">Elastic Beanstalk</span></li><li><span class="No-Break">EMR</span></li><li><span class="No-Break">Firehose</span></li><li><span class="No-Break">IAM</span></li><li><span class="No-Break">Lightsail</span></li><li><span class="No-Break">OpsWorks</span></li><li><span class="No-Break">RDS</span></li><li><span class="No-Break">Recon</span></li><li><span class="No-Break">S3</span></li><li><span class="No-Break">SES</span></li><li><span class="No-Break">SQS</span></li></ul></li>
				<li><strong class="bold">Pacu</strong> (<a href="https://github.com/RhinoSecurityLabs/pacu">https://github.com/RhinoSecurityLabs/pacu</a>) is an entire open source AWS pentesting framework<a id="_idIndexMarker351"/> from Rhino Security Labs. It can be run<a id="_idIndexMarker352"/> from a Docker container or directly from a Linux or macOS client with Python3.7+ and pip3 support from the command line. It features a collection of 36 plugin modules to perform a variety of simulated attacks in AWS, including privilege escalation, data exfiltration, log manipulation, service exploitation, and enumeration. Each module will require your organization’s AWS access keys in order to run <span class="No-Break">its tests.</span><p class="list-inset">Pacu is designed<a id="_idIndexMarker353"/> with extensibility in mind, and it encourages other developers to contribute to the project with new modules <span class="No-Break">and improvements.</span></p></li>
				<li><strong class="bold">Cred Scanner</strong> (<a href="https://github.com/disruptops/cred_scanner">https://github.com/disruptops/cred_scanner</a>) is a Python program<a id="_idIndexMarker354"/> that can be run from the command line with Python 3.6 support. It has a simple purpose: to find AWS credentials <span class="No-Break">in files.</span></li>
				<li><strong class="bold">CloudFrunt</strong> (<a href="https://github.com/MindPointGroup/cloudfrunt">https://github.com/MindPointGroup/cloudfrunt</a>) is another useful Python<a id="_idIndexMarker355"/> command-line tool. It’s designed to find misconfigurations in <span class="No-Break">AWS CloudFront.</span></li>
				<li><strong class="bold">Redboto</strong> (<a href="https://github.com/ihamburglar/Redboto">https://github.com/ihamburglar/Redboto</a>) is a collection of scripts to aid in AWS<a id="_idIndexMarker356"/> red team engagements. It’s a series of Python files that can be installed <span class="No-Break">through pip.</span><p class="list-inset">This particular script may be the <span class="No-Break">most useful:</span></p><pre class="source-code">
"getEC2Files.py</pre><p class="list-inset">It’s certainly the most complicated script of the bunch. This script works well in conjunction with <strong class="source-inline">describeInstances.py</strong>, which gives you metadata about instances in EC2. With an API key, you can exfiltrate files from an EC2 instance. The script takes a snapshot of a target volume, spins up an instance to attach to the volume, then spins up and creates an S3 bucket. When the instance finishes launching, it encrypts and copies the chosen files to the S3 bucket, and the script pulls down from the S3 bucket and decrypts the files. The script then tears down the infrastructure that it has created, leaving only logs behind, <span class="No-Break">if enabled.</span></p></li>			</ul>
			<p>So, there you have it! The most helpful AWS pentesting tools range from complex commercial vulnerability scanners with monthly subscription fees to simple, open source Python <a id="_idIndexMarker357"/>scripts. I look forward to explaining how to use some of these tools in much greater detail in the <span class="No-Break">following chapters.</span></p>
			<h1 id="_idParaDest-79"><a id="_idTextAnchor078"/>Summary</h1>
			<p>AWS is one of the most popular cloud platforms around. You will almost certainly be expected to work with AWS applications and services as a <span class="No-Break">cloud pentester.</span></p>
			<p>AWS includes a lot of its own security controls and tools that your organization may or may not be using. It really ought to be using them, as implementing Amazon’s own security controls is a crucial cybersecurity baseline that can prevent a lot <span class="No-Break">of cyberattacks.</span></p>
			<p>Some of the many first-party AWS security applications include Amazon Inspector, AWS Security Hub, and <span class="No-Break">Amazon GuardDuty.</span></p>
			<p>There are also third-party scripts and tools that you can use to conduct vulnerability scans and pentests while abiding by Amazon’s policies. They include Prowler, Pacu, CloudFront, and <span class="No-Break">many others.</span></p>
			<p>It’s important to understand Amazon’s pentesting policies and rules and abide by them. Amazon owns all AWS infrastructure. So, even when you’re working with your organization’s AWS network, you’re metaphorically in Amazon’s home. You need to be a <span class="No-Break">considerate guest.</span></p>
			<p>In the next chapter, I’ll walk you through AWS’s security controls in greater detail. I’ll also walk you through actually using Prowler and Pacu, complete with videos. You can set up your own AWS instance to try these tools <span class="No-Break">for yourself.</span></p>
			<h1 id="_idParaDest-80"><a id="_idTextAnchor079"/>Further reading</h1>
			<p>To learn more on the topics covered in this chapter, you can visit the <span class="No-Break">following links:</span></p>
			<ul>
				<li><em class="italic">CLI (command line interface) in </em><span class="No-Break"><em class="italic">AWS</em></span><span class="No-Break">: </span><a href="https://aws.amazon.com/cli/"><span class="No-Break">https://aws.amazon.com/cli/</span></a></li>
				<li><em class="italic">AWS security products and </em><span class="No-Break"><em class="italic">services</em></span><span class="No-Break">: </span><a href="https://aws.amazon.com/products/security/"><span class="No-Break">https://aws.amazon.com/products/security/</span></a></li>
				<li><em class="italic">Prowler </em><span class="No-Break"><em class="italic">documentation</em></span><span class="No-Break">: </span><a href="https://docs.prowler.cloud"><span class="No-Break">https://docs.prowler.cloud</span></a></li>
			</ul>
		</div>
	</body></html>