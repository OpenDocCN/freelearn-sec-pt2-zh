["```\n$ xxd -g 1 log.exe | more\n0000000: 4d 5a 90 00 03 00 00 00 04 00 00 00 ff ff 00 00  MZ..............\n0000010: b8 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00  ........@.......\n0000020: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n0000030: 00 00 00 00 00 00 00 00 00 00 00 00 e8 00 00 00  ................\n```", "```\n$ file mini\nmini: PE32 executable (GUI) Intel 80386, for MS Windows\n\n$ file notepad.exe\nnotepad.exe: PE32+ executable (GUI) x86-64, for MS Windows\n```", "```\n$ python Python 2.7.12 (default, Nov 19 2016, 06:48:10) >>> import magic\n>>> m = magic.open(magic.MAGIC_NONE)\n>>> m.load()\n>>> ftype = m.file(r'log.exe')\n>>> print ftype\nPE32 executable (GUI) Intel 80386, for MS Windows\n```", "```\n$ md5sum log.exe\n6e4e030fbd2ee786e1b6b758d5897316  log.exe\n\n$ sha256sum log.exe\n01636faaae739655bf88b39d21834b7dac923386d2b52efb4142cb278061f97f  log.exe\n\n$ sha1sum log.exe\n625644bacf83a889038e4a283d29204edc0e9b65  log.exe\n```", "```\n$ python\nPython 2.7.12 (default, Nov 19 2016, 06:48:10)\n>>> import hashlib\n>>> content = open(r\"log.exe\",\"rb\").read()\n>>> print hashlib.md5(content).hexdigest()\n6e4e030fbd2ee786e1b6b758d5897316\n>>> print hashlib.sha256(content).hexdigest()\n01636faaae739655bf88b39d21834b7dac923386d2b52efb4142cb278061f97f\n>>> print hashlib.sha1(content).hexdigest()\n625644bacf83a889038e4a283d29204edc0e9b65\n```", "```\nimport urllib\nimport urllib2\nimport json\nimport sys\n\nhash_value = sys.argv[1]\nvt_url = \"https://www.virustotal.com/vtapi/v2/file/report\"\napi_key = \"<update your api key here>\"\nparameters = {'apikey': api_key, 'resource': hash_value}\nencoded_parameters = urllib.urlencode(parameters)\nrequest = urllib2.Request(vt_url, encoded_parameters)\nresponse = urllib2.urlopen(request)\njson_response = json.loads(response.read())\nif json_response['response_code']:\n    detections = json_response['positives']\n    total = json_response['total']\n    scan_results = json_response['scans']\n    print \"Detections: %s/%s\" % (detections, total)\n    print \"VirusTotal Results:\"\n    for av_name, av_data in scan_results.items():\n        print \"\\t%s ==> %s\" % (av_name, av_data['result'])\nelse:\n    print \"No AV Detections For: %s\" % hash_value\n```", "```\n$ md5sum 5340.exe\n5340fcfb3d2fa263c280e9659d13ba93 5340.exe\n```", "```\n$ python vt_hash_query.py 5340fcfb3d2fa263c280e9659d13ba93\nDetections: 44/56\nVirusTotal Results:\n  Bkav ==> None\n  MicroWorld-eScan ==> Trojan.Generic.11318045\n  nProtect ==> Trojan/W32.Agent.105472.SJ\n  CMC ==> None\n  CAT-QuickHeal ==> Trojan.Agen.r4\n  ALYac ==> Trojan.Generic.11318045\n  Malwarebytes ==> None\n  Zillya ==> None\n  SUPERAntiSpyware ==> None\n  TheHacker ==> None\n  K7GW ==> Trojan ( 001d37dc1 )\n  K7AntiVirus ==> Trojan ( 001d37dc1 )\n  NANO-Antivirus ==> Trojan.Win32.Agent.cxbxiy\n  F-Prot ==> W32/Etumbot.K\n  Symantec ==> Trojan.Zbot\n  [.........Removed..............]\n```", "```\n$ strings -a log.exe\n!This program cannot be run in DOS mode.\nRich\n.text\n`.rdata\n@.data\nL$\"%\nh4z@\n128.91.34.188\n%04d-%02d-%02d %02d:%02d:%02d %s\n```", "```\n$ strings -a spybot.exe\n!This program cannot be run in DOS mode.\n.text\n`.bss\n.data\n.idata\n.rsrc\n]_^[\nkeylog.txt\n%s (Changed window\nKeylogger Started\nHH:mm:ss]\n[dd:MMM:yyyy,\nSynFlooding: %s port: %i delay: %i times:%i.\nbla bla blaaaasdasd\nPortscanner startip: %s port: %i delay: %ssec.\nPortscanner startip: %s port: %i delay: %ssec. logging to: %s\nkuang\nsub7\n%i.%i.%i.0\nscan\nredirect %s:%i > %s:%i)\nKeylogger logging to %s\nKeylogger active output to: DCC chat\nKeylogger active output to: %s\nerror already logging keys to %s use \"stopkeylogger\" to stop\nstartkeylogger\npasswords\n```", "```\n$ strings -a -el multi.exe\nAppData\n44859ba2c98feb83b5aab46a9af5fefc\nhaixxdrekt.dyndns.hu\nTrue\nSoftware\\Microsoft\\Windows\\CurrentVersion\\Run\nSoftware\\\n.exe\nSEE_MASK_NOZONECHECKS\nnetsh firewall add allowedprogram \"\n```", "```\n$ chmod +x floss\n$ ./floss 5340.exe\nFLOSS static ASCII strings\n!This program cannot be run in DOS mode.\nRich\n.text\n`.rdata\n@.data\n[..removed..]\n\nFLOSS decoded 15 strings\nkb71271.log\nR6002\n- floating point not loaded\n\\Microsoft\nwinlogdate.exe\n~tasyd3.xls\n[....REMOVED....]\n\nFLOSS extracted 13 stack strings\nBINARY\nka4a8213.log\nafjlfjsskjfslkfjsdlkf\n'Clt\n~tasyd3.xls\n\"%s\"=\"%s\"\nregedit /s %s\n[HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run]\n[.....REMOVED......]\n```", "```\n$ strings -a spybot.exe\n[....removed....]\nEDU_Hack.exe\nSitebot.exe\nWinamp_Installer.exe\nPlanetSide.exe\nDreamweaverMX_Crack.exe\nFlashFXP_Crack.exe\nPostal_2_Crack.exe\nRed_Faction_2_No-CD_Crack.exe\nRenegade_No-CD_Crack.exe\nGenerals_No-CD_Crack.exe\nNorton_Anti-Virus_2002_Crack.exe\nPorn.exe\nAVP_Crack.exe\nzoneallarm_pro_crack.exe\n[...REMOVED...]\n209.126.201.22\n209.126.201.20\n```", "```\n$ upx -o spybot_packed.exe spybot.exe\n                       Ultimate Packer for eXecutables\n                          Copyright (C) 1996 - 2013\nUPX 3.91 Markus Oberhumer, Laszlo Molnar & John Reiser Sep 30th 2013\nFile size Ratio Format Name\n-------------------- ------ ----------- -----------\n44576 -> 21536 48.31% win32/pe spybot_packed.exe\nPacked 1 file.\n\n$ ls -al\ntotal 76\ndrwxrwxr-x 2 ubuntu ubuntu 4096 Jul 9 09:04 .\ndrwxr-xr-x 6 ubuntu ubuntu 4096 Jul 9 09:04 ..\n-rw-r--r-- 1 ubuntu ubuntu 44576 Oct 22 2014 spybot.exe\n-rw-r--r-- 1 ubuntu ubuntu 21536 Oct 22 2014 spybot_packed.exe\n```", "```\n$ strings -a spybot_packed.exe\n!This program cannot be run in DOS mode.\nUPX0\nUPX1\n.rsrc\n3.91\nUPX!\nt ;t\n/t:VU\n]^M \n9-lh\n:A$m\nhAgo .\nC@@f.\nQ*vPCi\n%_I;9\nPVh29A\n[...REMOVED...]\n```", "```\nimport pefile\nimport sys\n\nmal_file = sys.argv[1]\npe = pefile.PE(mal_file)\nif hasattr(pe, 'DIRECTORY_ENTRY_IMPORT'):\n    for entry in pe.DIRECTORY_ENTRY_IMPORT:\n        print \"%s\" % entry.dll\n        for imp in entry.imports:\n            if imp.name != None:\n                print \"\\t%s\" % (imp.name)\n            else:\n                print \"\\tord(%s)\" % (str(imp.ordinal))\n        print \"\\n\"\n```", "```\n$ python enum_imports.py spybot_packed.exe\nKERNEL32.DLL\n  LoadLibraryA\n  GetProcAddress\n  VirtualProtect\n  VirtualAlloc\n  VirtualFree\n  ExitProcess\n\nADVAPI32.DLL\n  RegCloseKey\n\nCRTDLL.DLL\n  atoi\n[...REMOVED....]\n```", "```\n$ python\nPython 2.7.12 (default, Nov 19 2016, 06:48:10)\n>>> import pefile\n>>> pe = pefile.PE(\"rmn.dll\")\n>>> if hasattr(pe, 'DIRECTORY_ENTRY_EXPORT'):\n...     for exp in pe.DIRECTORY_ENTRY_EXPORT.symbols:\n...         print \"%s\" % exp.name\n... \nAddDriverPath\nAddRegistryforME\nCleanupDevice\nCleanupDevice_EX\nCreateBridgeRegistryfor2K\nCreateFolder\nCreateKey\nCreateRegistry\nDeleteDriverPath\nDeleteOemFile\nDeleteOemInfFile\nDeleteRegistryforME\nDuplicateFile\nEditRegistry\nEnumerateDevice\nGetOS\n[.....REMOVED....]\n```", "```\nimport pefile\nimport sys\n\npe = pefile.PE(sys.argv[1])\nfor section in pe.sections:\n    print \"%s %s %s %s\" % (section.Name,\n                           hex(section.VirtualAddress),\n                           hex(section.Misc_VirtualSize),\n                           section.SizeOfRawData)\nprint \"\\n\"\n```", "```\n$ python display_sections.py olib.exe\nUPX0 0x1000 0x1f000 0\nUPX1 0x20000 0xe000 53760\n.rsrc 0x2e000 0x6000 24576\n```", "```\n>>> import pefile\n>>> import time\n>>> pe = pefile.PE(\"veri.exe\")\n>>> timestamp = pe.FILE_HEADER.TimeDateStamp\n>>> print time.strftime(\"%Y-%m-%d %H:%M:%S\",time.localtime(timestamp))\n2020-01-06 08:36:17\n```", "```\n$ ssdeep veri.exe\nssdeep,1.1--blocksize:hash:hash,filename\n49152:op398U/qCazcQ3iEZgcwwGF0iWC28pUtu6On2spPHlDB:op98USfcy8cwF2bC28pUtsRptDB,\"/home/ubuntu/Desktop/veri.exe\"\n```", "```\n$ ls\naiggs.exe jnas.exe veri.exe\n\n$ md5sum *\n48c1d7c541b27757c16b9c2c8477182b aiggs.exe\n92b91106c108ad2cc78a606a5970c0b0 jnas.exe\nce9ce9fc733792ec676164fc5b2622f2 veri.exe\n```", "```\n$ ssdeep -pb *\naiggs.exe matches jnas.exe (99)\njnas.exe matches aiggs.exe (99)\n```", "```\n$ ssdeep -lrpa samples/\nsamples//aiggs.exe matches samples//crop.exe (0)\nsamples//aiggs.exe matches samples//jnas.exe (99)\n\nsamples//crop.exe matches samples//aiggs.exe (0)\nsamples//crop.exe matches samples//jnas.exe (0)\n\nsamples//jnas.exe matches samples//aiggs.exe (99)\nsamples//jnas.exe matches samples//crop.exe (0)\n\n```", "```\n$ ssdeep * > all_hashes.txt\n$ ssdeep -m all_hashes.txt blab.exe\n/home/ubuntu/blab.exe matches all_hashes.txt:/home/ubuntu/aiggs.exe (99)\n/home/ubuntu/blab.exe matches all_hashes.txt:/home/ubuntu/jnas.exe (100)\n```", "```\n$ python\nPython 2.7.12 (default, Nov 19 2016, 06:48:10) \n>>> import ssdeep\n>>> hash1 = ssdeep.hash_from_file('jnas.exe')\n>>> print hash1\n384:l3gexUw/L+JrgUon5b9uSDMwE9Pfg6NgrWoBYi51mRvR6JZlbw8hqIusZzZXe:pIAKG91Dw1hPRpcnud\n>>> hash2 = ssdeep.hash_from_file('aiggs.exe')\n>>> print hash2\n384:l3gexUw/L+JrgUon5b9uSDMwE9Pfg6NgrWoBYi51mRvR6JZlbw8hqIusZzZWe:pIAKG91Dw1hPRpcnu+\n>>> ssdeep.compare(hash1, hash2)\n99\n>>> \n```", "```\nimport pefile\nimport sys\n\npe = pefile.PE(sys.argv[1])\nprint pe.get_imphash()\n```", "```\n$ python get_imphash.py 5340.exe\n278a52c6b04fae914c4965d2b4fdec86\n```", "```\n$ md5sum *\n3e69945e5865ccc861f69b24bc1166b6 maxe.exe\n1f92ff8711716ca795fbd81c477e45f5 sent.exe\n\n$ python get_imphash.py samples/maxe.exe\nb722c33458882a1ab65a13e99efe357e\n$ python get_imphash.py samples/sent.exe\nb722c33458882a1ab65a13e99efe357e\n```", "```\n>>> import pefile\n>>> pe = pefile.PE(\"5340.exe\")\n>>> for section in pe.sections:\n...     print \"%s\\t%s\" % (section.Name, section.get_hash_md5())\n... \n.text b1b56e7a97ec95ed093fd6cfdd594f6c\n.rdata a7dc36d3f527ff2e1ff7bec3241abf51\n.data 8ec812e17cccb062515746a7336c654a\n.rsrc 405d2a82e6429de8637869c5514b489c\n```", "```\nrule suspicious_strings\n{ \nstrings:\n    $a = \"Synflooding\"\n    $b = \"Portscanner\"\n    $c = \"Keylogger\"\n\ncondition:\n    ($a or $b or $c)\n}\n```", "```\n$ yara -r suspicious.yara samples/\nsuspicious_strings samples//spybot.exe\nsuspicious_strings samples//wuamqr.exe\n```", "```\nrule suspicious_strings\n{\nstrings:\n    $a = \"Synflooding\" ascii wide nocase\n    $b = \"Portscanner\" ascii wide nocase\n    $c = \"Keylogger\"   ascii wide nocase\ncondition:\n    ($a or $b or $c)\n}\n```", "```\n$ yara suspicious.yara samples/\nsuspicious_strings samples//test.doc\nsuspicious_strings samples//spybot.exe\nsuspicious_strings samples//wuamqr.exe\n```", "```\nrule suspicious_strings\n{\nstrings:\n    $mz = {4D 5A}\n    $a = \"Synflooding\" ascii wide nocase\n    $b = \"Portscanner\" ascii wide nocase\n    $c = \"Keylogger\" ascii wide nocase\ncondition:\n    ($mz at 0) and ($a or $b or $c)\n}\n```", "```\n$ yara -r suspicious.yara samples/\nsuspicious_strings samples//spybot.exe\nsuspicious_strings samples//wuamqr.exe\n```", "```\nrule embedded_office_document\n{\nmeta:\ndescription = \"Detects embedded office document\"\n\nstrings:\n    $mz = { 4D 5A }\n    $a = { D0 CF 11 E0 A1 B1 1A E1 }\ncondition:\n    ($mz at 0) and $a in (1024..filesize)\n}\n```", "```\n$ yara -r embedded_doc.yara samples/\nembedded_office_document samples//5340.exe\n```", "```\nrule mal_digital_cert_9002_rat\n{\nmeta:\n    description = \"Detects malicious digital certificates used by RAT 9002\"\n    ref = \"http://blog.cylance.com/another-9002-trojan-variant\"\n\nstrings:\n    $mz = { 4D 5A }\n    $a = { 45 6e 96 7a 81 5a a5 cb b9 9f b8 6a ca 8f 7f 69 }\n\ncondition:\n    ($mz at 0) and ($a in (1024..filesize))\n}\n```", "```\n$ yara -r digi_cert_9002.yara samples/\nmal_digital_cert_9002_rat samples//ry.dll\nmal_digital_cert_9002_rat samples//rat9002/Mshype.dll\nmal_digital_cert_9002_rat samples//rat9002/bmp1f.exe\n```", "```\n[UPX 2.90 (LZMA)]\nsignature = 60 BE ?? ?? ?? ?? 8D BE ?? ?? ?? ?? 57 83 CD FF EB 10 90 90 90 90 90 90 8A 06 46 88 07 47 01 DB 75 07 8B 1E 83 EE FC 11 DB 72 ED B8 01 00 00 00 01 DB 75 07 8B 1E 83 EE FC 11 DB 11 C0 01 DB\nep_only = true\n```", "```\nimport \"pe\"\nrule UPX_290_LZMA\n{\nmeta:\n    description = \"Detects UPX packer 2.90\"\n    ref = \"userdb.txt file from the Exeinfo PE\"\n\nstrings:\n    $a = { 60 BE ?? ?? ?? ?? 8D BE ?? ?? ?? ?? 57 83 CD FF EB 10 90 90 90 90 90 90 8A 06 46 88 07 47 01 DB 75 07 8B 1E 83 EE FC 11 DB 72 ED B8 01 00 00 00 01 DB 75 07 8B 1E 83 EE FC 11 DB 11 C0 01 DB }\n\ncondition:\n    $a at pe.entry_point\n} \n```", "```\nrule UPX_290_LZMA\n{\nmeta:\n    description = \"Detects UPX packer 2.90\"\n    ref = \"userdb.txt file from the Exeinfo PE\"\n\nstrings:\n    $a = { 60 BE ?? ?? ?? ?? 8D BE ?? ?? ?? ?? 57 83 CD FF EB 10 90 90 90 90 90 90 8A 06 46 88 07 47 01 DB 75 07 8B 1E 83 EE FC 11 DB 72 ED B8 01 00 00 00 01 DB 75 07 8B 1E 83 EE FC 11 DB 11 C0 01 DB }\n\ncondition:\n    $a at entrypoint\n} \n```", "```\n$ yara upx_test_new.yara samples/\nUPX_290_LZMA samples//olib.exe\nUPX_290_LZMA samples//spybot_packed.exe\n```", "```\nrule Gh0stRat_communications\n{\nmeta:\nDescription = \"Detects the Gh0stRat communication in Packet Captures\"\n\nstrings:\n$gst1 = {47 68 30 73 74 ?? ?? 00 00 ?? ?? 00 00 78 9c}\n$gst2 = {63 62 31 73 74 ?? ?? 00 00 ?? ?? 00 00 78 9c}\n$gst3 = {30 30 30 30 30 30 30 30 ?? ?? 00 00 ?? ?? 00 00 78 9c}\n$gst4 = {45 79 65 73 32 ?? ?? 00 00 ?? ?? 00 00 78 9c}\n$gst5 = {48 45 41 52 54 ?? ?? 00 00 ?? ?? 00 00 78 9c}\n$any_variant = /.{5,16}\\x00\\x00..\\x00\\x00\\x78\\x9c/\n\ncondition:\nany of ($gst*) or ($any_variant)\n}\n```", "```\n$ yara ghost_communications.yara pcaps/\nGh0stRat_communications pcaps//Gh0st.pcap\nGh0stRat_communications pcaps//cb1st.pcap\nGh0stRat_communications pcaps//HEART.pcap\n```", "```\nrule Darkmegi_Rootkit\n{\nmeta:\nDescription = \"Detects the kernel mode Driver and Dll component of Darkmegi/waltrodock rootkit\"\n\nstrings:\n$drv_str1 = \"com32.dll\"\n$drv_str2 = /H:\\\\RKTDOW~1\\\\RKTDRI~1\\\\RKTDRI~1\\\\objfre\\\\i386\\\\RktDriver.pdb/\n$dll_str1 = \"RktLibrary.dll\"\n$dll_str2 = /\\\\\\\\.\\\\NpcDark/\n$dll_str3 = \"RktDownload\"\n$dll_str4 = \"VersionKey.ini\"\n\ncondition:\n(all of them) or (any of ($drv_str*)) or (any of ($dll_str*))\n}\n```", "```\n$ yara darkmegi.yara samples/\nDarkmegi_Rootkit samples//63713B0ED6E9153571EB5AEAC1FBB7A2\nDarkmegi_Rootkit samples//E7AB13A24081BFFA21272F69FFD32DBF-\nDarkmegi_Rootkit samples//0FC4C5E7CD4D6F76327D2F67E82107B2\nDarkmegi_Rootkit samples//B9632E610F9C91031F227821544775FA\nDarkmegi_Rootkit samples//802D47E7C656A6E8F4EA72A6FECD95CF\nDarkmegi_Rootkit samples//E7AB13A24081BFFA21272F69FFD32DBF\n[......................REMOVED..............................]\n```"]