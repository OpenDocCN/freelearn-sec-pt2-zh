<html><head></head><body><div class="chapter" title="Chapter&#xA0;5.&#xA0;Working with Other Platforms"><div class="titlepage"><div><div><h1 class="title"><a id="ch05"/>Chapter 5. Working with Other Platforms</h1></div></div></div><p>In this chapter, we will cover:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Setting up the Blackberry development environment and simulator</li><li class="listitem" style="list-style-type: disc">Setting up the Blackberry pentesting environment</li><li class="listitem" style="list-style-type: disc">Setting up the Windows phone development environment and simulator</li><li class="listitem" style="list-style-type: disc">Setting up the Windows phone pentesting environment</li><li class="listitem" style="list-style-type: disc">Configuring traffic interception settings for Blackberry phones</li><li class="listitem" style="list-style-type: disc">Stealing data from Windows phones applications</li><li class="listitem" style="list-style-type: disc">Stealing data from Blackberry applications</li><li class="listitem" style="list-style-type: disc">Reading local data in Windows phone</li><li class="listitem" style="list-style-type: disc">NFC-based attacks</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec50"/>Introduction</h1></div></div></div><p>In this chapter, we will introduce other mobile platforms. So far we have focused on Android and iOS platforms in this book. Here we take an opportunity to introduce Blackberry and Windows Phone as next popular mobile platforms.</p><p>Blackberry has been the favorite mobile of Enterprise users for a long time. Though the Blackberry market share has reduced in SmartPhone segment, it still has got the usage to be introduced and discussed in this book. QWERTY keypads used to differentiate earlier Blackberry phones.</p><p>Windows Mobiles are picking up with an increased number of users opting for the same. Windows 7 and 8 have been a success and successive phones are planned to bring about more innovations. The vertical swipe movement of screens differentiates the Windows mobiles.</p><p>The most common aspects to learn for mobile platforms are setting up development and pentest environments and learning about simulators, traffic interception setup, and reading/stealing data from these phones. So let us gear ourselves up to learn these for Blackberry and Windows platforms in this bonus chapter. Also there is a bonus recipe on <span class="strong"><strong>Near Field Communication</strong></span> (<span class="strong"><strong>NFC</strong></span>) based attacks.</p></div></div>
<div class="section" title="Setting up the Blackberry development environment and simulator"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec51"/>Setting up the Blackberry development environment and simulator</h1></div></div></div><p>To start learning any new mobile platform, you should follow the mentioned sequence:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Learn to setup the <span class="strong"><strong>Integrated Development Environment</strong></span> (<span class="strong"><strong>IDE</strong></span>)</li><li class="listitem" style="list-style-type: disc">Learn programming language and to code apps</li><li class="listitem" style="list-style-type: disc">Learn the simulators and emulators to debug the apps</li><li class="listitem" style="list-style-type: disc">Setup the pentest environment</li><li class="listitem" style="list-style-type: disc">Learn pentesting aspects in the (current) mobile platform</li></ul></div><p>Download the Momentics IDE for <span class="strong"><strong>Blackberry</strong></span> (<span class="strong"><strong>BB</strong></span>). Install it and setup the IDE. It can connect to both Blackberry Phones and Blackberry Simulators.</p><p>Here onwards we focus on Blackberry Simulators.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec176"/>Getting ready</h2></div></div></div><p>Download the <span class="strong"><strong>Blackberry Device 10 Simulator</strong></span>. We have used Windows OS for the same. The corresponding Simulator can be downloaded from: 
<a class="ulink" href="http://developer.blackberry.com/develop/simulator/simulator_installing.html">http://developer.blackberry.com/develop/simulator/simulator_installing.html</a>

</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec177"/>How to do it...</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Run the installer file; it will guide you through the installation steps. Once the installation completes, you get a screen as follows:<p>
</p><div class="mediaobject"><img src="graphics/image_05_001.jpg" alt="How to do it..."/></div><p>
</p></li><li class="listitem">Next, locate and run <code class="literal">runBB10Simulator.bat</code> file. Post running the bat file, the listening component gets started for Blackberry Simulator.</li><li class="listitem">Now locate the VMware file <code class="literal">BlackBerry10Simulator.vmx</code> and start the VMware. The VMware image boots up and a simulator starts for you, as follows:<p>
</p><div class="mediaobject"><img src="graphics/image_05_002.jpg" alt="How to do it..."/></div><p>
</p></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec178"/>How it works...</h2></div></div></div><p>The batch file is a listening component for the Blackberry Simulators. It is compulsory to run the batch file, without which Blackberry Simulator will not run. Note that the batch file DOS window needs to be open till the time BB10 Simulator is in use.</p><p>BB10 Simulator starts in the virtual machine image. It can be configured as per our requirements. Please refer to the BB10 simulator user guide mentioned under the <span class="emphasis"><em>See also</em></span> section of this recipe.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec179"/>There's more...</h2></div></div></div><p>Momentics IDE can be used to connect to BB phones or BB Simulators. This completes the development environment and its runtime integration. Applications can be developed in IDE and can be debugged or run in a linked device or simulator.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec180"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><a class="ulink" href="https://developer.blackberry.com/devzone/files/develop/simulator/BB10_Device_Simulator_UG.pdf">https://developer.blackberry.com/devzone/files/develop/simulator/BB10_Device_Simulator_UG.pdf</a></li></ul></div></div></div>
<div class="section" title="Setting up the Blackberry pentesting environment"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec52"/>Setting up the Blackberry pentesting environment</h1></div></div></div><p>Once you are familiar with Blackberry as a platform, simulators, and/or phone, get into the mood of penetration testing. Penetration testing for mobile application, can be broadly classified under four categories:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Mobile application traffic related attacks</li><li class="listitem" style="list-style-type: disc">Mobile device storage-related attacks</li><li class="listitem" style="list-style-type: disc">Mobile application source code-related attacks</li><li class="listitem" style="list-style-type: disc">Attacks involving mobile OS features used by mobile applications</li></ul></div><p>A lab for pentesting should be well equipped with basic necessities to cater for the preceding four categorical needs.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec181"/>Getting ready</h2></div></div></div><p>We have to set up a lab for Blackberry pentesting. To get going, we need the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Blackberry IDE</li><li class="listitem" style="list-style-type: disc">Blackberry phones</li><li class="listitem" style="list-style-type: disc">Blackberry simulators</li><li class="listitem" style="list-style-type: disc">Proxy tools such as Charles, Burp Suite, and Fiddler</li><li class="listitem" style="list-style-type: disc">A Wi-Fi network</li><li class="listitem" style="list-style-type: disc">Blackberry backup tools</li><li class="listitem" style="list-style-type: disc">A data cable</li><li class="listitem" style="list-style-type: disc">Decompiler tools</li></ul></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec182"/>How to do it...</h2></div></div></div><p>Let us see how each of these tools help:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Blackberry IDE</strong></span>: This IDE is needed majorly for code review assignments. The code of the BB apps can be analyzed to discover any insecurity from the development-generic or business logic errors. This step is usually not required in case of pure pentest-based assignments. Installation of the Blackberry IDE is covered in the previous recipe.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Blackberry phones</strong></span>: Run-time applications have to be tested. BB phones are needed to install and run the app to be able to do the pentest.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Blackberry simulators</strong></span>: Simulators also provide a runtime environment for debugging and pentesting purposes. Simulators are life savers; when the phones of specific versions are not available, we can switch over to the simulator of that particular version. However, if RAM or disk space is limited, Simulators may be slow and may become difficult to use. Blackberry Simulators get installed as part of an IDE; this we have learnt in previous recipes.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Proxy tools such as Charles, Burp Suite, and Fiddler</strong></span>: Various proxy tools can be downloaded from their websites. These are quite straightforward and there are guides and help forums about those as well. These tools are easy to install; just download the installer from the respective websites and a few clicks will make the tool ready to use.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>A Wi-Fi network</strong></span>: We need a Wi-Fi network for interception of Wi-Fi traffic. We will later set up a proxy for mobile devices to a laptop running proxy tools, both on the same Wi-Fi network.<p>Either you can use a Wi-Fi router to set up your personal Wi-Fi network or you can use one of the free tools available to create a hotspot from your laptop. In our experience, it is sometimes difficult to work with the latter option, so we suggest using the first option.</p></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Blackberry backup tools</strong></span>: Tools to take Blackberry backups and extract or mine data from the backup. Traditionally, data stored on the BB phone has been difficult to steal. This can be overcome by taking a phone backup from the phone that and mining the data from backup.<p>Tools such as Blackberry Extractor or BlackBerry Backup Extractor are helpful in this regard.</p></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Data cable</strong></span>: It is also important to own a data cable. Later we will use it to connect to the phone to read data and to conduct attacks originating via USB.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Decompiler tools</strong></span>: It is also important that these tools are ready in our lab. These small tools help us in the decompilation of applications. We will use a tool called Coddec in a recipe to follow in this chapter. There we will cover the installation and usage of this tool.</li></ul></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec183"/>How it works...</h2></div></div></div><p>With the tools ready at our Pentest lab, let us see how we can link the penetration testing use cases to different categories while using the tools:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Mobile application traffic-related attacks</strong></span>: This is where the Wi-Fi network and proxy tools are going to come in handy. A laptop with Charles or Burp proxy installed is connected to Wi-Fi. A mobile device running the application is directed to the laptop proxy, using proxy configuration on the device. Since both laptop and mobile device are on the same Wi-Fi network, application traffic gets routed via Charles or Burp proxy tools. Configure the appropriate proxy settings in the simulator or phone to be able to route the traffic to Charles or Burp proxy tools.<p>Effectively this whole process makes application traffic readable and editable via proxy tools and we can conduct various attacks such as parameter manipulation to bypass business logics or to gain privilege access.</p></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Mobile device storage-related attacks</strong></span>: We have a data cable to connect the phone to the laptop. We have the Simulator on the laptop. Both of them can run mobile applications. Use Blackberry desktop software to connect the phone to the laptops. This channel can lead to data stealing attacks such as directly reading the phone data or taking the backup of phone for offline data mining.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Mobile application source code-related attacks</strong></span>: Decompiling the BB applications results in the raw source code. The Coddec tool can be used for this purpose. The hardcoded sensitive data present in the application source code is revealed.</li></ul></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec184"/>There's more...</h2></div></div></div><p>Attacks involving mobile OS features used by mobile application is the most complicated category. There are various BB OS related features which applications interact with such as Bluetooth, NFC, intents, broadcast receivers, and so on. These also need to be covered in an offensive penetration test.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec185"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://us.blackberry.com/software/desktop.html">http://us.blackberry.com/software/desktop.html</a></li><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://www.blackberryextractor.com/">http://www.blackberryextractor.com/</a></li></ul></div></div></div>
<div class="section" title="Setting up the Windows phone development environment and simulator"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec53"/>Setting up the Windows phone development environment and simulator</h1></div></div></div><p>As we learned previously, to start with a new mobile platform, we have to follow this sequence:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Learn to set up the integrated development environment</li><li class="listitem" style="list-style-type: disc">Learn programming language and to code apps</li><li class="listitem" style="list-style-type: disc">Learn the simulators and emulators to debug the apps</li><li class="listitem" style="list-style-type: disc">Set up the pentest environment</li><li class="listitem" style="list-style-type: disc">Learn pentesting aspects in the (current) mobile platform</li></ul></div><p>Visual Studio has been the development framework for Windows apps.</p><p>Since Windows 10, <span class="strong"><strong>Universal Windows Platform</strong></span> (<span class="strong"><strong>UWP</strong></span>) is used for application development. UWP apps as the name suggests can run on any type of Windows platform (tablets, phones, and desktops).</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec186"/>Getting ready</h2></div></div></div><p>Download the Windows Phone SDK from the repository at 
<a class="ulink" href="https://dev.windows.com/en-us/downloads/sdk-archive">https://dev.windows.com/en-us/downloads/sdk-archive</a>
.</p><p>Emulators can also be downloaded from the same repository. For Universal Windows App, SDK, and emulator download links are present in the top section of the above mentioned repository link.</p><p>We used Windows 8.1 SDK and Emulator in this recipe.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec187"/>How to do it...</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Download the Windows 8.1 SDK from <a class="ulink" href="http://go.microsoft.com/fwlink/p/?LinkId=323507">http://go.microsoft.com/fwlink/p/?LinkId=323507</a>.</li><li class="listitem">Run the installer file; it will guide you through the installation steps. The following screen allows you to choose the features you want to install:<p>
</p><div class="mediaobject"><img src="graphics/image_05_003.jpg" alt="How to do it..."/></div><p>
</p></li><li class="listitem">Once the installation completes, the <span class="strong"><strong>Welcome to the Windows Software Development Kit for Windows 8.1</strong></span> message is displayed.</li><li class="listitem">Now go ahead and download and install the Windows 8.1 Emulator from:<p>
<a class="ulink" href="https://www.microsoft.com/en-us/download/details.aspx?id=43719">https://www.microsoft.com/en-us/download/details.aspx?id=43719</a>
</p></li><li class="listitem">The emulator can be launched using <code class="literal">xde.exe</code>. Once the initial set of preferences are selected, the emulator window launches and you now have the Windows application development and runtime environment created.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec188"/>How it works...</h2></div></div></div><p>Development work in Windows 8.1 requires SDK, Emulator, and .Net Framework. The applications can be coded in Windows 8.1 and can be run in Emulator. Alternatively, precoded applications and built applications can be run independently in the Emulator. This is possible because Emulators can also be launched outside the SDK as Hyper-V VM and runs as a VHD.</p><p>With Microsoft promoting <span class="strong"><strong>Universal Windows Platform</strong></span> (<span class="strong"><strong>UWP</strong></span>) on Windows 10, development is expected to migrate to Windows 10 and UWP. It makes sense to code applications once and use them in multiple places such as phone, tablets, and desktops. UWP is expected to change the whole Windows application development landscape.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec189"/>There's more...</h2></div></div></div><p>Once you are through with the SDK and Emulator, it is time to code the first application. It is suggested that readers try out coding basic apps in Windows 8.1 or in Windows 10 UWP platform to gain better familiarity with platform specifics. The Microsoft website itself is a very good place to start for first apps as they provide sample code for learning purposes. The link for the sample application is mentioned under the <span class="emphasis"><em>See also</em></span> section of this recipe.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec190"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://insidethecloudos.azurewebsites.net/running-windows-8-1-phone-emulator-outside-of-visual-studio-2013-and-2015/">http://insidethecloudos.azurewebsites.net/running-windows-8-1-phone-emulator-outside-of-visual-studio-2013-and-2015/</a></li><li class="listitem" style="list-style-type: disc"><a class="ulink" href="https://channel9.msdn.com/Series/Windows-Phone-8-1-Development-for-Absolute-Beginners/Part-11-Working-with-the-Windows-Phone-8-1-Emulator">https://channel9.msdn.com/Series/Windows-Phone-8-1-Development-for-Absolute-Beginners/Part-11-Working-with-the-Windows-Phone-8-1-Emulator</a></li><li class="listitem" style="list-style-type: disc"><a class="ulink" href="https://dev.windows.com/en-us/samples">https://dev.windows.com/en-us/samples</a></li></ul></div></div></div>
<div class="section" title="Setting up the Windows phone pentesting environment"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec54"/>Setting up the Windows phone pentesting environment</h1></div></div></div><p>Once you gain the basics of Windows platform SDK, emulators and phones, it is the time to get ready to do penetration testing. As you have learned previously, for Windows also, we will analyze penetration testing under four broad categories:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Mobile Application Traffic related attacks</li><li class="listitem" style="list-style-type: disc">Mobile Device Storage related attacks</li><li class="listitem" style="list-style-type: disc">Mobile Application Source Code related attacks</li><li class="listitem" style="list-style-type: disc">Attacks involving mobile OS features used by mobile application</li></ul></div><p>The Windows platform pentest lab also needs to be well equipped with basic necessities to cater for the preceding four categorical needs.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec191"/>Getting ready</h2></div></div></div><p>We have to set up a lab for Windows mobile pentesting. To get going, we need the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Windows phone SDK</li><li class="listitem" style="list-style-type: disc">Windows mobiles or tablets</li><li class="listitem" style="list-style-type: disc">Windows phone emulators</li><li class="listitem" style="list-style-type: disc">Proxy tools such as Charles, Burp Suite, and Fiddler</li><li class="listitem" style="list-style-type: disc">A Wi-Fi network</li><li class="listitem" style="list-style-type: disc">A data cable</li></ul></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec192"/>How to do it...</h2></div></div></div><p>Let us see how each of these tools help:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Windows phone SDK</strong></span>: This SDK is needed majorly for code review assignments. The code of the Windows apps can be analyzed to discover any insecurity from the development - generic or business logic errors. This step is usually not required in case of pure pentest based assignments.<p>Also Windows SDK may come in handy for reading code files stolen from the packaged app. We have set up Windows phone SDK in the previous recipe.</p></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Windows mobiles/tablets</strong></span>: Run time applications have to be tested. Windows mobiles and tablets are needed to install and run the app to be able to do the pentest.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Windows phone emulators</strong></span>: Emulators also provide runtime environments for debugging and pentesting purposes. The emulators are life savers; when the phones of specific versions are not available, we can switch over to Emulator of that particular version. The emulator is accessible by launching <code class="literal">xde.exe</code> from the SDK installation.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Proxy tools such as Charles, Burp Suite, and Fiddler</strong></span>: Various proxy tools can be downloaded from their websites. These are quite straightforward and there are guides and help forums about those as well. These tools are easy to install; just download the installer from the respective websites and a few clicks will make the tool ready to use. A Wi-Fi network: We need a Wi-Fi network for interception of Wi-Fi traffic. We will later set up a proxy for mobile devices to a laptop running proxy tools, both on the same Wi-Fi network.<p>Either you can use a Wi-Fi router to set up your personal Wi-Fi network or you can use one of the free tools available to create a hotspot from your laptop. In our experience, it is sometimes difficult to work with the latter option, so we prefer using the first option.</p></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Data cable</strong></span>: It is also important to own a data cable. Later we will use it to connect to the phone to read data and to conduct attacks originating via USB.</li></ul></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec193"/>How it works...</h2></div></div></div><p>With the tools ready at our Pentest lab, let us see how we can link the penetration testing use cases to different categories while using the tools:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Mobile application traffic-related attacks</strong></span>: A Wi-Fi network and proxy tools are used to attack mobile application traffic. A laptop with Charles or Burp proxy installed is connected to Wi-Fi. A mobile device running the application is directed to the laptop proxy, using proxy configuration on the device. Since both laptop and mobile device are on the same Wi-Fi network, application traffic gets routed via Charles or Burp proxy tools. Configure the appropriate proxy settings in the emulator or phone to be able to route the traffic to Charles or Burp proxy tools. Now the traffic can be tampered with the proxy tools and it is possible to conduct parameter manipulation, and injection kinds of attack.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Mobile device storage-related attacks</strong></span>: We have a data cable to connect the phone to the laptop. We have the emulator on the laptop. Both of them can run mobile applications. Use WP Power tools to connect the phone to the laptops. This channel can lead to data stealing attacks such as directly reading or tampering the phone data. We will demonstrate this in the last but one recipe of this chapter.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Mobile application source code-related attacks</strong></span>: Using SDK and other decompiler tools, raw source code of the Windows phone application can be obtained. This step is performed to uncover the hardcoded sensitive data or sensitive business logic coded in the client-side mobile application source code.</li></ul></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec194"/>There's more...</h2></div></div></div><p>Attacks involving mobile OS features used by mobile applications is the most complicated category. There are various Windows OS related features which applications interact with such as Bluetooth, NFC, intents, broadcast receivers, and so on. These also need to be covered in an offensive penetration test.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec195"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://pen-testing.sans.org/blog/2011/10/28/mobile-application-assessments-part-2-a-look-at-windows-mobile">http://pen-testing.sans.org/blog/2011/10/28/mobile-application-assessments-part-2-a-look-at-windows-mobile</a></li><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://resources.infosecinstitute.com/windows-phone-digital-forensics-2/">http://resources.infosecinstitute.com/windows-phone-digital-forensics-2/</a></li><li class="listitem" style="list-style-type: disc"><a class="ulink" href="https://www.securityninja.co.uk/application-security/windows-phone-app-analyser-v1-0-released-today-2/">https://www.securityninja.co.uk/application-security/windows-phone-app-analyser-v1-0-released-today-2/</a></li></ul></div></div></div>
<div class="section" title="Configuring traffic interception settings for Blackberry phones"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec55"/>Configuring traffic interception settings for Blackberry phones</h1></div></div></div><p>Traditionally, Blackberry phones never used to provide an option to set up a proxy to the users. There was no option to specify proxy settings (proxy IP address and port number). Because of this, we cannot set a proxy to these phones. However, for testing purposes we used Simulator and set a proxy and conducted our testing. Let us now learn how to set a proxy to the Blackberry simulator.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec196"/>Getting ready</h2></div></div></div><p>We need to get our environment ready first. This recipe requires that any of the following be installed on the test machine:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>MDS server with Blackberry simulator</strong></span>: Use the combination of MDS and Blackberry simulator to simulate the connection services of <span class="strong"><strong>Blackberry Enterprise server</strong></span> (<span class="strong"><strong>BES</strong></span>).</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Blackberry 10 simulator</strong></span>: Use the Blackberry 10 simulator as a standalone device. Previously in this book, we learned about Blackberry 10 simulators.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Blackberry phone devices</strong></span>: Proxy can be set on Blackberry 10 phones as well.</li></ul></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec197"/>How to do it...</h2></div></div></div><p>The installation can be done using two of the following methods.</p><div class="section" title="Case 1 - Using MDS server and Blackberry simulator"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl3sec8"/>Case 1 - Using MDS server and Blackberry simulator</h3></div></div></div><p>This combination comes in handy when simulating a BES server kind of environment. The proxy settings have to be made via changes in the MDS server's configuration file. This configuration file is responsible for network connections and hence the traffic from the device gets routed via a specified proxy.</p><p>Here are the configurations required in the MDS server's configurations:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Locate the <code class="literal">rimpublic.property</code> file in the installation directory. We found the path at our end, <code class="literal">C:\Program Files\Research In Motion\Blackberry JDE 5.0.0\MDS\config</code>.</li><li class="listitem">In the <code class="literal">rimpublic.property</code> file, navigate to the <code class="literal">[HTTP_HANDLER]</code> section and modify this section by adding the proxy configuration specification lines as follows:<pre class="programlisting">application.handler.http.proxyEnabled= true &#13;
application.handler.http.proxyHost= localhost &#13;
application.handler.http.proxyPort= 9999 &#13;
</pre></li></ol></div></div><div class="section" title="Case 2 - Blackberry 10 simulators"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl3sec9"/>Case 2 - Blackberry 10 simulators</h3></div></div></div><p>Assuming that you have followed the <span class="emphasis"><em>Setting up the Blackberry Development Environment and Simulator</em></span> recipe and have the setup ready, you are all set for the current recipe:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Search for network connections and locate <span class="strong"><strong>Networks and Connections</strong></span> under <span class="strong"><strong>System Settings</strong></span>. Your Simulator screen should look similar to the following screenshot:<p>
</p><div class="mediaobject"><img src="graphics/image_05_004.jpg" alt="Case 2 - Blackberry 10 simulators"/></div><p>
</p></li><li class="listitem">Now go ahead with <span class="strong"><strong>Networks and Connections</strong></span> and add your device to the available Wi-Fi network of the lab setup.</li><li class="listitem">Under the connecting SSID settings, configure proxy details such as <span class="strong"><strong>Proxy Server*</strong></span>, <span class="strong"><strong>Proxy Port</strong></span>, <span class="strong"><strong>Username</strong></span>, and <span class="strong"><strong>Password</strong></span> (if applicable), in the following screen:<p>
</p><div class="mediaobject"><img src="graphics/image_05_005.jpg" alt="Case 2 - Blackberry 10 simulators"/></div><p>
</p></li></ol></div><p>This would connect the Simulator to the proxy tool via Wi-Fi and now you can tamper the application traffic.</p></div><div class="section" title="Case 3 - Blackberry 10 phones"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl3sec10"/>Case 3 - Blackberry 10 phones</h3></div></div></div><p>Follow similar steps as in Case 2 on the Blackberry phone instead of the simulator. Your phone should start sending application traffic via HTTP proxy tools.</p></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec198"/>How it works...</h2></div></div></div><p>Now let us see how interception works. First, we need to configure Burp proxy to run on <code class="literal">9999</code>. The following screenshot shows how the interface should look after it is configured to run on <code class="literal">9999</code>. Change the default port number of Burp proxy by clicking on the <span class="strong"><strong>Edit</strong></span> button and update the port number field with <code class="literal">9999</code>. Once you click on the <span class="strong"><strong>OK</strong></span> button, the <span class="strong"><strong>Proxy Listeners</strong></span> tab looks as shown in the following screenshot:</p><p>
</p><div class="mediaobject"><img src="graphics/image_05_006.jpg" alt="How it works..."/></div><p>
</p><p>Now that Blackberry Simulator and Burp Proxy is working, the application traffic can be captured and edited. Various web application-related attacks can be done now by manipulating the application traffic.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec199"/>There's more...</h2></div></div></div><p>Try different proxy tools:</p><p>In our experience, we have noted that sometimes some proxies cannot handle all mobile app traffic. Generally, it is a good idea to switch proxy tools if application capture does not work. Usually Burp Suite and Charles Proxy are able to handle most types of mobile application traffic.</p><p>Also Burp Proxy's default <code class="literal">8080</code> port creates a conflict with MDS, which is why we used port <code class="literal">9999</code> in our configurations. Using Charles Proxy, the default port is <code class="literal">8888</code> which means you will not face the MDS conflict by-default.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec200"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://supportforums.blackberry.com/t5/Testing-and-Deployment/Configure-the-BlackBerry-MDS-Simulator-to-work-behind-a-proxy/ta-p/446115">http://supportforums.blackberry.com/t5/Testing-and-Deployment/Configure-the-BlackBerry-MDS-Simulator-to-work-behind-a-proxy/ta-p/446115</a></li><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://prashantverma21.blogspot.in/2011/12/setting-up-proxy-for-blackberry.html">http://prashantverma21.blogspot.in/2011/12/setting-up-proxy-for-blackberry.html</a></li></ul></div></div></div>
<div class="section" title="Stealing data from Windows phones applications"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec56"/>Stealing data from Windows phones applications</h1></div></div></div><p>Stealing data from the application source code residing on the phone is an important attack vector. OWASP Mobile Top 10 puts it up as M10: Lack of Binary Protection. Reverse engineering the mobile application to obtain the decompiled source code and then mining the data hardcoded in the application may result in sensitive data revealing. At times developers tend to hardcode connection strings, passwords, keys, or access tokens in the application.</p><p>This recipe performs decompiling to steal data from Windows Phone apps which are in <code class="literal">.xap</code> format.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec201"/>Getting ready</h2></div></div></div><p>The tool to convert the <code class="literal">.dll</code> to a <code class="literal">.cs</code> or <code class="literal">.vb</code> project file is shown as following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>ILSpy</strong></span>: ILSpy is a very useful open source tool to decompile and manipulate .NET apps. We will use it to convert DLL files to the original <code class="literal">.cs</code> or <code class="literal">.vb</code> files.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Decompresser tool</strong></span>: Winrar/WinZip/7zip</li></ul></div><p>
</p><div class="mediaobject"><img src="graphics/image_05_007.jpg" alt="Getting ready"/></div><p>
</p><p>Windows Market applications are <span class="strong"><strong>Digital Rights Management</strong></span> (<span class="strong"><strong>DRM</strong></span>) protected and it may not be easy to obtain DLLs just by uncompressing the file:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Study the contents of the application package and note the <code class="literal">.dll</code> file present:<p>
</p><div class="mediaobject"><img src="graphics/image_05_008.jpg" alt="Getting ready"/></div><p>
</p></li><li class="listitem">Now use ILSpy to decompile the DLL file and obtain the original source code. In the ILSpy console, go to <span class="strong"><strong>Open</strong></span> under <span class="strong"><strong>File</strong></span> menu and provide the path of the DLL file to be decompiled:<p>
</p><div class="mediaobject"><img src="graphics/image_05_009.jpg" alt="Getting ready"/></div><p>
</p></li><li class="listitem">The result of this process is the entire application source code (a snippet of which is shown in the following screenshot). The source code can now be searched for hardcoded secrets such as keys, passwords, PIN, and so on:<p>
</p><div class="mediaobject"><img src="graphics/image_05_010.jpg" alt="Getting ready"/></div><p>
</p></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec202"/>How it works...</h2></div></div></div><p>The Windows Phone compiler suite compiles the developer's .net files into DLL object code files, and then the <code class="literal">.dll</code> files are converted into <code class="literal">.xap</code> files. XAP are Silverlight or Windows phone compatible applications.</p><p>The main objective of this method is to get hold of the intermediate <code class="literal">.dll</code> file and then use a <code class="literal">.net</code> decompiler to decompile the same and obtain a project file. We did this in two steps discussed:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The XAP file is analyzed and DLL is obtained.</li><li class="listitem" style="list-style-type: disc">ILSpy is used to obtain decompiled source code from the DLL file.</li></ul></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec203"/>There's more...</h2></div></div></div><p>Source code is available in decompiled format. What next?</p><p>Apply tricks such as decompiler tool search features or extract decompiled code in a folder and use a <code class="literal">grep</code> or <code class="literal">find</code> command. Use keywords such as <code class="literal">password</code>, <code class="literal">pwd</code>, <code class="literal">key</code>, <code class="literal">connection</code>, <code class="literal">encryption</code>, and <code class="literal">o-auth</code> in static string searches to find sensitive information.</p><p>Manually, browse through the file names which may look to implement critical business logic, authentication, or encryption.</p><p>Try breaking into the application server with the obtained information from the source code.</p><p>Obfuscators are used by smart developers to make hackers and crackers tasks more difficult. Source code is obfuscated which makes interpretation of the decompiled code difficult.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec204"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Free, open source obfuscator</strong></span>: <a class="ulink" href="http://yck1509.github.io/ConfuserEx/">http://yck1509.github.io/ConfuserEx/</a></li></ul></div></div></div>
<div class="section" title="Stealing data from Blackberry applications"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec57"/>Stealing data from Blackberry applications</h1></div></div></div><p>Stealing data from the application source code residing on the phone, as also recognized under OWASP Mobile Top 10 as M10: Lack of Binary Protection, is a source of leakage of sensitive hardcoded data. Reverse engineering the mobile application to obtain the decompiled source code and then mining the data hardcoded in the application is performed. At times developers tend to hardcode connection strings, passwords, keys, or access tokens in the application.</p><p>This recipe extends the goal of the previous recipe to the Blackberry platform and attempts to decompile the Blackberry application that is in <code class="literal">.cod</code> format.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec205"/>Getting ready</h2></div></div></div><p>The following tools are required for the readiness in accordance with the current recipe:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Coddec</strong></span>: A tool to convert <code class="literal">.cod</code> file to <code class="literal">.java</code> file is needed. We used Coddec for the same.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>A few .cod files</strong></span>: We need a few application files that are <code class="literal">.cod</code> files to attempt decompilation.</li></ul></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec206"/>How to do it...</h2></div></div></div><p>Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Copy all the <code class="literal">.cod</code> files from the device onto your machine (these <code class="literal">.cod</code> files can be found in the external SD card of the Blackberry phone provided you install the application on an external SD card). Open the same in notepad and check for encryption and non-readable forms:<p>
</p><div class="mediaobject"><img src="graphics/image_05_011.jpg" alt="How to do it..."/></div><p>
</p></li><li class="listitem">Now, extract the <code class="literal">coddec</code> tool as shown in the following screenshot. The <code class="literal">doit.bat</code> file is the command to execute and perform the decompilation:<p>
</p><div class="mediaobject"><img src="graphics/image_05_012.jpg" alt="How to do it..."/></div><p>
</p></li><li class="listitem">Copy the <code class="literal">.cod</code> files into the <code class="literal">coddec</code> tools folder source.</li><li class="listitem">Run the command <code class="literal">doit.bat *.cod</code> in the command line. This action converts non-readable <code class="literal">.cod</code> files to readable notepad files with source code now more interpretable.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec207"/>How it works...</h2></div></div></div><p>The Blackberry compiler suite compiles the developer's Java files into class files, and then the class files are converted into <code class="literal">.cod</code> files. The <code class="literal">.cod</code> files relate to code files of Blackberry. These are proprietary Blackberry application code package format.</p><p>To reverse the application source code, we used a tool called Coddec which helped us to translate the encrypted <code class="literal">.cod</code> proprietary code to a code-equivalent readable file.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec208"/>There's more...</h2></div></div></div><p>Once the application code is decompiled, let us locate some sensitive useful data. Let us browse through the contents of the code and search for the treasure key words such as <code class="literal">keys</code>, <code class="literal">algorithm</code>, <code class="literal">password</code>, <code class="literal">authentication</code>, <code class="literal">formula</code> and so on.</p><p>In our case, we obtained RIM API or library references used. Though this may not directly lead to a hack, it helps us understand the mobile application design.</p><p>Blackberry platform latest versions are equipped with further stronger compilation processes, making it more difficult to obtain the code references.</p><p>Obfuscation can be used on Blackberry platforms as well to protect the source code. This can be done by following certain steps within Blackberry JDE itself. Please follow the link mentioned underneath for the same.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec209"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><a class="ulink" href="https://supportforums.blackberry.com/t5/Java-Development/Obfuscate-code-in-a-BlackBerry-application/ta-p/444843">https://supportforums.blackberry.com/t5/Java-Development/Obfuscate-code-in-a-BlackBerry-application/ta-p/444843</a></li></ul></div></div></div>
<div class="section" title="Reading local data in Windows phone"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec58"/>Reading local data in Windows phone</h1></div></div></div><p>As we have learned previously in this book, mobile apps tend to store data on the phone. The data stored can be in multiple formats on different mobile platforms like <code class="literal">.plist</code>, <code class="literal">.sqlite</code>, and <code class="literal">.xml</code> file. OWASP recognizes this under M2: Insecure Data Storage. Data mining in the application folders (such as <code class="literal">/data/data</code> in case of Android) may result in the leakage of sensitive data present there. This recipe is intended to provide you with details on how to read locally stored data from the Windows Phone memory.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec210"/>Getting ready</h2></div></div></div><p>The following tools are required for the readiness in accordance with the current recipe:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>WP Power Tools</strong></span>: Windows Phone Power Tools allow you to interact with your applications and perform activities such as storage analysis</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>The XAP of the application</strong></span>: We would need a few XAP files to analyse their storage</li></ul></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec211"/>How to do it...</h2></div></div></div><p>Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Install Windows Phone Power tools from this link (<a class="ulink" href="http://wptools.codeplex.com/releases/view/97029">http://wptools.codeplex.com/releases/view/97029</a>) onto the Windows 8 system. Connect the Windows phone to the laptop via a USB cable.</li><li class="listitem">Once installed, launch WP Power Tools and connect it to the Windows device from the <span class="strong"><strong>connect to a device</strong></span> tab. This is depicted in the following screenshot:<p>
</p><div class="mediaobject"><img src="graphics/image_05_013.jpg" alt="How to do it..."/></div><p>
</p></li><li class="listitem">Using <span class="strong"><strong>WP Power Tools</strong></span>, install the XAP on the Windows device as shown in the following screenshot:<p>
</p><div class="mediaobject"><img src="graphics/image_05_014.jpg" alt="How to do it..."/></div><p>
</p></li><li class="listitem">Once the application has been installed on the device, browse through it and exit.</li><li class="listitem">Open the <span class="strong"><strong>Isolated Storage</strong></span> tab of WP Power Tools and right-click on the icon with the application name. This is depicted in the following screenshot (using a test app). Click on <span class="strong"><strong>Refresh</strong></span> to populate the data:<p>
</p><div class="mediaobject"><img src="graphics/image_05_015.jpg" alt="How to do it..."/></div><p>
</p></li><li class="listitem">Browse through the files within the folder named after the application:<p>
</p><div class="mediaobject"><img src="graphics/image_05_016.jpg" alt="How to do it..."/></div><p>
</p></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec212"/>How it works...</h2></div></div></div><p>Windows Phone Power Tools work by installing a windows app (<code class="literal">.xap</code> file) and analyzing the file structure created by the application. This eventually leads us to the locally stored data. For example, in case of the example taken in this recipe, an SQLite file was found that is displayed in the following screenshot:</p><p>
</p><div class="mediaobject"><img src="graphics/image_05_017.jpg" alt="How it works..."/></div><p>
</p><p>Since this works by installation of an application, the applications installed from Windows Store can't be analyzed this way.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec213"/>There's more...</h2></div></div></div><p>As part of Windows Phone 8 SDK, there is a tool called Isolated Storage Explorer. This command line tool can read and modify files in the application's local data folder in the phone (this can be related to the ADB tool of Android). The usage information for Isolated Storage Explorer can be found here:</p><p>

<a class="ulink" href="https://msdn.microsoft.com/en-in/library/windows/apps/hh286408(v=vs.105).aspx">https://msdn.microsoft.com/en-in/library/windows/apps/hh286408(v=vs.105).aspx</a>

</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec214"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://wptools.codeplex.com/releases/view/97029">http://wptools.codeplex.com/releases/view/97029</a></li><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://resources.infosecinstitute.com/windows-phone-digital-forensics-2/">http://resources.infosecinstitute.com/windows-phone-digital-forensics-2/</a></li></ul></div></div></div>
<div class="section" title="NFC-based attacks"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec59"/>NFC-based attacks</h1></div></div></div><p>
<span class="strong"><strong>Near Field Communication</strong></span> (<span class="strong"><strong>NFC</strong></span>) is a communication mechanism for proximity devices. NFC-enabled peers can communicate with each other without internet just like Bluetooth devices can. A hardware chip is present in NFC-enabled phones that enables NFC communication with other peers.</p><p>A few organizations have started using MiFare cards and card readers that are NFC enabled. User attendance and access control records are logged this way. These cards can also be used to make payments at cafeterias, and so on.</p><p>Google Wallet is a good example of a mobile app that can use NFC for payments.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec215"/>Getting ready</h2></div></div></div><p>To try out NFC based hacks, you need:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">NFC-enabled phones</li><li class="listitem" style="list-style-type: disc">NFC tag(s) or NFC credit cards</li><li class="listitem" style="list-style-type: disc">Applications such as NFCProxy for Android phone</li><li class="listitem" style="list-style-type: disc">NFC applications such as NFC Reader or Advanced NFC System downloaded from the Play Store</li></ul></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec216"/>How to do it...</h2></div></div></div><p>Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Install NFCProxy tool and other NFC apps (NFC Reader and Advanced NFC System) on your Android phone.</li><li class="listitem">NFCProxy can be downloaded from <a class="ulink" href="https://sourceforge.net/projects/nfcproxy/">https://sourceforge.net/projects/nfcproxy/</a>. Other tools are present on the Play Store.</li><li class="listitem">Touch the NFC tag with the Phone running NFC tools</li><li class="listitem">Notice that with the interaction in NFC communication range (less than 4 cms), the data stored on the NFC tag is read by these NFC applications.</li><li class="listitem">Here is the screen you see when you use <span class="strong"><strong>Advanced NFC System</strong></span>:<p>
</p><div class="mediaobject"><img src="graphics/image_05_018.jpg" alt="How to do it..."/><div class="caption">Notice that you can read, reset, or configure NFC tags with it.</div></div><p>
</p></li><li class="listitem">You can use NFCProxy to proxy the transactional data between the NFC card reader and the NFC-enabled card. Here is a snapshot of the tool showing saved NFC data (made available by the tool creators):<p>
</p><div class="mediaobject"><img src="graphics/image_05_019.jpg" alt="How to do it..."/></div><p>
</p></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec217"/>How it works...</h2></div></div></div><p>NFC can be attacked in multiple ways. Common attacks on NFC include:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Eavesdropping</li><li class="listitem" style="list-style-type: disc">Data tampering</li><li class="listitem" style="list-style-type: disc">Data fuzzing</li></ul></div><div class="section" title="Eavesdropping"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl3sec11"/>Eavesdropping</h3></div></div></div><p>A common problem with NFC has been missing encryption. NFC communication can be sniffed by a rogue proximity device and since the encryption is missing or weak encoding is used, the data transmitted can be obtained.</p><p>If in the enterprise scenario, communication of NFC-enabled MiFare cards is sniffed, data such as employee IDs and their uniquely associated tokens to record their attendance is stolen. This stolen data can then be cloned to create rogue NFC peers and the entire organization's access control can be bypassed.</p></div><div class="section" title="Data tampering"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl3sec12"/>Data tampering</h3></div></div></div><p>NFC Proxy is an android application. It can be used to set up a proxy between an RFID card and the reader. The captured sensitive data via proxy mode can be displayed, replayed, or deleted. The saved date can later be used to clone payment cards thereby creating duplicate NFC peers. These fake cards would later be used for fraudulent transactions, or the captured transaction can be replayed multiple times to cause financial harm to the victim.</p></div><div class="section" title="Data fuzzing"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl3sec13"/>Data fuzzing</h3></div></div></div><p>The captured data once under our control can be tampered with, can also be fuzzed with long strings. This may lead to buffer overflow kinds of attack.</p></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec218"/>There's more...</h2></div></div></div><p>Mobile apps tend to store data on the phone. Weak NFC communication settings in the phone can be a boon to the attackers. NFC apps may use the stored data on the phone to communicate. Weak settings such as authentication requirement for NFC peers along with missing encryption in NFC becomes a boon.</p><p>Consider the payment app that stores credit card information in the phone and flashes the same when a payment is to be made. A targeted attack here can sniff the credit card details being exchanged between the other two NFC peers.</p><p>It is very important to securely configure NFC on the mobile phones. A few security measures:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Turn off NFC when it is not needed</li><li class="listitem" style="list-style-type: disc">Keep your device updated with the latest NFC patch</li><li class="listitem" style="list-style-type: disc">Configure authentication passwords for other NFC peers, if the device permits you to do so.</li></ul></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec219"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://blackwinghq.com/assets/labs/presentations/EddieLeeDefcon20.pdf">http://blackwinghq.com/assets/labs/presentations/EddieLeeDefcon20.pdf</a></li><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://sourceforge.net/projects/nfcproxy/">http://sourceforge.net/projects/nfcproxy/</a></li></ul></div></div></div></body></html>