- en: Preface
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Almost every day we hear about new breaches, data leaks, or ransomware attacks.
    Cybercrime nowadays is a big business that constantly strives for improvement.
    It is no longer a one-man show; cybercriminals have their own methodology, tooling,
    and qualified staff. The way to defend against them is to understand how they
    attack, their tactics, and their techniques.
  prefs: []
  type: TYPE_NORMAL
- en: We will apply this approach against various products of the most popular software
    vendor – Microsoft. This book is focused purely on Windows-based infrastructure
    because on-premises infrastructure is still a big thing for most companies. In
    this book, I will take you through an attack kill chain against**Active Directory**
    *(***AD***),* Active Directory Certificate Services, Microsoft Exchange Server,
    Microsoft SQL Server, and**System Center Configuration Manager** *(***SCCM***).*
    During the process, you will be introduced to known tactics and techniques with
    a lot of hands-on exercises.
  prefs: []
  type: TYPE_NORMAL
- en: By the end of the book, you will be able to perform a hands-on comprehensive
    security assessment of Windows-based infrastructure. In addition, you will receive
    recommendations on how to detect adversary activity and remediation suggestions.
  prefs: []
  type: TYPE_NORMAL
- en: Who this book is for
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This book is truly intended to be an all-in-one guide for security professionals
    who work with Windows-based infrastructure, especially AD. Penetration testers
    and red team operators will find practical attack scenarios that they may encounter
    during real-life assessments. Security and IT engineers, as well as blue teamers
    and incident responders, will benefit from detection and remediation guidelines.
    To get the most out of this book, you should have basic knowledge of Windows services
    and AD.
  prefs: []
  type: TYPE_NORMAL
- en: What this book covers
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[*Chapter 1*](B18964_01.xhtml#_idTextAnchor012), *Getting the Lab Ready and
    Attacking Exchange Server*, provides an overview of the attack kill chain, shows
    you how to deploy the lab environment, and focuses on Exchange Server attack surfaces
    with practical examples.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 2*](B18964_02.xhtml#_idTextAnchor025), *Defense Evasion*, teaches
    you about evading **Antimalware Scan Interface** (**AMSI**) and AppLocker, PowerShell
    enhanced logging, Sysmon, and **Event Tracing for** **Windows** (**ETW**).'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 3*](B18964_03.xhtml#_idTextAnchor040), *Domain Reconnaissance and
    Discovery*, is where you will learn how to perform reconnaissance in a domain,
    blend into environment traffic, and learn more about the internals of tools such
    as BloodHound and Microsoft **Advanced Threat** **Analytics** (**ATA**).'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 4*](B18964_04.xhtml#_idTextAnchor061), *Credential Access in a Domain*,
    covers ways to obtain credentials in the domain environment by capturing the hash,
    coercing authentication, “roasting” Kerberos, reading clear-text passwords if
    **Local Administrator Password Solution** (**LAPS**) is misconfigured, and collecting
    hashes of gMSA accounts or of a whole domain via DCSync.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 5*](B18964_05.xhtml#_idTextAnchor093), *Lateral Movement in Domain
    and Across Forests*, shows how an adversary can maneuver across an environment
    by abusing different types of delegation, passing different types of credential
    materials, relaying captured hashes, as well as moving to other forests.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 6*](B18964_06.xhtml#_idTextAnchor119), *Domain Privilege Escalation*,
    is where we will focus on ways to elevate privileges in a domain by abusing misconfigured
    **Access Control Lists** (**ACL**), **Group Policy Objects** (**GPO**), and special
    built-in groups, as well as moving from a child domain to a parent domain.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 7*](B18964_07.xhtml#_idTextAnchor146), *Persistence on Domain Level*,
    shows techniques to establish persistence on the domain level by forging tickets
    and manipulating ACLs and objects, as well as on the domain controller itself
    by adding a Skeleton Key, malicious SSP, a registry backdoor, and so on.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 8*](B18964_08.xhtml#_idTextAnchor163), *Abusing Active Directory
    Certificate Services*, covers the fundamentals of **Public Key Infrastructure**
    (**PKI**) implementation by Microsoft, along with ways to steal certificates,
    escalate privileges in the domain, and achieve persistence on account and domain
    levels.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 9*](B18964_09.xhtml#_idTextAnchor191), *Compromising Microsoft SQL
    Server*, is where we will focus on how to attack SQL Server, including enumeration,
    privilege escalation, lateral movement, and persistence.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 10*](B18964_10.xhtml#_idTextAnchor222), *Taking over WSUS and SCCM*,
    provides an overview of IT support management software and ways to abuse its functionality,
    leading to a complete takeover of the whole environment.'
  prefs: []
  type: TYPE_NORMAL
- en: To get the most out of this book
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '| **Software/hardware covered in** **the book** | **Operating** **system requirements**
    |'
  prefs: []
  type: TYPE_TB
- en: '| Windows Active Directory | Linux host |'
  prefs: []
  type: TYPE_TB
- en: '| Windows Services – WSUS and AD CS | Kali virtual machine |'
  prefs: []
  type: TYPE_TB
- en: '| Exchange Server |  |'
  prefs: []
  type: TYPE_TB
- en: '| SQL Server |  |'
  prefs: []
  type: TYPE_TB
- en: '| SCCM |  |'
  prefs: []
  type: TYPE_TB
- en: Conventions used
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There are a number of text conventions used throughout this book.
  prefs: []
  type: TYPE_NORMAL
- en: '**Code in text**: Indicates code words in text, database table names, folder
    names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter
    handles. Here is an example: “**MailSniper** calculates the time difference between
    authentication attempt responses.”'
  prefs: []
  type: TYPE_NORMAL
- en: 'Any command-line input or output is written as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '**Bold**: Indicates a new term, an important word, or words that you see on
    screen. For instance, words in menus or dialog boxes appear in **bold**. Here
    is an example: “We will cover attack detection and possible prevention measures,
    as well as offensive **Operational** **Security** (**OpSec**).”'
  prefs: []
  type: TYPE_NORMAL
- en: Tips or important notes
  prefs: []
  type: TYPE_NORMAL
- en: Appear like this.
  prefs: []
  type: TYPE_NORMAL
- en: Get in touch
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Feedback from our readers is always welcome.
  prefs: []
  type: TYPE_NORMAL
- en: '**General feedback**: If you have questions about any aspect of this book,
    email us at [customercare@packtpub.com](mailto:customercare@packtpub.com) and
    mention the book title in the subject of your message.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Errata**: Although we have taken every care to ensure the accuracy of our
    content, mistakes do happen. If you have found a mistake in this book, we would
    be grateful if you would report this to us. Please visit [www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)
    and fill in the form.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Piracy**: If you come across any illegal copies of our works in any form
    on the internet, we would be grateful if you would provide us with the location
    address or website name. Please contact us at [copyright@packtpub.com](mailto:copyright@packtpub.com)
    with a link to the material.'
  prefs: []
  type: TYPE_NORMAL
- en: '**If you are interested in becoming an author**: If there is a topic that you
    have expertise in and you are interested in either writing or contributing to
    a book, please visit [authors.packtpub.com](http://authors.packtpub.com).'
  prefs: []
  type: TYPE_NORMAL
- en: Share Your Thoughts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Once you’ve read *Pentesting Active Directory and Windows-based Infrastructure*,
    we’d love to hear your thoughts! Please [click here to go straight to the Amazon
    review page](https://packt.link/r/1804611360) for this book and share your feedback.
  prefs: []
  type: TYPE_NORMAL
- en: Your review is important to us and the tech community and will help us make
    sure we’re delivering excellent quality content.
  prefs: []
  type: TYPE_NORMAL
- en: Download a free PDF copy of this book
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Thanks for purchasing this book!
  prefs: []
  type: TYPE_NORMAL
- en: Do you like to read on the go but are unable to carry your print books everywhere?
  prefs: []
  type: TYPE_NORMAL
- en: Is your eBook purchase not compatible with the device of your choice?
  prefs: []
  type: TYPE_NORMAL
- en: Don’t worry, now with every Packt book you get a DRM-free PDF version of that
    book at no cost.
  prefs: []
  type: TYPE_NORMAL
- en: Read anywhere, any place, on any device. Search, copy, and paste code from your
    favorite technical books directly into your application.
  prefs: []
  type: TYPE_NORMAL
- en: The perks don’t stop there, you can get exclusive access to discounts, newsletters,
    and great free content in your inbox daily
  prefs: []
  type: TYPE_NORMAL
- en: 'Follow these simple steps to get the benefits:'
  prefs: []
  type: TYPE_NORMAL
- en: Scan the QR code or visit the link below
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](image/B18964_QR_Free_PDF.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '[https://packt.link/free-ebook/9781804611364](https://packt.link/free-ebook/9781804611364)'
  prefs: []
  type: TYPE_NORMAL
- en: Submit your proof of purchase
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: That’s it! We’ll send your free PDF and other benefits to your email directly
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
