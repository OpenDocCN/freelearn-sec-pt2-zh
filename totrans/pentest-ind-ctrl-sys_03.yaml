- en: '*Chapter 4*: Open Source Ninja'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This chapter will take you, the reader, through the art of Google-Fu, researching
    a company, facility, process, control, contract, or other form of publicly shared
    information. This allows you to understand how to obtain as much information pre-engagement
    as possible. The important part is that time and time again, employees like to
    publish information about their organization. Information that is not normally
    shared by a company can be items such as firewalls used for segmentation, endpoint
    protection, **network access control** (**NAC**) information, **intrusion detection
    system** (**IDS**) products implemented, and many more revealing strategies. However,
    with a drive to be ever more connected, websites such as LinkedIn can reveal what
    an organization may be utilizing.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now that we have gleaned some amazing details about the organization that we
    are going after, we can ask the question: *What is the side load?* If we know
    the company is Rockwell, can we create accounts on Rockwell''s support network?
    Can we engineer tools and people to get even deeper into the organization?'
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we''re going to cover the following main topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Understanding Google-Fu
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Searching LinkedIn
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Experimenting with Shodan.io
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Investigating with **Exploit Database** (**exploit-db**)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Traversing the **National Vulnerability Database** (**NVD**)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Technical requirements
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For this chapter, you will need the following:'
  prefs: []
  type: TYPE_NORMAL
- en: A computer with browser of choice to access the websites discussed
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A LinkedIn account would be very beneficial for this chapter
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Understanding Google-Fu
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Google has to be one of the most notable search engines on the market. I personally
    used **WebCrawler** back in the **Netscape** days. I remember hearing that phrase
    *Did you google it?* for the first time in 2002 while I was fixing someone''s
    PalmPilot. It might be a foregone conclusion that everyone reading this content
    has encountered the Google search engine at some point in their career. With that
    said, I am still going to relay some nuggets of truth: the Google search engine
    is a giant indexer, basically crawling the internet and documenting and historizing
    the data that it encounters. Now, this next statistic is purely speculative and
    has no quantifiable evidence; however, I am pretty confident that 99% of Google
    users have never really embraced the advanced features that Google has to offer.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Google dorking** or **Google hacking** is simply a method of using Google''s
    advanced search features to glean sensitive details from the internet. Combining
    and stringing together advanced search functions allows a user to quickly acquire
    publicly indexed information. Using these advanced features is perfectly legal;
    however, the question of legality is challenged when the data indexed is used
    to compromise and exploit the *owner''s data*. This is akin to finding vulnerabilities.
    There is nothing illegal with discovering a bug—software today is riddled with
    them, hence the perpetual slew of updates that we are constantly performing. However,
    if the new bug is used to exploit *other customers that utilize the same software*,
    this is illegal. With that said, finding sensitive information using Google dorking
    while engaged in a **penetration test** (**pentest**) or during research efforts
    requires responsible disclosure.'
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: Responsible disclosure is a process by which security personnel communicate
    discoveries found through their research to the appropriate parties involved,
    such as the software or hardware vendor, the company whose sensitive data has
    been exposed, and the local **computer emergency response team** (**CERT**).
  prefs: []
  type: TYPE_NORMAL
- en: 'With that disclaimer out of the way, let''s proceed further. Here is a link
    to the **Google Hacking Database** (**GHDB**), which documents many uses of the
    advanced functions that can be used: [https://www.exploit-db.com/google-hacking-database](https://www.exploit-db.com/google-hacking-database).'
  prefs: []
  type: TYPE_NORMAL
- en: 'This is what the site will look like once you navigate to it:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.1 – GHDB'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.01_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.1 – GHDB
  prefs: []
  type: TYPE_NORMAL
- en: 'Here is a short list of advanced functions for Google dorking. There are many
    more that can be found in the preceding link, but I don''t want to get lost down
    a proverbial rabbit hole:'
  prefs: []
  type: TYPE_NORMAL
- en: '**site**: (search only in the site provided)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**inurl**: (search for a keyword in the **Uniform Resource Locator** (**URL**)
    provided)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**intitle**: (search for a keyword in the title of the web page)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**intext**: (search for a keyword in the body of the web page)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**filetype**: (search for files with a keyword provided)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**ext**: (search for files with a keyword provided)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'These functions can be run in the Google browser to focus on information pertaining
    to your client. For example, you could run a search as shown in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.2 – Advanced search'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.02_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.2 – Advanced search
  prefs: []
  type: TYPE_NORMAL
- en: 'This will search the [https://www.cdc.gov/](https://www.cdc.gov/) site for
    any public-facing **File Transfer Protocol** (**FTP**) servers that may be accessible.
    This is a very simple example that helps demonstrate the capabilities of the advanced
    functions the Google search engine has to offer. Other services and hosted file
    shares can be searched for, such as the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Web Distributed Authoring and Versioning** (**WebDAV**): **intitle:"Directory
    Listing For /" + inurl:webdav tomcat**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Structured Query Language** (**SQL**): **intitle: "index of" "admin/sql/"**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**VTScada**: **intitle:''VTScada Anywhere Client''**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'A more complex function would be something similar to the one shown here:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.3 – Complex function'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.03_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.3 – Complex function
  prefs: []
  type: TYPE_NORMAL
- en: You will see a list of Rockwell **programmable logic controllers** (**PLCs**)
    and their web access interface that has been exposed directly to the internet.
    Reviewing the command shown in *Figure 4.3*, you see that we are looking for the
    term **Rockwell Automation** in the **index.html** title in the URL, and finally,
    the specific term **Device Name**. Many devices can be discovered this way.
  prefs: []
  type: TYPE_NORMAL
- en: Using standard queries and these advanced functions, you can start to build
    a profile of your client. Building a profile is a key step in a pentesting engagement
    as it allows deeper insight into your customer's infrastructure, which can be
    useful for harvesting information to result in a successful outcome with regard
    to your engagement. Start with the company name and determine which industry this
    customer operates in. This is important, as some **Industrial Control System**
    (**ICS**) vendors have a strong foothold in very specific industries. A prime
    example would be **Schweitzer Engineering Laboratories** (**SEL**), who have products
    that can address almost all types of industries; however, you will find them primarily
    in the energy sector. If you happen to be in an engagement with an energy producer,
    transmission, or distribution customer, you can be assured that you will come
    across SEL technology. This is one example of a technology bound to an industry
    but many other examples exist, and they are easy to find by utilizing the search
    features we covered before.
  prefs: []
  type: TYPE_NORMAL
- en: In this section, we touched on the power of Google's advanced search features
    and the details that can be captured from writing very focused queries. We can
    use the data discovered to shape customer profiles prior to even stepping foot
    into a meeting. In the next section, we are going to review the people component
    and look at effective ways of using LinkedIn.
  prefs: []
  type: TYPE_NORMAL
- en: Searching LinkedIn
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'LinkedIn has to be the largest professional social media networking site. There
    are 740+ million total users on the platform. 55 million companies are listed
    on LinkedIn according to their listed statistics, which can be found at the following
    link: [https://news.linkedin.com/about-us#Statistics](https://news.linkedin.com/about-us#Statistics).'
  prefs: []
  type: TYPE_NORMAL
- en: Chances are that because of the many users and companies on the platform, we
    are bound to find some nuggets of gold when it comes to a pentesting engagement.
    Since the site is basically a real-time virtual resume for professional individuals,
    a mass amount of information for the user is stored in easily searchable text.
    Data points relating to the size of a company, the industry in which the company
    participates, technology used by the company, and people employed by the company
    are all readily available through the search input.
  prefs: []
  type: TYPE_NORMAL
- en: 'Searching LinkedIn has the granularity to narrow in on the following details:'
  prefs: []
  type: TYPE_NORMAL
- en: People
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Jobs
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Companies
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Groups
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Schools
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Posts
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Events
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'When you search a customer''s company, the results will relate to the relative
    size of the company, as with the company shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.4 – Company search'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.04_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.4 – Company search
  prefs: []
  type: TYPE_NORMAL
- en: 'From this, we know where employees live and where they studied. We have the
    ability to search for employees by title, keyword, or school inside the sub-search
    input. Now, for the observant few, you may have noticed a bug already! LinkedIn
    indicates that there are 24,887 employees and also notes that 25,042 of them live
    in the **United States** (**US**). **Artificial intelligence** (**AI**) will take
    over the world one day, but not yet, my friends. We can start to narrow in on
    our search by looking for general keywords. Starting with **supervisory control
    and data acquisition (SCADA)**, we get 476 employees with SCADA listed in their
    profiles, as illustrated in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.5 – SCADA sub search'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.05_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.5 – SCADA sub search
  prefs: []
  type: TYPE_NORMAL
- en: 'Running a specific search for a skillset keyword, such as **telvent**, will
    help narrow in on the systems used by this sample company and the people who may
    have credentials on these systems. You can see the returned results in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.6 – Telvent skillset'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.06_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.6 – Telvent skillset
  prefs: []
  type: TYPE_NORMAL
- en: 'When you narrow in on a subset of individuals and research their current position
    and details around the workplace''s accomplishments, you can find many interesting
    and concrete details such as those shown in the following screenshot, where the
    company name has been redacted out of courtesy:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.7 – Public information on systems'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.07_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.7 – Public information on systems
  prefs: []
  type: TYPE_NORMAL
- en: As you can see, in this section, it is quite easy to build a more holistic profile
    of a company by using LinkedIn to fill in the blanks. The search feature in LinkedIn
    allows us to build a list of employees and positions, narrow in on the technology
    that the company uses, and finally build a short list of possible credential accounts
    as to who may have access to this technology (as seen in the previous screenshot).
    In order to build displays, the user requires an account on **Telvent-DMS** (**Distribution
    Management System**) and **SCADA-EMS** (**Energy Management System**). Leveraging
    this readily available data is crucial for any successful engagement. In the next
    section, we will be exploring Shodan.io and will examine how the insights that
    we can gather from using this search engine with help round out the technology
    that is readily accessible.
  prefs: []
  type: TYPE_NORMAL
- en: Experimenting with Shodan.io
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As claimed by their home page, "*Shodan is the world's first search engine for
    internet-connected devices*." In the last two sections, we used different search
    tactics to gain a free insight into how an organization is structured and organized
    and how to expose any services that might be open to the public. This allowed
    us to build a profile for our customer relating to the industry they are operating
    in, the individuals who are employed by them, and—if we are lucky—some of the
    technologies they are using. In this section, we are going to dive deeper into
    the services and technology by using Shodan.io.
  prefs: []
  type: TYPE_NORMAL
- en: 'If you navigate to [the following link,](https://www.shodan.io/) , you will
    see the search engine window, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.8 – Shodan.io search engine'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.08_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.8 – Shodan.io search engine
  prefs: []
  type: TYPE_NORMAL
- en: 'Clicking on the **Explore** button will take us to the following screen:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.9 – Exploring Shodan.io'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.09_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.9 – Exploring Shodan.io
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, we want to click on the top category, **Industrial Control Systems**,
    and you will be taken to a page that looks like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.10 – Industrial Control Systems'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.10_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.10 – Industrial Control Systems
  prefs: []
  type: TYPE_NORMAL
- en: 'If you scroll down the page, you will notice that the systems are documented
    by a protocol discovered by the search engine. These protocols are public-facing,
    as shown here:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.11 – Public-facing protocols'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.11_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.11 – Public-facing protocols
  prefs: []
  type: TYPE_NORMAL
- en: Now, we did skip ahead to look specifically at the **Industrial Control Systems**
    section, but if this were a real engagement, you would have wanted to search the
    company name to see if any "low-hanging items" were present. Also, I would advise
    you to get into the habit of looking for corporate **Internet Protocol** (**IP**)
    ranges in the search input on the landing page.
  prefs: []
  type: TYPE_NORMAL
- en: Story time
  prefs: []
  type: TYPE_NORMAL
- en: The reason I say this is that during an engagement, I had just arrived at the
    head office of a customer. My team was already inside, so I quickly tethered my
    laptop to my cell phone and did a simple Shodan lookup of the IP range for the
    customer and discovered a **Citrix virtual private network** (**VPN**) **access
    portal**. Using my cell phone, I called reception and socially engineered credentials
    to get access to the VPN portal. I quickly logged in and realized that a simple
    "kiosk break" could be used and that the entire portal was running as domain admin
    on a domain controller. Needless to say, the 2-week engagement went quite smoothly.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, disclaimer time once again. Clicking on any of the protocols'' **Explore**
    buttons is completely harmless, and reviewing the information that is shared on
    the screen is OK as well. Traversing to the IP address discovered gets into a
    very gray zone, as what may be publicly available shouldn''t be. Though it is
    rare these days to find a complete operator console on Shodan, it''s not impossible.
    If you come across a gas pipeline SCADA system, you are definitely in the realm
    of being liable if, all of a sudden, a compressor station shuts down or a mainline
    block valve closes. Remember the SCADA system that we discovered from the **GE-XA21**
    LinkedIn user? It uses **Distributed Network Protocol 3** (**DNP3**) for communication,
    along with various other protocols. If you look at the **Protocols** section,
    you will see the **DNP3** button. Click it, and you will be brought to the following
    screen:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.12 – DNP3 discovered'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.12_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.12 – DNP3 discovered
  prefs: []
  type: TYPE_NORMAL
- en: 'As you navigate around, you will see that there are lots of options for filtering
    and searching. You can filter by country, city, organization, equipment, service,
    port, and much more. Out of curiosity, let''s search for the **Koyo CLICK** PLC
    that we set up in our lab and see the results, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.13 – Koyo CLICK'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.13_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.13 – Koyo CLICK
  prefs: []
  type: TYPE_NORMAL
- en: As you can see, Shodan has crawled Koyo CLICK devices that are freely open to
    the internet.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: I emphasize, as a blue teamer, that you consistently and routinely check Shodan.io
    for your organization's IP space and technology. This will help you stay ahead
    of any unsightly breaches, and forces pentesters to work harder during their engagement.
  prefs: []
  type: TYPE_NORMAL
- en: In this section, we briefly touched on the power of using Shodan.io and finding
    industrial technology that is exposed to the internet. Using Shodan.io during
    a pentesting engagement is a must, as you may find interesting customer equipment
    and/or services sitting online. By now, during a normal engagement, you will have
    a well-rounded profile assembled for your customer. You will have companies, industries,
    technologies, and people associated with your customer. In the next section, we
    will be reviewing **exploit-db**, which we quickly touched on with Google hacking,
    but we will be going deeper into details of how to associate technology with discovered
    and documented exploits.
  prefs: []
  type: TYPE_NORMAL
- en: Investigating with ExploitDB
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'ExploitDB is a giant archive of shared discoveries pertaining to software flaws,
    exploits, and vulnerabilities. It allows for a community of security researchers
    and pentesters to share known compromises in an easily searchable format. Navigating
    to [https://www.exploit-db.com](https://www.exploit-db.com), you will land on
    the home page and be presented with the latest documented vulnerabilities discovered,
    as seen in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.14 – ExploitDB'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.14_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.14 – ExploitDB
  prefs: []
  type: TYPE_NORMAL
- en: 'If you notice, on the right-hand side we have a search input field. Type **SCADA**
    and press *Enter*. At the time of the printing of this book, you will see 50 vulnerabilities
    related to various SCADA systems, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.15 – SCADA vulnerabilities'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.15_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.15 – SCADA vulnerabilities
  prefs: []
  type: TYPE_NORMAL
- en: 'As you can see on the screen, we have eight headings, which are outlined as
    follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Date**: This is the date that the vulnerability was added to ExploitDB.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Download**: This is the code that you can download to carry out the exploit.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**App**: This is a copy of the vulnerable app that the exploit works against.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Verified**: This is an approval notice indicating that the exploit is verified
    to work.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Title**: Description of exploit.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Type**: Type of exploit.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Platform**: System that the exploit works against.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Author**: This is the author of the exploit code.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'For many vulnerabilities, authors have included code that allows you to quickly
    review and augment your environment. This technique of reviewing code structure
    for **proof-of-concept** (**POC**) work will be covered in more depth in a later
    chapter, but for now, just know that you can find access to various code that
    will help you achieve a foothold in your clients'' technology stack. We are going
    to take a closer look at a simple vulnerability. If we look at the following screenshot,
    you will see that **Rockwell SCADA** has a listed exploit from 2018:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](image/Figure_4.16_B16321.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 4.16 – Rockwell exploit
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on the description, and let''s review the following screen:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.17 – Rockwell SCADA exploit'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.17_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.17 – Rockwell SCADA exploit
  prefs: []
  type: TYPE_NORMAL
- en: If you notice, **CVE** (which stands for **Common Vulnerabilities and Exposures**)
    is labeled as **2016-2279**, meaning this vulnerability dates back to 2016—or
    at least that it was reported in 2016—but doesn't necessarily mean that it was
    discovered in 2016; it may have been found at an earlier date. As you can see,
    the various versions that this exploit effects are documented, and at the very
    end of the script is a simple **PoC** example, which means that from the **graphical
    user interface** (**GUI**) we can run simple **cross-site scripting** (**XSS**)
    to hijack a user's session or steal sensitive system information, but we will
    discuss more on this later. We know now that we can search **exploit-db** for
    any known vulnerabilities and related code that takes advantage of these flaws.
    This can all be done pre-engagement. In the next section, I want to quickly look
    at the NVD to understand the origin and driver of the exploit code found in **exploit-db**.
  prefs: []
  type: TYPE_NORMAL
- en: Traversing the NVD
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The NVD is the largest consortium of recorded vulnerabilities in the open source
    space. Navigating to [https://nvd.nist.gov/vuln/search](https://nvd.nist.gov/vuln/search)
    will bring you to the following screen:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.18 – NVD'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.18_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.18 – NVD
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, search the CVE that we found earlier in Exploit DB for Rockwell SCADA.
    The CVE was **2016-2279**. Type this CVE into the search input field and press
    *Enter*, and you will see the following screen:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.19 – NVD CVE 2016-2279'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.19_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.19 – NVD CVE 2016-2279
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, click on the link in the **Vuln ID** field we see shown in the results
    window, and you will see the following screen:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.20 – CVE-2016-2279 details'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.20_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.20 – CVE-2016-2279 details
  prefs: []
  type: TYPE_NORMAL
- en: 'There is a lot of information gathered and displayed here. Most notable are
    the systems affected and the risk score attached to them. Reviewing this data
    is important, as you will understand the depth and breadth of impact of discovering
    these controllers and the version of them operating in the customer environment.
    To look at something a bit more relevant, go back to the main screen and run a
    query against **Rockwell technology**. You should see the following vulnerabilities:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.21 – Rockwell vulnerabilities'
  prefs: []
  type: TYPE_NORMAL
- en: '](image/Figure_4.21_B16321.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 4.21 – Rockwell vulnerabilities
  prefs: []
  type: TYPE_NORMAL
- en: Here, you can see that there are 94 records found relating to Rockwell. The
    last published date was **March 03, 2021** and the record has a CVE ID of **CVE-2021-22681**.
    Reviewing this vulnerability, you can see it is ranked **CRITICAL**—and rightfully
    so, as it indicates that an unauthenticated attacker could bypass authentication
    and directly make changes on the controller. This is scary as an attacker could
    change set points on a process, leading to unscheduled downtime, loss of control,
    or even process failure. This is good news for a pentester as it provides a launching
    point for access to critical infrastructure.
  prefs: []
  type: TYPE_NORMAL
- en: Disclaimer
  prefs: []
  type: TYPE_NORMAL
- en: Finding a vulnerability at a process-control level that has physical access
    to **input/output** (**I/O**) should be documented and not acted upon unless you
    know the exact outcome of exploiting a known vulnerability as things have a tendency
    to go dark or boom, all possible outcomes that can be very scary.
  prefs: []
  type: TYPE_NORMAL
- en: In this section, we discovered what the NVD is and where we can find more knowledge
    around known vulnerabilities that have been documented. This is key, as we can
    build supporting evidence on our assessment report and use the documented vulnerabilities
    to gain access to our customers' infrastructure.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we covered a number of **open source intelligence** (**OSINT**)
    topics, specifically focusing on the ICS space. We looked at Google-Fu and how
    we research our customer to discover industry details and possible users. To dig
    deeper, we turned to LinkedIn to see if any of the employees listed on it published
    sensitive information in relation to their employer and the technology being used.
  prefs: []
  type: TYPE_NORMAL
- en: Next, we looked at Shodan.io for technology that is sitting on publicly accessible
    networks and to see if this technology belongs to our customer. After that, we
    moved over to ExploitDB to see if there is any publicly provided code that exploits
    vulnerabilities on the technology that we discovered in the previous steps. Finally,
    we looked directly at the NVD to see which vulnerabilities exist on systems that
    we gathered. With this information collected and documented, we have a well-rounded
    understanding of our customers' industries, people, processes, and technologies.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will learn about the importance of spanning and capturing
    traffic that we can leverage to discover which real devices are communicating
    on a network.
  prefs: []
  type: TYPE_NORMAL
