<html><head></head><body>
		<div id="_idContainer555">
			<h1 id="_idParaDest-131"><em class="italic"><a id="_idTextAnchor147"/>Chapter 13</em>: Pwned but with Remorse</h1>
			<p>We have finally arrived at our destination. Make sure your seat backs and tray tables are in their full upright position. Make sure your seat belt is securely fastened and all carry-on luggage is stowed. We are now at the point in the pentest where we must collect all the information that we captured and correlate the data into a report. Know that if there is no report, then the engagement never happened. From a business perspective, this is fundamentally the most pivotal part of the pentesting engagement. In this chapter, we will discuss how to build a report template, backfill that template with key information found during the engagement, and finally provide some remediation points to help close the security gap.</p>
			<p>In this chapter, we're going to cover the following main topics:</p>
			<ul>
				<li>Preparing a pentest report</li>
				<li>Closing the security gap</li>
			</ul>
			<h1 id="_idParaDest-132"><a id="_idTextAnchor148"/>Technical requirements</h1>
			<p>For this chapter, you will need the following:</p>
			<ul>
				<li>A word processor tool, such as Microsoft Word or Google Docs</li>
				<li>A drawing tool, which will be used for graphics in the report</li>
			</ul>
			<h1 id="_idParaDest-133"><a id="_idTextAnchor149"/>Preparing a pentest report</h1>
			<p>When <a id="_idIndexMarker848"/>preparing a report, it ultimately comes down to personal preference and, possibly, if you are working for a larger company, corporate branding. Getting the theme, icons, logos, and brands out of the way, at the core, there is a fundamental structure that should be used as a guideline to build your report against. Now, depending on your educational background, talking about report structure might come across as redundant; however, it is critical to build a clear and concise report that can be easily ingested by your customer because if they can't follow the flow of the report, it might be the last engagement you have with that client.</p>
			<p class="callout-heading">Story time</p>
			<p class="callout">I spent many years <a id="_idIndexMarker849"/>working with, and for, <strong class="bold">Engineering Procurement Construction</strong> (<strong class="bold">EPC</strong>) companies. During that time, I became very familiar with <strong class="source-inline">search and replace all</strong> word processor functions. Building a reusable set of reporting templates is vital to a successful pentesting career. With each engagement and deliverable, you can modify, tweak, and enhance the template to make a dynamite report. I personally feel that even if you are the best technical pentester but you cannot write a report, even if your life depended on it, then you will have a very hard career ahead of you. I think the big houses have spent years building out their report templates, and the few of us running smaller shops are still sharpening our reporting deliverables.</p>
			<p>I like to start <a id="_idIndexMarker850"/>every report with a title page containing the company's logo, the name of the report, and the customer's company logo, as this helps appease the marketing team. Based on my background working with engineering companies, I then add a table containing the following information:</p>
			<ul>
				<li>Revision</li>
				<li>Date</li>
				<li>Description</li>
				<li>By</li>
				<li>Approval</li>
			</ul>
			<p>The report should look something like the following:</p>
			<div>
				<div id="_idContainer544" class="IMG---Figure">
					<img src="image/B16321_13_001.jpg" alt="Figure 13.1 – Change control&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.1 – Change control</p>
			<p>The <em class="italic">Revision</em> number is a way to track which version of the report you are working on, in the event that you have multiple team members. <em class="italic">Date</em> should be obvious, as you want to track when the revision was done. The <em class="italic">Description</em> column gives the description of <a id="_idIndexMarker851"/>the changes/actions that occurred in the report. <em class="italic">By</em> is for the author of the revision and then, finally, the approver. This will help turn the report into a controlled engineering document, and it should adhere to a change management process. </p>
			<p>You then want to build out a high-level summary, which should include a scoring mechanism that relates the level of risk discovered through the testing. The risk score can be calculated by<a id="_idIndexMarker852"/> the following formula:</p>
			<p><em class="italic">(attack vector) x (probability of happening) x (level of complexity) – (security controls) = cyber risk. </em></p>
			<p>The following headings break down the formula and explain in greater detail each variable in the formula.</p>
			<h2 id="_idParaDest-134"><a id="_idTextAnchor150"/>Attack vector </h2>
			<p>This can be open<a id="_idIndexMarker853"/> services, reusable credentials, spear phishing, and vulnerabilities associated with software that is discovered in the environment. You should be providing numerical weighting to each of these techniques. I haven't determined whether there is a <em class="italic">best</em> method for doing this yet. I feel everyone struggles with associating numerical weighting with specific attack vectors. </p>
			<h2 id="_idParaDest-135"><a id="_idTextAnchor151"/>Probability of happening</h2>
			<p>Calculating<a id="_idIndexMarker854"/> the probability of an event happening is a straightforward stats problem where you use the classical probability rule, by taking the simple event and dividing it by the total number of plausible event outcomes. If we take our attack vector events as an example, it would be a ¼ or 0.25 probability of any one of those events occurring.</p>
			<h2 id="_idParaDest-136"><a id="_idTextAnchor152"/>Level of complexity</h2>
			<p>There are <a id="_idIndexMarker855"/>many methods to calculate complexity. I, however, simply use an expertise scale:</p>
			<ul>
				<li>Script kiddy (beginner)</li>
				<li>Hacker (junior)</li>
				<li>Career pentester (intermediate)</li>
				<li>Nation state (senior) </li>
			</ul>
			<p>If a service<a id="_idIndexMarker856"/> is open and external-facing, such as <strong class="bold">File Transfer Protocol</strong> (<strong class="bold">FTP</strong>), <strong class="bold">Network File System</strong> (<strong class="bold">NFS</strong>), or something similar, then it is easy to <a id="_idIndexMarker857"/>say <a id="_idIndexMarker858"/>that this is a relatively low level of complexity, which increases the risk factor.</p>
			<h2 id="_idParaDest-137"><a id="_idTextAnchor153"/>Security controls</h2>
			<p>This directly relates<a id="_idIndexMarker859"/> to technology, policy, and procedures that a customer uses to secure their industrial environment. Asking very direct questions as you are performing testing is important to quantify and categorize the controls. Some of these questions can be as follows:</p>
			<ul>
				<li>Are they using firewalls?</li>
				<li>Are they using legacy firewalls?</li>
				<li>Are there issues with the firewall rules?</li>
				<li>Are they using <a id="_idIndexMarker860"/>crazy black-site <strong class="bold">Access Control Lists</strong> (<strong class="bold">ACLs</strong>) that no one knows exists? (This should be a story for another day).</li>
				<li>Are they <a id="_idIndexMarker861"/>using <strong class="bold">Network Access Control</strong> (<strong class="bold">NAC</strong>)?</li>
				<li>Are they <a id="_idIndexMarker862"/>using a <strong class="bold">Network-based Intrusion Detection System</strong> (<strong class="bold">NIDS</strong>)?</li>
				<li>Are they <a id="_idIndexMarker863"/>using a <strong class="bold">Host-based Intrusion Detection System</strong> (<strong class="bold">HIDS</strong>)?</li>
			</ul>
			<p>Taking <a id="_idIndexMarker864"/>our last example, which we talked about in <em class="italic">Level of complexity</em>, even in a case of an open service exposure, if they have mitigating controls, the risk goes down considerably.</p>
			<p>After the summary, we get down to the nitty-gritty. You may have noticed while reading through the book that there was a unique feel and flow. This was by design; we started working through some fundamentals on lab development, dabbled with the hardware, and then we moved on to explore techniques and tactics utilized in pentesting engagements. This is where we loosely followed the following plan:</p>
			<ol>
				<li>Information gathering</li>
				<li>Enumeration</li>
				<li>Access</li>
				<li>Privilege escalation</li>
				<li>Lateral movement</li>
				<li>Impact analysis</li>
			</ol>
			<p>This by no <a id="_idIndexMarker865"/>means is set in stone, hence the word loosely in the previous sentence. Everyone has their own strategy and groove for what works for them, and with time you will find what works best for you and your future clients. We started tackling the first item in the aforementioned plan, information gathering, in <a href="B16321_04_Epub_AM.xhtml#_idTextAnchor040"><em class="italic">Chapter 4</em></a>, <em class="italic">Open Source Ninja</em>, where we explored <em class="italic">Google Fu</em>, <em class="italic">Searching LinkedIn</em>, <em class="italic">Experimenting with Shodan.io</em>, <em class="italic">Investigating with ExploitDB</em>, and <em class="italic">Traversing NVD</em>. Performing these tasks allows us to consume a lot of information; during these actions, we need to capture the important, useful, and reusable data and store it, so that we can compile it for the information gathering section. This data needs to be communicated to the customer if it divulges too much detail that ultimately opens the door for a threat actor to slip in. Some of the key information I look for are email addresses and passwords that have been part of pwned reports. The following link allows you to quickly check to see whether your email has been compromised but also to check whether your customers' emails have been compromised: <a href="https://haveibeenpwned.com/">https://haveibeenpwned.com/</a> (thanks to Mr. Troy Hunt, the creator of the website). There are many services that are paid subscriptions and allow access to the breach data to pull out sensitive information. </p>
			<p>After the<a id="_idIndexMarker866"/> information section, we roll into the enumeration portion of the report. The tools to<a id="_idIndexMarker867"/> capture this data are found in <a href="B16321_07_Epub_AM.xhtml#_idTextAnchor081"><em class="italic">Chapter 7</em></a>, <em class="italic">Scanning 101</em>, where we <a id="_idIndexMarker868"/>worked with <strong class="bold">Nmap</strong>, <strong class="bold">RustScan</strong>, <strong class="bold">Gobuster</strong>, and <strong class="bold">feroxbuster</strong>. Using <a id="_idIndexMarker869"/>these tools will help discover open ports, services, web applications, and hidden pages. There will be an incredible amount of data that can be harvested using these tools, and I have seen reports turned in where it has been pages and pages of Nmap scans, which I feel were used to pad the report page count. I caution that adding multiple pages of scans, like in the following figure, would be the wrong approach: </p>
			<div>
				<div id="_idContainer545" class="IMG---Figure">
					<img src="image/B16321_13_002.jpg" alt="Figure 13.2 – NMAP scan of a single host&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.2 – NMAP scan of a single host</p>
			<p>Look <a id="_idIndexMarker870"/>strategically at what machines are found and the ports that are identified, and build a very clear and concise table of data discovered. In <a href="B16321_05_Epub_AM.xhtml#_idTextAnchor049"><em class="italic">Chapter 5</em></a>, <em class="italic">Span Me If You Can</em>, we talked about <strong class="bold">Intrusion Detection System</strong> (<strong class="bold">IDS</strong>) technology, which is a great solution for automatically building out asset lists with <a id="_idIndexMarker871"/>ports and services. There are companies such as Forescout, Tenable, Cisco, Nozomi, Claroty, and SCADAfence that offer a 90-day trial and test IDS software. You can use these tools to build out presentation-worthy imagery. I will use an open source tool called <strong class="bold">NetworkMiner</strong>, which <a id="_idIndexMarker872"/>you can install by following this link: <a href="https://www.netresec.com/?page=networkminer">https://www.netresec.com/?page=networkminer</a>. </p>
			<p>Here is a quick sample of the information that can be gathered while running enumeration on the lab equipment:</p>
			<div>
				<div id="_idContainer546" class="IMG---Figure">
					<img src="image/B16321_13_003.jpg" alt="Figure 13.3 – NetworkMiner lab details&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.3 – NetworkMiner lab details</p>
			<p>Now that we have <a id="_idIndexMarker873"/>enumeration covered, we want to move on to access. In this step, we want to clearly communicate how we established access into our customer's network, what services we leveraged, and what user accounts we compromised to gain access, including diagrams, as the following is very useful as a visual aid:</p>
			<div>
				<div id="_idContainer547" class="IMG---Figure">
					<img src="image/B16321_13_004.jpg" alt="Figure 13.4 – Initial network access&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.4 – Initial network access</p>
			<p>Initial access could be an open service that was discovered during enumeration as in the preceding figure, or<a id="_idIndexMarker874"/> it could be a reverse shell driven by a phishing email, or a credential reuse attack from harvested data during the information gathering process. Regardless of the method of documenting, it is very important because if the access isn't documented, then the access never occurred. </p>
			<p>After documenting the initial attack, we want to document how we performed and gained privilege escalation on the systems. We covered this in <a href="B16321_11_Epub_AM.xhtml#_idTextAnchor130"><em class="italic">Chapter 11</em></a>, <em class="italic">Whoot… I Have To Go Deep</em>, and we<a id="_idIndexMarker875"/> talked about <strong class="bold">horizontal</strong> and <strong class="bold">vertical</strong> types <a id="_idIndexMarker876"/>of privilege escalation. We used <strong class="bold">Mimikatz</strong> to <em class="italic">pass the ticket</em>, and <strong class="bold">WinPEAS</strong> to automate the discovery of<a id="_idIndexMarker877"/> even more methods <a id="_idIndexMarker878"/>and tactics to use to elevate privileges. During the course of your testing, you should document the procedures run, the machines that you ran them on, and the privileges that you discovered. The following figure is a screenshot of a WinPEAS scan:</p>
			<div>
				<div id="_idContainer548" class="IMG---Figure">
					<img src="image/B16321_13_005.jpg" alt="Figure 13.5 – WinPEAS basic scan&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.5 – WinPEAS basic scan</p>
			<p>After <a id="_idIndexMarker879"/>documenting privilege escalation, we want to move on to lateral movement. We want to mention how we were able to migrate from the enterprise network down into the operational network and then finally pivot down into the controls-level network, where the <strong class="bold">Programmable Logic Controllers</strong> (<strong class="bold">PLCs</strong>), <strong class="bold">Remote Terminal Units</strong> (<strong class="bold">RTUs</strong>), controllers, and other industrial <a id="_idIndexMarker880"/>equipment resides. Now, depending on the <a id="_idIndexMarker881"/>engagement level and type of pentest that you are running, the lateral movement might simply be from operations to control, based on the fact that the customer dropped you into the operations network. Providing a graphic as shown<a id="_idIndexMarker882"/> in the following figure helps the customer's blue team really understand where they need to apply more security controls:</p>
			<div>
				<div id="_idContainer549" class="IMG---Figure">
					<img src="image/B16321_13_006.jpg" alt="Figure 13.6 – Lateral movement&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.6 – Lateral movement</p>
			<p>Finally, after all the previous steps have been documented, we arrive at the last item, impact analysis. Impact analysis might be the single most important topic of the entire report, as it is<a id="_idIndexMarker883"/> the justification for why customers hire pentesters in the first place. The requirement for them is to understand whether it is a temporary loss of operational control, business interruption, shutdown, ransom, or a myriad of other nasty issues that could cause financial loss, catastrophic failure, or even loss of life. </p>
			<p class="callout-heading">Story time</p>
			<p class="callout">When working in the northern part of Canada, I saw an engineering team switch configurations on two controllers. One controller was managing and operating a compressor and the other controller was operating a pump. No one caught the error until it was too late; the compressor blew all the seals and the pump cavitated. Needless to say, there was major disruption and financial losses for something so simple as pushing a new configuration to a PLC, much like we did in <a href="B16321_03_Epub_AM.xhtml#_idTextAnchor033"><em class="italic">Chapter 3</em></a>, <em class="italic">I Love My Bits – Lab Setup</em>. No lives were lost, which is fortunate, but this is a cautionary tale of being absolutely cautious when you gain access at the control level. If automation engineers who designed the system can make a simple mistake and cause tens of millions of dollars' worth of damage, imagine what damage a pentester could do by spraying the network with scans, scripts, and <a id="_idIndexMarker884"/>pushing different configurations to PLCs, RTUs, <strong class="bold">Human Machine Interfaces</strong> (<strong class="bold">HMIs</strong>), or controllers.</p>
			<p>The impact analysis section should be very clean and clear, and tied back to the lateral movement and privilege escalation. In <a href="B16321_12_Epub_AM.xhtml#_idTextAnchor139"><em class="italic">Chapter 12</em></a>, <em class="italic">I See the Future</em>, we gained access to the user interface of the SCADA system, which is a great example of absolute system control. We would document our findings from <a href="B16321_12_Epub_AM.xhtml#_idTextAnchor139"><em class="italic">Chapter 12</em></a>, <em class="italic">I See the Future</em>, in the impact analysis, due to the fact that we were able to reuse credentials discovered in the operations network; we could authenticate to the SCADA system and ultimately lock every user out and shut down the system. The key importance here is knowing the industry that your customer is in, which should have been discovered in the pre-engagement, kick-off meeting, or information-gathering step. Different industries will contain different levels of impact, and knowing this will be critical to document potential losses.</p>
			<p>In this section, we discussed a general format that you can take to formulate a well-rounded penetration report. We talked about structure, content, and impact, and a high-level strategy to follow. Once again, this isn't the only way to write a report and everyone can put their own spin and take on how to architect their report. It ultimately comes down to client industry and personal branding. In the next section, we are going to discuss some remediation tactics to close the security gap and ultimately help the blue team build a better defensive strategy.</p>
			<h1 id="_idParaDest-138"><a id="_idTextAnchor154"/>Closing the security gap</h1>
			<p>When it <a id="_idIndexMarker885"/>comes to pentesting, it isn't always doom and gloom. We do have a bright side to the job and that comes in the form of conveying security recommendations to help prevent the tactics and techniques used throughout your testing. In this section, we will discuss some of the security technology that can be implemented to help shore up a blue team's security posture. </p>
			<h2 id="_idParaDest-139"><a id="_idTextAnchor155"/>MITRE ATT&amp;CK</h2>
			<p>Before we<a id="_idIndexMarker886"/> jump right into the technology side of things, I want to talk <a id="_idIndexMarker887"/>about the MITRE ATT&amp;CK matrix, which <a id="_idIndexMarker888"/>can be found at this link: <a href="https://collaborate.mitre.org/attackics/index.php/Main_Page">https://collaborate.mitre.org/attackics/index.php/Main_Page</a>.</p>
			<p>This is a <a id="_idIndexMarker889"/>great visual representation of adversarial <strong class="bold">Tactics, Techniques, and Procedures </strong>(<strong class="bold">TTPs</strong>). I recommend running through each item and verifying whether your organization is vulnerable to any of the documented TTPs. Using the <a id="_idIndexMarker890"/>lateral movement tactic <a id="_idIndexMarker891"/>that we discussed in <a href="B16321_10_Epub_AM.xhtml#_idTextAnchor112"><em class="italic">Chapter 10</em></a>, <em class="italic">I Can Do It 420</em>, <a href="B16321_11_Epub_AM.xhtml#_idTextAnchor130"><em class="italic">Chapter 11</em></a>, <em class="italic">Whoot... I Have To Go Deep</em>, and <a href="B16321_12_Epub_AM.xhtml#_idTextAnchor139"><em class="italic">Chapter 12</em></a>, <em class="italic">I See the Future</em>, we will focus on the valid accounts technique, as shown in the following figure:</p>
			<div>
				<div id="_idContainer550" class="IMG---Figure">
					<img src="image/B16321_13_007.jpg" alt="Figure 13.7 – Lateral movement tactic&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.7 – Lateral movement tactic</p>
			<p>As we discussed in <a href="B16321_12_Epub_AM.xhtml#_idTextAnchor139"><em class="italic">Chapter 12</em></a>, <em class="italic">I See the Future</em>, password reuse is a major issue in the Industrial Control System (ICS) space. Under<a id="_idIndexMarker892"/> the valid accounts technique, you will find a description <a id="_idIndexMarker893"/>of the technique, assets that it can affect, real-world attacks that use valid accounts<a id="_idIndexMarker894"/> as the technique to compromise the organizations, and, most importantly, the mitigations. The following figure shows a screenshot of the <a id="_idIndexMarker895"/>valid accounts technique:</p>
			<div>
				<div id="_idContainer551" class="IMG---Figure">
					<img src="image/B16321_13_008.jpg" alt="Figure 13.8 – Valid accounts technique&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.8 – Valid accounts technique</p>
			<p>As stated previously, mitigations are a very important piece of information that can be implemented by the blue team, and these implementations will increase the security maturity of their company. The following figure is an example of the mitigations that can be taken to protect <a id="_idIndexMarker896"/>your organization against lateral movement tactics using the valid accounts technique:</p>
			<div>
				<div id="_idContainer552" class="IMG---Figure">
					<img src="image/B16321_13_009.jpg" alt="Figure 13.9 – Valid account technique mitigations&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.9 – Valid account technique mitigations</p>
			<p>There<a id="_idIndexMarker897"/> are <a id="_idIndexMarker898"/>automated systems that help ease this procedure. However, they do come with a hefty price tag. You will be able to see the results of some of these tools and how they were able to stack up to detection count, analytic coverage, telemetry coverage, and visibility of the <a id="_idIndexMarker899"/>Triton attack of 2017 if you follow this link: <a href="https://attackevals.mitre-engenuity.org/ics/triton/">https://attackevals.mitre-engenuity.org/ics/triton/</a>.</p>
			<p>Now that we have discussed the MITRE ATT&amp;CK matrix, we will move on to technology that can be adopted to help improve a defense strategy. I know that when people read this section, they will suggest that posture, procedures, and defense in depth are more important, and they wouldn't be wrong. However, those topics are very subjective in nature, and we can get lost down many rabbit holes discussing those particular topics. I chose the topic of technology for the simple reason that everyone can agree that budgets for shiny new products get approval before strategic training programs. Also, there needs to be some bare minimums in place to mitigate at least 90% of most attacks.</p>
			<h2 id="_idParaDest-140"><a id="_idTextAnchor156"/>Industrial firewalls</h2>
			<p>One of <a id="_idIndexMarker900"/>the oldest security technologies and one of the most fundamental is the firewall. You would be surprised but there are organizations<a id="_idIndexMarker901"/> that still do not use firewalls in their industrial environment. There are fewer and fewer of these organizations to be found, especially after the numerous international industrial incidents, but they can still be discovered. We quickly discussed firewalls in <a href="B16321_11_Epub_AM.xhtml#_idTextAnchor130"><em class="italic">Chapter 11</em></a>, <em class="italic">Whoot… I Have To Go Deep</em>, and did a bit of high-level configuration of a pfSense firewall. In this section, we are going to discuss industry firewalls that you will come across in your pentesting journeys.</p>
			<p>The Cisco ISA3000 is <a id="_idIndexMarker902"/>an industrial firewall that you most certainly will come across; it is hyper-prevalent in the oil and gas industry. If you come across a customer that uses Cisco core switches, then there is a high probability that you find the ISA3000 in the lower segments. There are many highlights of the ISA3000, such as its ability to integrate into the greater Cisco ecosystem<a id="_idIndexMarker903"/> alongside <strong class="bold">Identity Services Engine</strong> (<strong class="bold">ISE</strong>), <strong class="bold">Cyber Vision</strong>, <strong class="bold">SecureX</strong>, <strong class="bold">Threat Response</strong>, and <a id="_idIndexMarker904"/>other<a id="_idIndexMarker905"/> Cisco security products. The ISA3000 supports containers, and this allows for the organization to quickly spin up Cisco Cyber Vision, which<a id="_idIndexMarker906"/> is an <strong class="bold">industrial intrusion detection system</strong>. Because of the containerization, the <a id="_idIndexMarker907"/>need for extra hardware and excesses spanning to take place is reduced. Next, with the ISE integration, it allows for newly discovered devices to be immediately quarantined by having ISE publish <strong class="bold">Security Group Tags</strong> (<strong class="bold">SGTs</strong>), which <a id="_idIndexMarker908"/>will auto-create rules for the network. This type of behavior can be very frustrating when operating a pentest in an environment that has enabled this type of integration. You will notice that you have access to certain assets for a short period of time and then, moments later, a loss of communication with the same assets due to published rules. More information about this can be found at the following link: <a href="https://www.cisco.com/c/en/us/products/security/industrial-security-appliance-isa/index.html">https://www.cisco.com/c/en/us/products/security/industrial-security-appliance-isa/index.html</a>.<span class="hidden"> </span></p>
			<p>The Palo Alto PA-220R has <a id="_idIndexMarker909"/>gained amazing traction in many unique industries and is the second most common firewall that I have encountered inside the industrial networks that I have worked with. Just like Cisco, Palo Alto has integrated ruggedized firewalls into a larger overarching ecosystem. One of the most interesting features in my mind would have to be Palo Alto's WildFire service. WildFire is a community-shared service, where anything detected and crafted is detected and shared across the subscription service. If a rogue malicious file is detected on the system, it is tagged, and a signature is generated and submitted to WildFire. Any customer subscribed to WildFire has the ability to automatically pull down the signature and add it to the list of detection signatures inside the PA-220R. This service, if enabled, can be<a id="_idIndexMarker910"/> painfully <a id="_idIndexMarker911"/>annoying, as it requires some advanced strategies using <strong class="bold">MSFvenom</strong> and <strong class="bold">Shikata Ga Nai</strong>, which is a polymorphic <a id="_idIndexMarker912"/>encoder for generating reverse shellcode. This helps prevent WildFire from stopping unique files containing shellcode from being blocked across entire industries. More information about the <a id="_idIndexMarker913"/>Palo Alto ruggedized firewall can be found at the following link: <a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall/pa-220r">https://www.paloaltonetworks.com/network-security/next-generation-firewall/pa-220r</a>.</p>
			<p>The Check Point Quantum Rugged 1570R is another NGFW to percolate down into the <strong class="bold">ICS</strong> space, and I <a id="_idIndexMarker914"/>have definitely come across this in utility companies. Touting a library of 1500 ICS protocols, I can definitely vouch for a number of these and, specifically, the protocols that we discussed in <a href="B16321_08_Epub_AM.xhtml#_idTextAnchor097"><em class="italic">Chapter 8</em></a>, <em class="italic">Protocols 202</em>. The following link will provide <a id="_idIndexMarker915"/>more information: <a href="https://www.checkpoint.com/quantum/next-generation-firewall/industrial-control-systems-appliances/">https://www.checkpoint.com/quantum/next-generation-firewall/industrial-control-systems-appliances/</a>. </p>
			<p>Other notable firewalls include Fortinet, Hirschmann, Red Lion, and Stormshield, to name a few. </p>
			<p>In the next section, we will be discussing various OT monitoring solutions.</p>
			<h4>OT monitoring solutions</h4>
			<p>For <a id="_idIndexMarker916"/>some time, OT monitoring solutions <a id="_idIndexMarker917"/>were the de facto technology being utilized in industrial networks. These solutions are a mixture of agents, rules, baselines, policies, and signatures. The deployment method was to install agents on the workstations, data historians, SCADA servers, and various other equipment, and have those agents collect key operational information from the assets that they are installed on and send it to a collection point. At this collection point, rules and signatures are applied to detect changes or anomalous behavior on the endpoint. This generates alerts and events that can be monitored by a security team. The following diagram is what a typical installation <a id="_idIndexMarker918"/>could look like inside our lab:</p>
			<div>
				<div id="_idContainer553" class="IMG---Figure">
					<img src="image/B16321_13_010.jpg" alt="Figure 13.10 – A typical OT monitoring solution&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.10 – A typical OT monitoring solution</p>
			<p>Industrial Defender's solution, now called ASM, is notably one of the first, if not the first, industrial cybersecurity solutions to hit the market. This product can be found on six or seven continents in multiple industries and landed a heavy presence in the electrical utility industry, as it <a id="_idIndexMarker919"/>embraced the <strong class="bold">North American Electric Reliability Corporation</strong> (<strong class="bold">NERC</strong>) <strong class="bold">Critical Infrastructure Protection</strong> (<strong class="bold">CIP</strong>) standard and provided an automated solution that aided utilities in adhering to compliance requirements. This product allows the customer to have a complete granularity of every asset in<a id="_idIndexMarker920"/> the network, software installed, users that have access, firewall rules applied, patches applied, services running, and <a id="_idIndexMarker921"/>much more. If a new account is locally created, an alert is instantly triggered and sent off to the security team, due to the fact that the baseline of the asset has been altered. The following link can provide more solution information: <a href="https://www.industrialdefender.com/ot-cyber-risk-management/">https://www.industrialdefender.com/ot-cyber-risk-management/</a>.</p>
			<p>PAS's Cyber Integrity is a <a id="_idIndexMarker922"/>direct competitor to Industrial Defender's ASM solution. Both provide similar features to address the fortification tasks that the industrial <a id="_idIndexMarker923"/>cybersecurity landscape presents. PAS has a unique feature that allows customers to keep track of their PLC, RTU, and controller source code, and perform differentials on files, looking for any major issues that could rear their ugly head, plus the added value of having a gold copy of the source for a quick rollback. If you follow this link, you will find more information about Cyber Integrity: <a href="https://cyber.pas.com/cyber-integrity/ot-ics-cyber-integrity">https://cyber.pas.com/cyber-integrity/ot-ics-cyber-integrity</a>.</p>
			<p>Other <a id="_idIndexMarker924"/>notable OT monitoring products include Verve and <a id="_idIndexMarker925"/>Tripwire.  </p>
			<p>In the next section, we will be discussing <strong class="bold">IDS</strong></p>
			<p>.</p>
			<h4>Intrusion detection systems</h4>
			<p>In <a href="B16321_05_Epub_AM.xhtml#_idTextAnchor049"><em class="italic">Chapter 5</em></a>, <em class="italic">Span Me If You Can</em>, I covered <a id="_idIndexMarker926"/>IDS in<a id="_idIndexMarker927"/> great detail, and now we are talking about them again due to the fact that they really have taken the industry by storm, and at the time of writing this, Dragos, Claroty, and Nozomi Networks have all raised $100 million of additional capital, which means that these technologies certainly have legs and the confidence of institutional investors. Dale Peterson and Roger Collins started a company called Digital Bond over two decades before the writing of this book. They wrote the first signatures for the IDS space. I wonder if they knew at the time that the industry would grow as dramatically as it has, with companies such as SecurityMatters, Indegy, CyberX, and Sentryo being acquired for close to a combined value of $500 million, and then the previous three companies adding over $300 million extra in funding, in addition to companies such as SCADAfence and Armis, which tips the industry value into well over $1 billion. If the company you come across doesn't have an IDS, I would say that this is an easy win when it comes to recommendations. If you look at the following diagram, you can see the typical placement<a id="_idIndexMarker928"/> of IDS sensors, although you can have variable numbers of sensors scattered around the network:</p>
			<div>
				<div id="_idContainer554" class="IMG---Figure">
					<img src="image/B16321_13_011.jpg" alt="Figure 13.11 – A typical IDS installation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.11 – A typical IDS installation</p>
			<p>The Dragos Platform <a id="_idIndexMarker929"/>has infused the latest industry intelligence with top-tier talent to develop a holistic solution. The unique part of the product is the battle-tested playbooks that they incorporate into the solution. On top of the detection and alerting features that generate events, there lies a module that provides clients with plans of actions to take to close any security gaps that are detected. This allows for the product to be managed and<a id="_idIndexMarker930"/> monitored by non-industry experts, which happens to be one of the biggest issues in industrial cybersecurity – the drastic lack of skilled talent. If you come across this technology, know that you have a high probability of having your device being blacklisted across the switchgear. More information about the platform can be <a id="_idIndexMarker931"/>found at this link: <a href="https://www.dragos.com/platform/">https://www.dragos.com/platform/</a>.</p>
			<p>Claroty's <strong class="bold">Continuous Threat Detection</strong> (<strong class="bold">CTD</strong>) brings all the bells and whistles those other IDS solutions present. The security research team is top-notch, and they have published information <a id="_idIndexMarker932"/>on multiple vulnerabilities for the community to consume and detect. One of the most interesting features is the root-cause analysis that the platform performs. This allows the user to trace from where a security breach or vulnerability started. A lot of research goes into a module that performs this unique analysis, and the customer base benefits from this and enables the security<a id="_idIndexMarker933"/> team to plug the holes. For more information, follow this link: <a href="https://claroty.com/comprehensive-platform-overview/">https://claroty.com/comprehensive-platform-overview/</a>.</p>
			<p>Notable vendors include Nozomi Networks, Cisco Cyber Vision (Sentryo), SCADAfence, Tenable OT (Indegy), Microsoft (CyberX), and Forescout (SecurityMatters).</p>
			<p>I should make a note that when mentioning other tools, there has been no bias, just simply equipment that I have come across during my career in industrial cybersecurity. There are many other products and vendors that round out the topics that were covered, such as industrial firewalls, OT monitoring solutions, IDS, and host IDS. Make sure that you do your due diligence when researching and investigating products and technology that you want to recommend to your clients during the recommendations stage of your report.</p>
			<h1 id="_idParaDest-141"><a id="_idTextAnchor157"/>Summary</h1>
			<p>In this chapter, we discussed tips and techniques for drafting a penetration report and went through key elements that will help close the security gap for your customers.</p>
			<p>These topics round out the pentesting journey, which brings us to the end of the chapter and, ultimately, the book. Some people might have made it this far and they may be disappointed that there was no <em class="italic">click, deploy, and pwn</em> solution to hack critical infrastructure. I have to say that writing this book caused some moral dilemmas with how deep to go on certain topics and how much compromising information should be revealed. I think that enough knowledge was passed on to help new pentesters establish a firm foundation and build on these fundamental skills. I wish you luck and best wishes on your journey, and I will leave you with this quote:</p>
			<p class="author-quote">"There's really no secret about our approach. We keep moving forward – opening up new doors and doing new things – because we're curious. And curiosity keeps leading us down new paths. We're always exploring and experimenting."</p>
			<p class="author-quote">                                                                                            – Walt Disney</p>
		</div>
	</body></html>