<html><head></head><body>
		<div id="_idContainer003">
			<h1 id="_idParaDest-5"><a id="_idTextAnchor004"/>Preface</h1>
			<p>The industrial cybersecurity industry has grown significantly in recent years. To truly secure today's critical infrastructure, red teams must be employed to continuously test and exploit the security integrity of a company's people, processes, and products. This pentesting book takes a slightly different approach than most by helping you to gain hands-on experience with equipment that you'll come across in the field. This will enable you to understand how industrial equipment interacts and operates within an operational environment.</p>
			<p>The book begins by helping you get to grips with the basics of industrial processes, and then shows you how to create and break the process, along with gathering open source intel to create a threat landscape for your potential customer. As you advance, you'll find out how to install and utilize offensive techniques used by professional hackers. Throughout the book, you'll explore industrial equipment, open source intel gathering, port and service discovery, pivoting, and finally, launching attacks against systems in an industrial network.</p>
			<p>By the end of this penetration testing book, you'll not only understand how to analyze and navigate the intricacies of an <strong class="bold">Industrial Control System</strong> (<strong class="bold">ICS</strong>) but will also have gained essential offensive and defensive skills to proactively protect industrial networks from modern cyber-attacks.</p>
			<h1 id="_idParaDest-6"><a id="_idTextAnchor005"/>Who this book is for</h1>
			<p>This book started out as purely a manual for industrial pentesting and in doing so it was aimed at people who wanted learn about industrial pentesting; however, it grew into more of a convergence effort because I had numerous people ask me about getting into the <strong class="bold">Operational Technology</strong> (<strong class="bold">OT</strong>) security space, I figured that I would try and cover topics that addressed both sides of the convergence the OT and IT personas.  IT security personnel who want a hands-on introduction to industrial pentesting will learn about the automation and controls aspect of industrial pentesting, while automation/control engineers who want to better understand their potential threat landscape will learn more about the IT networking aspects.</p>
			<h1 id="_idParaDest-7"><a id="_idTextAnchor006"/>What this book covers</h1>
			<p><a href="B16321_01_Epub_AM.xhtml#_idTextAnchor013"><em class="italic">Chapter 1</em></a>, <em class="italic">Using Virtualization</em>, will walk you through the basic building blocks of virtualization, and then progress into building out a hypervisor that will support our virtual ICS lab.</p>
			<p><a href="B16321_02_Epub_AM.xhtml#_idTextAnchor027"><em class="italic">Chapter 2</em></a>, <em class="italic">Route the Hardware</em>, covers the principles of setting up a <strong class="bold">Programmable Logic Controller</strong> (<strong class="bold">PLC</strong>), and then moves on to the fundamentals of connecting that PLC to a virtual machine on our newly minted hypervisor.</p>
			<p><a href="B16321_03_Epub_AM.xhtml#_idTextAnchor033"><em class="italic">Chapter 3</em></a>, <em class="italic">I Love My Bits – Lab Setup</em>, takes us through the steps of writing, downloading, and uploading our first program to our PLC.</p>
			<p><a href="B16321_04_Epub_AM.xhtml#_idTextAnchor040"><em class="italic">Chapter 4</em></a>, <em class="italic">Open Source Ninja</em>, teaches you about the power of Google-Fu, oversharing on LinkedIn, exposed devices on Shodan.io, navigating ExploitDB, and finally, leveraging the national vulnerability database.</p>
			<p><a href="B16321_05_Epub_AM.xhtml#_idTextAnchor049"><em class="italic">Chapter 5</em></a>, <em class="italic">Span Me If You Can</em>, teaches you about SPANs and TAPs and how they can be leveraged in a pentesting engagement, and then we will take a deep dive into intrusion detection systems.</p>
			<p><a href="B16321_06_Epub_AM.xhtml#_idTextAnchor063"><em class="italic">Chapter 6</em></a>, <em class="italic">Packet Deep Dive</em>, walks through the structure of a typical packet, teaching you how to capture packets from the wire, and then analyzing those packets for key information.</p>
			<p><a href="B16321_07_Epub_AM.xhtml#_idTextAnchor081"><em class="italic">Chapter 7</em></a>, <em class="italic">Scanning 101</em>, starts out by building a live SCADA system, and then moves on to using NMAP, RustScan, Gobuster, and feroxbuster to perform scanning techniques on our live SCADA system.</p>
			<p><a href="B16321_08_Epub_AM.xhtml#_idTextAnchor097"><em class="italic">Chapter 8</em></a>, <em class="italic">Protocols 202</em>, takes a deep dive into Modbus and Ethernet/IP and the ways we can utilize these protocols to perform pentesting tasks inside the ICS.</p>
			<p><a href="B16321_09_Epub_AM.xhtml#_idTextAnchor106"><em class="italic">Chapter 9</em></a>, <em class="italic">Ninja 308</em>, leverages FoxyProxy and Burp Suite to analyze and attack the SCADA user interface.</p>
			<p><a href="B16321_10_Epub_AM.xhtml#_idTextAnchor112"><em class="italic">Chapter 10</em></a>, <em class="italic">I Can Do It 420</em>, starts off by installing and configuring a corporate-side firewall to provide a more holistic lab setup. Then, we continue on to scanning, exploiting, and then landing reverse shells.</p>
			<p><a href="B16321_11_Epub_AM.xhtml#_idTextAnchor130"><em class="italic">Chapter 11</em></a>, <em class="italic">Whoot… I Have To Go Deep</em>, now that we have the shells, looks at running post-exploitation modules to glean data from inside the network. We will escalate privileges on the machines that we compromise, and then pivot down to the lower segments.</p>
			<p><a href="B16321_12_Epub_AM.xhtml#_idTextAnchor139"><em class="italic">Chapter 12</em></a>, <em class="italic">I See the Future</em>, looks at the dangers of credential reuse by taking you through the steps of leveraging credentials discovered in previous steps and then accessing the SCADA interface for ultimate control of the system.</p>
			<p><a href="B16321_13_Epub_AM.xhtml#_idTextAnchor147"><em class="italic">Chapter 13</em></a>, <em class="italic">Pwnd but with Remorse</em>, discusses the core deliverable, the report. If there is no evidence, did a test actually occur? We will prepare a template for future assessments/pentests, then discuss the critical information that lands inside the report, and then finally, document recommendations that can be used by the blue team to protect their systems into the future.</p>
			<h1 id="_idParaDest-8"><a id="_idTextAnchor007"/>To get the most out of this book</h1>
			<p>You should try and get your hands on a mini-PC that can handle 32 GB+ of RAM and has at least two Ethernet ports. Intel NUC, GIGABYTE BRIX, and Zotac Z-Box are examples of devices that would be very useful to run your virtual images on.</p>
			<p><strong class="bold">If you are using the digital version of this book, we advise you to type the code yourself or access the code from the book's GitHub repository (a link is available in the next section). Doing so will help you avoid any potential errors related to the copying and pasting of code.</strong></p>
			<p>Code in Action</p>
			<p>The Code in Action videos for this book can be viewed at <a href="https://bit.ly/3iZpT2f">https://bit.ly/3iZpT2f</a>.</p>
			<h1 id="_idParaDest-9"><a id="_idTextAnchor008"/>Download the color images</h1>
			<p>We also provide a PDF file that has color images of the screenshots and diagrams used in this book. You can download it here: <a href="http://www.packtpub.com/sites/default/files/downloads/9781800202382_ColorImages.pdf">http://www.packtpub.com/sites/default/files/downloads/9781800202382_ColorImages.pdf</a>.</p>
			<h1 id="_idParaDest-10"><a id="_idTextAnchor009"/>Conventions used</h1>
			<p>There are a number of text conventions used throughout this book.</p>
			<p><strong class="source-inline">Code in text</strong>: Indicates code words in text, database table names, folder names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter handles. Here is an example: "Go ahead and open the PCAP file labeled <strong class="source-inline">4SICS-GeekLounge-151021.pcap</strong> with Wireshark."</p>
			<p>A block of code is set as follows:</p>
			<p class="source-code">def run_async_server(): </p>
			<p class="source-code">    store = ModbusSlaveContext( </p>
			<p class="source-code">        di=ModbusSequentialDataBlock(0, [17]*100), </p>
			<p class="source-code">        co=ModbusSequentialDataBlock(0, [17]*100), </p>
			<p class="source-code">        hr=ModbusSequentialDataBlock(0, [17]*100),</p>
			<p>When we wish to draw your attention to a particular part of a code block, the relevant lines or items are set in bold:</p>
			<p class="source-code">import logging </p>
			<p class="source-code">FORMAT = ('%(asctime)-15s %(threadName)-15s'  </p>
			<p class="source-code">          '%(levelname)-8s %(module)-15s:%(lineno)-8s %(message)s') </p>
			<p class="source-code"><strong class="bold">logging.basicConfig(format=FORMAT) </strong></p>
			<p class="source-code">log = logging.getLogger() </p>
			<p class="source-code">log.setLevel(logging.DEBUG)</p>
			<p>Any command-line input or output is written as follows:</p>
			<p class="source-code">tcpdump -i &lt;interface&gt; -v -X</p>
			<p><strong class="bold">Bold</strong>: Indicates a new term, an important word, or words that you see onscreen. For instance, words in menus or dialog boxes appear in <strong class="bold">bold</strong>. Here is an example: "We will want to set the port mirroring, so select the <strong class="bold">Monitoring</strong> option from the menu on the left and then select <strong class="bold">Port Mirror</strong>."</p>
			<p class="callout-heading">Tips or important notes	</p>
			<p class="callout">Appear like this.</p>
			<h1 id="_idParaDest-11"><a id="_idTextAnchor010"/>Get in touch</h1>
			<p>Feedback from our readers is always welcome.</p>
			<p><strong class="bold">General feedback</strong>: If you have questions about any aspect of this book, email us at <strong class="source-inline">customercare@packtpub.com</strong> and mention the book title in the subject of your message.</p>
			<p><strong class="bold">Errata</strong>: Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you have found a mistake in this book, we would be grateful if you would report this to us. Please visit <a href="http://www.packtpub.com/support/errata">www.packtpub.com/support/errata</a> and fill in the form.</p>
			<p><strong class="bold">Piracy</strong>: If you come across any illegal copies of our works in any form on the internet, we would be grateful if you would provide us with the location address or website name. Please contact us at <strong class="source-inline">copyright@packt.com</strong> with a link to the material.</p>
			<p><strong class="bold">If you are interested in becoming an author</strong>: If there is a topic that you have expertise in and you are interested in either writing or contributing to a book, please visit <a href="http://authors.packtpub.com">authors.packtpub.com</a>.</p>
			<h1 id="_idParaDest-12"><a id="_idTextAnchor011"/>Share Your Thoughts</h1>
			<p>Once you've read <em class="italic">Pentesting Industrial Control Systems</em>, we'd love to hear your thoughts! Please <a href="">click here to go straight to the Amazon review page</a> for this book and share your feedback.</p>
			<p>Your review is important to us and the tech community and will help us make sure we're delivering excellent quality content.</p>
		</div>
	</body></html>