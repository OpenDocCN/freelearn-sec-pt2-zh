<html><head></head><body><div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Secure Network Design</h1>
                </header>
            
            <article>
                
<p>In the previous chapter you learned about the basic concept of infrastructure security and built a strong foundation for the different areas required to understand the need for information security based on current security threats that exist in cyber space.</p>
<p>The internet has grown dramatically and has reached a stage where everyone must be connected in order to exchange information. Imagine that billions of people with internet enabled devices are directly connected to the internet, and some sort of unsecured network becomes a target for cyber criminals.</p>
<p>In this chapter, we describe how to secure a network and look at the significance of network security. In a layered fashion, we will also discuss methods and approaches to building a secure network based on business aims.</p>
<p>The following topics will be covered in this chapter:</p>
<ul>
<li>Access control</li>
<li>Network management and security design</li>
<li>Hardening your TCP/IP stack</li>
<li>DoS and DDoS attacks</li>
<li>IP spoofing</li>
<li>Ping sweeps and port scans</li>
<li>DNS vulnerabilities</li>
<li>Two-factor authentication</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Access control </h1>
                </header>
            
            <article>
                
<p>As an application or network owner, we should know who or what is accessing our network resources. If we do not know or do not keep track of our activity and instead just assume what is happening on the network, we cannot guarantee data security and the safety of end-users.</p>
<p>We need to start with the basics of security. This begins with understanding what's on our network.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Asset classification and physical security</h1>
                </header>
            
            <article>
                
<p>The most basic (but often most overlooked) element of network security involves keeping hardware protected from theft or physical intrusion.</p>
<p>As mentioned earlier, the first thing we need to classify is our assets. Once data classification is identified, network servers, network switches and other core network components should be protected in well-guarded facilities. Cages and racks should be locked and permission should be granted based on requirements with proper approval and proper security guidelines.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Authentication, authorization, and accounting</h1>
                </header>
            
            <article>
                
<p><strong>Authentication, authorization, and accounting</strong> (<strong>AAA</strong>) is a function for centrally and securely controlling access to IT infrastructure resources. This is achieved by enforcing policies and providing audit functionality by keeping track of activities performed on a given device. In simple terms, authentication can refer to identifying a user with a username and password. The AAA server matches user's authentication credentials against credentials setup and stored in a back-end database. The authorization process validates whether the user has the authority to do a specified task or not. This can include accessing or executing any command on a given resource. The final piece in the AAA function is accounting, which records all the activity on resources consumed by a user during access.</p>
<p>AAA functions are always offered by an exclusive centralized AAA server, a software program that performs all these functions. A current standard by which network access servers interface with the AAA server is the <strong>Remote Authentication Dial-In User Service</strong> (<strong>RADIUS</strong>) or <strong>Terminal Access Controller Access Control System</strong> (<strong>TACACS</strong>) protocols.</p>
<p>TACACS can be further connected to domain controller security groups, which gives elevated security access. You will have to create two security groups on domain controller, for example, <em>RO</em> and <em>RW</em>. After one or two human security approvals, your user account will be automatically added to the <em>RW</em> group. This provides a way to dynamically request administrative (admin) access to production machines. After the specified time, the account will be removed from there automatically.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Network management and security design</h1>
                </header>
            
            <article>
                
<p>For managing network and networking assets, there must always be a centralized secure management utility subnet for services such as DNS, DHCP, NTP, AAA, and network management. By defining boundaries, it becomes much easier to troubleshoot problems with the services when they are in known locations with a few well-known access paths and methods.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Network segmentation</h1>
                </header>
            
            <article>
                
<p>Most of us focus on front door security and threats coming from the outside world by putting some sort of firewall on the perimeter. In reality, relying upon perimeter security alone does not protect your network and information data. Doing this is like putting money into a bank which depends on one armed guard.</p>
<p>The concept of <em>segmentation</em> is based on ancient history, when Roman empires formed and fought units based on the ethnic and geographic identity of captured warriors. The idea was very simple: groups of warriors were formed on the basis of their similar backgrounds so that they could bond with each other and ultimately become better fighting units.</p>
<p>Resource consolidation, virtualization and network consolidation can be beneficial when focusing on infrastructure security. The consolidation of network infrastructure with improved security has been a crucial part of the segmentation strategy. A legacy model of distributed applications and services with complex designs are now migrating to shared physical infrastructure or cloud networks that require separation to maintain strong isolation. Similarly, networks have gone through abrupt changes over the past few years with the introduction of virtualization, <strong>Software Defined Network</strong> (<strong>SDN</strong>), containers, wireless connectivity, hosting services, Data Center infrastructure and the <strong>Internet of Things</strong> (<strong>IoT</strong>). Network separation can be achieved by implementing Layer-2 technologies such as VLANs, Layer-3 technologies such as <strong>virtual routing and forwarding</strong> (<strong>VRF</strong>) for routing separation, and zone based firewalls for segment separation.</p>
<p>In today's cyber security environment, you have to assume that you are not 100% immune to these threats and something malicious might already be on a network. Using a multi-layer approach, network segmentation makes it more difficult for an attacker to launch an attack throughout your entire network. It also adds an additional layer of deterrent for insiders because you can isolate valuable data and resources from insider attacks.</p>
<p>From a network design point of view, networks with limited segmentation, a high number of users and various applications typically experience access control issues. Every user group has access to pretty much every application in the enterprise network. All departments can connect to all other resources on a network, as shown in the following diagram:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/3a6e366a-700a-4789-bfaf-38912b41c9f1.png" style="width:41.00em;height:23.08em;" width="559" height="315"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Segmentation strategy steps</h1>
                </header>
            
            <article>
                
<p>Segmentation design and strategy should be based on the critical asset value or resource, not simply on network boundaries-based isolation. This design strategy should start as a high level network design which segregates the various zones through traditional network boundaries such as DMZ, data center, virtual cloud and campus network. It then consistently drills into each zone to provide isolation between the applications within it:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-92 image-border" src="Images/5fe10efc-47fb-49d4-bc3a-b2af1909ea02.png" style="width:41.92em;height:29.92em;" width="622" height="443"/></div>
<p><strong>Virtual LAN (VLAN)</strong>: A flat local area network segment forms a single broadcast domain. This means that if a user broadcasts information on a LAN, the broadcast will be heard by all other users on the same LAN. To limit the broadcast and to separate users and applications, the LAN segment can be divided into logical segments called <strong>VLAN </strong>while still sharing the same common wired physical network. In the following diagram, you can refer to the first VLAN as VLAN_1, which is dedicated to the finance team; VLAN_2 is dedicated to HR and VLAN_3 to payroll. All VLANs share the same physical media but are logically separated in order to limit broadcast:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-93 image-border" src="Images/34fb2433-6ad2-4521-ab18-14af6125e1de.png" style="width:64.50em;height:30.33em;" width="774" height="364"/></div>
<p>In the following diagram, each color represents a different VLAN. This diagram demonstrates what the connection will look like:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1195 image-border" src="Images/214f9ba7-e644-4df2-b3df-ffba8aea161e.png" style="width:12.00em;height:12.08em;" width="448" height="453"/></div>
<p>The red cable represents VLAN1, the violet cable represents VLAN2 and the yellow cable represents VLAN3.</p>
<p><strong>Virtual Routing and Forwarding</strong> <strong>(VRF)</strong><span>: Virtualization is a technique which has the great advantage of hiding the physical characteristics of computer resources shared with multiple operating systems. An end user interacts with those resources without even knowing the common shared resources. VRF is a technique for </span><span><strong>Internet Protocol</strong> </span><span>(</span><strong>IP</strong><span>) network routers that allows multiple instances of a routing table to exist in a router and work simultaneously. VRF also increases network security, which is the reason why these VRF resources cannot talk to each other unless they talk via a separate Layer-3 device. The main advantage of VRF is that they can have overlapping IP addresses without having any conflict. For example, in an MPLS network, multiple customers are using the same IP range and service provider resources are shared. VRF provides the flexibility to use the same IP space for multiple customers and security as well. As shown in the following diagram, there are four VRFs and all are using the same IP range on the same router:</span></p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-94 image-border" src="Images/27582320-33b4-4d51-a237-25760d994ac9.png" style="width:31.92em;height:18.42em;" width="704" height="405"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Network protection consideration and design</h1>
                </header>
            
            <article>
                
<p>LAN protection revolves around Layer-2 protection on OSI models. All layers of TCP/IP have got its own security threats and vulnerabilities. A firewall is one very simple way to protect a LAN, but this only protects traffic which is coming from outside. Layer-2 attacks are sources from <em>inside</em> a LAN.</p>
<p>It is difficult for an outsider to achieve a Layer-2 attack, but never underestimate the power of insiders. Insiders can do more damage than outsiders by launching malicious attacks from inside the network. The proactive deterrence for this would be to keep track of your logs and setup your IDS to detect such attacks!</p>
<p>Before going deeper into this topic, let's get an understanding of how network switches work.</p>
<p>Let us examine a topology in a VLAN segment: A, B &amp; C are three hosts which are connected to three different ports on a single switch. When host A sends data to host B through port <kbd>Fastethernet0/1</kbd>, the switch learns that host A is located on port <kbd><span>Fastethernet</span>0/1</kbd> and records mapping into the <strong>Content-Addressable Memory</strong> (<strong>CAM</strong>). If host B does not initiate a connection and does not send <span>even</span><span> </span><span>a single packet, then the switch is not able to locate host B and will therefore flood the packet originated by A to all VLAN ports. Learning by flood is the basic behavior of the switch which is carried out to discover hosts on a network:</span></p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1197 image-border" src="Images/159b11c3-b9b9-4820-a9a2-880ad140c2a1.png" style="width:28.58em;height:25.75em;" width="923" height="829"/></div>
<div class="CDPAlignCenter CDPAlign"/>
<p>Here are the known major Layer-2 attacks:</p>
<ul>
<li><strong>CAM OVERFLOW / MAC FLOODING</strong>: Switches store MAC addresses in a CAM table. Memory size varies according to each model and capacity, but memory size is limited. It is very possible to flood the network switch with <span class="_Yht">fictitious</span><span> </span>MAC address data. The switch, not knowing how to handle the excess data, falls into a trap and starts acting as a HUB. After the attack, you can use a program like Wireshark or any other generic sniffer to listen to all the traffic on the network, because the switch will be forwarding data out of all other ports. Macof is a member of the <kbd>dsniff</kbd> suit tool set and is mainly used to flood the switch on a local network with MAC addresses. Macof generates thousands of packets per second, and each packet is sent random source and destination IP addresses. A source and destination MAC address is also different for each Ethernet frame.</li>
<li><strong>CAM Flow Protection and Defensive Measures</strong>: Port security features can be used to protect a network against this kind of attack, which limits the number of MAC addresses on an interface. Cisco is built into the IOS, and this allows you to shut the port down if the switch receives more than a certain number of MAC addresses on one port.</li>
</ul>
<p>Nexus 3064 switch can hold 128k entries. Total MAC addresses learned by this switch can be viewed using this command:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-95 image-border" src="Images/1363132c-b03b-454c-bdce-8d562b8076dd.png" style="width:44.25em;height:11.00em;" width="609" height="152"/></div>
<p>Cisco IOS switch 2960 can hold 8k entries:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-96 image-border" src="Images/fa21c692-f226-4d26-bda0-419680df252f.png" style="width:40.67em;height:17.83em;" width="574" height="252"/></div>
<p>As soon as you launch the <kbd>macof</kbd> attack, available addresses become zero and the switch starts acting as a HUB.</p>
<p>You can limit the number of MAC addresses learned on this switch interface and define the violation action. Keep in mind that this is a simple step to secure the user port, but in the case of data center environments where virtualization is used, more MAC addresses are expected to be learned on the same switch port:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-97 image-border" src="Images/3149a86e-6568-48d0-8943-78e1870b433b.png" style="width:41.17em;height:16.08em;" width="580" height="228"/></div>
<p>This is a virtual environment and multiple MACs are being learned on the same interface. This is not an attack but you can still limit the number of MACs in accordance with the design guide:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-98 image-border" src="Images/e295cea8-3fcc-44cd-b86a-dc128f4280bd.png" style="width:84.08em;height:21.17em;" width="888" height="223"/></div>
<p><strong>ARP SPOOFING: Address Resolution Protocol</strong> (<strong>ARP</strong>) is a protocol or process used for finding an unknown MAC address for a known IP address. All network devices that need to communicate on the network broadcast ARP queries in the system to find out other machines' MAC addresses. In simple terms, for any communication on an IP network, we need to know the MAC address of the next hop in order to place the packet on the wire. </p>
<p>There are two types of ARP messages that can be sent:</p>
<ul>
<li>ARP request</li>
<li>ARP reply</li>
</ul>
<p>In an ARP request message, the sender broadcasts the ARP request to all computers in a subnet in order to discover the MAC address of the targeted IP address.</p>
<p>In an ARP reply, the target system sends the reply to the sender, giving the MAC address.</p>
<p>For example, the target spoofed may be the internet gateway router. The attacker spoofs the router's MAC address. To divert traffic, you will have to put the same IP on the other device. However, this will cause IP duplication and may alert the network administrator. There are very few ARP requests transmitted by a router because the ARP caching time for such a device may be huge (for example, default CISCO router configuration takes eight hours). All of this magic happens with gratuitous ARP, which automatically causes ARP to broadcast its MAC address to the entire network. In this case, attackers will send <strong>Gratuitous ARP</strong> (<strong>GARP</strong>) to poison the ARP table in a victim's machine:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-99 image-border" src="Images/c70826fa-2114-40ca-ba65-81d96f7b0f6a.png" style="width:74.67em;height:41.08em;" width="896" height="493"/></div>
<p style="margin: 0in;margin-bottom: .0001pt;background: white"><span>The preceding diagram demonstrates the normal process for learning the MAC address of the gateway. A victim's host machine sends ARP requests to the default gateway <kbd>192.168.1.1</kbd> and gets a response which contains the MAC address <kbd>CC:CC:CC:CC:CC</kbd>:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/1e9c2144-a1fe-4f70-9735-5683206dceaf.png" width="916" height="494"/></div>
<p>Attackers send G-ARP, which tells the victim that they now own the default gateway <kbd>192.168.1.1</kbd> and the source IP <kbd>192.168.1.2</kbd>. This is where the game begins. The communication can now be hijacked with the sniffer. This will enable the victim and the internet gateway to exchange traffic through the attacker's PC <span>without notifying them</span>.</p>
<p><strong>WAN protection</strong>: WAN is a geographically distributed connectivity that connects multiple networks. A typical WAN may consist of a connection to an internet service provider's multiple locations, internet connection between ISPs, connectivity to branch offices, collocation facilities, cloud services, public internet connectivity, and other locations. For example, MPLS WAN, INTERNET WAN, PRIVATE LEASE LINES, IPLC CIRCUITS, and DARK FIBER CIRCUITS.</p>
<p>To protect confidentiality and integrity for data travelling over the WAN, we need to ensure data is encrypted. Over internet VPNs, IPsec and SSL encryptions can provide comprehensive protection.</p>
<p>All MPLS service providers use the term <strong><span>Virtual Private Network</span></strong> (<strong><span>VPN</span></strong>), indicating some level of security. But in reality, MPLS does not provide encryption by default. Instead, technology allows service providers to keep the separate routing tables for each customer. Attackers cannot directly gain access to an MPLS customer network, but they might gain access to the core network. The lack of inbuilt encryption would mean that the attacker could sniff data and analyze it. Just in case the core network is compromised, IPsec offers additional security over an MPLS network.</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-100 image-border" src="Images/7b2da8b1-0d2f-4912-af7d-23f9855456f2.png" style="width:49.08em;height:19.83em;" width="778" height="315"/></div>
<p>When planning for encryption, we need to decide which layer we want to encrypt.</p>
<p><strong>Why encrypt Layer-1?</strong> </p>
<p>Encrypting IP data traffic at higher layers can significantly increase the latency between two network nodes, while Layer-1 encryption gives extremely low latency and high throughput. Keeping in mind the rise of 100 Gigabits (and beyond) network connectivity, the desired results can be achieved by encrypting data on Layer-1. The complexity of the network and encryption management also increases with higher-layer encryption, more devices to manage, and complex encryption key management. Optical encryption includes the encryption and decryption process together with the key distribution between the transmitter and receiver.</p>
<p>The major use case is <strong>data center interconnect</strong> (<strong>DCI</strong>) over dark fiber:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-101 image-border" src="Images/778976d0-4974-452e-8c03-e9ad019c498e.png" style="width:43.00em;height:24.83em;" width="720" height="414"/></div>
<p><strong>Why encrypt Layer-2?</strong></p>
<p>An Ethernet encryptor that encrypts the network at Layer-2 is the best option when it comes to securing an Ethernet based VPN. The tapping of networks is a common and unpreventable <span>practice</span><span>. Layer-2 encryption is hardware processed which operates at almost full wire speed and is adaptable to an L2 network (point-to-multipoint and multi-mode links):</span></p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-102 image-border" src="Images/f35b0a72-7a18-4e6a-bcf1-046985b3de6d.png" style="width:65.33em;height:11.92em;" width="842" height="154"/></div>
<p>MACsec offers you Layer-2, hop-by-hop encryption. Every hop device will encrypt and decrypt packets, but the IP and IP payload will be encrypted. If you look at a packet in transit, you will only see the Layer-2 header and nothing else. MACsec is the IEEE 802.1AE standard for authenticating and encrypting packets between two MACsec capable devices. Not all switches support MACsec. Check switch capabilities before implementing MACsec.</p>
<p>TrustSec uses AES-128 <strong>GCM and GMAC</strong> (<strong>Galois/Counter Mode Advanced Encryption Standard 128</strong>). MACsec can be configured between hosts - in this mode, the switch is called <strong>Downlink MACsec</strong>. MACsec also works between switches - this mode is called <strong>Uplink MACsec</strong>.</p>
<p>For downlink mode, we need to have NIC, which helps MACsec or Cisco to reply on any connected software: </p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/dd388e5c-3f34-4d84-8cfe-3f54731acb6b.png" width="868" height="279"/></div>
<p><strong>Why encrypt Layer-3?</strong> </p>
<p>Public internet is cheap and more flexible. Keeping in mind that public internet is not safe, IPsec provides a lot of flexibility to encrypt data and to provide a framework to maintain confidentiality, integrity, authentication, and anti-replay. IPsec offers a  standards based end-to-end encryption solution that is agnostic to the underlying physical network infrastructure. IPsec also has several limitations. This includes the fact that it does not support non-IP traffic flows, including data center storage protocols such as <strong>Fiber-Channel</strong> (<strong>FC</strong>). </p>
<p>IPsec encryption takes place at the network layer (Layer-3) in the OSI model. Layer-2 and Layer-1 encryption technologies provide bump-in-the-wire with 100% throughput at line rate and far lower latency than IPsec VPNs, which operate at Layer-3. Layer-3 encryption is a better choice for low-bandwidth environments: </p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-103 image-border" src="Images/6d758c62-b58d-4f26-9284-eefaf70f299f.png" style="width:64.42em;height:49.33em;" width="773" height="592"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Hardening your TCP/IP stack</h1>
                </header>
            
            <article>
                
<p>For any given operating system, tuning of the TCP/IP stack can be performed by the system administrator. Changing the default values of TCP/IP stack variables provides another layer of protection and helps you to secure your hosts in a better way.</p>
<p>This is all about determining and making decisions about how many connections the server can maintain in a half-open state before TCP/IP triggers SYN flooding attack protection. This simply means that to configure the threshold value of the TCP connection, requests must be exceeded before SYN flood protection is triggered.</p>
<p>The following parameters can be adjusted on an operating system level to tune TCP/IP stacks. These are not only applicable to the operating system, but also to network devices such as firewalls and load balancers, which allow you to fine tune TCP stacks:</p>
<ul>
<li><kbd>TcpMaxHalfOpen</kbd></li>
<li><kbd>TcpMaxHalfOpenRetried</kbd></li>
<li><kbd>TcpMaxPortsExhausted</kbd></li>
<li><kbd>TcpMaxConnectResponseRetransmissions</kbd></li>
</ul>
<p>We will discuss DoS attacks in detail in the next section.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">DoS and DDoS attacks </h1>
                </header>
            
            <article>
                
<p>A Denial-of-Service is an attack in which online services do not respond to connections from legitimate hosts due to their resources being overused by malicious requests. This attack becomes a <strong>Distributed Denial-of-Service</strong> (<strong>DDoS</strong>) attack when it comes from multiple sources and it becomes difficult to block the source with IP or Geo-location.</p>
<p>DDoS attacks usually take the form of the following:</p>
<ul>
<li>Volume-based attacks</li>
<li>Application layer attacks</li>
<li>Low-rate attacks</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Volume-based attacks</h1>
                </header>
            
            <article>
                
<p>Volume based attacks are by far the most common type of DDoS attacks.</p>
<div class="packt_infobox">According to Arbor Networks, 65% of DDoS attacks are volumetric in nature.</div>
<p>Volume-based attacks are characterized by an excessive amount of traffic (sometimes in excess of 100 Gbps). They do not mandate large amounts of traffic to be generated by one location or one source.</p>
<p>The following is an example of such an attack:</p>
<ul>
<li><strong>NTP Amplification</strong>: The NTP amplification attack is a volume based DDoS attack in which an attacker exploits the publicly accessible <strong>Network Time Protocol</strong> (<strong>NTP</strong>) server functionality. This command, called <kbd>monlist</kbd>, sends the requester a list of the last six hundred hosts that were connected to the queried server. So, for a small query, response data is very high. Let us consider the fact that the ratio of query:response is 1:50. This means that attackers can generate 50 Gpbs of traffic using a NIC of 1 Gbps, and the same thing will be replicated across multiple sources. This can cause multiple terabits of traffic in a network.</li>
</ul>
<p style="padding-left: 60px">In the following diagram, you can see that attackers generate a query to public NTP servers with the spoofed IP of a victim. In response to an NTP query, the server sends a huge amount of data to the victim's IP, which chokes the network for the victim and make resources unavailable:</p>
<div style="padding-left: 30px" class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-104 image-border" src="Images/9b5eedcb-06a3-4c20-af21-5c2f8a453979.png" style="width:42.08em;height:20.67em;" width="768" height="377"/></div>
<ul>
<li><strong>Mitigation</strong>: Source IP verification should be activated to prevent spoofed packets from leaving the network.</li>
</ul>
<p>Other similar examples of volume based attacks are:</p>
<ul>
<li><strong>User Datagram Protocol</strong> (<strong>UDP</strong>) Floods</li>
<li>ICMP floods</li>
<li><strong>Domain Name Servers</strong> (<strong>DNS</strong>) Amplification</li>
<li><strong><span>Character Generator</span></strong> (<strong><span>Chargen</span></strong>)</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Application layer attacks</h1>
                </header>
            
            <article>
                
<p>Application attacks are low traffic rate attacks which are very hard to detect. These are targeted at weaknesses in an application or server with the goal of establishing a connection and exhausting processes and transactions. Such attacks do not require a botnet type army; generating a low traffic rate needs few sources and the traffic type seems to be legitimate.</p>
<p>The most famous example of a Layer-7 attack is the HTTP Get/Post DDoS attack.</p>
<ul>
<li><strong>HTTP Flood Attack</strong>: HTTP flood is a very common type of DDoS attack in which the cyber criminal exploits HTTP <kbd>GET</kbd> or <kbd>POST</kbd> requests to attack an online web server or application. The attacker forms a botnet army to send the targeted server a very large number of GET (image content) or POST (files) requests. The targeted web server attempts to answer each request coming from the botnet army. In accordance with normal application behavior, the server allocates the maximum number of resources to handle the requests. This prevents genuine requests coming from authentic users to reach to the web server or application. This simply turns into a denial of service:</li>
</ul>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-105 image-border" src="Images/a5544048-c144-4080-ad79-d8dac8ae4b2f.png" style="width:46.42em;height:29.75em;" width="849" height="544"/></div>
<ul>
<li><strong>Cloud is a new platform for attackers</strong>: To create a zombie botnet army cloud series provides a new platform to hackers. Thousand of VMs/hosts can be created and deleted in a few seconds and the traffic looks legitimate:</li>
</ul>
<div style="padding-left: 30px" class="CDPAlignCenter CDPAlign"><img style="font-size: 1em;color: #333333;width:57.08em;height:29.83em;" class="alignnone size-full wp-image-106 image-border" src="Images/04418ac6-0091-4c88-936a-2ef24ba28116.png" width="838" height="438"/></div>
<ul>
<li><strong>Mitigation</strong>: A ring-based Anycast solution offers inbuilt DDoS protection against such flood attacks. The most highly-effective mitigation mechanisms rely on a combination of traffic profiling methods, including identifying the IP reputation.</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Low-rate attacks</h1>
                </header>
            
            <article>
                
<p>Low-rate attacks are focused on bringing a target down quietly. This is very different to high rate brute-force attacks. These attacks leave connections open on the target by creating a relatively low number of connections over a period of time and leaving those sessions open for as long as possible. A famous example of these types of attacks is the <strong>Slowloris</strong> tool, which allows an attacker to take down a victim's web server with minimal bandwidth requirements and without launching numerous connections at the same time.</p>
<p><strong>Slowloris</strong> is an application layer (Layer-7) DDoS attack which operates by utilizing valid partial HTTP requests. The attacker sends HTTP headers with opening connections to a targeted web server and then keeps those connections open for as long as possible, but never completes a request. To avoid connection timeout, the attacker periodically sends another set of partial request headers to the target in order to keep the request alive. This ultimately overflows the maximum concurrent connection pool, and leads to denial of service for subsequent connections from legitimate users.</p>
<p><strong>Mitigation</strong>:</p>
<ul>
<li>Increase server availability</li>
<li>Rate limit incoming requests</li>
<li>Limit the number of connections coming from one IP address.</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">IP spoofing</h1>
                </header>
            
            <article>
                
<p>IP spoofing is the creation of IP packets using somebody else's IP address as the source address of an IP packet.</p>
<p>Let's take a look at IP headers in an IP packet:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-107 image-border" src="Images/7ba889e6-2926-4365-918f-c30ea7af289f.png" style="width:43.25em;height:23.83em;" width="679" height="375"/></div>
<p>In the following diagram, the attackers represent someone else's IP address:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-108 image-border" src="Images/7fe47706-01ea-46a4-8bca-0f48536e90a8.png" style="width:57.50em;height:32.00em;" width="690" height="384"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Anti-spoofing using access lists</h1>
                </header>
            
            <article>
                
<p>A network operator can implement an anti-spoofing access-list filter to prevent packets with incorrect source IP addresses from entering and leaving the network. With the following command, the access list will prevent incoming packets that have the internal IP address from coming in. <kbd>220.x.x.x</kbd> is a network which I own, so I do not expect to encounter any packets coming from outside my own IP address.</p>
<p>Cisco IOS command:</p>
<pre><strong>access-list 101 deny 220.x.x.0 0.0.0.255 any</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Encryption</h1>
                </header>
            
            <article>
                
<p>Another possible way to prevent IP spoofing is to encrypt all network traffic to prevent source and destination hosts from being compromised.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Anti-spoofing using RPF checks</h1>
                </header>
            
            <article>
                
<p>RPF is a feature with multi vendor support to prevent IP spoofing. It can be used for both unicast and multicast. RPF checks the source address of a packet as well as the interface it's being learned from. If the source address is present in the routing table, then the packet is accepted by the routing device. If not, it will drop the packet. The only problem with RPF is that it does not work with asymmetric routes and therefore requires strictly symmetric routing patterns.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Ping sweeps and Port scans</h1>
                </header>
            
            <article>
                
<p><span>Let's try to understand ping before we discuss ping sweep.</span></p>
<ul>
<li><strong>Ping</strong>: Ping is a tool commonly used to find the status of a host on a network. Ping is based on the ICMP protocol. When a Ping process request is sent out as an ICMP echo to the target host, it replies with an ICMP echo reply.</li>
<li><strong>Ping Sweep</strong>:<strong> </strong>Ping sweep is a technique that can be used to find out which hosts are alive in a network for a defined IP range. Network admins who allow ICMP are vulnerable to ICMP based attacks.</li>
</ul>
<p style="padding-left: 60px">Multiple tools are available for ping sweeps. You can even develop your own tool with a small script. Here is a simple example of how to run a ping sweep from a Windows machine: <kbd>FOR /L</kbd> loop, which is a counter, the variable is <kbd>%i</kbd>. It starts at <kbd>1</kbd> and increases by <kbd>1</kbd> with each iteration through the loop, going up to <kbd>255</kbd>. I want to ping through a /24-sized subnet for network <kbd>192.168.0.0/24</kbd> and ping each IP address once (<kbd>-n 1</kbd>). Filters can be used <kbd>| find “Reply"</kbd>, but this will only show the IPs you get a reply from. In my live network, I have four IPs responding to the ICMP ping, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-867 image-border" src="Images/1eee94ed-95b4-4379-ab9f-a8fa981cd2ad.png" style="width:83.25em;height:17.67em;" width="999" height="212"/></div>
<ul>
<li><strong>Port Scan</strong>: Firstly, let's explore what port is. Any application on a host should have a valid port which acts like a small door to communicate with other hosts on the network. You can have a total of 65,535 TCP ports and another 65,535 UDP ports. Port ranges <kbd>0</kbd> to <kbd>1023</kbd> are reserved for privileged services and are designated as well-known ports.</li>
</ul>
<p style="padding-left: 60px">A port scan is a process that sends client requests to a range of server port addresses on a targeted host, with the aim of looking for active ports and exploiting a known vulnerability of that service.</p>
<ul>
<li><strong>TCP Port Scan</strong>: TCP port scan is the most basic form of TCP scanning. Port scanning tools can scan a target at a very quick speed of approximately one thousand ports per second or more. These tools use operating systems to open a connection to any port on the target machine in order to detect the number of available services for a given target. If the port is listening, an initial connection handshake will succeed, otherwise the port will not be reachable.</li>
<li><strong>TCP SYN scanning</strong>: TCP SYN scan is based on the TCP three-way handshake and is also known as <strong>half-open</strong> scanning. The attacker does not open a full TCP connection but sends a SYN packet and waits for a response. A SYN/ACK response from the target indicates that the port is listening and as soon as a SYN/ACK is received, the attacker sends an RST response.</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Mitigation</h1>
                </header>
            
            <article>
                
<p>A simple solution to this problem is to stop ICMP totally. ICMP can be stopped on a firewall layer, network layer or even on a host layer. We understand that ICMP is a very common troubleshooting tool for network admin and system admin, but instead of relying upon an ICMP based ping, we should rely upon a TCP ping. Such scans can also be detected and stopped by the IPS/IDS system.</p>
<p>For a host-based example,  ICMP Echo can be easily blocked on Windows by configuring an inbound rule. A new rule can be created by using the utility <kbd>wf.msc</kbd> from the Windows system:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-868 image-border" src="Images/656f9a9b-61c1-439c-a24d-7a38c55c63c8.png" style="width:49.75em;height:40.67em;" width="1061" height="867"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">DNS vulnerabilities </h1>
                </header>
            
            <article>
                
<p><span>DNS continues to be a very attractive target for hackers and a very important piece of network from a user's point of view. We use it seamlessly almost every time we hit a web page or application throughout a day, without even knowing that it exists.</span></p>
<p><span>DNS provides a way to resolve the IP address of any host on the internet with directory services.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How does DNS work?</h1>
                </header>
            
            <article>
                
<p>A host sends a DNS query request to a DNS server and, in response, gets the IP address <kbd>1.1.1.1</kbd> for  <kbd>www.abc.com</kbd>. The host can now make a direct request to <kbd>www.abc.com</kbd> using  the IP address: </p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-111 image-border" src="Images/e55dcfae-01b0-426f-a47a-544512a61b53.png" style="width:58.08em;height:33.67em;" width="697" height="404"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">DNS protocol attacks</h1>
                </header>
            
            <article>
                
<p><strong>DNS spoofing or DNS cache poisoning</strong>: DNS spoofing occurs when particular DNS server records are altered to redirect traffic to the attacker. This redirection of traffic allows the attacker to steal data because it is hard for users to recognize the difference between an actual web page and a false web page.</p>
<p>In this example, users are trying to get the IP address for a real web server which is <kbd>1.1.1.1</kbd> but attackers have manipulated the DNS record and, consequently, users are redirected to the IP address for a fake website, which is <kbd>2.2.2.2</kbd>:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-112 image-border" src="Images/7ec0665b-0d51-43b7-9801-836d7f06a147.png" style="width:53.67em;height:35.33em;" width="644" height="424"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Mitigation</h1>
                </header>
            
            <article>
                
<p><strong><span>Domain Name System Security Extensions</span></strong> (<strong>DNSSEC</strong>) is a secure technology based on digitally signed DNS records to help determine data authenticity. DNSSEC creates a secure domain name system by adding cryptographic signatures to existing DNS records. The main goal for DNSSEC is to strengthen trust in the internet by helping to protect users from being redirected to fraudulent websites and unintended addresses. </p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Two factor authentication</h1>
                </header>
            
            <article>
                
<p><strong>Two-Factor Authentication</strong> (<strong>2FA</strong>) is an optional layer of security which adds another level of protection to your account. This process combines something you have (a token or code) with something you know (a password). Two-factor authentication is more effective in securing account access than a password alone, making it more difficult for attackers to access your accounts since they become dynamic in nature. The two common methods of 2FA are as follows: </p>
<ul>
<li><strong>Authentication App or Token</strong>: Generate a security code using a trusted app or security RSA token</li>
</ul>
<ul>
<li><strong>SMS Verification</strong>: Send a security code to the phone number linked to your account via an SMS text message</li>
</ul>
<p>An example of two-factor authentication:</p>
<p>Most banks now have two-factor authentication available to their customers. <span>A good example of network administration is to combine an RSA feature with Cisco TACACS or Radius to gain access for any network device.</span> VPN users must be authenticated with 2FA to validate an identity.</p>
<p>Hardware tokens (in the form of key fobs or card readers) are difficult to maintain due to logistic support and tokens are also usually small and easily lost. 2FA makes life easier by utilizing mobile phone SMS technology.</p>
<p>Following is an image of an RSA Hardware Token:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-869 image-border" src="Images/910d4143-4e7c-4114-84fc-c2eb6f1da0f2.png" style="width:20.33em;height:12.25em;" width="1399" height="843"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Summary </h1>
                </header>
            
            <article>
                
<p>The process of designing a secure network requires identifying an insecure area, understanding the methods of network attacks and the best solutions to meet the needs of a business. The four fundamental technical requirements of network design are scalability, availability, security, and manageability.</p>
<p>We discussed the importance of using the right approach to safeguard against security threats in an increasingly internet oriented world. We also covered the security weaknesses for all networking layers including routers, switches, firewall configuration systems and risks when connected to the internet. We have also learnt the best security methods and how to protect the network from vulnerabilities, threats and attacks by applying security configurations.</p>
<p>In the next chapter, we will discuss more about server security, encryption methods and policy enforcement with regards to data protection.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Questions</h1>
                </header>
            
            <article>
                
<ol>
<li>What does AAA stand for?</li>
</ol>
<ul>
<li style="list-style-type: none">
<ol>
<li>Authority</li>
<li>Authorization</li>
<li>Auditing</li>
<li>Authentication</li>
<li>Accounting</li>
</ol>
</li>
</ul>
<ol start="2">
<li>What are the two most common AAA protocols?
<ol>
<li class="mce-root"><span>TCP/IP</span></li>
<li>RADIUS</li>
<li>TACACS+</li>
<li>PPP</li>
</ol>
</li>
</ol>
<ol start="3">
<li>An attack which attempts to make targeted sy<span>stems unavailable to its intended users is called:</span></li>
</ol>
<ul>
<li style="list-style-type: none">
<ol>
<li><span>Denial-of-Service attack</span></li>
<li><span>Slow read attack</span></li>
<li><span>Spoofed attack</span></li>
<li><span>Starvation attack</span></li>
</ol>
</li>
</ul>
<ol start="4">
<li>Which of the following is not an attack, but a tool which searches for available services to identify vulnerabilities in order to attack a given target?
<ol>
<li><span>Denial-of-Service</span></li>
<li><span>Port scanning</span></li>
<li><span>Memory access violation</span></li>
<li>Dumpster diving</li>
</ol>
</li>
</ol>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Further reading</h1>
                </header>
            
            <article>
                
<p>For references and further information, refer to the following links:</p>
<ul>
<li><a href="https://gcn.com/Articles/2014/08/07/Layer-1-network-encryption.aspx">https://gcn.com/Articles/2014/08/07/Layer-1-network-encryption.aspx</a></li>
<li><a href="http://www.uebermeister.com/files/inside%20it/2016_Introduction_Encryption_Metro_and_Carrier_Ethernet.pdf">http://www.uebermeister.com/files/inside it/2016_Introduction_Encryption_Metro_and_Carrier_Ethernet.pdf</a></li>
<li><a href="http://ieeexplore.ieee.org/document/7781061/">http://ieeexplore.ieee.org/document/7781061/</a></li>
</ul>
<p> </p>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  </body></html>