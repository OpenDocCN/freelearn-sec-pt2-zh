<html><head></head><body><div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Public Key Infrastructure-SSL</h1>
                </header>
            
            <article>
                
<p>In the previous chapter, we learned about network mapping tools and port scanning techniques used to detect the remote OS.</p>
<p>In today's digital era, more and more internet users are growing web businesses. Small to large businesses are coming up with higher numbers of marketing tools such as ads, web services, emails, social media, digital content, online banking, online cell phone apps and, of course, online shopping. However, no one wants to store or send information on the internet until information security is guaranteed. </p>
<p><strong>Secure Socket Layer</strong> (<strong>SSL</strong>) provides transport layer security for web-based applications and also provides end users or customers with a secure browsing experience. In this chapter we are going to discuss what SSL is, how it works and who needs it. We will also discuss the evolution of SSL, focusing on what you need to know in order to implement it. <span>This will include looking at current threats and verification methods.</span></p>
<p>We will be covering the following topics:</p>
<ul>
<li>Foundation of SSL</li>
<li>TLS versus SSL</li>
<li><strong>Public Key Infrastructure</strong> (<strong>PKI</strong>)</li>
<li>Attacks against PKI</li>
<li>Microsoft Windows and IIS</li>
<li>OpenSSL</li>
<li>SSL Management tools</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Foundation of SSL</h1>
                </header>
            
            <article>
                
<p>In this section, we will learn the basics of SSL from the point of view of the end user, focusing on what users should know about SSL for the purpose of safe browsing. Having an SSL certificate stamp on your website is very important for security. In order to protect data from attackers, SSL technology is used to create an encrypted connection between an end user (typically a web browser) and the web server. SSL allows sensitive information such as credit card numbers, social security numbers, and login credentials to be transmitted securely in an encrypted format. Even if an attacker is able to intercept all of the data sent between a client and a web server, they still cannot read and use the information in encrypted data. </p>
<p>To understand where SSL fits into a TCP/IP or OSI model, let's take a look at the following diagram. For secure applications such as HTTPs, SSL/TLS comes in between the application and the Layer 4 transport layer:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/6c0b2db3-8277-4f42-8120-9a1134fbaf21.png" style="width:32.50em;height:29.00em;" width="776" height="691"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How do I know that SSL is working?</h1>
                </header>
            
            <article>
                
<p>Before exchanging any information, it is very important for users to know that the area of a website they are on is safe and secure. <span>Different browsers have different ways of showing SSL status but you can usually find it by checking the address bar at the top of the browser. Let's take a look at a few browsers: </span></p>
<p><strong>Microsoft Edge:</strong></p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/ea3bfa5e-9d0a-4da8-9839-f081ca88bfcf.png" style="width:51.50em;height:10.50em;" width="1646" height="335"/></div>
<p><strong>Microsoft IE:</strong></p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/56a38bc8-cf40-4807-b14d-b712c50df092.png" style="width:52.17em;height:10.83em;" width="1228" height="255"/></div>
<p><strong>Google Chrome:</strong></p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/efb1a16f-0d17-441b-9aeb-fc4901bd01ef.png" style="width:55.67em;height:11.33em;" width="1844" height="375"/></div>
<p>We can clearly observe that each is similar in the sense that they all have a green accent color, a padlock symbol and the information is displayed in the status bar, which tells you that this is a secure site.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Why no PadLock?</h1>
                </header>
            
            <article>
                
<p>Browsers are smart enough nowadays. Let's take a look at the alarming error message I was getting when accessing a banking website. In this situation, you should not share your information: </p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/6ccfa3df-0b1d-407b-9768-9c2568b08f33.png" style="width:52.25em;height:27.67em;" width="1135" height="601"/></div>
<p>Here, you can clearly see that there is no green color and no padlock sign on the status bar. The browser also indicates a reason why this site is not secure.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">SSL certificate</h1>
                </header>
            
            <article>
                
<p>An SSL certificate is a digital public document that binds a cryptographic key to the details of an owner or organization such as through domain name, host name or location. This verifies that a legitimate company owns the website which is being accessed.</p>
<p>An SSL certificate has three specific functions:</p>
<ul>
<li>Authentication</li>
<li>Verification</li>
<li>Data Encryption</li>
</ul>
<p>In other words, the SSL certificate will have information about w<span>ho has issued the certificate and to whom it is issued. This is not limited to web servers, it can also be used for end user machines, mobile phones and many more applications. Every SSL certificate will have an expiry date attached to it, which is similar to how an exam certificate cannot be used after its expiry date. Consequently, to extend the validity of the certificate, it must be renewed. An SSL certificate will also have a public key and digital signatures. As the name suggests, a public key is incorporated into the SSL certificate shared with web browsers and a digital certificate is a process that guarantees that the contents of a message have not been altered in transit.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">The evolution of SSL and TLS</h1>
                </header>
            
            <article>
                
<p><strong>Transport Layer Security</strong> (<strong>TLS</strong>) protocol is the most widely used protocol on the internet today. SSL was originally developed by Netscape in 1993. Let's take a look at the history of the SSL protocol:</p>
<ul>
<li><strong>SSL 1.0</strong>: This was the first specification by Netscape in early 1994, which was never released for public use. This is because it was heavily criticized by the cryptographic community for the implementation of weak cryptographic algorithms.</li>
<li><strong>SSL 2.0</strong>: In early 1995, Netscape released SSL 2.0, an improved version of the original. However, this also did not succeed. In this version, message authentication used MD5, which most security-aware users had already moved away from. Handshake messages are not protected. This permits a MITM attack to trick the client into picking a weaker cipher suite than it would normally choose.</li>
<li><strong>SSL 3.0</strong>:<strong> </strong>SSL version 3 was released by Netscape in 1996 to enhance SSL version 2 and to support more algorithms. Many SSL version 2 platforms were already deployed at the time so there was no clean way to cut over to SSL version 3. This forced SSL version 3 to allow the backward compatibility to SSL version 2. Therefore, unless you definitely know which SSL versions the server supports, your SSL application should run in both SSL version 2 and SSL version 3 mode. This enables a client to communicate with both SSL version 2 and SSL version 3 servers. This also allows the server to have connections with SSL version 2 and SSL version 3 clients. However, if either the client or the server supports only SSL version 2, only that version will be used.</li>
</ul>
<div class="packt_infobox">SSL 3.0 was vulnerable to the POODLE attack, marking the end to the SSL 3.0 era. This was discovered by the Google security team and disclosed to the public on October 14, 2014.</div>
<ul>
<li><strong>TLS 1.0</strong>:<strong> </strong>The TLS protocol itself is based on the SSL 3.0 specification as published by Netscape in January 1999. The differences between this protocol and SSL 3.0 are not dramatic, but they are significant enough that TLS 1.0 and SSL 3.0 do not inter-operate.</li>
<li><strong>TLS 1.1, TLS 1.2 and TLS 1.3</strong>: RFC 4346 was released in April 2006 and TLS 1.1 is an update to TLS 1.0. The changes that were brought about included replacing the implicit <strong>initialization vector</strong> (<strong>IV</strong>) with an explicit IV to protect against <strong>Cipher block chaining</strong> (<strong>CBC</strong>) attacks. In August 2008, TLS 1.2 was based on TLS 1.1.</li>
</ul>
<p style="padding-left: 60px">As of January 2018, TLS 1.3 is the latest protocol, though it is a working draft. Let's take a look on a browser (Internet Explorer) for current supported version of SSL and TLS.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Current Supported Standard</h1>
                </header>
            
            <article>
                
<p>For Microsoft Internet Explorer, follow these steps: <span class="packt_screen">T</span><span class="packt_screen">ools</span>|<span class="packt_screen">Internet Options</span>|<span class="packt_screen">Advance</span>. In the following screenshot, we can see that TLS 1.o to TLS 1.2 options are checked while SSL 3.0 is disabled or unchecked:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/31de327e-4e4b-4f38-bc4c-c2a54eb4358a.png" style="width:32.83em;height:32.83em;" width="611" height="611"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Why hasn't TLS 1.3 been implemented yet?</h1>
                </header>
            
            <article>
                
<p>Such security upgrades are complex in nature. In a multi-vendor internet environment, you need to update both client and servers to support a new security standard. So far, no major browsers have TLS 1.3 enabled by default. It cannot be assumed that by a specific date, every server and end user device will support all new security standards. Furthermore, TLS 1.3 is not an extension but a major change with complete revamping. The way TLS or SSL version negotiation works is that an end user device sends the latest version of a supported <span>protocol</span><span> to a server, which responds with the latest version and chooses something which is supported by both of them.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Time to say goodbye to SSL and early TLS</h1>
                </header>
            
            <article>
                
<p>According to <strong>PCI Data Security Standard</strong> (<strong>PCI DSS</strong>) for safeguarding payment data, 30 June 2018 is the deadline for disabling SSL/early TLS and implementing a more secure encryption protocol of TLS 1.1 or higher. There are many vulnerabilities in SSL and early TLS that, left unaddressed, put organizations at risk of being breached. The widespread POODLE and BEAST exploits are just a couple of examples of how attackers have taken advantage of weaknesses in SSL and early TLS to compromise organizations.</p>
<p>Visit the following website for more information:</p>
<p><a href="https://blog.pcisecuritystandards.org/are-you-ready-for-30-june-2018-sayin-goodbye-to-ssl-early-tls">https://blog.pcisecuritystandards.org/are-you-ready-for-30-june-2018-sayin-goodbye-to-ssl-early-tls</a></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">SSL certificate component </h1>
                </header>
            
            <article>
                
<p>Let's first discuss client side SSL, and then we will focus on server side. Your browser comes pre-installed with trusted CAs. Every time we visit a website, your browser verifies a trust chain and, during handshake, ends with one of the locally trusted root certificates<span>.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Root certificate</h1>
                </header>
            
            <article>
                
<p>Let's take a look at Microsoft IE pre-installed CAs. You can check this in the browsing directory through <span class="packt_screen">Tools|</span><span class="packt_screen">Internet Options</span>|<span class="packt_screen">Content</span>|<span class="packt_screen">Certificates</span>|<span class="packt_screen">Trusted Root Certification Authorities</span>:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/bb6072b8-53af-44a6-9cd8-7ceb08f7164b.png" width="1361" height="519"/></div>
<p>Root certificates do have an expiry date, but they tend to have exceptionally long validity times (often between 10-20 years). As part of a browser or operating system update patch, you will get fresh root certificates before the old ones expire. Lacking a CAs root certificate, no browser would know whether to accept an SSL certificate issued by that CA. These SSL certificates are known as <em>single root</em> certificates. </p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Intermediate certificate</h1>
                </header>
            
            <article>
                
<p>From a security point of view, the private key of the root certificate is critical and should be kept in the certificate provider's secure data center. Furthermore, the public key of the root certificate is given to browsers such as Microsoft and Google to be added to their list of trusted roots. Any compromise of the root certificate's key would deem the complete certificate chain built by the certificate provider as untrustworthy.</p>
<p>An intermediate certificate authority is an entity that is authorized to sign certificates. Logically, the root CA must sign all certificates. For security reasons, the intermediate CA signs certificates on behalf of the root CA, but intermediate certificates are signed by the root CA.</p>
<p>Let's browse a few sites and look at an intermediate certificate. In this example, I have opened <a href="http://www.google.com">www.google.com</a> in IE. I have mentioned that <span class="packt_screen">GeoTrust Global CA [Root] </span>reflects root signing authority, <span class="packt_screen">Google Internet Authority G2 [Intermediate]</span> reflects Intermediate Certificate and, finally, <span class="packt_screen">*.google.com [End Host]</span> is the End host identity:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/9dc68e93-18c8-4c5e-a63c-4fe81cd53ec5.png" style="width:31.50em;height:40.42em;" width="603" height="777"/></div>
<p>Let's take another example. This time we have <a href="http://www.flipkart.com">www.flipkart.com</a>. Here, there are two intermediate certificates and, by logic, there can be multiple since these are a subset of a main certificate. The confusing aspect comes in when you try to relate different classes and groups associated with a certificate:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/471227e6-ab2b-4f45-b5df-474f11f63a05.png" style="width:34.58em;height:41.42em;" width="603" height="725"/></div>
<p>These classes are vendors defined but pretty much consistent across all top level certificate authorities. Let's take a look at the different possible classes of certificates that CAs will offer to their clients and what these classes mean to the client.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">SSL certificates classes </h1>
                </header>
            
            <article>
                
<p>CA uses the concept of classes for different types of digital certificates, but these classes are not specified in any SSL/TLS RFC. Let's try to understand what different classes mean to SSL end users.</p>
<ul>
<li><strong>Class 1</strong>: Class 1 certificates are delivered without any prior verification. This is also known as a <strong><span>Domain Validation</span></strong> (<strong>DV</strong>) certificate and relies on the <kbd>WHOIS</kbd> information database (you must prove you own the domain). A DV certificate is a low authentication product which does not guarantee the identity of the website's owner nor the actual existence of the organization. This simply refers to two entities talking over an encrypted channel without knowing each other.</li>
</ul>
<div class="packt_infobox">Note: This can be heavily misused by attackers by launching phishing sites. Users assume that the website has a valid certificate issued by a major certificate authority.</div>
<div class="packt_tip">Never use low—authentication certificates for web based applications.</div>
<ul>
<li><strong>Class 2</strong>: For<strong> </strong>Class 2 certificates, (Medium Security Level) a background check is required which includes looking at the organization, business, or person who owns the domain, and confirming its existence. These are typically called the organization validated certs.</li>
<li><strong>Class 3</strong>: These are client certificates (Extended validation High Security) that are delivered after an audit. They check details of the organization, including verifying the physical address using multiple sources of truth and the certificate's owner. </li>
<li><strong>Class 4</strong>: Class 4 certificates are intended for online business transactions between companies.</li>
<li><strong>Class 5</strong>: Class 5 certificates are intended for private organizations or governmental security.</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">TLS versus SSL</h1>
                </header>
            
            <article>
                
<p>Both <span>TLS </span>and SSL are security frameworks that provide data encryption and authentication for web based applications to ensure data protection. An SSL and TLS handshake is a mechanism for web based applications which takes place just after the TCP handshake occurs between a client and a server. The handshake doesn’t encrypt anything on its own, but actually negotiates for a shared secret and encryption type which both sides agree on.</p>
<p>In the diagram below, we can see that just after the TCP and SSL handshake starts, a secure client sends a 'hello' message to the server with a supported set of ciphers. The server responds with a top support cipher and also shares its certificate with the public key:  </p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/965fe4f0-54d0-4d40-8abb-87aa82f7b48a.png" style="width:34.00em;height:22.92em;" width="747" height="503"/></div>
<div class="CDPAlignCenter CDPAlign"/>
<p>Let's take a look  at Wireshark to validate. A client sends all available cipher suits to a server marked in the black box:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1207 image-border" src="Images/6e79f3fe-d239-4476-8dc2-848b62bc17ad.png" style="width:46.42em;height:24.50em;" width="1390" height="726"/></div>
<p>In server hello, the sever sends the top cipher it can use for security, shown in the black box:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-907 image-border" src="Images/efd89ff1-fd94-4c5e-b584-4769ba637400.png" style="width:100.75em;height:46.42em;" width="1209" height="557"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Public Key Infrastructure</h1>
                </header>
            
            <article>
                
<p>PKI refers to processes and technologies which provide a secure data exchange between two nodes over unsecured infrastructure. It uses private and public key pairs to achieve the underlying security service.</p>
<p>There are three types of cryptography algorithms:</p>
<ul>
<li>Symmetric</li>
<li>Asymmetric</li>
<li>Hash function.</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Symmetric encryption</h1>
                </header>
            
            <article>
                
<p>In symmetric encryption, a single key is used both to encrypt and decrypt traffic. Symmetric encryptions are fast, simple and easy to implement. However, some easy ciphers are vulnerable to brute-force attacks, making management a complex job. If the key is compromised, then the whole system becomes vulnerable. <strong>Data encryption standard</strong> (<strong>DES</strong>) and <strong>Advance encryption standard</strong> (<strong>AES</strong>) are symmetric systems, but AES is much more reliable than DES.</p>
<p>The symmetric encryption scheme has five elements:</p>
<ul>
<li class="mce-root"><strong>Plain-text</strong>: Refers to the original data that needs to be encrypted</li>
<li class="mce-root"><strong>Encryption Algorithm</strong>: Refers to a combination of ciphers used to encrypt data</li>
<li class="mce-root"><strong>Secure Key</strong>: Refers to input in the encryption algorithm</li>
<li class="mce-root"><strong>Cipher-text</strong>: Refers to output and format, which is dependent upon plain-text and key input</li>
<li class="mce-root"><strong>Decryption Algorithm</strong>: This works in reverse of encryption - the cipher test becomes input data and the output becomes plain-text original input:</li>
</ul>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1179 image-border" src="Images/424a0987-21c0-4764-83a1-81d5d9c12e9c.png" style="width:43.00em;height:29.08em;" width="1315" height="890"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Asymmetric encryption</h1>
                </header>
            
            <article>
                
<p>Asymmetrical encryption is also known as public key cryptography, which is a relatively secure method compared to symmetric encryption. In this method, two keys are used. One key is used for encryption and the other key is used for decryption. The public key is what its name suggests— public. It is made available to a browser when accessing the web server during the SSL handshake process. On the other hand, the private key must remain confidential and secure to its respective owner. Let's assume that the client generates the secret, encrypts it using the server's RSA public key and sends it to the server, which decrypts it using its private key. It is very important to protect the private key, because if the key is lost, then the system becomes void:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1181 image-border" src="Images/4a7d8759-5630-4215-9881-ed79cd5f5822.png" style="width:42.83em;height:29.00em;" width="1315" height="890"/></div>
<p>Two of the most popular Asymmetric Encryption Algorithms are:</p>
<ul>
<li><strong>Rivest-Shamir-Adleman (RSA)</strong>: This is the most widely used asymmetric algorithm. Let's take a look at the SSL certificate to verify what algorithm is being used. Under certificate details, you can see that the Public Key value is RSA (2048) and this indicates RSA encryption:</li>
</ul>
<div style="padding-left: 60px" class="CDPAlignCenter CDPAlign"><img src="Images/e98ec20c-6b8e-4ebf-8163-61589637591e.png" style="width:29.92em;height:20.17em;" width="579" height="391"/></div>
<ul>
<li><span><strong>Elliptic Curve Cryptography (ECC)</strong>: </span><span>In the second example, you can see that the Public Key value is ECC by viewing </span><span>certificate details. ECC is gaining fame within the industry as an alternative to RSA:</span></li>
</ul>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-908 image-border" src="Images/ff82e4f8-f056-47c4-8003-09a8eebfbdad.png" style="width:28.42em;height:18.92em;" width="595" height="396"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Hash function</h1>
                </header>
            
            <article>
                
<p>A hash is a number generated from the information inside a file, maybe a clear text file. The resulting string is a fixed length, and will vary widely with small variations in input. Hashing differs from encryption and does not use a process to encrypt and decrypt data. Hashing, however, is a one-way function that scrambles plain text to produce a unique message digest. With a properly designed algorithm, it works in a one-way direction, hence there is no way to reverse the hashing process to reveal the original password:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1184 image-border" src="Images/828c9e62-8de9-476b-9cc9-be9589578067.png" style="width:38.33em;height:38.33em;" width="1339" height="1338"/></div>
<p>Let's understand the working.</p>
<p>A user enters a password and a User ID in a browser and sends it to the authentication server <span>over a secure channel</span><span>. The server uses the User ID to look up the associated message digest. The password submitted by the user is then hashed with the same algorithm, and if the resulting message digest matches the one stored on the server, it is then authenticated.</span></p>
<p>Some of the popular Hashing Algorithms are: </p>
<ul>
<li><strong>MD Family</strong>: MD2, MD4 and MD5 (1989 -1992). All of these were 128 bit hash functions. MD5 is the most famous hash algorithm. MD6 also came into the industry but never gained popularity and was replaced by SHA3.</li>
<li><strong>SHA Family</strong>: There are four versions of SHA. This includes SHA0 (most vulnerable), SHA1 (most popular), SHA2 (widely deployed) and SHA3, which was introduced in 2012.</li>
<li><strong>AES Family</strong>: AES comes with three block ciphers. This includes AES-128, AES-192 and AES-256. Each cipher encrypts and decrypts data in blocks of 128 bits using cryptographic keys of 128, 192 and 256 bits.</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Attacks against PKI</h1>
                </header>
            
            <article>
                
<p>If you ask any security expert if PKI is 100% safe, the answer would be a big <em>NO </em>- there are a few concerns that are raised by security experts from time to time. I will begin by looking at the management of CA certificates and private keys. The internet is full of billions of websites and services, and so there are multiple certificate authorities. Rolling out new standards takes many years since this affects the whole security ecosystem.</p>
<p>As a system, PKI is nothing but mathematics. Once someone cracks the formula, a new formula will be introduced to the industry, which looks stronger and more secure. <span>But for how long would this be the case?</span>  Another major issue comes with securing private keys. The normal scenario is that you, as a client, generate your private key pair on your own machine, then send the CSR to the CA as part of a certificate request. In some cases, it is a good idea to let the CA generate the key pair and send it to you. In case of private key loss, your CA can provide you with a private key. </p>
<p>Let's take a look at a recent incident in which this happened. Thousands of customers received emails from the security firm DigiCert to say that their SSL certificates were being revoked because of a security compromise at Trustico. If the certificate is currently in an active state, this would mean that customers would begin receiving untrusted certificate warnings. According to an official statement, 23,000 private keys were compromised. This mainly affected customers who used Trustico's website to generate both their private/public keys and their CSRs.</p>
<div class="packt_tip">You should never trust anyone with your private keys. They should be generated and kept safe only on the servers upon which you wish to install the certificates.<br/>
You can also visit <a href="https://www.ssllabs.com/ssl-pulse">https://www.ssllabs.com/ssl-pulse. </a><span>SSL pulse is a continuous and global dashboard for monitoring the quality of SSL/TLS support over time across 150,000 SSL and TLS-enabled websites, based on Alexa's list of the most popular sites in the world.</span> </div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Microsoft Windows and IIS</h1>
                </header>
            
            <article>
                
<p>In this section, we will discuss SSL certificate installation with Microsoft IIS:</p>
<ol>
<li>Start IIS manager and double click server certificate.</li>
<li>Select <span class="packt_screen">Actions</span> menu (on the right) and click on <span class="packt_screen">Create Certificate Request</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/e9ffe029-73e3-418f-af6d-b6e2a9e7ee63.png" style="width:43.00em;height:30.83em;" width="1333" height="956"/></div>
<p style="padding-left: 60px">This will open the Request Certificate wizard:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/07d1cb3b-824c-4341-886d-492b71909e7f.png" style="width:43.17em;height:33.33em;" width="1009" height="780"/></div>
<p>In the <span class="packt_screen">Cryptographic Service Provider Properties</span> window, leave both settings at their default values (Microsoft RSA SChannel and 2048) and then click <span class="packt_screen">Next</span>:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-909 image-border" src="Images/911c39b8-3ca6-42d5-87a4-d8e482f82a21.png" style="width:82.75em;height:62.17em;" width="993" height="746"/></div>
<p>Enter a filename and location to save your CSR: </p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/f0913621-55a0-48db-bf7c-6f3104afd9f1.png" style="width:48.17em;height:35.92em;" width="1022" height="764"/></div>
<p>You can now open the text file to check the CSR request. This file should go to CA to <span>receive</span> a signature:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/29f59753-a127-461e-9256-be755a3b3b44.png" style="width:47.08em;height:39.25em;" width="1137" height="950"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">OpenSSL</h1>
                </header>
            
            <article>
                
<p>OpenSSL is an open source project that consists of a cryptographic library and an SSL toolkit.</p>
<p>According to the project's website itself, the OpenSSL Project is:</p>
<div class="mce-root packt_quote">"A collaborative effort to develop a robust, commercial-grade,<br/>
full-featured, and Open Source toolkit implementing the <strong>Secure Sockets Layer</strong> (<strong>SSL</strong>) and <strong>Transport Layer Security</strong> (<strong>TLS</strong>) protocols as well as a full-strength general purpose cryptography library. The project is managed by a worldwide community of volunteers that use the Internet to communicate, plan, and develop the OpenSSL toolkit and its related documentation."</div>
<p>OpenSSL libraries can be used to create a certificate request (CSR), a self-signed certificate and even to issue a certificate as a CA. If you are running a small <span>or corporate</span><span> organization  and have the ability to import a root trust certificate to all computer systems, you can become your own CA and issue certificates yourself.</span></p>
<p>For example, I will be using my Ubuntu server. This is an old release but of course you have the choice to upgrade it:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/249bedcf-beb7-48bb-afd9-cf43217ef3f2.png" style="width:36.67em;height:8.17em;" width="674" height="150"/></div>
<p>The latest version can be downloaded from the OpenSSL official website: <a href="https://www.openssl.org/source/">https://www.openssl.org/source/</a>:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-910 image-border" src="Images/6b4fb64f-567e-41b2-80cb-31742111bdca.png" style="width:39.75em;height:10.00em;" width="1114" height="281"/></div>
<p>On the Ubuntu server, you can locate files under the <kbd>/usr/lib/ssl</kbd> path:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/634f8b3f-abe4-4e49-b5b1-0dce18908b67.png" style="width:38.92em;height:4.58em;" width="703" height="83"/></div>
<p>Let's take a look at how to generate a private key and the CSR:</p>
<ol>
<li>First we will generate the private key. This will be an RSA 2048 key. However, you have the option to choose DSA or EC keys. The fields which ask for your email address, optional company name and challenge password can be left blank:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/9ab59c42-d987-4d88-a90c-aa088fd86803.png" style="width:59.08em;height:16.17em;" width="1187" height="324"/></div>
<ol start="2">
<li>In step two you will be asked for the information required for the certificate, organization, state, organization name, FQDN and email address:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1208 image-border" src="Images/c25e5fd3-089f-4429-ba9c-77989a573795.png" style="width:75.92em;height:31.75em;" width="911" height="381"/></div>
<p style="padding-left: 60px">The private key and CSR can now be located in same folder:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/b7b608f0-0b53-49b6-b01c-9953083d527b.png" style="width:59.75em;height:31.42em;" width="877" height="461"/></div>
<p>This is just an overview. For more information, you can visit <a href="https://www.openssl.org/">https://www.openssl.org/</a> or main pages.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">SSL Management tools</h1>
                </header>
            
            <article>
                
<p>In my personal experience, the most common issue with managing certificates is the certificate expiry. For small organizations, manual tracking is possible, but this would be a strenuous exercise. It is better to have an automated framework to monitor the certificate expiry/renewal across all service assets.</p>
<p>A few of the very famous SSL management tools include:</p>
<ul>
<li><strong>SolarWinds SSL Certificate Management</strong></li>
<li><strong>Qualys CertView</strong></li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Summary </h1>
                </header>
            
            <article>
                
<p>This chapter served as an introduction to understanding the world of PKI. The chapter began with the basic fundamentals of SSL from a user's point of view and discussed how SSL works for web-based applications. We also covered what functions and algorithms are available for us to generate a strong certificate. In addition, we have seen how certificates are generated for Windows IIS and looked at how to use the OpenSSL tool. This chapter also gave you an insight into the threats to PKI and how to safeguard against them for a better user experience.</p>
<p>In the next chapter, we will discuss firewall as a security appliance and explore its place in network infrastructure.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Questions</h1>
                </header>
            
            <article>
                
<ol>
<li>The full form of SSL is:
<ol>
<li>Serial Session Layer</li>
<li>Secure Socket Layer</li>
<li>Session Secure Layer</li>
<li>Series Socket Layer</li>
</ol>
</li>
</ol>
<ol start="2">
<li class="mce-root">What provides security at the transport layer?
<ol>
<li class="mce-root">SSL</li>
<li class="mce-root">TLS</li>
<li class="mce-root">either (1) or (2)</li>
<li class="mce-root">both (1) and (2)</li>
</ol>
</li>
</ol>
<ol start="3">
<li class="mce-root">What is the standard TCP port for an SSL supported application?
<ol>
<li class="mce-root"><kbd>420</kbd></li>
<li class="mce-root"><kbd>1032</kbd></li>
<li class="mce-root"><kbd>443</kbd></li>
<li class="mce-root"><kbd>322</kbd></li>
</ol>
</li>
</ol>
<ol start="4">
<li class="mce-root">How do you identify a secure site? Select all correct answers.
<ol>
<li class="mce-root"><kbd>http</kbd></li>
<li class="mce-root"><kbd>https</kbd></li>
<li class="mce-root">the open padlock</li>
<li class="mce-root">the locked padlock</li>
</ol>
</li>
</ol>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Further reading</h1>
                </header>
            
            <article>
                
<p>For more information, refer to the following links: </p>
<ul>
<li><a href="https://tools.ietf.org/html/rfc6101">https://tools.ietf.org/html/rfc6101</a></li>
<li><a href="https://tools.ietf.org/html/rfc5246">https://tools.ietf.org/html/rfc5246</a></li>
<li><a href="https://www.ssllabs.com/">https://www.ssllabs.com/</a></li>
<li><a href="https://blog.pcisecuritystandards.org/are-you-ready-for-30-june-2018-sayin-goodbye-to-ssl-early-tls">https://blog.pcisecuritystandards.org/are-you-ready-for-30-june-2018-sayin-goodbye-to-ssl-early-tls</a></li>
<li><a href="https://www.openssl.org/">https://www.openssl.org/</a></li>
</ul>
<p> </p>


            </article>

            
        </section>
    </div>



  </body></html>