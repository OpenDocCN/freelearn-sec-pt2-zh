<html><head></head><body><div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">VPN and WAN Encryption</h1>
                </header>
            
            <article>
                
<p>In the previous chapter, we discussed data protection and security techniques by looking at firewalls and firewall network design, as well as its placement. In this chapter, we will focus on protecting data before transmitting it over a public internet infrastructure or a network infrastructure <span>shared</span><span> </span><span>by a service provider.</span></p>
<p>We are going to cover the following topics in this chapter:</p>
<ul>
<li>Overview</li>
<li><span>Classes of VPN</span></li>
<li>Type of VPN protocol</li>
<li>VPN design</li>
<li>IKE V1 versus IKE V2</li>
<li>WAN encryption technique</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Overview</h1>
                </header>
            
            <article>
                
<p class="mce-root">Data is the new currency or oil. It can be found in your shopping pattern, emails, online banking, food ordering and in many places besides. Every year, we continue to encounter issues such as cyber threats, illegal surveillance (Wikileaks), and anti-privacy advocacy that targets these areas. In a connected world like the internet, security and privacy is a must when it comes to protecting data. As an end user, it's impossible to have an end-to-end visibility on public internet infrastructure that we use day to day. Fortunately, we have <strong>virtual private networks</strong> (<strong>VPN</strong>), a type of shield which forms a secure tunnel between two or more VPN supported devices. VPN helps to protect data traffic from snooping or man-in-the-middle attacks. However, to pick the best VPN service out there, we first need to understand the different VPN types and their use cases.</p>
<p>There are many use cases for VPNs.<strong> </strong>One very common reason why a VPN might be used for secure communication for mobile users or between branches and head offices is because it provides secure access for corporate IT resources:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1119 image-border" src="Images/e38ea5f0-881c-4548-8038-ac77e8e09a4b.png" style="width:38.75em;height:27.42em;" width="1731" height="1211"/></div>
<p class="mce-root">Your local ISP acts as a gateway for internet access and your activity can be tracked via this. In the same way as when you attempt to access any resources, the resource provider can also track your location based on your IP address. This is going to be another use case where you hide your identity by using third-party VPNs. In the following diagram, you can see that a user sitting in Manila can connect to a global resource, that might be blocked for the local ISP in Manila:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1189 image-border" src="Images/16453b90-b7c5-4d0a-a99c-beba5ec97391.png" style="width:42.58em;height:39.17em;" width="1999" height="1839"/></div>
<p>These VPNs are available either in app format or are inbuilt within the browser. Some organizations also provide full tunnel capabilities. Here, once you are connected to a corporate VPN, your exit point to the internet would be your organization's internet gateway.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Classes of VPN</h1>
                </header>
            
            <article>
                
<p>VPN trusts a user to connect to private resources securely over public            <span>infrastructure </span>networks that we don't trust. VPN creates an encrypted connection (known as a secure VPN tunnel) and all data traffic passes through this secure tunnel. </p>
<p>Let’s consider several different VPNs and think about where they fit. We’ll look at two main classes of VPN, which I will refer to as remote access VPNs and network-based site-to-site VPNs:</p>
<ul>
<li><strong>Remote access VPN</strong>:<strong> </strong>This is a<strong> </strong><span>perfect solution for users who need to connect to a corporate network to gain access to IT resources remotely. For example, telecommuters, mobile users, and extranet users. The connection between the user and the corp network happens through the internet. VPNs might require users to install the VPN client firewall vendors' specific software, or they may be required to use a web-based client. The VPN client software forms a secure tunnel with the VPN server and encapsulates and encrypts the information before sending it over the internet to the VPN server. IPSec or tunnelling protocols can be used to establish a tunnel between endpoints on a network. VPN technology offers IPSec and SSL, two of the most famous and widely deployed methods to deploy remote VPNs.</span></li>
</ul>
<div class="packt_tip">A remote access VPN user must have an AAA profile to control access and authorization.</div>
<ul>
<li><strong>Site–to–Site VPN</strong>:<strong> </strong>Site-to-site VPNs (often known as point-to-point VPNs) are mostly used in the corporate sector to provide IT resource access to branch offices and partners' offices in different geographic locations. When remote offices of the same organization are connected using site-to-site VPNs, it is known as an intranet based VPN. If the purpose was to provide connectivity to a partner's domain, then it would be known as an extranet VPN.</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Type of VPN protocol</h1>
                </header>
            
            <article>
                
<p>VPN types are distinguished by the various tunnelling protocols, such as PPTP, and L2TP with IPSec. Each of these VPN protocols offer different features and levels of security.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Point-to-Point tunneling protocol</h1>
                </header>
            
            <article>
                
<p>PPTP remains a popular network protocol – especially on Windows computers - and it is one of the oldest protocols still in use. This has been developed by Microsoft to encapsulate another protocol called point-to-point. PPTP uses underlying authentication protocols such as MS-CHAP (<span><strong>Challenge Handshake Authentication Protocol</strong> </span>(<strong><span>CHAP</span></strong>))—v1/v2, which are subject to serious security vulnerabilities. PPTP VPN encrypts data using 128-bit encryption, which makes it the fastest, but the weakest in terms of security.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Layer 2 Tunneling Protocol</h1>
                </header>
            
            <article>
                
<p>L2TP is developed by combining characteristics of the <strong><span>Layer 2 Forwarding Protocol</span></strong> (<strong><span>L2F</span></strong>), designed by Cisco, with those of  PPTP, designed by Microsoft. As L2TP does not offer confidentiality and encryption features on its own, another protocol called IPSec is used along with it to secure the connection. For end host clients, software installation is not required since almost all operating systems offer inbuilt VPN clients. 256 bit encryption is a mandatory addition to the L2TP VPN. L2TP is a CPU processor that is intensive due to double encapsulation. The first encapsulation takes place when the L2TP VPN functions and it is then topped off with the second IPSec encapsulation.</p>
<p>Let's look at Windows 10 inbuilt VPN options: You have the option to use L2TP with pre-shared keys and certificates:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-564 image-border" src="Images/4d175206-3c85-4099-ae5f-7d34660dd62e.png" style="width:23.42em;height:22.08em;" width="611" height="576"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Secure Socket Tunneling protocol</h1>
                </header>
            
            <article>
                
<p>Based on VPN, <strong>Secure Socket Tunneling protocol</strong> (<strong>SSTP</strong>) is best suited to VPN for highly confidential online activities, such as banking transactions, e-commerce transactions or business communications. SSTP VPN is Microsoft's SSL VPN, which worked on port <kbd>443</kbd>, and this port is likely not blocked by any ISP. SSTP comes with Integrated <strong><span>Network Access Protection</span></strong> (<strong><span>NAP</span></strong>) support for client health checks, including antivirus and firewall. Unlike other VPN protocols, SSTP establishes a single HTTPS channel from client to server, and also supports strong authentication<span> smartcards, RSA secureID, and so on.</span></p>
<div class="packt_infobox">The NAP platform is not available from Windows 10 onwards.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Internet Protocol Security</h1>
                </header>
            
            <article>
                
<p><strong>Internet Protocol Security</strong> (<strong>IPsec</strong>) is a widely deployed open standard,multi-vendor supported framework design based on cryptography to achieve security and data protection for IPv4 and IPv6. IPsec does support symmetric and asymmetric cryptography to secure communications. The asymmetric cryptography always requires more CPU processing power and higher performance. This is because the implementation uses asymmetric cryptography to share a shared secret and it then performs<span> </span>symmetric encryption. </p>
<p>The main components of IPSec are mentioned below:</p>
<ul>
<li class="mce-root"><strong>Authentication Header</strong> (<strong>AH</strong>)</li>
<li class="mce-root"><strong>Encapsulating Security Payload</strong> (<strong>ESP</strong>)</li>
<li class="mce-root"><strong>Internet Key Exchange Protocols</strong> (<strong>IKE</strong>)</li>
</ul>
<p>AH only provides message authentication. In other words, AH only lets the receiver verify that the message is intact and unaltered; it doesn't encrypt data. The following diagram shows the packet format before and after AH encapsulation:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1193 image-border" src="Images/20759435-e606-4671-b8ed-18778406b8fc.png" style="width:39.50em;height:17.92em;" width="1154" height="523"/></div>
<p>The basic difference is that ESP provides actual encryption. It encrypts the payload of the packet and protects it from snooping and replay. <span>The following diagram shows the packet</span></p>
<div class="CDPAlignCenter CDPAlign"><span><img class="alignnone size-full wp-image-1191 image-border" src="Images/7d0eb6fd-976f-4fe4-88a9-f1789ef366bd.png" style="width:40.67em;height:21.17em;" width="1248" height="668"/>:</span></div>
<div class="packt_tip packt_infobox">No current deployment of IPsec uses AH.</div>
<p>There are two phases for IPsec communication:</p>
<p>In the first phase (marked in blue), IKE establishes a secure channel. In the second phase (marked in green), encrypted data is transmitted. </p>
<p>There are two versions of IKE: IKE V1 and IKE V2. We will discuss the benefits of V2 in an upcoming section. For more details, you can refer to <a href="https://tools.ietf.org/html/rfc6311">https://tools.ietf.org/html/rfc6311</a>:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1194 image-border" src="Images/2c8af39f-3da0-4f20-bb4f-a12f0e6541f5.png" style="width:43.33em;height:16.33em;" width="1570" height="544"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">SSL VPN</h1>
                </header>
            
            <article>
                
<p>For remote access roaming users, SSL VPN is the best solution. The SSL protocol provides confidentiality and authenticity over the public internet. SSL uses TCP <kbd>443</kbd>, which is a non-blocking port for any ISP. To connect VPN, users need to type SSL VPN FQDN in the browser, for example, <a href="https://vpn.corp.com">https://vpn.corp.com</a> . Upon successful authentication, users can communicate with corporate IT resources. SSL VPN doesn't require installation and configuration of client software at the user end. </p>
<p>Let's try to understand the security of SSL VPN. Having VPN does not mean that everything is good and that data  transmission is safe. SSL VPN relies on SSL PKI cryptography. Using insecure or outdated weak encryption simply translates into putting corporate data at risk. Please refer to Chapter 9 for the latest SSL/TLS standard.</p>
<div class="packt_infobox">Please keep in mind that an SSL secure channel is always built between a host and gateway, not to the end resources.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">MPLS VPN</h1>
                </header>
            
            <article>
                
<p>MPLS VPNs are the best use case for multi-site global connectivity to Enterprise Networks. Enterprises connect to the same MPLS service provider with two or more sites to form a VPN. MPLS L3VPN is the most commonly deployed application over <strong>multi-protocol label switched</strong> (<strong>MPLS</strong>) networks. MPLS allows service providers to virtualize their network resources on the service provider Edge, so customers can share the physical network but still maintain logical isolation. <span>Enterprise customers use service providers such as MPLS infrastructures to connect to multiple global sites. Alternatively, large enterprises may use MPLS internally for their own global infrastructures.</span> The <span><strong>Provider Edge</strong> </span>(<strong><span>PE</span></strong>) router terminates customers' circuit into a <strong>virtual route forwarding</strong> (<strong>VRF</strong>) instance that is unique to every customer, and then forwards it to a provider core router, using MPLS to tag the traffic and identify the VRF the traffic belongs to:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1196 image-border" src="Images/7019faff-b1d2-4486-b34c-8292e4b81bc4.png" style="width:48.33em;height:17.83em;" width="1999" height="744"/></div>
<div class="packt_infobox">MPLS does not provide encryption by default.</div>
<p>For remote access VPNs, never choose PPTP unless you have no other option and are doing basic activities such as streaming Netflix, which doesn't require security or safety. Use L2TP/IPsec when you have to and keep in mind that SSTP is a good alternative for Windows devices that need stronger security. IKEv2 is the latest and greatest offering which is perfect because it won't drop a secure VPN connection when switching between a Wi-Fi network or cell connection. We will discuss the IKEv2 feature in our next section.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">VPN Design</h1>
                </header>
            
            <article>
                
<p>Let's discuss design considerations for site-to-site firewall termination points.</p>
<ul>
<li><strong>A Separate VPN Firewall</strong>: You might have seen multiple scenarios for enterprise networks. Having a single firewall gives networks less flexibility and a single VPN termination point. However, most networks have at least a dual firewall layer from a security point of view. The first firewall is there to stop all unwanted data traffic and to control DMZ traffic, while the second firewall can be used to terminate a VPN connection, along with next generation firewall features such as URL filtering, and antivirus: </li>
</ul>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-979 image-border" src="Images/3e6152d6-f614-4102-9c53-9b8387c97ea5.png" style="width:47.42em;height:21.42em;" width="978" height="441"/></div>
<ul>
<li><strong>Remote Access VPN Tunnels—to split or not to split?</strong>: Whenever an organization evaluates options to set up VPN for its remote workers and partners, one of the security considerations that arise is whether or not to support a split tunnel model. Let's explore the pros and cons of this. A full tunnel translates a secure connection when all your traffic goes through the VPN. A split tunnel means that only corporate traffic goes through the tunnel. For the rest of the traffic, a local internet connection would be used.</li>
</ul>
<p style="padding-left: 60px">The following diagram shows a split tunnel: Red traffic goes through a local internet gateway.</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-566 image-border" src="Images/74078736-56a5-4a4a-94ba-2941a6012018.png" style="width:49.17em;height:25.50em;" width="995" height="517"/></div>
<p style="padding-left: 60px">The following diagram shows a full tunnel: All traffic goes through the VPN.</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-567 image-border" src="Images/48a31925-a649-48c8-a161-0ce20fed9dee.png" style="width:48.50em;height:23.58em;" width="1031" height="501"/></div>
<p>As we have seen, a split tunnel might make a faster internet connection via a local internet gateway, but direct connection bypasses all corporate control and security policies, such as URL filtering and malware protection. In a full tunnel, all traffic travels through a corporate gateway, providing great security. However, an extra hop to a network might cause slow network access. A full tunnel also helps you to hide your identity on the internet.</p>
<div class="packt_tip">If your business has enough bandwidth to accommodate all remote users, then the network and security administrator must use a full tunnel. An organization with a large remote workforce can consume significant amounts of bandwidth.</div>
<p>A common practice followed by most network administrators is to choose  pre-shared secrets for authentication, which is identical on both ends of the connection termination point. This would be done rather than setting up a <strong>Certificate Authority</strong> (<strong>CA</strong>) and issuing individual keys to each IPSec endpoint. Consequently, if one endpoint is compromised or physically stolen, the whole network becomes vulnerable. As IT staff keeps changing, the secrecy of that pre-shared key defeats the object over time. An SSL/TLS certificate based VPN works well, but that also brings device configuration overheads. However, if you still decide on using pre-shared keys then you should have a process in place for changing them after a certain amount of time, and you should use different pre-shared keys on different VPN connections. For approved and strong encryption, you must look at the <strong>Federal Information Processing Standards</strong> (<strong>FIPS</strong>), published by the <span>National Institute of Standards and Technology.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">IKE V1 versus IKE V2</h1>
                </header>
            
            <article>
                
<p>In this section, we will go over what IKE is and what the differences are between IKEv1 and IKEv2.<br/>
IKE  is a protocol that belongs to the IPsec protocols suite and is responsible for setting up a security association (an agreement between both parties) that enables two end IPsec enabled devices to send data securely:</p>
<ul>
<li>IKEv2 is faster and light on bandwidth, as a smaller number of messages are needed to establish a tunnel. With IKEv1, we had main mode (nine messages), and aggressive mode (six messages). In contrast, IKEv2 only has one mode that has only four messages.</li>
<li>IKEv2 provides inbuilt NAT Traversal and, by default, IKEv1 does not provide this facility. It is a well-known fact that the IPSec protocol was not designed with <strong>Network Address and Port Translation</strong> (<span><strong>NAPT</strong>)</span> in mind. The initial payload and, in particular, the headers are encrypted when using IPSec ESP mode. An intermediate NAT device cannot change these encrypted headers to its own address. During phase one negotiations, if NAT Traversal detection is on, one or both peers signify to each other that they are using NAT Traversal, then the IKE negotiations switch to using UDP port <strong>4500</strong>.</li>
<li>IKEv2 has inbuilt tunnel liveness status checks. If a tunnel is broken down, it has the facilities to detect and re-establish the tunnel. However, IKEv1 does not have this functionality. There are several workarounds for IKEv1, but these are not standardized.</li>
<li>IKEv1 supports authentication via pre-shared keys, digital signatures, and public key encryption. IKEv2 supports pre-shared keys, digital signatures and <span><strong>Extensible</strong> <strong>Authentication Protocol</strong> (</span><span><strong>EAP</strong>)</span>. IPSec peers in IKEv1 must use the same type of authentication - for example, both pre-shared keys or both digital signature. However, IKEv2 supports asymmetric authentication—one side can authenticate using pre-shared keys while the other side uses digital signatures.</li>
<li><span>IKEv2 Mobility and Multihoming Protocol RFC 4555</span> (<span>MOBIKE</span>) supports a remote access VPN user in moving from one IP address to another without reestablishing all security associations with the VPN gateway. The ability to move between IP addresses without performing cryptographic calculations and without the overhead of reconnecting to the VPN gateway improves the user experience. IKEv1 does not support any mechanism to do this, whereas IKEv2 does.</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">WAN Encryption technique</h1>
                </header>
            
            <article>
                
<p>In the internet and WAN connected environment of today, it is important to encrypt business-critical data in order to keep the data secure and reduce the risks of spying and snooping. Data breaches also include fiber tapping. With the continued increase of WAN bandwidth driven by video traffic, the online gaming industry and cloud services, we have seen  the speed grow from 1 GB to 10 GB, to 40 GB, and now to 100 GB. With growing link speeds and a demand for bandwidth to continually increase, the traditional layer-3 encryption will not be enough to meet requirements.</p>
<p>The three most common methods for implementing encryption are as follows:</p>
<ol>
<li class="mce-root">IPsec, or Layer-3 (L3) encryption</li>
<li class="mce-root">MACsec, or Layer-2 (L2) encryption</li>
<li class="mce-root"><strong><span>Optical Network</span></strong> (<strong><span>OTN</span></strong>) or Layer-1 (L1) encryption</li>
</ol>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">IPsec Layer-3 encryption</h1>
                </header>
            
            <article>
                
<p>We have already discussed IPsec in the previous section. Here, we will discuss how IPsec complements WAN technology. Layer-3 encryption is well-suited to environments where you have low-bandwidth connections and do not have the devices to support encryption at Layer-2 or Layer-1 levels. Organizations are running WAN technology in a different way, for example, with ATMs, Frame-Relay, Metro-Ethernet and MPLS-based solutions. The ultimate security question is: <em>Who do you trust with your business-critical data?</em> If your answer is the service provider, then you <span>probably</span><span> do not need to encrypt your data. However, if your answer is nobody, </span><span>then you must transmit data to an encrypted service provider.</span></p>
<p>Let's look at the MPLS VPN provider, which is widely deployed in WAN technology. The primary benefit of this service provider is faster transport techniques with proper isolation between customers. The terminology includes VPN, but this does not mean that your data is being encrypted by default.</p>
<p>As the following diagram shows, two customers can use the same subnet and connect to the same router of services provided with proper isolation:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1198 image-border" src="Images/aafd3947-0235-4d25-82fa-2cb9bde02981.png" style="width:166.58em;height:65.50em;" width="1999" height="786"/></div>
<p>To secure data transmission over MPLS, you <span>can take an IPsec approach from CE to CE for securing the VPN customer's traffic across an untrusted infrastructure. Introducing IPsec prevents the insertion of bogus CE into the VPN and the leakage of traffic from the secured VPN to a non-trusted VPN. This added a complexity and scalability issue for large-scale deployment. </span></p>
<p>The <strong>Dynamic Multi-point VPN</strong> (<strong>DMVPN</strong>) model works with the principle of the <strong>Next Hop Resolution Protocol</strong> (<strong>NHRP</strong>). Every IPsec node holds information about how to reach the next hop server, which returns the address of the target IPsec node to the originating node. This is a very scalable way to dynamically establish IPsec tunnels on demand. This is  pretty much <span>a </span><span>scalable solution that is independent to underlying WAN infrastructures:</span></p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-981 image-border" src="Images/59887547-82ba-48c0-af78-8ed17162bbc1.png" style="width:45.58em;height:33.75em;" width="1133" height="839"/></div>
<p>You must consider performance before leveraging IPSec for high-speed link encryption. The routers' throughput capabilities are restricted to the IPSec encryption engine limits, rather than using an encryption solution that can leverage the maximum aggregate throughput capabilities of the router. Using IPsec encryption adds 57 bytes of overhead to encapsulate the IP header of the original packet and to add an additional authentication header and trailer. Using IPsec along with GRE adds an extra overhead of 76 bytes. More overhead directly translates into less bandwidth throughput.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">MACsec—Layer-2 Encryption</h1>
                </header>
            
            <article>
                
<p>As the name implies, MACsec is a MAC layer or link layer encryption that offers a simplified, line-rate, per port encryption option for secure next-generation high bandwidth deployments. Organizations that comply with FIPS, HIPAA, and PCI DSS have to implement strong cryptography to protect sensitive data during transmission. MACsec provides great hop-by-hop deployment flexibility. Whenever you feel the public infrastructure is not safe, you can implement MACsec between transport nodes.</p>
<p>Use Cases: You can use MACsec encryption end-to-end using the following examples:</p>
<ul>
<li>Host-to-Switch</li>
<li>Switch-to-Switch</li>
<li>Router-to-Switch</li>
<li>Router-to-Router Data center Interconnect</li>
</ul>
<p>Let's look at the 802.1 AE (MACsec) format: The actual Ether-type + Payload is encrypted as follows:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1126 image-border" src="Images/2a24f4ba-43f7-462c-bc0c-f75a459fb750.png" style="width:144.33em;height:13.33em;" width="1732" height="160"/></div>
<p>Now let's look at one Cisco example for data center interconnection using MACsec. Introducing Layer-2 devices between Layer-3  and any routing protocol can be run between Layer-3 devices. The DWDM WAN link would be encrypted; the main reason to encrypt this link is that it might be a shared infrastructure provided by a third party:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1199 image-border" src="Images/b3d5dc63-d38d-49c8-9d0e-124eb89c5fcf.png" style="width:43.67em;height:24.00em;" width="1999" height="1233"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Optical Network—Layer-1 Encryption</h1>
                </header>
            
            <article>
                
<p>There are multiple ways to access fiber. This includes:</p>
<ul>
<li>Tapping on street cabinet</li>
<li>Fiber coupling devices</li>
<li>Protocol analyzer and splice boxes.</li>
</ul>
<p>A Layer-1 encryption solution supports applications such as secured data center connectivity for financial institutions, encrypted managed services for carriers, and secured networks for government institutions. Since it is done at the lowest layer possible in the OSI model, Layer 1 encryption technically provides the highest level of security. It also has fast speed and low latency, as well as 100% throughput with 0 bytes overhead:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-982 image-border" src="Images/712b8b8b-7987-49c1-86e6-c5453370213d.png" style="width:95.00em;height:41.33em;" width="1140" height="496"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Summary </h1>
                </header>
            
            <article>
                
<p>This chapter provides a very detailed overview of VPNs, with a focus on using IPSec as a VPN technology. It started by covering the various use cases for VPN and available <span>options</span><span>. It then covered the technicalities of different VPN protocols, such as PPTP, L2TP, SSTP, IPsec, and the components that make up IPSec.</span></p>
<p class="mce-root">The middle section of this chapter covered the design principle of corporate remote access VPNs by looking at full and split tunnel options and their benefits. The chapter finished by looking at WAN encryption techniques, from Enterprise to cloud services and financial organizations, in order to ensure security on different layers of the data communication model.</p>
<p class="mce-root">Now that you have a basic knowledge of all layers from network to application security, the next chapter will look at an overall approach to infrastructure security and future technology.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Questions</h1>
                </header>
            
            <article>
                
<ol>
<li>Which of the following may be used as a terminating point for a site-to-site VPN tunnel?
<ol>
<li>Firewall</li>
<li>Router</li>
<li>Concentrator</li>
<li>All of the above</li>
</ol>
</li>
</ol>
<ol start="2">
<li>Which of the following is not a Layer-2 tunneling protocol?
<ol>
<li>PPTP</li>
<li>IPsec</li>
<li>L2TP</li>
<li>.MPLS VPN</li>
</ol>
</li>
</ol>
<ol start="3">
<li>IKE creates SAs for:
<ol>
<li>SSL</li>
<li>PGP</li>
<li>IPSec</li>
<li>VP</li>
</ol>
</li>
</ol>
<ol start="4">
<li>IPSec defines two protocols: _______ and ________.
<ol>
<li>AH; SSL</li>
<li>PGP; ESP</li>
<li>AH; ESP</li>
<li>All of the above</li>
</ol>
</li>
</ol>
<ol start="5">
<li>______ provides authentication at the IP level.
<ol>
<li>AH</li>
<li>ESP</li>
<li>PGP</li>
<li>SSL</li>
</ol>
</li>
</ol>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Further Reading</h1>
                </header>
            
            <article>
                
<p>For more information, visit the following links:</p>
<ul>
<li><a href="https://tools.ietf.org/html/rfc2409">https://tools.ietf.org/html/rfc2409</a></li>
<li><a href="https://tools.ietf.org/html/rfc5996">https://tools.ietf.org/html/rfc5996</a></li>
<li><a href="https://tools.ietf.org/html/rfc3031">https://tools.ietf.org/html/rfc3031</a></li>
<li><a href="https://www.sans.org/reading-room/whitepapers/vpns/">https://www.sans.org/reading-room/whitepapers/vpns/</a></li>
</ul>
<p> </p>


            </article>

            
        </section>
    </div>



  </body></html>