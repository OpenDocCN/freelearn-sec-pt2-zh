<html><head></head><body><div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Delving Deep into the Usage of Kali Linux</h1>
                </header>
            
            <article>
                
<p class="mce-root">I have been so excited to write this chapter and share all of the information that you will need to master the usage of Kali Linux. A lot of the content in this chapter will be common among Debian Linux distributions, and by the end of the chapter, you will be able to handle Kali Linux with ease, like a real hacker. Speaking of hackers, it's good to know that Kali Linux is used by both black hat hackers and professional penetration testers. I've always used it during my engagements, and I occasionally (but rarely) use Microsoft Windows OS.</p>
<p>Kali Linux contains tons of tools dedicated to penetration testing, and it would be a big challenge to get used to all of them at once. In this chapter, I will show you my most often used commands. I keep them with me when I'm on an engagement, in order to manipulate the operating system of Kali Linux. You will see a lot of commands in this chapter; use them as a cheat sheet to help you achieve your goals. This is just the beginning of how to use Kali Linux as an operating system,<strong> </strong>and in upcoming chapters, you will learn about the penetration testing tools installed on Kali.</p>
<div class="packt_tip">Before you start reading this chapter, I want to emphasize the importance of using the <strong>Terminal window</strong>. If you want to be good at using Kali Linux, you should focus all of your efforts on mastering the ins and outs of the Terminal window. In fact, I never use the GUI, unless the tool is made for something like Burp, for example; and that is an exception, my friends.</div>
<p>Are you thrilled? In this chapter, you will learn about the following:</p>
<ul>
<li>The Kali Linux filesystem structure</li>
<li>Handling applications and packages</li>
<li>Managing the filesystem in Kali</li>
<li>Kali security management</li>
<li>Handling the secure shell</li>
<li>Configuring the network services in Kali</li>
<li>Process management commands</li>
<li>System info commands</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">The Kali filesystem structure</h1>
                </header>
            
            <article>
                
<p>The first thing that you need to start to understand is the Kali Linux <strong>filesystem structure</strong>, which is based on the Debian distribution filesystem. If you have used Microsoft Windows OS before, then the Linux structure will be a bit similar to it. For example, Windows starts with the <kbd>C:\</kbd> directory, while the Linux OS starts with <kbd><strong>/</strong></kbd>, which is called the <kbd>root</kbd> directory.</p>
<div class="packt_infobox">The <kbd>root</kbd> directory (<kbd><strong>/</strong></kbd>) and the root <kbd>home</kbd> directory (<kbd>/root</kbd>) that you use in Kali are not the same. The latter is used as a home directory for the root user.</div>
<p>In Kali, we always use the root user to log in to our machine, and that means that you have no limits to what you can do in the OS. Every single piece in the Linux system is based on files; it's okay to look around, but be careful if you decide to change any of the configuration files.</p>
<p>The directory structure in Kali is based on the Unix <strong>Filesystem Hierarchy Standard</strong> (<strong>FHS</strong>), which defines the Linux directories, and their contents, as well:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/edbe0eca-8c0f-4d3a-8613-4a93bfa65ffe.png" width="1034" height="611"/></div>
<div class="mce-root CDPAlignCenter CDPAlign"/>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<th>
<p>Directory</p>
</th>
<th>
<p>Contents description</p>
</th>
</tr>
<tr>
<td>
<p><kbd>/bin</kbd></p>
</td>
<td>
<p>Essential system commands binaries for all users. (For example, <kbd>grep</kbd>, <kbd>ls</kbd>, <kbd>cat</kbd>. This is like <kbd>c:\Windows\System32</kbd> in Windows.)</p>
</td>
</tr>
<tr>
<td>
<p><kbd>/boot</kbd></p>
</td>
<td>
<p>Contains the boot loader, Kernels, and <kbd>initrd</kbd> files.</p>
</td>
</tr>
<tr>
<td>
<p><kbd>/dev</kbd></p>
</td>
<td>
<p>This directory contains the pointer locations to various devices.</p>
</td>
</tr>
<tr>
<td>
<p><kbd>/etc</kbd></p>
</td>
<td>
<p>This folder contains all of the <kbd>administration</kbd>/<kbd>configuration</kbd> files and passwords.</p>
</td>
</tr>
<tr>
<td>
<p><kbd>/lib</kbd></p>
</td>
<td>
<p>The libraries <span>essential for the binaries in <kbd>/bin/</kbd> and <kbd>/sbin/</kbd>.</span></p>
</td>
</tr>
<tr>
<td>
<p><kbd>/lost+found</kbd></p>
</td>
<td>
<p><span>Files that were recovered previously.</span></p>
</td>
</tr>
<tr>
<td>
<p><kbd>/mnt</kbd></p>
</td>
<td>
<p>Contains t<span>emporarily</span> mounted<span> directories.</span></p>
</td>
</tr>
<tr>
<td>
<p><kbd>/media</kbd></p>
</td>
<td>
<p><span>Mount folder for removable</span> media, <span>such as CD-ROMs.</span></p>
</td>
</tr>
<tr>
<td>
<p><kbd>/opt</kbd></p>
</td>
<td>
<p><span>Add-on application software packages (</span><span>pre-compiled, non-<kbd>.deb</kbd> binary distribution (</span>tar'ed..) <span>goes here).</span></p>
</td>
</tr>
<tr>
<td>
<p><kbd>/proc</kbd></p>
</td>
<td>
<p>Contains Kernel and processes status (as usual, in text files, for example, uptime and network).</p>
</td>
</tr>
<tr>
<td>
<p><kbd>/root</kbd></p>
</td>
<td>
<p>The root user home directory.</p>
</td>
</tr>
<tr>
<td>
<p><kbd>/sbin</kbd></p>
</td>
<td>
<p>Contains system binaries that are dedicated to administrative commands (for example, <kbd>daemons</kbd>, <kbd>init</kbd>, <kbd>route</kbd>, and many more).</p>
</td>
</tr>
<tr>
<td>
<p><kbd>/tmp</kbd></p>
</td>
<td>
<p>A temporary folder that contains files that are used for a short period of time.</p>
</td>
</tr>
<tr>
<td>
<p><kbd>/srv</kbd></p>
</td>
<td>
<p>Some specific data that is served by the system.</p>
</td>
</tr>
<tr>
<td>
<p><kbd>/sys</kbd></p>
</td>
<td>
<p>Very similar to <kbd>/proc</kbd>.</p>
</td>
</tr>
<tr>
<td>
<p><kbd>/home</kbd></p>
</td>
<td>
<p>Contains the users' home directories.</p>
</td>
</tr>
<tr>
<td>
<p><kbd>/usr</kbd></p>
</td>
<td>
<p><span>Contains read-only data (formerly from</span> the UNIX s<span>ourc</span>e re<span>pository; now from</span> UNIX sy<span>stem</span> <strong>r</strong><span>esources):</span></p>
<ul>
<li><kbd>/usr/bin/</kbd>: Same as for the top-level hierarchy</li>
<li><kbd>/usr/include/</kbd>: Standard include files</li>
<li><kbd>/usr/lib/</kbd>: Same as for the top-level hierarchy</li>
<li><kbd>/usr/sbin/</kbd>: Same as for the top-level hierarchy</li>
<li><kbd>/usr/share/</kbd>: Architecture-independent (shared) data</li>
<li><kbd>/usr/src/</kbd>: Source code (to build Debian packages - see <kbd>/usr/local/src/</kbd>)</li>
<li><kbd>/usr/X11R6/</kbd>: X Window System, Version 11, Release 6</li>
<li><kbd>/usr/local/</kbd>: Tertiary hierarchy for local data installed by the system administrator</li>
<li><kbd>/usr/local/bin</kbd>: Locally compiled binaries, local shell script, and so on</li>
<li><kbd>/usr/local/src</kbd>: Source code (place to extract and build non-Debianized stuff)</li>
</ul>
</td>
</tr>
<tr>
<td>
<p><kbd>/var</kbd></p>
</td>
<td>
<p>Contains variable data (for example, websites, logs, databases, and much more).</p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Handling applications and packages</h1>
                </header>
            
            <article>
                
<p>Kali Linux p<span>ackages are stored in repositories and downloaded to the system to ensure the integrity of the package. Make sure to always update the system, as mentioned in the previous chapter. The repository configuration file is located at</span> <kbd>/etc/apt/sources.list</kbd>.<strong> </strong><span>Make sure that this file is not empty (it will be if you didn't choose the network mirror option during the installation process); if it is, your Kali will not update. </span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">The Advanced Packaging Tool</h1>
                </header>
            
            <article>
                
<p>The <strong>Advanced Packaging Tool</strong> (<strong>APT</strong>) is used for installing or upgrading packages, along with all of the required dependencies. The APT can also be used to upgrade a complete distribution of Kali:</p>
<ul>
<li class="mce-root"><kbd>apt-get update</kbd> or <kbd>apt update</kbd>: This command is used to synchronize the local package index files with their sources, as defined in <kbd>/etc/apt/sources.list</kbd>. The <kbd>update</kbd> command should always be used first, before performing an <kbd>upgrade</kbd> or <kbd>dist-upgrade</kbd>.</li>
<li class="mce-root"><kbd>apt-get upgrade</kbd> or <kbd>apt upgrade</kbd>: This command is used to install the newest versions of all packages installed on the system using <kbd>/etc/apt/sources.list</kbd>. The <kbd>upgrade</kbd> command will not change or delete packages that are not being upgraded, and it will not install packages that are not already installed. The <kbd>-y</kbd> switch is used, with this command, to automatically accept the prompt messages.</li>
<li class="mce-root"><kbd>apt-get dist-upgrade</kbd> or <kbd>apt dist-upgrade</kbd>: This command upgrades all packages currently installed on the system, and their dependencies. It also removes obsolete packages from the system. The <kbd>-y</kbd> switch is used, along with this command, to automatically accept the prompt messages.</li>
</ul>
<p style="padding-left: 60px">To fully upgrade your Kali Linux OS, use the following commands:</p>
<pre style="padding-left: 60px"><strong>apt update</strong><br/><strong>apt dist-upgrade -y</strong><br/><span><strong>reboot</strong><br/></span></pre>
<div class="packt_infobox">You can combine the three preceding commands into one command by using <kbd>&amp;&amp; apt update &amp;&amp; apt dist-upgrade -y &amp;&amp; reboot</kbd>.</div>
<ul>
<li>To show the full description of a package and identify its dependencies, use the following:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>apt-cache show [package name]</strong></pre>
<ul>
<li>To remove a package from Kali, <span>use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>apt-get remove [package name]</strong></pre>
<ul>
<li>To install an application from the repository, <span>use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>apt-get install [application name]</strong></pre>
<div class="packt_infobox">Sometimes, you will download applications from the web, and you will need to install them using the following command:<br/>
<br/>
<kbd>./configure &amp;&amp; make &amp;&amp; make install</kbd></div>
<p>If you want to download a tool package from the GitHub repository, use the following command (to get the URL, on the repo homepage, <span>click</span> <span>the <span class="packt_screen">Clone</span> <span class="packt_screen">or d</span><span class="packt_screen">ownload</span> button, and the URL will be revealed</span>):</p>
<pre><strong>git clone [Github repo URL]</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Debian's package management system</h1>
                </header>
            
            <article>
                
<p class="mce-root">This packaging system uses the <kbd>dpkg</kbd> command to install, remove, and query packages.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Using dpkg commands</h1>
                </header>
            
            <article>
                
<p>The upcoming commands are the most frequent ones that I use, but if you are curious and want to know more about all of the commands, then execute the following commands <span>in your Terminal:</span></p>
<ul>
<li>To get the <kbd>help</kbd> instructions for the <kbd>dpkg</kbd> command, use the following:</li>
</ul>
<pre style="padding-left: 60px"><strong>dpkg --help</strong> </pre>
<div class="packt_tip">You can use <kbd>--help</kbd> to see the instructions of any command you like. Also, you have the option to use the manual command:<br/>
<br/>
<kbd>man [application name]</kbd></div>
<ul>
<li>To list all of the packages installed on Kali, <span>use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>dpkg -l</strong></pre>
<div class="packt_tip">You can use the <kbd>dpkg -l</kbd> command in your post-exploitation phase to list all of the applications installed on the compromised Linux box.</div>
<ul>
<li>To find a specific application already installed on the system, <span>use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>dpkg -l | grep [application name]</strong></pre>
<ul>
<li>To install a newly downloaded <kbd>.deb</kbd> application, <span>use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>dpkg -i [path\filename.deb]</strong></pre>
<ul>
<li>To remove an installed application, <span>use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>dpkg -r [application name]</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Handling the filesystem in Kali</h1>
                </header>
            
            <article>
                
<p>I could write a whole book for this section, but I will do my best to show you the commands that you're going to need in your arsenal as a penetration tester.</p>
<p>Before I start listing all of the commands, I would like to share a unique command-line utility that you'll need to master before starting with any of the utilities in this chapter. You can probably guess it; it's called the Help switch! This option will give you a handful of information regarding the command that you are going to execute.</p>
<p>For example, if you want to list the contents of a directory and you're not sure of the options for the command, all you need to do is append the <kbd>--help</kbd> switch, and you can visualize all of the possible functionalities of the command:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/ef990674-55b4-4876-ad71-85c986a8b631.png" style="width:41.83em;height:35.75em;" width="562" height="480"/></div>
<p>Are you ready? This is going to be a long list (a sort of cheat sheet). Let's start:</p>
<ul>
<li>To list the directory and files, use the following:</li>
</ul>
<pre style="padding-left: 60px"><strong>ls</strong></pre>
<ul>
<li>To list hidden items (<kbd>-a</kbd>) in a formatted way (<kbd>-l</kbd>), use the following:</li>
</ul>
<pre style="padding-left: 60px"><strong>ls -la</strong></pre>
<ul>
<li>To list files and directories in a human-readable form<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>ls -lh</strong></pre>
<ul>
<li>To change the current directory to a new one<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>cd [directory path]</strong></pre>
<ul>
<li>To print the working directory<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>pwd</strong></pre>
<ul>
<li>To make a new directory<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>mkdir [path/directory name]</strong></pre>
<ul>
<li>To remove (delete) a file<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>rm [path/file name]</strong></pre>
<ul>
<li>To delete a directory<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>rm -r [path/directory name]</strong></pre>
<ul>
<li>To copy a file to a new location<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>cp [path1/file name] [path2/filename]</strong></pre>
<ul>
<li>To copy a directory to a new location<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>cp -r [path/directory name]</strong></pre>
<ul>
<li>To move/rename a file or a directory<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>mv [path1/file name] [path2/file name]</strong><br/><strong>mv [path1/directory name] [path2/directory name]</strong></pre>
<ul>
<li>To create an empty file<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>touch [path/new file name]</strong></pre>
<ul>
<li>To display the contents of a file<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>cat [path/file name]</strong><br/><strong>more [path/file name]</strong><br/><strong>#list the first 10 lines</strong><br/><strong>head [path/file name]</strong><br/><strong>#list the last 10 lines</strong><br/><strong>tail [path/file name]</strong></pre>
<ul>
<li>To open a text file for editing<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>gedit [path/file name]</strong><br/><strong>#Terminal window text editor (Some people use the Vim editor but that's not my choice)</strong><br/><strong>nano [path/file name]</strong></pre>
<ul>
<li>To find files on your Kali box<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>locate [file name]</strong><br/><strong>find [Path where to start the search] -name [file name patterns]</strong></pre>
<ul>
<li><span>The command that will list the drives (partitions</span>) <span>on the system (for example, <kbd>/dev/sda1 or /dev/sda2</kbd>) is as follows:</span></li>
</ul>
<pre style="padding-left: 60px"><strong>fdisk -l</strong></pre>
<ul>
<li>To mount an unmounted partition<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>mount [path source]  [path destination]<br/>#Example mounting a hidden windows drive that is already installed on the same machine<br/>#Already executed $fdisk -l and saw a drive /dev/sda2<br/>mount /dev/sda2 /mnt/windowsmount</strong></pre>
<ul>
<li>To check the type of a file<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>file [path/file name]</strong></pre>
<ul>
<li>To add the execute permission to a file (sometimes you will need it because by default you cannot execute it)<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>chmod +x [path/file name]</strong></pre>
<ul>
<li>To redirect the output of the Terminal window to a file<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>[command] &gt; [path/filename]</strong><br/><strong>#Example to save the ls command output to a file called output.txt</strong><br/><strong>ls -lh &gt; /root/temp/output.txt</strong></pre>
<ul>
<li>To filter text in a text file or in a command Terminal output<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>grep [text to filter]</strong></pre>
<div class="packt_infobox">The <kbd>grep</kbd> command is most frequently used with the <kbd>Pipe</kbd> symbol, <kbd>|</kbd>, to filter text coming out from the Terminal window. For example, to filter the word <kbd>password</kbd> in a text file called <kbd>config.txt</kbd>, you would use the following command:<br/>
<br/>
<kbd>cat config.txt | grep password</kbd></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">File compression commands</h1>
                </header>
            
            <article>
                
<p><span>You can use the following commands to manage your compressed files on any Linux Debian distribution:</span></p>
<ul>
<li>The following creates <kbd>file.tar</kbd>, containing files:</li>
</ul>
<pre style="padding-left: 60px"><strong>tar cf [file.tar] [files]</strong></pre>
<ul>
<li class="mce-root">The following extracts files from a <kbd>tar</kbd>, <kbd>file.tar</kbd>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>tar xf  [file.tar]</strong></pre>
<ul>
<li class="mce-root">The following creates a <kbd>tar</kbd> with Gzip compression:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>tar czf [file.tar.gz] [files]</strong></pre>
<ul>
<li class="mce-root">The following extracts a <kbd>tar</kbd> using Gzip:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>tar xzf [file.tar.gz]</strong></pre>
<ul>
<li class="mce-root">The following creates a <kbd>tar</kbd> with bzip2 compression:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>tar cjf [file.tar.bz2]</strong></pre>
<ul>
<li class="mce-root">The following extracts a bzip2 compressed file:</li>
</ul>
<pre style="padding-left: 60px"><strong>tar xjf [file.tar.bz2]</strong></pre>
<ul>
<li class="mce-root">The following compresses a file (or files) using <kbd>gzip</kbd> compression:</li>
</ul>
<pre style="padding-left: 60px"><strong>gzip [files]</strong></pre>
<ul>
<li class="mce-root">The following decompresses a compressed <kbd>gz</kbd> file:</li>
</ul>
<pre style="padding-left: 60px"><strong>gzip -d [file.gz]</strong></pre>
<ul>
<li class="mce-root">The following unzips a ZIP file:</li>
</ul>
<pre style="padding-left: 60px"><strong>unzip [file.zip]</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Security management</h1>
                </header>
            
            <article>
                
<p>Managing users in Kali is not an everyday task, but you will probably use it occasionally. Personally, I rarely use the following commands, but sometimes, you might need to handle user management:</p>
<ul>
<li>To <kbd>add</kbd> a user with <kbd>sudo</kbd> capabilities in Kali, use the following command:</li>
</ul>
<pre style="padding-left: 60px"><strong>useradd -m [username] -G sudo -s /bin/bash</strong></pre>
<ul>
<li>If you're logged in and you want to elevate your privilege to a root user, try this command:</li>
</ul>
<pre style="padding-left: 60px"><strong>su - [desired root user name]</strong></pre>
<ul>
<li>If you're logged in and you want to <kbd>execute</kbd> a root command, use the following:</li>
</ul>
<pre style="padding-left: 60px"><strong>sudo [application name]</strong></pre>
<ul>
<li>To change the root (or any user's) password, use the following:</li>
</ul>
<pre style="padding-left: 60px"><strong>passwd [user name]</strong></pre>
<ul>
<li>The <kbd>shadow</kbd> file is important in Kali, because it stores the hashed passwords and some useful information about users. For example, I created a user called <kbd>gus</kbd> on Kali, so, to get his information, I should execute the following command:</li>
</ul>
<pre style="padding-left: 60px"><strong>ls /etc/shadhow | grep gus</strong><br/><br/><strong>#output</strong><br/><strong>gus:$6$mNP6T4jA$sn0eAgo7o1pjSUxe6loigq1wWhC4agpWpWopv0mVBr2V21ZfU./hAMPJTO/7Ecajd0SVozLGwDOrc37hN1ktL0:17517:0:99999:7:::</strong></pre>
<p><span>Let's look at each field of the output that is separated by a </span><kbd>:</kbd> <span>: </span></p>
<ul>
<li><span>The first field is self-explanatory; it's the username (<kbd>gus</kbd>)</span></li>
<li>The second field is the hashed password (the <kbd>$6</kbd> means it's using the SHA-512 algorithm)</li>
<li>The third field (<kbd>17515</kbd>) is the days in Unix time that the password was changed</li>
</ul>
<p> </p>
<ul>
<li>Field number four (<kbd>0</kbd>) specifies the number of days that are required between password changes</li>
<li>Field five (<kbd>9999</kbd>) specifies the number of days after which it's necessary to change the password</li>
<li>The next field (<kbd>7</kbd>) is the number of days before the required password change, and that the user gets a warning</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Secure shell protocol</h1>
                </header>
            
            <article>
                
<p><strong>Secure shell</strong> (<strong>SSH</strong>) protocol is a network protocol that is used to establish an encrypted communication between a server and a client, using the TCP protocol. The SSH service is TCP-based, and listens, by default, on port <kbd>22</kbd>. In general, a public-private key pair allows users to log in to a system without requiring a password. The public key is present on all systems that require a secure connection, while the user keeps the private key in a secure place. On the target systems, the public key is verified against a list of authorized keys that are allowed to remotely access the server. SSH can be compromised when the public key is not cryptographically strong enough, and can be guessed.</p>
<ul>
<li class="mce-root">To start the ssh service, use the following:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>service ssh start</strong></pre>
<ul>
<li class="mce-root">To check whether the service is running properly, use the following:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>netstat -antp|grep sshd</strong><br/><strong># or</strong><br/><strong>service ssh status</strong></pre>
<ul>
<li class="mce-root">To enable the service to start on boot<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>systemctl enable ssh</strong></pre>
<ul>
<li>To stop the SSH service<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px"><strong>service ssh stop</strong></pre>
<ul>
<li class="mce-root">To connect to a remote SSH server<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>ssh [username@IP]</strong></pre>
<ul>
<li class="mce-root">To connect to an SSH server that is using a custom <kbd>port number</kbd> (not <kbd>22</kbd>)<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>ssh -p [port number]</strong></pre>
<ul>
<li class="mce-root">To generate a new SSH key<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>dpkg-reconfigure openssh-server</strong></pre>
<ul>
<li>To allow root remote login into SSH, perform the following:
<ol>
<li>Open the file, <kbd>/etc/ssh/sshd_config</kbd></li>
<li>Change the <span class="packt_screen">PermitRootLogin</span> parameter to Y<span class="packt_screen">es</span>, and restart the SSH server</li>
</ol>
</li>
</ul>
<div class="packt_infobox">As you may have guessed, to manage any service, you can use the following commands:<br/>
<br/>
<kbd>service [service name] start (To start the service)</kbd><br/>
<kbd><span>service [service name] stop (To stop the service)</span></kbd><br/>
<kbd><span>service [service name] restart (To restart the service)</span></kbd><br/>
<kbd><span>service [service name] status (To get the status of the service)</span></kbd></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Configuring network services in Kali</h1>
                </header>
            
            <article>
                
<p>I'm doing my best to show you the necessary commands in each section. You don't need to know all of the commands for managing network services in Kali, but you are surely going to use some of them. In this section, I will show you my favorite commands related to the network services in Kali Linux.</p>
<p>To operate Kali properly, you need to ensure that it has connectivity to either a wired or a wireless network. You may need to obtain an IP address through <strong>Dynamic Host Configuration Protocol</strong> (<strong>DHCP</strong>), or assign one statically.</p>
<p>The first important command is <kbd>ifconfig</kbd>, which you will use to check the IP address on your Kali machine:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/37b3dbfe-b48e-4d45-bf4d-f2ab892d18a9.png" style="width:34.67em;height:18.50em;" width="508" height="271"/></div>
<p>You can see my Kali IP address, <kbd>10.0.0.197</kbd>, after executing this command (in the preceding screenshot). Also, you need to pay attention to the network interface names—<kbd>eth0</kbd> represents the Ethernet cable, and the OS gives it a number (which is <kbd>0</kbd>, in this case). If you had another Ethernet cable connected to your Kali, you would probably see another interface, called <kbd>eth1</kbd>. If you connected a wireless adapter (or if you had it built in), Kali would show another interface, called <kbd>wlan0</kbd>.</p>
<p>In the preceding example, we received a dynamic IP address from the DHCP server. If, for any reason, you want to refresh the IP address, you can execute the following commands:</p>
<pre><strong>dhclient [interface name]</strong><br/><strong>#Example</strong><br/><strong>dhclient eth0</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Setting a static IP on Kali</h1>
                </header>
            
            <article>
                
<p>Sometimes, you need to have a dedicated static LAN IP address for your Kali Linux. A very practical scenario is when you're on duty and you want to go under the radar, by not communicating with the DHCP server of your client (or your employer). Another purpose for a static IP address is if you have a separate VLAN, and you want to join it manually.</p>
<p>Let's look at the implementation of a static IP address:</p>
<ol>
<li>First, open the file <kbd>/etc/network/interfaces</kbd> <span>using your favorite text editor:</span></li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/e20de616-ce9a-435b-9fbf-1ca4e77c622a.png" style="width:36.83em;height:17.42em;" width="1995" height="942"/></div>
<p style="padding-left: 60px">I will add a new static IP address, <kbd>10.0.0.99</kbd>, to the network <kbd>10.0.0.0/24</kbd>, at the end of the file. In your case, the network will probably be <kbd>192.168.0.0/24</kbd>. As for me, I use the <kbd>10.0.0.0</kbd> network addressing architecture:</p>
<pre style="padding-left: 60px"><strong># This file describes the network interfaces available on your system</strong><br/><strong># and how to activate them. For more information, see interfaces(5).</strong><br/><br/><strong>source /etc/network/interfaces.d/*</strong><br/><br/><strong># The loopback network interface</strong><br/><strong>auto lo</strong><br/><strong>iface lo inet loopback</strong><br/><br/><strong>#Static IP Address</strong><br/><strong>auto eth0</strong><br/><strong>iface eth0 inet static</strong><br/><strong>    address 10.0.0.99</strong><br/><strong>    netmask 255.255.255.0</strong><br/><strong>    network 10.0.0.0</strong><br/><strong>    broadcast 10.0.0.255</strong><br/><strong>    gateway 10.0.0.1</strong></pre>
<ol start="2">
<li>Save the file (<em>Ctrl</em> + <em>S</em>), and restart your Kali machine. (Hint: I will use the <kbd>reboot</kbd> command in the Terminal window to restart my Kali.) After the reboot, execute the <kbd>ifconfig</kbd> command, and you should see your new IP address set. Then, you will be ready to go:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/cdbe9be3-0819-456e-8962-62cede42f6a6.png" style="width:36.42em;height:21.08em;" width="511" height="296"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Checking active connections in Kali</h1>
                </header>
            
            <article>
                
<p><strong>Network statistics</strong> (<kbd>netstat</kbd>) is a command-line tool that displays the active network connections on your Kali. It is used for finding problems (like Malware that are listening to incoming connections, for example, or malware that are trying to contact external (outgoing) servers). <kbd>netstat</kbd> can be used for many reasons. Most of the time, <kbd>netstat</kbd> is combined with the <kbd>grep</kbd> command, to filter the output results:</p>
<pre><strong>netstat -antp</strong></pre>
<ul>
<li><kbd>-a</kbd>: <span>Shows both the listening and non-listening sockets.</span></li>
<li><kbd>-n</kbd>: <span>Shows numerical addresses, instead of trying to determine symbolic hosts, ports, or usernames.</span></li>
<li><kbd>-t</kbd>: Shows TCP connections.</li>
<li><kbd>-p</kbd>: <span>Shows the</span> <span><strong>process identifier</strong></span> (<span><strong>PID</strong></span>) <span>and the name of the program to which each socket belongs:</span></li>
</ul>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/229ce190-a996-4ef8-931a-72b8e309475c.png" width="866" height="137"/></div>
<p>As you can see in the preceding screenshot, my Kali host is listening on port <kbd>80</kbd>, because I already started the Apache web server service.</p>
<div class="packt_tip">To start the Apache web server on Kali, execute the command <kbd>service apache2 start</kbd>.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Process management commands</h1>
                </header>
            
            <article>
                
<p><span>In general, Kali Linux is a stable system. However, things may occasionally go wrong, and sometimes, we will wish to tweak the system to better suit our needs. In this section, we will take a brief look at how we can manage processes on a Kali Linux system.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Htop utility</h1>
                </header>
            
            <article>
                
<p>Before I start listing all of the built-in commands for managing the processes in Kali, there is a handy tool that I always use. Unfortunately, it's not preinstalled on Kali. It's called <kbd>htop</kbd>. This command-line tool lists all of the running processes in the Terminal window, in a nice, user-friendly layout:</p>
<pre><strong>#To install it</strong><br/><strong>apt-get install htop</strong><br/><strong># To execute it</strong><br/><strong>htop</strong></pre>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/1acfd970-a9fc-4138-bcf1-56acea7a2b36.png" width="880" height="435"/></div>
<div class="packt_tip">Through using <kbd>htop</kbd>, I can see that I have a memory issue which is approximately full. This tells me that I should increase my memory settings for this VM.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Popular commands for process management</h1>
                </header>
            
            <article>
                
<p><span>We're not done yet; here are some more process management commands that can be very useful when using Kali Linux:</span></p>
<ul>
<li class="mce-root">To display all active processes, execute the following command:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>ps</strong></pre>
<div class="packt_tip">The <kbd>ps</kbd> command is very useful if you have a remote shell to a Linux box, and you want to list all of the current processes for privilege escalation.</div>
<ul>
<li class="mce-root">To display all running processes, use the following:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>top</strong></pre>
<ul>
<li class="mce-root">To kill a process with an ID (<kbd>PID</kbd>)<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>kill [PID Number]</strong></pre>
<ul>
<li class="mce-root">To kill all processes named <kbd>hello</kbd><span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>killall hello</strong></pre>
<ul>
<li class="mce-root">To force killing a process<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>kill -9 [PID Number]</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">System info commands</h1>
                </header>
            
            <article>
                
<p>This section will be very useful in the post-exploitation phase.</p>
<p>Suppose that you just escalated your privileges on a Linux box; how can you know if you're really an admin? Just execute the <kbd>id</kbd> command, and you'll get the results. Don't underestimate this section! Review it carefully, and see the commands that you can take advantage of during the post-exploitation phase on a Linux machine:</p>
<ul>
<li class="mce-root">To show the current host <kbd>uptime</kbd>, use the following:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>uptime</strong></pre>
<ul>
<li class="mce-root">To show who's logged in<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>w</strong><br/><strong>whoami</strong></pre>
<ul>
<li class="mce-root">To show who you are (as a user)<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>id</strong></pre>
<ul>
<li class="mce-root">To display information about a user<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>finger [user name]</strong></pre>
<ul>
<li class="mce-root">To show kernel information<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>uname -a</strong></pre>
<ul>
<li class="mce-root">To show CPU information<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>cat /proc/cpuinfo</strong></pre>
<ul>
<li class="mce-root">To show memory information<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>cat /proc/meminfo</strong></pre>
<ul>
<li class="mce-root">To show disk usage<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>df</strong></pre>
<ul>
<li class="mce-root">To show memory and swap usage<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>free</strong></pre>
<ul>
<li><span>To search all of the commands that were previously executed, use the following:</span></li>
</ul>
<pre style="padding-left: 60px"><span><strong>history</strong> </span></pre>
<ul>
<li class="mce-root">To detect the GPU model<span>, use the following</span>:</li>
</ul>
<pre style="padding-left: 60px" class="mce-root"><strong>lspci | grep VGA</strong></pre>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>Another chapter has been completed. You are now smarter than you were yesterday. So many commands, right? Don't worry; you don't need to memorize all of these commands. You can always come back to this chapter and use it as a reference for your Terminal window ninja skills.</p>
<p>As you may have realized, I get straight to the point, without wasting your time on useless information and nitty-gritty details that you will never use in your career. I hope that you enjoyed this chapter, and that you learned something new, so that you can start using your Kali Linux baby machine.</p>
<div class="grammarly-disable-indicator"/>


            </article>

            
        </section>
    </div>



  </body></html>