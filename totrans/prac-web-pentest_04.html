<html><head></head><body><div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">All About Using Burp Suite</h1>
                </header>
            
            <article>
                
<p class="mce-root">You are getting closer and closer to becoming a pro in application security testing. This chapter is dedicated to an amazing application called <strong>Burp Suite</strong>. It is a mandatory tool for testing web application security. I'm not trying to sell you the application; rather, I'm giving you an honest opinion, based on my own experience as a web application penetration tester. Burp was written by PortSwigger Ltd. I can't thank them enough for allowing us to test web applications, making sure that they are secure against threats.</p>
<p>You're probably wondering, why Burp? Why not one of the fancy, expensive, single-button tools out there on the market?</p>
<p>First of all, just because they are expensive doesn't mean that they are good; secondly, don't be a slave to the Gartner charts. Big companies increase their prices when they appear at the top of the Gartner chart; they are big businesses, and they want to make big bucks. On the other hand, Burp offers many options (from manual to automated tests) for only 350 USD per year, compared to other big name scanners, which cost thousands of dollars per year. When you work in the security field, you will be amazed by how expensive these tools are. Our job, as professionals, is to help our clients or companies choose the right tools for their budgets, while also providing a professional outcome.</p>
<p>False positives (fake vulnerabilities that are flagged by the scanner) will always be there, and it is your job to differentiate the real vulnerabilities from the false ones. Never copy and paste the contents of any report without understanding its contents. Try to test a vulnerability and make sure that it's real before putting it into a final report.</p>
<p>In this chapter, I will do my best to cover the ins and outs of Burp Suite, including the following:</p>
<ul>
<li>Introducing Burp Suite</li>
<li>Practical examples of how to use Burp Suite</li>
<li>How to use Burp Proxy</li>
<li>How to install the Burp SSL certificate</li>
<li>How to crawl a web application</li>
<li>How to find hidden items using Burp</li>
<li>Using the Burp vulnerabilities scanner</li>
<li>How to use the Repeater tab</li>
<li>Exploring the functionalities of the Intruder tab</li>
<li>How to install additional applications in Burp</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">An introduction to Burp Suite</h1>
                </header>
            
            <article>
                
<p class="mce-root">Burp Suite is a simple platform for web application security testing. This application has many tools, combining to form a monster at your fingertips. It will help you to test every component of your web application.</p>
<p class="mce-root">Burp will be the key in cases where you need to check how strong your website security is, how predictable your session tokens are, or how valid the checkpoint data in your application is. Furthermore, Burp allows for detailed manual assessments and automated technique combinations, leading to enumerate and analyze web application security analysis.</p>
<p class="mce-root">Burp has two editions that are available for download:</p>
<ul>
<li>Burp Suite Community Edition (pre-installed on Kali)</li>
<li><span>Burp Suite Professional Edition (requires a yearly license, around 350 USD per year)</span></li>
</ul>
<p class="mce-root">In summary, Burp is a local web proxy that allows you to manually modify, intercept, and inspect HTTP/S requests and responses between a user's browser and the target website that you're trying to test. While the user navigates through the web application manually, the tool intercepts all of the necessary details on all visited pages. The traffic between the server and the browser can be analyzed, modified, visualized, and, eventually, repeated multiple times. The professional version of Burp allows you to scan and find web application vulnerabilities.</p>
<p class="mce-root">The different tools included in Burp Suite can be seen in the tabs area (see the following screenshot):</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/6554e2b6-f780-4734-a441-8227865424ab.png" width="1570" height="593"/></div>
<ul>
<li class="mce-root"><span class="packt_screen">Target</span>: This tool allows you to visualize your target application's contents in a folder structure hierarchy <span>that corresponds to the site's URL structure</span>. <span>This</span> <span class="text-highlight">section</span> <span>shows all of the content that has been discovered until now, by manually browsing the site's pages. </span></li>
<li class="mce-root"><span class="packt_screen">Proxy</span>: This is the main engine of Burp, which allows it to intercept and modify all web traffic.</li>
<li class="mce-root"><span class="packt_screen">Spider</span>: This is a web spider tool that crawls applications to locate contents and functionalities.</li>
<li class="mce-root"><span class="packt_screen">Scanner</span>: <span>This tool is a web vulnerability scanner, which discovers numerous types of web vulnerabilities (SQLi, XSS, and CSRF) automatically. It is </span>available in the professional version only.</li>
<li class="mce-root"><span class="packt_screen">Intruder</span>: This<span> is a powerful tool for carrying out automated, customized attacks against web applications</span>. I call it the web fuzzer; web fuzzing typically involves sending unexpected input to the target application. This process may help to identify web application security flaws.</li>
<li class="mce-root"><span class="packt_screen">Repeater</span>: As the name suggests, it is used to manually modify and reissue web requests.</li>
<li class="mce-root"><span class="packt_screen">Sequencer</span>: This analyzes the quality of randomness in an application's session tokens or other important data items that are intended to be unpredictable.</li>
<li class="mce-root"><span class="packt_screen">Decoder</span>: This allows for encoding and decoding data.</li>
<li class="mce-root"><span class="packt_screen">Comparer</span>: <span>The Burp <span class="packt_screen">Comparer</span> is a handy utility for performing a visual diff between any two items of data, such as pairs of similar web responses.</span></li>
<li class="mce-root"><span class="packt_screen">Extender</span>: <span>Burp <span class="packt_screen">Extender</span> (<span class="packt_screen">BApp Store</span>) allows you to load Burp extensions, which extend Burp's functionalities through using third-party apps.</span></li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">A quick example </h1>
                </header>
            
            <article>
                
<p>Before I start to dig deeper into the functionality of each section, it is best to start with a simple example, so that you can quickly visualize how you can use this amazing application. <em>"Not just talking but by doing!"</em></p>
<p>This is going to be an oversimplified example, so I will not go into too much detail. I want you to understand the big picture. Later in this chapter, you will learn the nitty-gritty details of the functionalities:</p>
<ol>
<li>Fire Burp up, and open your browser in Kali Linux (I already set the <span class="packt_screen">Proxy</span> settings in Firefox; I will show you how to do that later).</li>
<li>Browse to the Mutillidae home page; you will see that the page is not loading, and that's normal, because the <span class="packt_screen">Proxy</span> in Burp has intercepted the request and is waiting for you to take action. </li>
<li>Switch to Burp, and you will see the web request in the <span class="packt_screen">Proxy</span><span><span>/</span></span><span class="packt_screen">Intercept</span> section. At this point, you can change the request, but I will just send it to the server using the <span class="packt_screen">Forward</span> button:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/6615c299-985d-4d4e-a743-dc66e5099b3a.png" style="width:38.50em;height:19.67em;" width="651" height="333"/></div>
<ol start="4">
<li>When you click on the <span class="packt_screen">Forward</span> button, Burp will send the request to the web server. If you enabled the option to intercept the response in the <span class="packt_screen">Options</span> tab, then you'll see that, as well.</li>
</ol>
<ol start="5">
<li>By default, the response is not intercepted; if you would like to change this behavior, go to the <span class="packt_screen">Options</span> tab, and make sure that you have the following settings:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/d6073314-886a-431c-8354-bb8db9bac982.png" style="width:40.92em;height:45.83em;" width="849" height="950"/></div>
<p style="padding-left: 60px">The preceding settings are the ones that I use for request and response interception in Burp on a daily basis (by default, you will have different settings for request/response interception).</p>
<ol start="6">
<li>What's next? Let the response go back to the client by clicking on the <span class="packt_screen">Forward</span> button. Then, switch the interception off by clicking on the <span class="packt_screen">Intercept is on</span> button. Note that by clicking on this button, Burp will still collect the web requests/responses, but they will not stop the page from loading, and it will not give you a chance to intercept and change the contents (of the web request/response).</li>
<li>I will now go back to the Mutillidae website and try to log in, and then manually browse to a couple of pages, because I want burp to start recognizing the structure of this website. Now, go back to Burp and click on the <span class="packt_screen">Target</span> tab, and you should see something similar to the following:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/c4d4da74-7f40-4965-9eea-b24e6dce70e2.png" style="width:42.92em;height:31.92em;" width="812" height="604"/></div>
<ol start="8">
<li>It looks like Burp intercepted everything that my browser was trying to connect with, and that's normal, because I did not filter or set the scope yet. To do this, I will right-click on the Mutillidae server IP address and select <span class="packt_screen">Add to scope</span>:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/f8167248-10ec-48ac-a2a9-89b55b4ce8f4.png" style="width:24.50em;height:40.92em;" width="414" height="692"/></div>
<ol start="9">
<li>I'm not done yet; we still need to clean up the mess, showing only the scope in the site map tree. To make this happen, click on the <span class="packt_screen">Filter: Hiding not found items;</span> section, a menu will appear. Select the checkbox to <span class="packt_screen">Show only in-scope items</span>:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1050 image-border" src="Images/33c87914-83cd-4ba5-bee1-8f6d91a1f070.png" style="width:166.25em;height:72.33em;" width="1995" height="868"/></div>
<p>Alright! You're done with this basic tutorial. Here's what a pen tester can do after finishing all of the preceding steps:</p>
<ol>
<li><strong>Spider</strong> the web application branch</li>
<li>Discover the <strong>hidden contents</strong></li>
<li><strong>Inspect</strong> the web request/response of each page</li>
<li><strong>Passively scan</strong> the web application</li>
<li><strong>Actively scan</strong> the web application</li>
<li><strong>Perform some manual tests</strong> using the <span class="packt_screen">Intruder</span> and <span class="packt_screen">Repeater</span> tabs</li>
<li>Test the vulnerabilities for <strong>false positives</strong></li>
<li>Generate a <strong>report</strong></li>
</ol>
<div class="packt_infobox">If you have purchased Burp Pro, then you can start it through the Terminal window by using the following command:<br/>
<br/>
<kbd> java -jar -Xmx2G /[path]/[burp.jar]</kbd></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Visualizing the application structure using Burp Target </h1>
                </header>
            
            <article>
                
<p>In the previous section, you saw how an application can be mapped by using Burp in the <span class="packt_screen">Target</span> tab. In this section, I want you to learn how Burp Target works (in a simplified way) so that you can handle the workflow when you're doing the pen tests.</p>
<p>The Burp Target tool offers you the following functionalities (I will only list the important ones):</p>
<ol>
<li><strong>Visualize</strong> the application structure using the <span class="packt_screen">Site Map</span> tab.</li>
<li>Define the <strong>scope</strong> of your target website using <span class="packt_screen">Add To Scope</span>.</li>
<li><strong>Spider</strong> the web application to discover more contents using <span class="packt_screen">Spider this branch</span>.</li>
<li>Search for <strong>hidden contents</strong> using the <span class="packt_screen">Discover Content</span> functionality.</li>
<li>Conduct a <strong>passive scan</strong>, using <span class="packt_screen">Passively Scan this branch</span> to identify some vulnerabilities.</li>
<li>List <strong>comments</strong>, <strong>scripts</strong>, and <strong>references</strong> by using the <span class="packt_screen">Engagement Tools</span> menu.</li>
<li><strong>Analyze</strong> the web application target <span>to identify all of the dynamic URLs and parameters</span> by using <span class="packt_screen">Analyze Target</span>.</li>
<li><strong>Send</strong> <strong>web requests</strong> to another tool tab (for example, <span class="packt_screen">Repeater</span>, <span class="packt_screen">Sequencer</span>, <span class="packt_screen">Decoder</span>, <span class="packt_screen">Comparer</span>, and <span class="packt_screen">Intruder</span>).</li>
<li>Conduct a full <span class="packt_screen">web application vulnerability scan</span> using <span class="packt_screen">Actively scan this branch</span>.</li>
</ol>
<ol start="10">
<li>Save the <strong>reports</strong> by branch using <span class="packt_screen">Issues/Report issues for this branch</span>:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/09ba47e3-e462-4389-9022-1db9c8b0bf98.png" width="1814" height="897"/></div>
<p>As you may have realized, the <span class="packt_screen">Target</span> tab is your <strong>dashboard</strong> for everything that you want to initiate using Burp. You will frequently spend your time on this section/tab. Looking at the preceding screenshot, you can see, in the middle section, all of the <strong>web requests/responses</strong> to the application (under the <span class="packt_screen">Contents</span> section) for further analysis. On the right-hand side of the screen, Burp shows the <span class="packt_screen">Issues</span>, and the <span class="packt_screen">Advisory</span> to fix every single flaw. Amazing, right?</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Intercepting the requests/responses using Burp Proxy</h1>
                </header>
            
            <article>
                
<p><span>The <span class="packt_screen">Proxy</span> tool is the heart of Burp. In summary, it intercepts all of the requests and responses that you try to manually visit using your browser</span><span>. It operates as a web proxy server, and it sits as a man-in-the-middle between your browser and destination web servers. This lets you intercept, inspect, and modify the raw traffic passing in both directions (request/response):</span></p>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/699789be-8924-4d2b-96f1-2580688d38ce.png" style="width:40.33em;height:19.67em;" width="627" height="306"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Setting the proxy in your browser</h1>
                </header>
            
            <article>
                
<p>I'm assuming that you are using Kali Linux for your web application penetration testing, so you will be using Firefox or Iceweasel as a browser. You can install Chrome, but the instructions that I'm using are for Firefox (if you're using Chrome, don't worry; the settings should be very similar to Firefox). </p>
<p>By default, Burp's port <span class="packt_screen">Proxy</span> number is <kbd>8080</kbd>, and this can be changed in the <span class="packt_screen">Options</span> sub-tab under the <span class="packt_screen">Proxy</span> tab:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/a36a2a91-dd3c-453e-8350-933658a57557.png" style="width:41.83em;height:20.67em;" width="809" height="400"/></div>
<p>Open Firefox and select <span class="packt_screen">Preferences</span> from the menu. Click on the <span class="packt_screen">Advanced</span> tab in the left menu; after that, select the <span class="packt_screen">Network</span> tab in the top menu, and click on the <span class="packt_screen">Settings</span> button in the <span class="packt_screen">Connection</span> section. Finally, enter the proxy settings in the <span class="packt_screen">Manual proxy configuration</span> section (see the following screenshot):</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/35e022fa-7ce1-4080-ac37-1a67186fc74e.png" style="width:26.75em;height:32.25em;" width="533" height="643"/></div>
<div class="packt_tip">
<ul>
<li>Don't forget to disable the proxy when you're done with your pen tests; otherwise, your browser will not load any pages when you turn Burp off.</li>
<li>Make sure that the <span class="packt_screen">No Proxy for:</span> textbox does not contain the value <kbd>127.0.0.1:8080</kbd>, or else Burp will not intercept the connection.</li>
<li>There is a nice, easy shortcut to avoid making all of these changes manually. You can use the FoxyProxy <span>plugin for Firefox. Try it out!</span></li>
</ul>
</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">BURP SSL certificate</h1>
                </header>
            
            <article>
                
<p>To use Burp Proxy most effectively with HTTPS websites, you will need to install Burp's CA certificate as a trusted root in your browser. If you have not already done so, configure your browser to use Burp as its proxy, and configure Burp to generate a CA-signed, per-host certificate (this is the default setting). Let's look at how to install it in Kali's Firefox browser:</p>
<ol>
<li>Open Firefox and browse to <kbd>http://burp</kbd>, then click on the <span class="packt_screen">CA Certificate</span> button to download it locally to your <kbd>Downloads</kbd> folder:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/1a9c21cf-758b-406c-ab26-af2dac8933f8.png" width="1405" height="234"/></div>
<ol start="2">
<li>After you've downloaded your CA file, open the Firefox <span class="packt_screen">Preferences</span> from the menu. <span>Click on the</span> <span class="packt_screen">Advanced</span> <span>tab in the left menu; after that, select the</span> <span class="packt_screen">Certificates</span> <span>tab in the top menu, and click on the</span> <span class="packt_screen">View Certificates</span> <span>button. Finally, click on the</span> <span class="packt_screen">Import</span> <span>button to install the certificate that you just downloaded from Burp (see the following screenshot):</span></li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/157fb174-29cd-4163-bbfa-4dcd67652f2d.png" style="width:42.92em;height:22.17em;" width="1034" height="533"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Burp Proxy options</h1>
                </header>
            
            <article>
                
<p>In the practical example that I shared with you previously, I showed you my configuration for the requests/responses in the <span class="packt_screen">Proxy</span>/<span class="packt_screen">Options</span> tab. Check it out, and try to implement it, if that is what you are looking for during your web intrusion tests.</p>
<p>I intercept requests/responses for the following reasons:</p>
<ul>
<li>To inspect the contents of the requests/responses for analysis</li>
<li>To intercept the request to override JavaScript validation</li>
<li>To intercept the response when I need to override any values that the server has sent (for example, any header value)</li>
</ul>
<p>An interesting configuration section is the <span class="packt_screen">Response Modification</span>, which allows you to <span class="packt_screen">Unhide hidden form fields</span> or <span class="packt_screen">Remove JavaScript form validation</span> automatically:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/ec7083d2-5745-457b-9bbb-ea88dc72ce40.png" style="width:30.08em;height:16.17em;" width="522" height="280"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Crawling the web application using Burp Spider</h1>
                </header>
            
            <article>
                
<p>The idea here is simple: all you need to know is how to find all of the pages for the web application of your target scope. There are three ways to accomplish this task:</p>
<ul>
<li>Manually crawling by using the Intruder tool</li>
<li>Automatically crawling by using Burp Spider</li>
<li>Automatically finding hidden items by using the Discover Content tool</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Manually crawling by using the Intruder tool</h1>
                </header>
            
            <article>
                
<p>In some cases you want to run a manual crawling using one of the predefined dictionary file, to do this perform the following steps:</p>
<ol>
<li>Select the root path; in our example, it's <kbd>mutillidae</kbd>, because this is our starting point for crawling. Next, right-click on the request and send it to the <span class="packt_screen">Intruder</span> tab:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/040a69db-5ab9-4f4b-ab02-51de5f9d965f.png" style="width:46.83em;height:36.17em;" width="1030" height="796"/></div>
<ol start="2">
<li>At this point, the <span class="packt_screen">Intruder</span> tab will start blinking, which tells you that it's ready (let's click on the <span class="packt_screen">Intruder</span> tab). The first thing that you will encounter in the <span class="packt_screen">Intruder</span> tab is the <span class="packt_screen">Target</span> section; leave it as it is, and move on to the <span class="packt_screen">Positions</span> section:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/5da1b1b5-ca26-4128-a923-f8c24ce45f90.png" style="width:33.33em;height:19.42em;" width="545" height="317"/></div>
<ol start="3">
<li>In the <span class="packt_screen">Positions</span> sub-tab, leave the attack type to <span class="packt_screen">Sniper</span>, and write any word (in my case, I've chosen the word <kbd>attack</kbd>) after <kbd>mutillidae/</kbd>. After that, we need to make sure that we have a clean slate, so click on the <span class="packt_screen">Clear</span> button to remove any pre-generated positions:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/203ae874-ded8-4a65-a248-23ceec3fdb86.png" width="1693" height="347"/></div>
<ol start="4">
<li>Next, select the word that you just wrote. In the preceding screenshot, I selected the word <kbd>attack</kbd> and clicked on the <span class="packt_screen"><strong>Add</strong></span> button, to tell Burp that this is where I am going to fuzz for directories:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/726439d5-3940-4a68-8be3-7f3aa627788f.png" style="width:39.42em;height:7.67em;" width="632" height="123"/></div>
<ol start="5">
<li>After that, click on the <span class="packt_screen">Payloads</span> tab, and make sure that the <span class="packt_screen">Payload type</span> is a simple list. Next, select <span class="packt_screen">Directories – short</span> from the <span class="packt_screen">Add from list ...</span> drop-down menu. You're now ready to click on the <span class="packt_screen">Start Attack</span> button, which will launch a pop-up window to show you the progress of the results:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/db0e239e-9373-4b40-91df-b1581649983b.png" width="1615" height="780"/></div>
<ol start="6">
<li>Finally, click on the <span class="packt_screen">Status</span> column header to sort the items by the response status code. For the Mutillidae application, I found an interesting passwords region (see the preceding screenshot). I will leave it as an exercise for you to check the contents of the <span class="packt_screen">passwords</span> directory:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/82765259-874a-4bf2-a396-9f2ac70e387c.png" width="956" height="738"/></div>
<div class="packt_tip">You can use the <span class="packt_screen">R</span><span class="packt_screen">epeater</span> tab, which we will explore in upcoming sections, to verify the preceding findings.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Automated crawling and finding hidden spots</h1>
                </header>
            
            <article>
                
<p>In the preceding section, I showed you the manual method for finding interesting directories, and you can do the same for finding pages, as well. If you have no time and you want to use an automated method, Burp offers you an easy way to scan your projects:</p>
<ol>
<li>Go to the <span class="packt_screen">Target</span> tab, and, in the site map, right-click on your <span class="packt_screen">Target</span> project and select <span class="packt_screen">Spider this branch</span> from the menu. At this point, the <span class="packt_screen">Spider</span> tab will blink, telling you that it's in progress; depending on the application depth, this action should not take too long to execute.</li>
<li>If you want to check for the progress of the crawling, go to the <span class="packt_screen">Spider</span> tab and select the <span class="packt_screen">Control</span> sub-tab, and you should get an idea of what is going on there:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/764fe834-5e2d-4852-85f8-6f9cea6e926c.png" width="1501" height="373"/></div>
<ol start="3">
<li>An even more powerful and time-consuming tool that can find hidden files and directories also exists in Burp. Be careful with this one, because it is aggressive, and it can sometimes cause the site to malfunction. If you use it, ask the development team to back up the database, in case things go in the wrong direction. </li>
</ol>
<ol start="4">
<li>To find hidden contents, right-click on the <kbd>Application</kbd> directory in the <span class="packt_screen">Target</span>/<span class="packt_screen">Site map</span> section. From the menu, select <span class="packt_screen">Engagement tools</span>; then, click on the <span class="packt_screen">Discover content </span>menu item. After this action, a pop-up menu will appear. To run it, all you have to do is click on the <span class="packt_screen">Session is not running </span>button, and the advanced crawling will start executing:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/03301533-3dcf-4b18-bc7c-9c10e131dfb0.png" style="width:51.08em;height:27.42em;" width="863" height="463"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Looking for web vulnerabilities using the scanner</h1>
                </header>
            
            <article>
                
<p>For an effective web application penetration test, you will need to perform both a manual test and an automated test. If you only do one of them, you're not doing the right thing. This has been a debate, and sometimes, I see teams relying on fancy, automated tools, because they lack the knowledge for manual tests. On the other hand, I've seen teams with sky high egos; they think that manual tests are for the elite, and that those tests should be enough. My philosophy is that you need both. In this section, I will show you the automated method to scan for vulnerabilities. The manual method will be covered in an upcoming chapter. </p>
<p>In Burp, the first type of scan is the passive scan, which <span>involves analyzing the HTTP messages for evidence of certain types of vulnerabilities. It does not send any additional requests to the server. This can be accomplished when you're browsing manually, and you can trigger it by right-clicking on the target scope on the site map. Then, from the menu, click on</span> <span class="packt_screen">Passively scan this branch</span>.</p>
<p>The second scan technique is the one that really automates the fuzzing to find web application vulnerabilities:</p>
<ol>
<li>To execute it, simply right-click on the directory that you wish to test, and then, from the menu, click on <span class="packt_screen">Actively scan this branch</span>. After this action, a pop-up menu will appear. In general, I use the options that you can see in the following screenshot:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/b56b820c-6e14-4e8d-8695-dfd9761e8d64.png" width="799" height="373"/></div>
<ol start="2">
<li>Click on <span class="packt_screen">Next</span>, and a second step will show you the list of files that will be scanned in this process. Check them out, then click on the <span class="packt_screen">OK</span> button to start the scanner:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/39deb50a-778a-4351-9263-3804a7f3e094.png" width="796" height="472"/></div>
<ol start="3">
<li>To check out the progress of this event, select the <span class="packt_screen">Scanner</span> tab, then click on the <span class="packt_screen">Scan queue</span> sub-tab. At first, you will see that the scanner has started to look for vulnerabilities; you can use the <span class="packt_screen">Status</span> column as an indicator of the progress of the scan:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/6b5f8169-ca4f-4124-b1b3-a937d4ea0a57.png" width="1155" height="302"/></div>
<ol start="4">
<li>Later, when all of the statuses turn into a <span class="packt_screen">Finished</span> state, you can start taking a peek at each item by double-clicking to see the results:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/f7ba025e-72b4-47c4-935a-894add890d69.png" width="956" height="698"/></div>
<p style="padding-left: 60px">This dialog window (seen in the preceding screenshot) allows you to analyze the <span class="packt_screen">Request</span> that Burp generated to produce the error <span class="packt_screen">Response</span>. Later, you will use the <span class="packt_screen">Repeater</span> tab to double-check the results and make sure that there's not a false positive.</p>
<ol start="5">
<li>Finally, it's time to generate a report. To do this, go back to the <span class="packt_screen">T</span><span class="packt_screen">arget</span> tab and select your target application root directory (in our case, it's going to be the <kbd>mutillidae</kbd> folder). Right-click and select <span class="packt_screen">Issues</span> from the menu, then click on <span class="packt_screen">Report issues for this branch</span>:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/652f2721-67a4-43b8-9883-021ea3582318.png" width="1117" height="646"/></div>
<ol start="6">
<li>After that, you will have a few dialog windows to fill out; they're pretty straightforward. I usually just choose the default options until the report is generated in an HTML format:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/f4f662da-1e4f-496d-9191-4e6fe58cca2e.png" width="963" height="670"/></div>
<p>At this stage, your role is to identify the false positives. Logically speaking, when you see Burp telling you that the confidence is <strong>Certain</strong> that is more than 90%, it is a real flaw. When the confidence is <strong>Firm</strong>, it means 60% it's not a false positive and <strong>Tentative</strong> most probably is a false positive. Flaws and vulnerabilities are called issues in Burp—just to make sure that you understand the terminology this application uses to identify web application vulnerabilities.</p>
<div class="packt_tip">Please do not copy the Burp report and give it to your client without checking for false positives; if you want to have a good reputation, then don't. I've seen reports from companies where the flaws were copied directly from the report—I've recognized the fonts in the Burp reports, and then you can assume what I did say when I saw that report.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Replaying web requests using the Repeater tab</h1>
                </header>
            
            <article>
                
<p>As the name suggests, the <span class="packt_screen">Repeater</span> tab allows you to repeat web requests manually. Why? To check the web response. Most of the time, you will use the <span class="packt_screen">S</span><span class="packt_screen">end to repeater</span> menu item to send the results to this section. After that, just click on the <span class="packt_screen">Go</span> button, and you will be able to replay the request:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/ed0a709c-ae78-4ab0-bff1-2d60549eab45.png" width="1749" height="373"/></div>
<p>The following is the checklist that I implement when I want to use the <span class="packt_screen">Repeater</span> tab:</p>
<ol>
<li>Testing the logic flaws of a page</li>
<li>Checking for false positive issues after generating a report</li>
<li>Changing the parameter values (for example, testing input-based vulnerabilities)</li>
</ol>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Fuzzing web requests using the Intruder tab</h1>
                </header>
            
            <article>
                
<p>Burp Intruder is a monster of automation, and it allows you to enumerate, fuzz, and harvest data from the target web application. In the old days, when I started using Burp, the first thing that I learned was to use the Intruder tool to brute-force login credentials. We will cover more examples in the upcoming chapters, but for this section, I want you to understand the basics of this tool:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/b730ca43-8044-427f-9e0c-3a827df3cfc7.png" width="1681" height="372"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Intruder attack types</h1>
                </header>
            
            <article>
                
<p>One of the most confusing things for beginners are the attack types in the Intruder tool. I will do my best to explain them to you in a practical way, so they won't be an obstacle for you to use this section:</p>
<ul>
<li class="mce-root"><strong>Sniper</strong>: This is the most popular one, and you can use it for only <em>one</em> payload. A practical example of this type of payload is the one that we saw earlier, for fuzzing directory names. Another example would be to fuzz the query string value. Hackers fuzz the product number in the URL, to see which products are on a discount before they appear online.</li>
<li class="mce-root"><strong>Battering ram</strong>: This uses a <em>single</em> payload, as well, but it allows you to place the <em>same payload into all defined positions</em>. A practical example is when you want to insert the email address in the form field and the query string.</li>
<li class="mce-root"><strong>Cluster bomb</strong>: This one uses <em>multiple</em> payloads for each position (the maximum is 20). In other words, this attack is used when an attack requires different, but <em>unrelated,</em> input to be inserted in multiple places in the request. The best way to explain it to you is through a practical example, which is the <em>password credentials attack</em>—my favorite one. So, you would use the username in one field and the password in the password field.</li>
<li class="mce-root"><strong>Pitchfork</strong>: This one uses <em>multiple</em> payloads for each position (the maximum is 20). In other words, this attack is used when an attack requires different, but <em>related</em> (the opposite of the cluster bomb), input to be inserted in multiple places in the request. For example, when you want to insert a username in a field, and its associated ID in another field.</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Practical examples</h1>
                </header>
            
            <article>
                
<p>By now, you have probably guessed what this tool can do, but let me widen your imagination and give you more examples that you can use when you want to handle the <span class="packt_screen">Intruder</span> tab:</p>
<ul>
<li class="mce-root">Enumerating usernames</li>
<li class="mce-root"><span>Enumerating account IDs</span></li>
<li class="mce-root"><span>Enumerating any ID (articleID, BlogID, ProductID, and so on)</span></li>
<li class="mce-root"><span>Enumerating documents (PDF</span>, TXT, and so on<span>)</span></li>
<li class="mce-root"><span><span>Enumerating pages</span></span></li>
<li class="mce-root"><span>Enumerating directories</span></li>
<li class="mce-root"><span>Fuzzing for vulnerabilities</span></li>
<li class="mce-root"><span>Fuzzing usernames/passwords</span></li>
</ul>
<p class="mce-root">There are many more; this is just a sample, including the most important ones, which I use on a daily basis. I hope they'll help you, as well.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Installing third-party apps using Burp Extender</h1>
                </header>
            
            <article>
                
<p><span>Before I start on this section, I would like to inform you that I did not include the <span class="packt_screen">Sequencer</span>, <span class="packt_screen">Decoder</span>, and <span class="packt_screen">Comparer</span> tabs in this chapter. In fact, I excluded them on purpose, because their usage is very straightforward. You will rarely use them in your daily career, so why waste your time?</span></p>
<p>Burp <span class="packt_screen">Extender</span> is an important tab; it will allow you to include additional, powerful functionalities in Burp. For example, if you want to add the functionality to scan for outdated JavaScript libraries, then you can install the module <kbd>Retire.js</kbd>, and it will do the work for you. There is a tool for every need: WAF, errors, Java, .NET, SQLi, XSS, and so on.</p>
<p>Before starting to use the <span class="packt_screen">BApp Store</span>, you will need to download the <strong>Jython</strong> standalone JAR from:<a href="http://www.jython.org/downloads.html"> http://www.jython.org/downloads.html</a>.</p>
<p>Jython is a library for Java and Python, and some apps use this library, so it's a prerequisite for the apps to work. After downloading the file, go to the <span class="packt_screen">Extender</span>/<span class="packt_screen">Options</span> tab, and include the path where you copied the downloaded file:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/f5daf1af-9c00-4d95-88b1-7b817490b82e.png" style="width:43.58em;height:45.42em;" width="674" height="702"/></div>
<p>To install your favorite app, go to the <span class="packt_screen">BApp Store</span> tab and pick the application that fits your needs, then click on the <span class="packt_screen">Install</span> button to install it. Sometimes, it takes a few seconds to install the app, so be patient. Some applications will inject an additional tab in Burp, so you will be able to configure it and manage the results at the same time:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/a11b9059-e54b-4896-aab4-95f26a1633d5.png" style="width:39.25em;height:49.17em;" width="739" height="925"/></div>
<p>I use these apps a lot, and I thought I should share a list of my favorite ones:</p>
<ul>
<li><span class="packt_screen">Active Scan ++</span></li>
<li><span class="packt_screen">Additional Scanner Checks</span></li>
<li><span class="packt_screen">Backslash Powered Scanner</span></li>
<li><span class="packt_screen">CO2</span></li>
<li><span class="packt_screen">Error Message Checks</span></li>
<li>J<span class="packt_screen">SON Beautifier</span></li>
<li><span class="packt_screen">Random IP Address Header</span></li>
<li><span class="packt_screen">Retire.js</span></li>
<li><span class="packt_screen">Scan manual insertion point</span></li>
<li><span class="packt_screen">SQLiPy</span></li>
<li><span class="packt_screen">WAFDetect</span></li>
<li><span class="packt_screen">Wordlist Extractor</span></li>
</ul>
<div class="packt_tip">If you see an error, like <kbd>java.lang.OutOfMemoryError: PermGen space</kbd>, <span class="Code">you can fix it by starting Burp using the following</span> command:<br/>
<span class="Code"><br/></span><kbd>java -XX:MaxPermSize=1G -jar [burp_file_name.jar]</kbd></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>Congratulations! You now know the ins and outs of Burp. In future chapters, we will use Burp to conduct our Web Intrusion Tests. I invite you to start practicing and using Burp; it is your Swiss Army knife for every Web Application Intrusion Test. If you can afford to buy a license, do it now! It is worthwhile for practicing and enhancing your web application hacking skills.</p>
<p>In the next chapter, I will show you the basics of web application vulnerabilities: a nice, exciting topic that will allow you to enhance and deepen your penetration testing skills.</p>


            </article>

            
        </section>
    </div>



  </body></html>