<html><head></head><body><div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Application Threat Modeling</h1>
                </header>
            
            <article>
                
<p class="mce-root">I have dedicated a whole chapter to this topic because people underestimate the importance of<span> </span><strong>Application Threat Modeling</strong><span> </span>(<strong>ATM</strong>). If you're an employee or a consultant in application security, you will always encounter projects that will deliver new releases of their product, and you will need to make sure to test these projects before they are deployed into the production servers. ATM happens at the beginning when the project is still in the Architecture phase. In fact, ATM is a security architecture document that allows you to identify future threats and to pinpoint the different pentest activities that need to be executed in the future deployment of the web application project.  </p>
<p>Here's the plan for this amazing chapter:</p>
<ul>
<li>Introducing the software development life cycle</li>
<li>Application Threat Modeling at a glance</li>
<li>Application Threat Modeling in real life</li>
<li>Application Threat Modeling document structure and contents</li>
<li>A practical example of an Application Threat Modeling document</li>
</ul>
<div class="packt_tip">A lot of principles in this chapter (and this book, as well) can be found at the<span> </span><strong>OWASP</strong><span> </span>website. I highly recommend that you keep the OWASP website in mind for your application security<span> </span>daily tasks: <a href="http://www.owasp.org">http://www.owasp.org</a>.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Software development life cycle</h1>
                </header>
            
            <article>
                
<p class="mce-root">Every application proceeds into a development life cycle before it is deployed into production. First, the project team comes up with an idea for a new product (a website) that allows the business to earn more money and clients. This is the <strong>Analysis/Architecture</strong> phase, where everyone sits around the table to discuss all the challenges of this new project. At the end of this phase, an Architecture document will be produced and presented to the Architecture Board who will approve it if the project meets the company's policies. After the approval, the project will start in the <strong>Development</strong> phase, where a team of developers and quality assurance engineers will join together to deliver the product. After a few sprints, a stable release will be ready for deployment into the production; the team will test this application and make sure that it's free of bugs. If everything is good (gating), then the team will proceed and deploy the web application into the production environment:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/48ea8a84-abf0-4010-8da8-ae1ae751b66d.png" width="1730" height="632"/></div>
<p class="mce-root">You, as an application security professional, play an important role in this workflow. During the first Architecture/Analysis stage, you are required to attend the meetings to understand the new application. Once the architecture document is completed, you will create your ATM document. Later, during the Development phase, you will execute all the penetration tests activities (Source Code Review, Web Intrusion Tests, and Infrastructure Security Tests) based on the ATM document that you wrote at the beginning.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Application Threat Modeling at a glance</h1>
                </header>
            
            <article>
                
<p>ATM is a methodology for analyzing the security posture of an application and it aims to help you lay out the foundations before starting the penetration testing activities. The document should address the security risks during the Architecture phase by identifying and quantifying them before project reaches the Development phase. You will see so many approaches out there for how to handle the threat modeling document (the best one that I recommend is the OWASP Application Threat Modeling document; check it out yourself and you will understand what I mean), but from my personal experience, I suggest you make it as simple as possible and don't waste your time over-describing the security risks of the application, because in this case, you're stepping on the feet of the information security risk assessment document. Use this document as a guide and a brainstorm to achieve the goal of the penetration tests' activities.</p>
<p class="mce-root">Before you start writing this document, you need to attend a few meetings (project kick-off meetings) so that you understand the application that you will be testing. Generally, at the end of the Architecture phase, a detailed architecture document will be produced, and this will allow you to finalize your work.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Application Threat Modeling in real life</h1>
                </header>
            
            <article>
                
<p>At the end of this chapter, I will provide a practical sample of an ATM document. If you feel that any of the items that I'm trying to discuss here are not clear (very theoretical), then I invite you to look at the example at the end of this chapter. If you want your team to be successful during the pentest phase, then you must do an ATM document prior to your penetration test activities. Let's take an example that I witness on a daily basis when I use this approach. A new project comes in, and the<span> </span><strong>Project Manager</strong><span> </span>(<strong>PM</strong>) contacts management, asking for an expert in application security, because they're going to build a new website. The management team then assigns you to that new project, which is still in the Architecture phase. You attend a couple of meetings to understand the contents of the project. Most probably, another security analyst from the information security department will be assigned to attend these meetings as well because his/her job is to write a risk assessment document for the same project. When the project team is ready, an architecture document will be produced and sent by email. Then, I can start on my application threat modeling document, of which I will send a copy to the Information Security Analyst and the Project Manager so they can use it as a guideline for the next phases. See the following table to understand how each phase is affected by our intervention.</p>
<p>This table contains a list of actions that I have witnessed in multiple big companies; the company that you work for probably has a different approach, but this is the best one that I've ever seen:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="background-color: #999999">
<p><strong>Requirements</strong></p>
</td>
<td style="background-color: #999999">
<p><strong>Architecture</strong></p>
</td>
<td style="background-color: #999999">
<p><strong>Development</strong></p>
</td>
<td style="background-color: #999999">
<p><strong>Gating Before Deployment</strong></p>
</td>
<td style="background-color: #999999">
<p><strong>Production</strong></p>
</td>
</tr>
<tr style="height: 48px">
<td style="height: 48px;width: 20%;vertical-align: top">
<p class="mce-root"><strong>Training</strong>: Developers, DevLeads, and Architects should be trained about application security best practices. The company should encourage the security training for IT.<br/>
Every team member should know their role:<br/>
- Security Champion<br/>
- Dev Lead<br/>
- Developer<br/>
- Quality Assurance Agent<br/>
- Project Manager<br/>
- Architect<br/>
- Application Security Agent<br/>
- Information Security Agent<br/>
- Architecture Peer review team<br/>
- Operation Security<br/>
- Deployment Gating Agent</p>
<p><strong> </strong></p>
</td>
<td style="height: 48px;width: 18%;vertical-align: top">
<p class="mce-root"><strong>Architecture phase</strong>: The project team will invite the<span> </span><strong>Application Security Agent</strong><span> </span>(<strong>ASA</strong>) to their kick-off meetings.<br/>
By attending these meetings the ASA will discover any flaws in the design and he/she can give recommendations regarding the application security.</p>
<p><strong>Application Threat Modeling</strong>: In the end the ASA should write an Application Threat Modeling document that will live with the security risk assessment written by the<span> </span><strong>Information Security Agent</strong><span> </span>(<strong>ISA</strong>).</p>
</td>
<td style="height: 48px;width: 30%;vertical-align: top">
<p><strong>Communication</strong>: There are some major key roles in the development phase:</p>
<p><strong>Security Champion</strong>: Generally a dev lead, this person will communicate with the Application Security Agent for revising the flaws in the static/dynamic code analysis. False positives will always be there so the ASA's role is to help the champion to figure out and differentiate the good flaws from the bad flaws.<br/>
The Security Champion will make sure that his/her team is following the secure coding best practices.</p>
<p><strong>QA</strong>: The Quality Assurance Agent should know who the ASA is because they will need each other to determine when the pre-prod environment is ready for testing.</p>
</td>
<td style="height: 48px;width: 22.6019%;vertical-align: top">
<p><strong>Intrusion Test</strong>: A Manual Intrusion Test should be executed before deploying into production. The Automated Test executed in the CI during the development phase is not enough to tackle any hidden web application-based vulnerability.</p>
<p><strong>Code Review</strong><span>: A Manual Static Code Analysis should be done and the ASA should be expert enough to not rely on the automated tools for discovering vulnerabilities.</span></p>
<p><strong>Infrastructure Test</strong><span>: A network vulnerability assessment will be executed against the web server where the application will be deployed to discover and assess the existing vulnerabilities.</span></p>
<p><strong>Information Security:</strong><span> </span><span>The ISA will get the results of the tests and will communicate with higher management to sign any risks associated with the deployment of the web application.<br/></span></p>
</td>
<td style="height: 48px;width: 15.3981%;vertical-align: top">
<p class="mce-root"><strong>Operation Security</strong>: The<span> </span><strong>Operation Security Agent</strong><span> </span>(<strong>OSA</strong>) will be aware of the deployment of the new application and he/she will revise all the security documents written by the ASA and ISA.</p>
</td>
</tr>
<tr style="height: 48px">
<td style="height: 48px;width: 20%;vertical-align: top">
<p><strong>Requirements</strong>: Secure Coding Standards should be in place for developers to use. This document should be in the hands of the developers the first day they join the company. Having this document will decrease security flaws later in the development life cycle.</p>
<p class="mce-root"/>
</td>
<td style="height: 48px;width: 18%;vertical-align: top">
<p><strong>Peer Review</strong>: After everyone has done their job and we have an official architecture document plus the security documents described previously, then the peer review board will verify that everything is in respect of the company's policies.</p>
<p class="mce-root"/>
</td>
<td style="height: 48px;width: 19%;vertical-align: top">
<p>Generally, the QA will supply the ASA with the test credentials and the URL for testing.</p>
<p><strong>PM</strong>: The project manager will communicate with the ASA for the timesheet and for raising any impediments that could delay the deployment of the project.</p>
</td>
<td style="height: 48px;width: 22.6019%;vertical-align: top">
<p><strong>Gating</strong><span>: The Deployment Gating Agent will check if the security tests are executed before allowing the project to go into production.</span>The Deployment Gating Agent will communicate with the ISA and ASA to verify that everything is done correctly.</p>
</td>
<td style="height: 48px;width: 15.3981%;vertical-align: top">
<p><strong>Health Check</strong>: The OSA will ensure that the application will be tested regularly (at least once per year).</p>
<p>The test should cover the three categories; source code, intrusion test, and infrastructure test.</p>
<p class="mce-root"/>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p class="mce-root">One of the big advantages of the ATM document is that it allows me to remember what the project is all about when it's time to execute the tests. In reality, there will be a delay of many months between the Architecture phase and the deployment of the project into production. In general, you don't work on a single project, and because of the high number of tests that you're going to encounter, this document will be your reference to help you remember what happened at the beginning of the project.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Application Threat Modeling document parts</h1>
                </header>
            
            <article>
                
<p>An ATM document has multiple sections. In fact, this document can be between 40-70 pages long. Understanding each section is crucial for a successful project. I know I told you previously to keep this document simple, but not too much; you should not miss the important details of an ATM document.</p>
<p>So, here's the list of the most important sections that an ATM document should contain:</p>
<ul>
<li>Data Flow Diagram</li>
<li>External dependencies</li>
<li>Trust levels</li>
<li>Entry points</li>
<li>Assets</li>
<li>Test strategies</li>
<li>Security risks</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Data Flow Diagram</h1>
                </header>
            
            <article>
                
<p class="mce-root">I placed this title,<span> </span><strong>Data Flow Diagram</strong><span> </span>(<strong>DFD</strong>), at the beginning for a reason; because it's my favorite section and I use it as a reference in the ATM document. The DFD will allow us to gain a better understanding of the application by providing a visual representation of the different pieces of the web application. The focus of the DFD is on how data moves through the application from the user until it reaches its final destination (for example, a database or filesystem). Generally, I use the architecture document that you already received during the Architecture phase, from the project team, to develop the DFD (the architecture document should contain the architecture diagram of the application):</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-912 image-border" src="Images/93d59a9c-b315-4d40-a0a6-46a73453ad75.png" style="width:144.83em;height:71.17em;" width="1738" height="854"/></div>
<p class="mce-root">As you can see from the preceding diagram, there are a number of shapes that the application security community uses when designing a DFD:</p>
<ul>
<li class="mce-root"><strong>External Entity</strong>: This shape represents the entity that interacts with an application (for example, customer, employee, manager, and so on):</li>
</ul>
<div class="mce-root CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1056 image-border" src="Images/79eb318d-90e6-490f-9689-66ca2e19fa6a.png" style="width:8.17em;height:4.75em;" width="197" height="115"/></div>
<ul>
<li class="mce-root"><strong>Privilege boundary</strong>:<strong> </strong>The privilege boundary shape is used to represent the change of privilege levels as the data flows through different areas in the system. It is represented by a red dotted line (see the preceding DFD example). </li>
</ul>
<p style="padding-left: 60px" class="mce-root">Also, I use the dotted rectangle shape to group the boundary for a group of items (for example, inside the company boundary).</p>
<ul>
<li class="mce-root"><strong>Data Flow</strong>:<strong> </strong>The data flow shape represents data movement within the application. The direction of the data movement is represented by the arrows:</li>
</ul>
<div class="mce-root CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1057 image-border" src="Images/27bc82a7-6fa0-44eb-b214-66d1210f56b8.png" style="width:13.92em;height:4.58em;" width="409" height="134"/></div>
<ul>
<li class="mce-root"><strong>Subprocess</strong>:<strong> </strong>This shape is used to present a collection of subprocesses. You use this one when you know that the task can be broken down into its subprocesses in another DFD:</li>
</ul>
<div class="mce-root CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1058 image-border" src="Images/2af3f5e9-13de-421a-b612-5f8e1883da79.png" style="width:12.42em;height:12.42em;" width="323" height="323"/></div>
<ul>
<li class="mce-root"><strong>Process</strong>: The process shape represents a piece that handles data within the application. In practice, I use the subprocess shape most of the time, but that's me and you're not obliged to follow my methodology (it's nice to sometimes step outside the norms and not be a victim of the shapes):</li>
</ul>
<div class="mce-root CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1059 image-border" src="Images/ee1b5861-760d-48de-988c-6762cc17ad6e.png" style="width:9.17em;height:9.17em;" width="284" height="284"/></div>
<ul>
<li class="mce-root"><strong>Data Store</strong>:<strong> </strong>The data store's shape is used to represent locations where data is stored (for example, file and database). I usually use the following shape:</li>
</ul>
<div class="mce-root CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1060 image-border" src="Images/4189d367-7e71-4018-8906-0526fa7432ec.png" style="width:12.00em;height:7.25em;" width="272" height="207"/></div>
<p style="padding-left: 60px" class="mce-root">I also use this shape (OWASP style):</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/4b50aacd-e48a-4cb7-87f3-b23d5e1c4119.png" style="width:10.75em;height:5.08em;" width="323" height="154"/></div>
<p class="mce-root">Here are some rules that I learned by myself in order to have a successful DFD diagram:</p>
<ul>
<li class="mce-root">Keep it simple (don't add too many details), but don't miss the important details either</li>
<li class="mce-root"><span>Be artistic and don't be a slave to the design that the community is using, you can have your own, too (discuss this with your manager if you have one)</span></li>
<li class="mce-root"><span><span>The diagram should be self-explanatory, even if you look at it after a year (or more)</span></span></li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">External dependencies</h1>
                </header>
            
            <article>
                
<p class="mce-root">This one can sometimes be confusing because of its name. External dependencies are typically the items that interact with the web application. The examples are endless here, but here are the ones that you will encounter most of the time:</p>
<ul>
<li class="mce-root">The web server vendor/OS (for example, IIS, Apache, and Linux Redhat)</li>
<li class="mce-root"><span>The database server OS and version (for example, MSSQL, MySQL, Oracle, and Windows server 2016)</span></li>
<li class="mce-root"><span>The firewalls and their versions (for example, Palo Alto Firewalls)</span></li>
<li class="mce-root"><span>The web service server (for example, IBM</span><span> </span>Datapower<span>)</span></li>
<li><span>External suppliers web services/cloud services (for example, MS Azure, Amazon, and cloud services)</span></li>
</ul>
<div class="mce-root packt_tip">Do NOT list all the details such as Cisco switches or routers, in the<span> </span><em>External dependencies</em><span> </span>section; you get the idea.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Trust levels</h1>
                </header>
            
            <article>
                
<p class="mce-root">Trust levels represent the access rights that the application will grant to any entity that is interacting with the web application. For example, if the web application stores its data in the database, in the backend, then ask yourself this question: who interacts with the database? The simple answer would be the Database Administrator, Database Read Users, and Database Read/Write Users. You should ask this question for every item that interacts with the web application (for example, web services, filesystems, logs, and so on).</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Entry points</h1>
                </header>
            
            <article>
                
<p class="mce-root">Entry points are the ways through which a potential attacker can interact with the application (read/write data). Examples can be any web page or web service endpoint. If you have a house, this will represent any door or windows to your house that allows a thief to get inside and steal things.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Assets</h1>
                </header>
            
            <article>
                
<p class="mce-root">Assets are the different parts of the application that a hacker would be interested in getting (also known as Threat target). Most of the time, the attacker is interested in the data, but here are more examples that you can use while developing this section:</p>
<ul>
<li class="mce-root">Read user data (for example, passwords, credit cards, personal information)</li>
<li class="mce-root"><span>Execute unauthorized functionalities (for example, add a new user and delete an account)</span></li>
<li class="mce-root"><span>Access to unauthorized systems (for example, access to the database, access to the web server file system through a terminal window)</span></li>
<li class="mce-root"><span>Different systems availability (for example, DOS against a web server)</span></li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Test strategies</h1>
                </header>
            
            <article>
                
<p class="mce-root">Your ATM document should include the different security tests that you will execute before deploying into production. You need to explain to the project why you're doing the tests and what the necessary details for this task are. For example, you need to specify the environment of the test (Dev, Staging, or Production). Also, will you need credentials for testing? If so, how many? (For example, admin or guest.)</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Security risks</h1>
                </header>
            
            <article>
                
<p class="mce-root">The ATM document is not a replacement for risk assessment, but it is a guide for you to get only the high-level application security risks.</p>
<p class="mce-root">Always ask the following questions to get a quick risk level of the application as a whole:</p>
<ul>
<li class="mce-root">Does the application handle any confidential data? Y/N</li>
<li class="mce-root"><span>Does the application write data to the backend? Y/N</span></li>
<li class="mce-root"><span>Any impact on the company's public image? Y/N</span></li>
<li class="mce-root"><span>Any impact on the company's clients? Y/N</span></li>
<li class="mce-root"><span>Is the application accessible from the internet? Y/N</span></li>
<li class="mce-root"><span>Is the application accessible from mobile devices? Y/N</span></li>
<li class="mce-root"><span>Does the application interact with third-party services? Y/N</span></li>
<li class="mce-root"><span>Is the application developed by a third-party? Y/N</span></li>
</ul>
<p class="mce-root">Wait, there is more—this is just an overall questionnaire that can give you a head start. Next, you need to classify the attacker's goals using the<span> </span><strong>STRIDE</strong><span> </span>methodology, which stands for:</p>
<ul>
<li class="mce-root"><strong>Spoofing</strong>: When a hacker steals the credentials/session of the victim</li>
<li class="mce-root"><strong>Tampering</strong>: The threat is accomplished by manipulating data at rest and in transit</li>
<li class="mce-root"><strong>Repudiation</strong>: This happens when we cannot trace who did what</li>
<li class="mce-root"><strong>Information Disclosure</strong>: This threat reveals confidential information to a hacker without being authorized to do it</li>
<li class="mce-root"><strong>Denial of Service</strong>: Threat targeting the systems and making them unusable by clients</li>
<li class="mce-root"><strong>Elevation of Privilege</strong>: Threat aimed to gain administrator privileges on the remote system</li>
</ul>
<p class="mce-root">Then, we take each security threat and give it a risk rank point using the<span> </span><strong>DREAD</strong><span> </span>methodology.</p>
<p class="mce-root">Here's a simple explanation of the<span> </span><strong>DREAD</strong><span> </span>ranking:</p>
<ul>
<li class="mce-root"><strong>Damage</strong><span> </span>(impact?)</li>
<li class="mce-root"><strong>Reproducibility</strong><span> </span>(how easy it is?)</li>
<li class="mce-root"><strong>Exploitability</strong> (time and effort?)</li>
<li class="mce-root"><strong>Affected Users</strong><span> </span>(how many users, including clients and employees?)</li>
<li class="mce-root"><strong>Discoverability</strong><span> </span>(easy to discover?)</li>
</ul>
<p class="mce-root">To calculate it, you need to give a rank number for each from 1 to 10, where 1 is low and 10 is high. After that, you add all the scores together and divide them by five and you will get the average result. Don't worry, you will see a practical example soon; for the time being, try to get the big picture.</p>
<p>The way to get a score/rating using DREAD is easy; the following table tells the story:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="background-color: #999999"/>
<td style="background-color: #999999">
<p><strong>Name</strong></p>
</td>
<td style="background-color: #999999">
<p><strong>High (8-10)</strong></p>
</td>
<td style="background-color: #999999">
<p><strong>Medium (4-7)</strong></p>
</td>
<td style="background-color: #999999">
<p><strong>Low (1-3)</strong></p>
</td>
</tr>
<tr>
<td>
<p>D</p>
</td>
<td>
<p>Damage </p>
</td>
<td>
<p><span>The attacker can subvert the security system; upload contents; get a remote shell; run as administrator.</span></p>
</td>
<td>
<p>Leaking some confidential information.</p>
</td>
<td>
<p>Leaking non-confidential Information.</p>
</td>
</tr>
<tr>
<td>
<p>R</p>
</td>
<td>
<p>Reproducibility</p>
</td>
<td>
<p>It can be reproduced in a short period of time.</p>
</td>
<td>
<p>It can be reproduced in certain situations.</p>
</td>
<td>
<p>It's very hard to reproduce the attack.</p>
</td>
</tr>
<tr>
<td>
<p>E</p>
</td>
<td>
<p>Exploitability</p>
</td>
<td>
<p>A script kiddie can exploit the vulnerability.</p>
</td>
<td>
<p>It takes some skills to exploit the vulnerability.</p>
</td>
<td>
<p>It takes someone with highly advanced skills to exploit the vulnerability.</p>
</td>
</tr>
<tr>
<td>
<p>A</p>
</td>
<td>
<p>Affected Users</p>
</td>
<td>
<p>More than 1,000 customers affected.</p>
</td>
<td>
<p>Between 100 and 1,000 customers affected.</p>
</td>
<td>
<p>Less than 100 customers affected.</p>
</td>
</tr>
<tr>
<td>
<p>D</p>
</td>
<td>
<p>Discoverability</p>
</td>
<td>
<p>Can be easily discovered using trivial tools.</p>
</td>
<td>
<p>Discovering the vulnerability will take some skills.</p>
</td>
<td>
<p>Discovering the vulnerability is highly difficult.</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p class="mce-root">Some people like to use the Information Security formula to calculate the security risk:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><em>Risk = Likelihood x Impact</em></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Practical example</h1>
                </header>
            
            <article>
                
<p>Our practical example is based on the Company Name XYZ Inc. The marketing team in XYZ wants to add a blog page to attract more clients and they want to call the project xBlog. You attended a few kick-off meetings and now, finally, they have sent you the architecture document, and inside it, you have the following diagram:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1061 image-border" src="Images/87f5f0c6-2e8b-4a42-8055-f694f1a039e7.png" style="width:40.42em;height:21.33em;" width="1500" height="792"/></div>
<p class="mce-root">According to this diagram, the clients (customers) will be able to access the blog from anywhere and they can add comments (the authentication process for customers is out of scope because clients will be authenticated through the main page of the company's website). On the other hand, the employees of XYZ can add a blog or approve a client comment through the WordPress CMS. Simple, right? Your job as an application security expert is to submit an ATM document to the project team before going to the architecture review board; let's start!</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">xBlog Threat Modeling</h1>
                </header>
            
            <article>
                
<p class="mce-root"><span>In cooperation with the [Company Name] objectives, which are aiming to preserve the security of its digital information resources, it is important for the administration of [Company Name] to be aware of the security risks and threats associated with the use of the [xBlog] application during normal business operation.</span></p>
<p class="mce-root"><span>This document consists of a security assessment report using Application Threat Modeling techniques. We will be evaluating the application [xBlog] to understand the security risks that can make an impact on the business operations of [Company Name].</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Scope</h1>
                </header>
            
            <article>
                
<p class="mce-root"><span>This document will be applied only to the application [xBlog] of [Company Name]. The application [xBlog] is physically located at the [Company Name] facilities.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Threat Modeling</h1>
                </header>
            
            <article>
                
<p>[To define Threat Modeling here, refer to the<span> </span><em>Application Threat Modeling at a Glance</em><span> </span>section of this chapter.]</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Project information</h1>
                </header>
            
            <article>
                
<p><span>In this section, we will add the description of the [xBlog] web application. The following table aims to identify the big picture for this project and to identify the users that will interact with it as well:</span></p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="background-color: #999999">
<p><strong>Application Version</strong></p>
</td>
<td>
<p>[xBlog v1.0]</p>
</td>
</tr>
<tr>
<td style="background-color: #999999">
<p><strong>Description</strong></p>
</td>
<td>
<p class="mce-root">The application [xBlog] is a new application that will target the [Company Name] customers and allow them to read blogs and comments to those blogs as well. The Blog [<kbd>blog.domain.com</kbd>] will be hosted separately using the WordPress CMS. A local admin will be able to administer the blog by adding new articles and managing the blog's comments as well.</p>
<p>Two types of users will use this application:</p>
<ul>
<li>Customers</li>
<li>WordPress administrators</li>
</ul>
</td>
</tr>
<tr>
<td style="background-color: #999999">
<p><strong>Document Owner</strong></p>
</td>
<td>
<p>Gus Khawaja</p>
</td>
</tr>
<tr>
<td style="background-color: #999999">
<p><strong>Participants</strong></p>
</td>
<td>
<ul>
<li>John Doe (Solution Architect)</li>
<li>Jane Doe (Project Manager)</li>
<li>Elliot Doe (Information Security Director)</li>
</ul>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Data Flow Diagram</h1>
                </header>
            
            <article>
                
<p><span>[To define Data Flow Diagram here, refer to the <em>Data Flow Diagram</em> section of this chapter:]</span></p>
<div class="mce-root CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1062 image-border" src="Images/2369771e-67fb-4dea-a451-48f7dfbbb0a3.png" style="width:144.83em;height:71.17em;" width="1738" height="854"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">External dependencies</h1>
                </header>
            
            <article>
                
<p><span>[To define External Dependencies here, refer to the <em>External dependencies</em> section of this chapter:]</span></p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr style="background-color: #999999">
<td>
<div class="CDPAlignCenter CDPAlign"><strong>ID</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Description</strong></div>
</td>
</tr>
<tr>
<td>
<p>1</p>
</td>
<td>
<p>The Website [<kbd>www.domain.com</kbd>] is protected by Cisco firewalls in DMZ Zone and the only communication available is TLS.</p>
</td>
</tr>
<tr>
<td>
<p>2</p>
</td>
<td>
<p>The Website [<kbd>www.blog.domain.com</kbd>] is using WordPress and is protected by a Cisco firewall in a DMZ Zone. T<span>he only communication available is TLS.</span></p>
</td>
</tr>
<tr>
<td>
<p>3</p>
</td>
<td>
<p>The Admin page for WordPress [<kbd>wpadmin.blog.domain.com</kbd>] is accessible internally through an HTTPS Link.</p>
</td>
</tr>
<tr>
<td>
<p>4</p>
</td>
<td>
<p>The web server of <span>[<kbd>www.domain.com</kbd>] is using Microsoft IIS and Windows Server 2016 with the latest security patches. (See the Nessus report on the intranet [rs66988_nessus.pdf].)</span></p>
</td>
</tr>
<tr>
<td>
<p>5</p>
</td>
<td>
<p>The web server of [<span><kbd>www.blog.domain.com</kbd>] is using Apache and Ubuntu Server 2016 with the latest security patches. (See the Nessus report on the intranet [rs56389_nessus.pdf].)</span></p>
</td>
</tr>
<tr>
<td>
<p>6</p>
</td>
<td>
<p>The database is using MySQL and is stored on the same server as the web application. <span>(See the Nessus report on the intranet [rs56389_nessus.pdf].)</span></p>
</td>
</tr>
<tr>
<td>
<p>7</p>
</td>
<td>
<p>Customers will access the blog through a hyperlink located on the menu of the website <span>[<kbd>www.domain.com</kbd>], which will redirect them to [<kbd>www.blog.domain.com</kbd>].</span></p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Trust levels</h1>
                </header>
            
            <article>
                
<p><span>[To define trust levels here, refer to the <em>Trust levels</em> section of this chapter:]</span></p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr style="background-color: #999999">
<td>
<div class="CDPAlignCenter CDPAlign"><strong>ID</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Name</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Description</strong></div>
</td>
</tr>
<tr>
<td>
<p>1</p>
</td>
<td>
<p>Anonymous Web User</p>
</td>
<td>
<p>This is any web anonymous user that is trying to use the [xBlog] application. This type of user will read blogs but will not be able to add comments since they did not log in previously.</p>
</td>
</tr>
<tr>
<td>
<p>2</p>
</td>
<td>
<p>Customers</p>
</td>
<td>
<p>The Customers will use the [xBlog] application to read blogs and add comments. The customer should be logged in order to add comments to the blog article.</p>
</td>
</tr>
<tr>
<td>
<p>3</p>
</td>
<td>
<p>WordPress Administrator</p>
</td>
<td>
<p>The WordPress Administrator will manage the website and approve blog articles. The role of the administrator is to approve customer comments as well before they go online.</p>
</td>
</tr>
<tr>
<td>
<p>4</p>
</td>
<td>
<p>Blogs Creator</p>
</td>
<td>
<p>The Blog Creator will create a new blog and the administrator will later approve this blog before it's published.</p>
</td>
</tr>
<tr>
<td>
<p>5</p>
</td>
<td>
<p>Database Administrator</p>
</td>
<td>
<p>The Database Administrator is a MySQL professional who will make sure to maintain and manage the database that stores the data of WordPress.</p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Entry points</h1>
                </header>
            
            <article>
                
<p><span>[To define the Entry Points here, refer to the <em>Entry points</em> section of this chapter:]</span></p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr style="background-color: #999999">
<td>
<div class="CDPAlignCenter CDPAlign"><strong>ID</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Name</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Description</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Trust levels</strong></div>
</td>
</tr>
<tr>
<td>
<p>1</p>
</td>
<td>
<p>HTTPS</p>
</td>
<td>
<p>The website will be only accessible through TLS. All the pages of this website will use it as well.</p>
</td>
<td>
<ul>
<li class="mce-root">Anonymous web user</li>
<li>Customers</li>
</ul>
</td>
</tr>
<tr>
<td>
<p>2</p>
</td>
<td>
<p>Blogs Page</p>
</td>
<td>
<p>This is the blogs articles listing page.</p>
</td>
<td>
<ul>
<li class="mce-root">Anonymous web user</li>
<li class="mce-root">Customers</li>
</ul>
</td>
</tr>
<tr>
<td>
<p>3</p>
</td>
<td>
<p>WordPress Login Page</p>
</td>
<td>
<p>The WP-Login page will be the one the employees use to log in to WordPress.</p>
</td>
<td>
<ul>
<li class="mce-root">WordPress administrator</li>
<li>Blogs creator</li>
</ul>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Assets</h1>
                </header>
            
            <article>
                
<p><span>[To define Assets here, refer to the <em>Assets</em> section of this chapter]. Optionally, you can add the Trust Levels (users) as an additional column to this table, but I don't include it most of the time in my ATM documents; it's your choice:</span></p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr style="background-color: #999999">
<td>
<div class="CDPAlignCenter CDPAlign"><strong>ID</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Name</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Description</strong></div>
</td>
</tr>
<tr style="background-color: #747474">
<td>
<p>1</p>
</td>
<td>
<p>Blog</p>
</td>
<td>
<p>Assets related to the blog's website</p>
</td>
</tr>
<tr>
<td>
<p>1.1</p>
</td>
<td>
<p>Access to WordPress</p>
</td>
<td>
<p>Get the credentials of an Admin/Moderator to access the WordPress platform</p>
</td>
</tr>
<tr>
<td>
<p>1.2</p>
</td>
<td>
<p>Availability of the website</p>
</td>
<td>
<p>The ability to make the site unavailable to clients or employees who manage it</p>
</td>
</tr>
<tr style="background-color: #747474">
<td>
<p>2</p>
</td>
<td>
<p>Database</p>
</td>
<td>
<p>Assets related to the MySQL database that holds the website data</p>
</td>
</tr>
<tr>
<td>
<p>2.1</p>
</td>
<td>
<p>Access to the database</p>
</td>
<td>
<p>Being able to access the MySQL locally or remotely</p>
</td>
</tr>
<tr>
<td>
<p>2.2</p>
</td>
<td>
<p>Availability of the database</p>
</td>
<td>
<p>Making the database unavailable to users</p>
</td>
</tr>
<tr>
<td>
<p>2.3</p>
</td>
<td>
<p>Ability to execute SQL statements</p>
</td>
<td>
<p>Being able to execute SQL queries to extract or manipulate data in the database</p>
</td>
</tr>
<tr>
<td>
<p>2.4</p>
</td>
<td>
<p>Access to Audit Logs data</p>
</td>
<td>
<p>Access the audit logs looking for confidential information</p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Threats list</h1>
                </header>
            
            <article>
                
<p><span>[To define Security Risks here, refer to the <em>Security risks</em> section of this chapter.]</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Spoofing – authentication</h1>
                </header>
            
            <article>
                
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="background-color: #999999">
<p><strong>Threat Description</strong></p>
</td>
<td>
<p><span>Threat action aimed to illegally access and use another user's credentials, such as username and password.</span></p>
</td>
</tr>
<tr>
<td style="background-color: #999999">
<p><strong>Threat Target</strong></p>
</td>
<td>
<p>Customer and employee credentials.</p>
</td>
</tr>
<tr>
<td style="background-color: #999999">
<p><strong>Attacker Steps</strong></p>
</td>
<td>
<p>An attacker can do the following:</p>
<ul>
<li>Steal the credentials through social engineering</li>
<li>Brute-force attempts to get into the system</li>
<li>Perform an SQL injection to bypass authentication or extract a user's credentials</li>
<li>Intercept and steal the session cookie from a user</li>
</ul>
</td>
</tr>
<tr>
<td style="background-color: #999999">
<p><strong>Counter-Measure</strong></p>
</td>
<td>
<ul>
<li class="mce-root">Secure Password Policy</li>
<li class="mce-root">Sessions Timeout</li>
<li class="mce-root">Account Lockout against brute-force attacks</li>
<li class="mce-root">Logging failed attempts</li>
<li class="mce-root">Validation against SQLi and XSS</li>
<li class="mce-root">The admin console for WordPress is only accessible through the intranet</li>
</ul>
</td>
</tr>
<tr>
<td style="background-color: #999999">
<p><strong>Existing Counter-Measure</strong></p>
</td>
<td>
<p>N/A - it's a new project</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>The DREAD review is as follows:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr style="background-color: #909090">
<td>
<div class="CDPAlignCenter CDPAlign"><strong>DREAD</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Details</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Score /10</strong></div>
</td>
</tr>
<tr>
<td>
<p><span>Damage</span></p>
</td>
<td>
<ul>
<li class="mce-root">Getting an admin account will allow the hacker to upload a remote shell and own the box</li>
<li>Getting a client account will allow the hacker to only post blogs on his behalf</li>
</ul>
</td>
<td>
<p>8</p>
</td>
</tr>
<tr>
<td>
<p>Reproducibility</p>
</td>
<td>
<p>It can be reproduced in a mid-long period of time.</p>
</td>
<td>
<p>6</p>
</td>
</tr>
<tr>
<td>
<p>Exploitability</p>
</td>
<td>
<p>It doesn't take a lot of skill to execute this attack.</p>
</td>
<td>
<p>7</p>
</td>
</tr>
<tr>
<td>
<p>Affected Users</p>
</td>
<td>
<p class="mce-root">An attack can be targeting a single user.</p>
<p>Dumping the MySQL database will include most of the customers and the admin account as well.</p>
</td>
<td>
<p>7</p>
</td>
</tr>
<tr>
<td>
<p><span>Discoverability</span></p>
</td>
<td>
<p>The Login page (for admin authentication) in WordPress is only accessible through the intranet. <span>So, discovering the application will be limited to the intranet zone.</span></p>
</td>
<td>
<p>3</p>
</td>
</tr>
<tr>
<td/>
<td>
<p class="CDPAlignRight CDPAlign"><strong>Total</strong></p>
</td>
<td>
<p><strong>6.2</strong></p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Tampering – integrity</h1>
                </header>
            
            <article>
                
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="background-color: #909090">
<p><strong>Threat Description</strong></p>
</td>
<td>
<p>Threat action that mainly aims to alter the data at rest or in transit.</p>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Threat Target</strong></p>
</td>
<td>
<p>The site data.</p>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Attacker Steps</strong></p>
</td>
<td>
<p class="mce-root">An attacker can do the following for this type of threat:</p>
<ul>
<li>Can manipulate data through an SQL injection Attack / XSS Attack</li>
<li>An internal<span> </span><span>attacker can manipulate data by accessing the database directly without having the right privilege</span></li>
<li>An attacker can intercept the communication and alter it</li>
</ul>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Counter-Measure</strong></p>
</td>
<td>
<ul>
<li>The admin console for WordPress is only accessible through the intranet</li>
<li>The database will not be accessible directly by a DB admin (only accessible through WordPress)</li>
<li>Communication is only accessible through TLS</li>
</ul>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Existing Counter-Measure</strong></p>
</td>
<td>
<p><span>N/A - it's a new project.</span></p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>The DREAD review is as follows:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr style="background-color: #909090">
<td>
<div class="CDPAlignCenter CDPAlign"><strong>DREAD</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Details</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Score /10</strong></div>
</td>
</tr>
<tr>
<td>
<p><span>Damage </span></p>
</td>
<td>
<p>Manipulating the data will damage the blog site and its integrity as well.</p>
</td>
<td>
<p>7</p>
</td>
</tr>
<tr>
<td>
<p><span>Reproducibility</span></p>
</td>
<td>
<p><span>It can be reproduced in</span><span> </span>a mid-long<span> </span><span>period of time.</span></p>
</td>
<td>
<p>6</p>
</td>
</tr>
<tr>
<td>
<p><span>Exploitability</span></p>
</td>
<td>
<p><span>It takes a lot of skill to execute this attack.</span></p>
</td>
<td>
<p>1</p>
</td>
</tr>
<tr>
<td>
<p><span>Affected Users</span></p>
</td>
<td>
<p>Most of the clients could be affected by this type of attack.</p>
</td>
<td>
<p>6</p>
</td>
</tr>
<tr>
<td>
<p><span>Discoverability</span></p>
</td>
<td>
<p class="mce-root"><span>The Login page (for admin authentication) in WordPress is only accessible through the intranet. So, discovering the application will be limited to the intranet zone.</span></p>
</td>
<td>
<p>3</p>
</td>
</tr>
<tr>
<td/>
<td>
<p class="CDPAlignRight CDPAlign"><strong>Total</strong></p>
</td>
<td>
<p><strong>4.6</strong></p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Repudiation</h1>
                </header>
            
            <article>
                
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="background-color: #909090">
<p><strong>Threat Description</strong></p>
</td>
<td>
<p><span>Threat action aimed to perform illegal operations in a system that lacks the ability to trace the prohibited operations.</span></p>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Threat Target</strong></p>
</td>
<td>
<p>Website (WordPress) functionalities.</p>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Attacker Steps</strong></p>
</td>
<td>
<p><span>An attacker can deny his/her attacks if the application does not support proper security logging.</span></p>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Counter-measure</strong></p>
</td>
<td>
<p class="mce-root">The application should:</p>
<ul>
<li>Log all the activities</li>
<li>Throw errors in case of a threat (for example, an SQLi attempt)</li>
</ul>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Existing Counter-measure</strong></p>
</td>
<td>
<p><span>N/A - it's a new project.</span></p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>The DREAD review is as follows:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr style="background-color: #909090">
<td>
<div class="CDPAlignCenter CDPAlign"><strong>DREAD</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Details</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Score /10</strong></div>
</td>
</tr>
<tr>
<td>
<p><span>Damage</span></p>
</td>
<td>
<p>Some or little.</p>
</td>
<td>
<p>2</p>
</td>
</tr>
<tr>
<td>
<p><span>Reproducibility</span></p>
</td>
<td>
<p>Can be reproduced any time.</p>
</td>
<td>
<p>7</p>
</td>
</tr>
<tr>
<td>
<p><span>Exploitability</span></p>
</td>
<td>
<p>The attacker will need some experience in application logging.</p>
</td>
<td>
<p>3</p>
</td>
</tr>
<tr>
<td>
<p><span>Affected Users</span></p>
</td>
<td>
<p>It can vary from 1 to more than 100.</p>
</td>
<td>
<p>5</p>
</td>
</tr>
<tr>
<td>
<p><span>Discoverability</span></p>
</td>
<td>
<p><span>The attacker needs to know the logging/monitoring architecture.</span></p>
</td>
<td>
<p>1</p>
</td>
</tr>
<tr>
<td/>
<td>
<p class="CDPAlignRight CDPAlign"><strong>Total</strong></p>
</td>
<td>
<p><strong>3.6</strong></p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Information disclosure – confidentiality</h1>
                </header>
            
            <article>
                
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="background-color: #909090">
<p><strong>Threat Description</strong></p>
</td>
<td>
<p><span>Exposing information (at rest and in transit) to someone not authorized to see it.</span></p>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Threat Target</strong></p>
</td>
<td>
<p>Application (WordPress) data.</p>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Attacker Steps</strong></p>
</td>
<td>
<p class="mce-root"><span>An attacker can do the following for this type of threat:</span></p>
<ul>
<li>Read data in transit</li>
<li>Read data from logs</li>
<li>Read data from error messages</li>
<li>Blog article contents can reveal confidential information</li>
<li>A hacker can exfiltrate data through SQL Injection attacks</li>
<li>A hacker can query data if he/she has access directly to the database</li>
</ul>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Counter-measure</strong></p>
</td>
<td>
<ul>
<li class="mce-root">Use only TLS for data in transit</li>
<li>Logs should not contain confidential information</li>
<li>Error messages should be generic</li>
<li>Blog articles will be approved by admins before they are published</li>
<li>Admins will approve the comments of the customers before they are published</li>
<li><span>The database will not be accessible directly by a</span><span> </span>DB<span> </span><span>admin (only accessible through WordPress)</span></li>
</ul>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Existing Counter-measure</strong></p>
</td>
<td>
<p><span>N/A - it's a new project.</span></p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>The DREAD report is as follows:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr style="background-color: #909090">
<td>
<div class="CDPAlignCenter CDPAlign"><strong>DREAD</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Details</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Score /10</strong></div>
</td>
</tr>
<tr>
<td>
<p><span>Damage</span></p>
</td>
<td>
<p>The damage of seeing the data inside WordPress is limited to the blogs of the company.</p>
</td>
<td>
<p>3</p>
</td>
</tr>
<tr>
<td>
<p><span>Reproducibility</span></p>
</td>
<td>
<p><span>Can be reproduced any time.</span></p>
</td>
<td>
<p>7</p>
</td>
</tr>
<tr>
<td>
<p><span>Exploitability</span></p>
</td>
<td>
<p><span>The attacker will need some experience in application programming and advanced attacks.</span></p>
</td>
<td>
<p>3</p>
</td>
</tr>
<tr>
<td>
<p><span>Affected Users</span></p>
</td>
<td>
<p><span>It can vary from 1 to more than 100.</span></p>
</td>
<td>
<p>5</p>
</td>
</tr>
<tr>
<td>
<p><span>Discoverability</span></p>
</td>
<td>
<p><span>The attacker needs to know the application architecture.</span></p>
</td>
<td>
<p>3</p>
</td>
</tr>
<tr>
<td/>
<td>
<p class="CDPAlignRight CDPAlign"><strong>Total</strong></p>
</td>
<td>
<p><strong>4.2</strong></p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Denial of service – availability</h1>
                </header>
            
            <article>
                
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="background-color: #909090">
<p><strong>Threat Description</strong></p>
</td>
<td>
<p><span>The application will be temporarily unavailable or unusable.</span></p>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Threat Target</strong></p>
</td>
<td>
<p>Application operations.</p>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Attacker Steps</strong></p>
</td>
<td>
<p><span>An attacker can send a huge number of requests aiming to bring the site down.  </span></p>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Counter-measure</strong></p>
</td>
<td>
<p>Putting a threshold in the application configuration file or web server.</p>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Existing Counter-measure</strong></p>
</td>
<td>
<p><span>Production Servers Load Balancing.</span></p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p class="mce-root">The DREAD report is as follows:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr style="background-color: #909090">
<td>
<div class="CDPAlignCenter CDPAlign"><strong>DREAD</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Details</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Score /10</strong></div>
</td>
</tr>
<tr>
<td>
<p>Damage</p>
</td>
<td>
<p>The website will be inaccessible.</p>
</td>
<td>
<p>8</p>
</td>
</tr>
<tr>
<td>
<p><span>Reproducibility</span></p>
</td>
<td>
<p>Can be reproduced any time.</p>
</td>
<td>
<p>8</p>
</td>
</tr>
<tr>
<td>
<p><span>Exploitability</span></p>
</td>
<td>
<p>A script kiddie can execute it.</p>
</td>
<td>
<p>8</p>
</td>
</tr>
<tr>
<td>
<p><span>Affected Users</span></p>
</td>
<td>
<p>Between 100 and probably more than 1,000.</p>
</td>
<td>
<p>7</p>
</td>
</tr>
<tr>
<td>
<p><span>Discoverability</span></p>
</td>
<td>
<p>Anyone can discover it using the URL.</p>
</td>
<td>
<p>9</p>
</td>
</tr>
<tr>
<td/>
<td>
<p class="CDPAlignRight CDPAlign">Total</p>
</td>
<td>
<p><strong>8</strong></p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Elevation of privilege – authorization</h1>
                </header>
            
            <article>
                
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="background-color: #909090">
<p><strong>Threat Description</strong></p>
</td>
<td>
<p><span>Threat aimed at gaining privileged access to resources, for gaining unauthorized access to information or to compromise a system.</span></p>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Threat Target</strong></p>
</td>
<td>
<p>Network Infrastructure.</p>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Attacker Steps</strong></p>
</td>
<td>
<p>After getting authenticated into the system, a<span>n attacker</span><span> </span>can upload a remote shell to manipulate the server remotely. If there are any missing configurations or patches, the hacker can take advantage of the flaw and escalate his/her  privileges.</p>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Counter-measure</strong></p>
</td>
<td>
<ul>
<li class="mce-root">Servers are always scanned for missing patches and configurations as well</li>
<li class="mce-root">Monitoring the applications for any suspicious activities</li>
</ul>
</td>
</tr>
<tr>
<td style="background-color: #909090">
<p><strong>Existing Counter-measure</strong></p>
</td>
<td>
<ul>
<li class="mce-root">Intrusion Detection Systems</li>
<li>Smart Data Loss Prevention Systems</li>
<li>Smart Firewalls</li>
<li>Network Separation using VLANs and Firewalls</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>The DREAD report is as follows:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr style="background-color: #909090">
<td>
<div class="CDPAlignCenter CDPAlign"><strong>DREAD</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Details</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Score /10</strong></div>
</td>
</tr>
<tr>
<td>
<p>Damage</p>
</td>
<td>
<p>The damage is very high in this case because the hacker will own the system and the network as well.</p>
</td>
<td>
<p>10</p>
</td>
</tr>
<tr>
<td>
<p><span>Reproducibility</span></p>
</td>
<td>
<p>It can be reproduced any time when the countermeasures are not implemented.</p>
</td>
<td>
<p>10</p>
</td>
</tr>
<tr>
<td>
<p><span>Exploitability</span></p>
</td>
<td>
<p>The attack can be executed by an intermediate skill hacker.</p>
</td>
<td>
<p>9</p>
</td>
</tr>
<tr>
<td>
<p><span>Affected Users</span></p>
</td>
<td>
<p><span>Between 100 and probably more than 1,000.</span></p>
</td>
<td>
<p>7</p>
</td>
</tr>
<tr>
<td>
<p><span>Discoverability</span></p>
</td>
<td>
<p>The flaw can be discovered internally because the admin console is not accessible to the outside perimeter.</p>
</td>
<td>
<p>6</p>
</td>
</tr>
<tr>
<td/>
<td>
<p class="CDPAlignRight CDPAlign">Total</p>
</td>
<td>
<p><strong>8.4</strong></p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Test strategies</h1>
                </header>
            
            <article>
                
<p><span>The application security team under Information Security Management will conduct the necessary security tests to enhance the web application's security posture. The activity listed in the following table will include all the items that need to be executed during the security penetration tests:</span></p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr style="background-color: #909090">
<td>
<div class="CDPAlignCenter CDPAlign"><strong>ID</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Name</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Tools</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Description</strong></div>
</td>
<td>
<div class="CDPAlignCenter CDPAlign"><strong>Environment</strong></div>
</td>
</tr>
<tr>
<td>
<p>1</p>
</td>
<td>
<p>Manual Source Review</p>
</td>
<td style="width: 250px">
<ul>
<li class="mce-root">Veracode</li>
<li class="mce-root">Visual Studio IDE  for .NET</li>
<li class="mce-root">Eclipse IDE for JAVA</li>
</ul>
</td>
<td>
<p>We don't need to inspect the source code since the application will be using WordPress CMS.</p>
</td>
<td>
<p>Pre-Prod</p>
</td>
</tr>
<tr>
<td>
<p>2</p>
</td>
<td>
<p>Web Intrusion Tests</p>
</td>
<td>
<p>Burp Suite Pro</p>
</td>
<td>
<p><span>The security analysts will execute a manual and automated Web Intrusion Test. This will simulate an attack that can happen on the website.</span></p>
</td>
<td>
<p>Pre-Prod</p>
</td>
</tr>
<tr>
<td>
<p>3</p>
</td>
<td>
<p>Web Services Fuzzing</p>
</td>
<td>
<p>Burp Suite Pro</p>
</td>
<td>
<p>N/A</p>
</td>
<td>
<p>N/A</p>
</td>
</tr>
<tr>
<td>
<p>4</p>
</td>
<td>
<p>Webserver Infrastructure Test</p>
</td>
<td>
<ul>
<li class="mce-root">Nessus</li>
<li>Nmap</li>
</ul>
</td>
<td>
<p><span>The security analyst will test the web server infrastructure security and be looking for any missing security patches or non-secure settings.</span></p>
</td>
<td>
<p>PROD</p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p class="mce-root"><span>As you've seen in this chapter, ATM is not so hard after all. People underestimate the importance of this document, but once you start using it, you won't be able to stop because it has so many benefits. Be creative and don't stick to the same template discussed in this chapter; instead, use it as a guideline for your next application threat modeling document.</span></p>
<p class="mce-root"><span>Any professional website project starts with an architecture phase, and that's when you need to show your skills and consider the ATM document as a security architecture document as well. Your job is not only to be a pentester, and that's a very important concept to understand in the security field. Feel free to add your desired sections, for example monitoring, logging, secure coding, security controls, or any recommendations that you feel will help the project at the beginning before they start with the development phase.</span></p>
<p class="mce-root"><span>In the next chapter, we will discuss another important topic in application security; static code analysis (Source Code Review). I won't go into details about it for the time being. I will leave the fun of discovering all the interesting stuff for the next chapter.</span></p>


            </article>

            
        </section>
    </div>



  </body></html>