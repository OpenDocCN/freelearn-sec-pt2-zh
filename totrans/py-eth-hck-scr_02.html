<html><head></head><body>
		<div id="_idContainer057">
			<h1 id="_idParaDest-67"><em class="italic"><a id="_idTextAnchor070"/>Chapter 3</em>: Reconnaissance and Information Gathering</h1>
			<p>In this chapter, we will learn about the basics of networking. Without having a solid understanding of computer networks, you will not be able to go very far in the field of penetration testing and ethical hacking. We will cover some basic details about how networking works. We will also take a look at the different abstraction layers in networking and the role of each layer. </p>
			<p>Every ethical hacking process starts with gathering relevant information about the target, and this chapter is dedicated to what type of information we can obtain and how this information can be useful to us. We will discuss the standard OSI model that's used to describe the network layers and how this model can be helpful for us. In this chapter, we will cover the following topics:</p>
			<ul>
				<li>What is a computer network?</li>
				<li>Classifying networks</li>
				<li>Network stack</li>
				<li>Network entities</li>
				<li>Protection</li>
				<li>Changing MAC </li>
			</ul>
			<h1 id="_idParaDest-68"><a id="_idTextAnchor071"/>What is a computer network?</h1>
			<p>In<a id="_idIndexMarker135"/> the <strong class="bold">Information Technology</strong> (<strong class="bold">IT</strong>) domain, <strong class="bold">networking</strong> means<a id="_idIndexMarker136"/> the <em class="italic">ability</em> of two or more devices to be able to <em class="italic">communicate</em> and <em class="italic">exchange data</em> with each other. In the early days of computing, computers were unable to talk to each other and were standalone systems. Their functionalities were very limited. As the technology advanced, the need for communication between devices grew. In its simplest form, two computers that connect with each over a <em class="italic">medium</em> form a network. This medium is the <em class="italic">link</em> through which these devices talk with each other. As we proceed, you will see that things become very complicated very quickly in computer networks: </p>
			<div>
				<div id="_idContainer038" class="IMG---Figure">
					<img src="image/B14788_03_01.jpg" alt="Figure 3.1 – The simplest form of a network – two interconnected computers&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.1 – The simplest form of a network – two interconnected computers</p>
			<p>As you will see in the following chapters, most modern-day computer networks are not built like this. For your <a id="_idIndexMarker137"/>computer to talk to other computers, it will need as many links as it has computers, and this can quickly become unmanageable. We will learn more about how we can avoid this problem by using a middle node called router in the <em class="italic">Components of a computer network</em> section. So, what happens when you want a network with 10 devices? For this, we could have cables running from every device to every other device and let them talk. The following diagram shows four computers talking with each other. As you can imagine, such a system would become exponentially unmanageable. This has several drawbacks. For example, it adds complexity to the system and wastes a lot of resources as you will need to maintain a cable between two computers, even if they <em class="italic">talk</em> for a very small amount of time: </p>
			<div>
				<div id="_idContainer039" class="IMG---Figure">
					<img src="image/B14788_03_02.jpg" alt="Figure 3.2 – Network with four nodes&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.2<a id="_idTextAnchor072"/> – Network with four nodes</p>
			<p>To get rid of this <a id="_idIndexMarker138"/>redundancy, we can introduce a central device that will be responsible for allowing different devices to talk to each other. There are different types of central devices, all of which we will explore in the <em class="italic">Components of a basic computer network</em> section:</p>
			<div>
				<div id="_idContainer040" class="IMG---Figure">
					<img src="image/B14788_03_03.jpg" alt="Figure 3.3 – Network with a central device&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.3 – Network with a central device</p>
			<p>The preceding diagram resembles the network we have in our homes. A central device – in our case, the <strong class="bold">router</strong> – helps us<a id="_idIndexMarker139"/> communicate with other devices. This is a very primitive form of a network; networks in real life are much more complex than this. Coming back to the idea of what constitutes a network, a <strong class="bold">network</strong> is <a id="_idIndexMarker140"/>simply two devices that communicate and share data with each other through a <strong class="bold">medium</strong>. Now that we have seen what a network is and started talking about what goes into constructing one, let's look at the components in detail.</p>
			<h1 id="_idParaDest-69"><a id="_idTextAnchor073"/>Components of a basic computer network</h1>
			<p>In this section, we <a id="_idIndexMarker141"/>will learn about the different components of a computer network. In computer network literature, you will often see the term <em class="italic">node</em> being used to represent a computer in a network. In networking domains, a specific nomenclature is used to identify particular devices in a network. We will look at these terms next.</p>
			<h2 id="_idParaDest-70"><a id="_idTextAnchor074"/>Node</h2>
			<p>A node<a id="_idIndexMarker142"/> is usually a device that is connected to <a id="_idIndexMarker143"/>the <em class="italic">central</em> device. In a sense, it is a computer that takes part in a communication network. This works for simple and small networks, but as more and more devices get added to a network, different devices start taking up different roles, so we can only simplify a device's role in a network as a node up to a certain point. In qualifying scenarios, nodes can be your laptop, desktop PC, printer, tablet, phone, or any other network connected device. </p>
			<h2 id="_idParaDest-71"><a id="_idTextAnchor075"/>Server</h2>
			<p>Servers <a id="_idIndexMarker144"/>are<a id="_idIndexMarker145"/> computers that hold some information that can be shared over the network to devices that need them. Servers are usually <em class="italic">online</em>, which means that they <em class="italic">serve</em> devices by being continuously available to other devices.</p>
			<h2 id="_idParaDest-72"><a id="_idTextAnchor076"/>Transmission media</h2>
			<p>The resource/link <a id="_idIndexMarker146"/>through <a id="_idIndexMarker147"/>which devices in a network are connected to each other and can communicate is called <em class="italic">transmission media</em>. It can be both wired and wireless. An example of wired transmission media is an <em class="italic">Ethernet cable</em>, which is typically used in local networks. <em class="italic">Wi-Fi</em> is an example of wireless transmission media. </p>
			<h2 id="_idParaDest-73"><a id="_idTextAnchor077"/>Network interface card</h2>
			<p>To participate in a <a id="_idIndexMarker148"/>network, the connecting node/device must have something called a <strong class="bold">Network Interface Card</strong> (<strong class="bold">NIC</strong>). The <a id="_idIndexMarker149"/>role of NIC is to take what you want to transfer and convert it into a form that's accepted by the transmission media. </p>
			<h2 id="_idParaDest-74"><a id="_idTextAnchor078"/>Hub</h2>
			<p>A hub<a id="_idIndexMarker150"/> is a central device in a network. If you want<a id="_idIndexMarker151"/> to communicate with a node in a network, you probably won't have a direct link to the node. Instead, you should have a link through some central device – in this case, a hub. Your message/data will go to a hub, which will then broadcast it to the whole network. Depending on the content of the message, the respective device will answer. </p>
			<h2 id="_idParaDest-75"><a id="_idTextAnchor079"/>Switch</h2>
			<p>A switch<a id="_idIndexMarker152"/> is a special type of hub. In contrast <a id="_idIndexMarker153"/>to a hub, which broadcasts the message to all the nodes, a switch only sends the message to the intended receiver. This greatly decreases traffic on the network since the devices that are not intended shouldn't receive the message. </p>
			<h2 id="_idParaDest-76"><a id="_idTextAnchor080"/>Router</h2>
			<p>So far, we have<a id="_idIndexMarker154"/> been talking about a single <a id="_idIndexMarker155"/>network. What if a computer wants to talk with a computer that is not present in your network? What if this computer is in France and the intended receiver computer is in a network in the United States? We can extend the concept of interconnection of computers to interconnection of networks. Routers are devices that help us communicate with external networks. </p>
			<h2 id="_idParaDest-77"><a id="_idTextAnchor081"/>Gateway</h2>
			<p>A gateway<a id="_idIndexMarker156"/> is the endpoint router in a network. All the<a id="_idIndexMarker157"/> traffic coming in or going out of a network goes through it. It acts as a mediator between the internet and local devices. To the devices outside our own network, the gateway is the main communication point for any device in the local network. </p>
			<h2 id="_idParaDest-78"><a id="_idTextAnchor082"/>Firewall</h2>
			<p>A firewall<a id="_idIndexMarker158"/> is an optional device in some networks. Firewalls can be <a id="_idIndexMarker159"/>software-based, such as your operating system's firewall, or they can be a hardware-based device for the whole network. The role of a firewall is to enhance the security of the system and to monitor the network traffic. This ensures that no unauthorized access is made to a network. Firewalls typically block all incoming connection requests to your local network, except those that have been authorized and mentioned in the rule engine of the firewall:</p>
			<div>
				<div id="_idContainer041" class="IMG---Figure">
					<img src="image/B14788_03_04.jpg" alt="Figure 3.4 – Components in a network&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.4 – Components in a network</p>
			<p>As the name implies, it <a id="_idIndexMarker160"/>serves as an entry point, as well as an exit point, to a local network. For practical reasons and for small networks, the small components of a network such as a router, switch, gateway, and sometimes even a firewall are merged into a single physical device. </p>
			<p>In this section, we learned about the different components of a network and what the role of each component is. Next, we will talk about how these different networks are classified. </p>
			<h1 id="_idParaDest-79"><a id="_idTextAnchor083"/>Classifying network</h1>
			<p>As more and more <a id="_idIndexMarker161"/>computers start connecting, it becomes essential to classify them into different classes so that we can use them. There are various methods we can use for classification; however, the most common one is network classification based on geography. We will discuss this next. </p>
			<h2 id="_idParaDest-80"><a id="_idTextAnchor084"/>Local area network</h2>
			<p>When you connect your laptop or phone to a Wi-Fi router located in your home, you are essentially participating in<a id="_idIndexMarker162"/> a <strong class="bold">local area network</strong> (<strong class="bold">LAN</strong>). There are <a id="_idIndexMarker163"/>multiple types of connections you can make to a LAN, such as by using Wi-Fi, which is a wireless connection, or by using a wired connection such as an ethernet cable. There is no hard definition of what constitutes a LAN. However, a LAN is usually composed of devices that are in the same proximity in a building. LAN can be as simple as two devices connecting to a router or as complicated as LANs in universities and offices. </p>
			<h3>Ethernet</h3>
			<p>Ethernet is one<a id="_idIndexMarker164"/> of the most used technologies in LAN. Modern ethernet protocols offer very high speeds in a LAN. It is highly reliable and secure compared to wireless mediums. The ethernet protocol defines how the data will be transferred over LAN. Modern-day ethernet can provide speeds in the order of Gigabits per second. </p>
			<h3>Wi-Fi</h3>
			<p>Complementary to<a id="_idIndexMarker165"/> ethernet, which uses physical cables to connect devices to a network, Wi-Fi allows devices to connect with each other over a wireless medium. This removes the need for wires. It should be noted the even though it is wireless, communication between devices on a LAN is not direct. The data still goes through a central router, called<a id="_idIndexMarker166"/> an <strong class="bold">Access Point</strong> (<strong class="bold">AP</strong>), which forwards the data to the intended recipient. </p>
			<p>A comparison <a id="_idIndexMarker167"/>between these<a id="_idIndexMarker168"/> two mediums is as follows:</p>
			<div>
				<div id="_idContainer042" class="IMG---Figure">
					<img src="image/Table_011.jpg" alt="Table 1.1 – Wi-Fi versus ethernet&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Table 1.1 – Wi-Fi versus ethernet</p>
			<p>Both mediums have their own pros and cons. Wireless is much easier to use for an average user and gives them more freedom of movement in the network, while cable-based ethernet is much faster and is often used when the need for mobility is low in a network. Now that we have learned about LAN, we will start looking at other geographical-based networks. </p>
			<h2 id="_idParaDest-81"><a id="_idTextAnchor085"/>Personal area network</h2>
			<p>In contrast to <a id="_idIndexMarker169"/>LAN, a <strong class="bold">personal area network</strong> (<strong class="bold">PAN</strong>) is usually very small. The range of PANs are in the order of<a id="_idIndexMarker170"/> tens of meters only. An example of a PAN would be two Bluetooth-based devices talking to each other. In rare cases, PANs are also connected to LANs. </p>
			<h2 id="_idParaDest-82"><a id="_idTextAnchor086"/>Metropolitan area networks</h2>
			<p>Sometimes, we tend to merge several small local area networks into a single category. They are usually <a id="_idIndexMarker171"/>called <strong class="bold">metropolitan area networks</strong> (<strong class="bold">MANs</strong>). An <a id="_idIndexMarker172"/>example of a MAN would be government offices located in different areas of a city connected to a single network. These networks are usually restricted to a city.</p>
			<h2 id="_idParaDest-83"><a id="_idTextAnchor087"/>Wide area network</h2>
			<p>As the name indicates, a <strong class="bold">wide area network</strong> (<strong class="bold">WAN</strong>) is a<a id="_idIndexMarker173"/> network that spans <a id="_idIndexMarker174"/>a large geographical area. A WAN usually constitutes a network within a country.</p>
			<h2 id="_idParaDest-84"><a id="_idTextAnchor088"/>Internet</h2>
			<p>So far, we have only discussed networks in one geographical location. Inter-network, or the<a id="_idIndexMarker175"/> internet, is a <a id="_idIndexMarker176"/>giant network that connects different networks located in different geographical locations to each other. With this huge network, you can communicate with any device anywhere in the world, provided it is also connected to the internet. Different WANs are connected to each other through very high-speed fiber optic networks: </p>
			<div>
				<div id="_idContainer043" class="IMG---Figure">
					<img src="image/B14788_03_05.jpg" alt="Figure 3.5 – Networks by scale&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.5 – Networks by scale</p>
			<p>So far, we have discussed the physical components of and different types of networks. This gave us an overview of networking in computers. Now that we are aware of the basics of networking, we can start diving deeper into how data is transferred from one device to another in a network.</p>
			<h1 id="_idParaDest-85"><a id="_idTextAnchor089"/>Network stack</h1>
			<p>The previous section gave us a <a id="_idIndexMarker177"/>high-level introduction to networking. Now, we will learn about how the actual bits and pieces are transferred over a network. </p>
			<h2 id="_idParaDest-86"><a id="_idTextAnchor090"/>Introduction to OSI model</h2>
			<p>From the time you type a message on an application to the time that it gets delivered to its intended recipient, your message passes though different layers in a communication system. To help us understand all the communication processes and mediums your data passes though before it reaches its destination, a framework was conceptualized to describe the functionality of a networking system. This model is called the <strong class="bold">Open Systems Interconnected</strong> (<strong class="bold">OSI</strong>) model. This<a id="_idIndexMarker178"/> model is not necessarily applied to the internet alone and can be applied to any modern communication system:</p>
			<div>
				<div id="_idContainer044" class="IMG---Figure">
					<img src="image/B14788_03_06.jpg" alt="Figure 3.6 – 7-layer OSI stack&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.6 – 7-layer OSI stack</p>
			<p>The OSI model contains 7 layers that conceptualize how data is transferred over any electronic communication medium. Let's look at these layers in more detail.</p>
			<h3>Application layer</h3>
			<p>The application layer<a id="_idIndexMarker179"/> is the top-most layer of the OSI stack. This is the layer that the user interacts with. Any internet-connected device you use probably has an application layer interface. It serves as an input/output endpoint to the user. Any data you send is added to the application layer and any data you receive from the others is displayed over this layer. </p>
			<h3>Presentation layer</h3>
			<p>This layer resides below the <a id="_idIndexMarker180"/>application layer and is responsible for converting data into a useful format. The data from the application layer comes in different formats and is usually not in the most readable form for the communication system. Here, data gets converted into a suitable form. Also, the user data in not encrypted from the application layer. At the presentation layer, encryption is usually added to the data for security purposes. </p>
			<h3>Session layer</h3>
			<p>Below the presentation layer is <a id="_idIndexMarker181"/>the session layer. Once the data is ready to be sent, the sending device and the receiving device must establish a connection so that they can send data over the channel. The session layer helps do just that – it establishes a connection from your device to the recipient device. </p>
			<h3>Transport layer</h3>
			<p>Once the session has been established between two devices, the data is ready to be sent over the channel. The transport layer<a id="_idIndexMarker182"/> takes the actual data to be sent and divides it into smaller and manageable chunks, called <em class="italic">segments</em>, that <a id="_idIndexMarker183"/>can be sent over the link. It is also responsible for receiving segments of data from other devices and assembling it back for your consumption.</p>
			<p>The transport layer is also responsible for flow and error control. Different transmission media has different speeds and different error rates. It is the job of the transport layer to ensure that proper data is transmitted.</p>
			<h3>Network layer</h3>
			<p>The role of the network layer<a id="_idIndexMarker184"/> comes into play when we want to communicate with devices that are not present on the same network. The network layer breaks down <em class="italic">segments</em> from the transport layer into even smaller <em class="italic">packets</em>. The network layer also determines the best possible route for the packet to take to reach its destination. </p>
			<h3>Data link layer</h3>
			<p>This is<a id="_idIndexMarker185"/> somewhat similar to the network layer; however, it facilitates communication between devices in the same network. The data link layer breaks down packets into frames. </p>
			<h3>Physical layer</h3>
			<p>This is the lowermost layer of the stack and is where the data entered by the user is converted into <a id="_idIndexMarker186"/>physical signals that can be transported over transmission media. In the case of a digital system, this means that 0s and 1s of data are converted into their suitable representations in physical systems, such as voltage levels. </p>
			<h2 id="_idParaDest-87"><a id="_idTextAnchor091"/>Complete cycle</h2>
			<p>The <a id="_idIndexMarker187"/>complete cycle for communication is as follows:</p>
			<div>
				<div id="_idContainer045" class="IMG---Figure">
					<img src="image/B14788_03_07.jpg" alt="Figure 3.7 – Data transmission in the OSI stack&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.7 – Data transmission in the OSI stack</p>
			<p>The data <a id="_idIndexMarker188"/>that's entered by user goes from the application layer to the physical layer and then from the physical layer to the application layer at the other end. </p>
			<h2 id="_idParaDest-88"><a id="_idTextAnchor092"/>TCP/IP model</h2>
			<p>The previously<a id="_idIndexMarker189"/> shown model is a very generic model that conceptualizes communication in any medium. However, how computer networks work is a special case of the OSI model and is commonly referred to as the TCP/IP model. You will often see this model mentioned in the literature instead of the more generic OSI model: </p>
			<div>
				<div id="_idContainer046" class="IMG---Figure">
					<img src="image/B14788_03_08.jpg" alt="Figure 3.8 – TCP/IP stack&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.8 – TCP/IP stack</p>
			<p>In contrast to the OSI model, which has seven layers, the internet stack has four layers. Let's look at them in more detail.</p>
			<h3>Application layer</h3>
			<p>This is the topmost layer. This <a id="_idIndexMarker190"/>layer is responsible for process-to-process communication. Common application layer protocols include HTTP, FTP, SSH, DNS, and others. </p>
			<h3>Transport layer</h3>
			<p>TCP and UDP are common<a id="_idIndexMarker191"/> protocols at this layer. This layer is responsible for end-to-end communication and error control. TCP is connection oriented, while UDP is a connectionless protocol. </p>
			<h3>Internet layer</h3>
			<p>This layer parallels the network<a id="_idIndexMarker192"/> layer in the OSI stack. It defines protocols that are responsible for logically transferring data from one node to another. One of the most famous protocols at this layer is the IP protocol, which uses IP addresses to communicate between devices. </p>
			<h3>Network access layer</h3>
			<p>This layer combines the data <a id="_idIndexMarker193"/>link and the physical layer in the OSI stack. </p>
			<h2 id="_idParaDest-89"><a id="_idTextAnchor093"/>Mapping the OSI and TCP/IP stack</h2>
			<p>The<a id="_idIndexMarker194"/> layer mapping for the<a id="_idIndexMarker195"/> OSI and TCP/IP stack is as follows:</p>
			<div>
				<div id="_idContainer047" class="IMG---Figure">
					<img src="image/B14788_03_09.jpg" alt="Figure 3.9 – Mapping for the TCP/IP and OSI stack&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.9 – Mapping for the TCP/IP and OSI stack</p>
			<p>The preceding image shows how the OSI stack is mapped to the TCP/IP stack for use in network communication. As we mentioned previously, even though the OSI model is a more generic model, the functionality of some of the layers in the OSI model can be merged into one layer in the TCP/IP stack. Now that we have learned how the data moves in a network at a conceptual level, we will dig more deeply into the actual bits and pieces of communication at the byte level.</p>
			<h1 id="_idParaDest-90"><a id="_idTextAnchor094"/>Network entities</h1>
			<p>Before proceeding, we will introduce a<a id="_idIndexMarker196"/> few network-related concepts that will be used throughout this book. Having prior knowledge of them is essential so that you have a complete understanding of this book.</p>
			<h2 id="_idParaDest-91"><a id="_idTextAnchor095"/>Private IP address</h2>
			<p>An <strong class="bold">internet protocol</strong> (<strong class="bold">IP</strong>) address is a <a id="_idIndexMarker197"/>unique identifier that identifies a <a id="_idIndexMarker198"/>device in a network. An IP address <a id="_idIndexMarker199"/>is a 32-bit number. Whenever you connect to a new network, you are either assigned a new IP address by <a id="_idIndexMarker200"/>a <strong class="bold">Dynamic Host Control Protocol</strong> (<strong class="bold">DHCP</strong>) server or you get an IP address stored in your system configuration if it is available. This is usually called a local/private IP address. More often than not, you will see this address in the form <strong class="source-inline">192.168.1.x</strong>. </p>
			<p class="callout-heading">Important Note about IP Addresses </p>
			<p class="callout">IP addresses are 32-bit, which means that there are only 2^32 = 4,294,967,295 internet addresses available. The IP address is an old protocol and when it was developed, there were not many internet-connected devices. At the time, 4 billion devices was considered a sufficient number. However, as we have seen recently, there are far more than 4 billion devices in the world today, so how do all the devices get their addresses? This is<a id="_idIndexMarker201"/> done through the <strong class="bold">Network Address Translation</strong> (<strong class="bold">NAT</strong>) protocol, which we will look at in a moment.</p>
			<p>In addition to a private IP address, we also have a public IP address. To avoid the problem of running out of IP addresses with each new device getting a new unique IP address, we use a protocol called the NAT protocol. Instead of giving each device a new IP address, when you get an internet connection from your <strong class="bold">Internet Service Provider</strong> (<strong class="bold">ISP</strong>), you <a id="_idIndexMarker202"/>will only get one public IP address. This will be associated with your router/gateway. This IP address will be accessible to all the other networks on the internet. So, every device within this network will use this public/gateway IP address to communicate with any device in the network. The following diagram illustrates this:</p>
			<div>
				<div id="_idContainer048" class="IMG---Figure">
					<img src="image/B14788_03_10.jpg" alt="Figure 3.10 – Public and private IPs&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.10 – Public and private IPs</p>
			<p>Let's <a id="_idIndexMarker203"/>consider your <a id="_idIndexMarker204"/>home LAN network, which contains four devices – three PCs and one router/gateway. When you get an internet subscription from your ISP, you will get a public IP address or a WAN IP address. In the preceding example, the public IP is <strong class="source-inline">169.2.4.55</strong>. This is associated with your router. If you connect to the router and go on the internet and search for your public IP, you will get this IP. You can also find this IP on your router's setting page. In addition to the public IP, each node in the network will have a private IP address. This address is not visible to the devices outside of this LAN. The private IP addresses in the preceding example are <strong class="source-inline">192.168.1.40</strong>, <strong class="source-inline">60</strong>, and <strong class="source-inline">80</strong>. Each of these devices will appear to have an IP address of <strong class="source-inline">169.2.4.55</strong> to the devices external to this network. </p>
			<p>So, to external devices, all these internal PCs will look like one device. So, how does the data coming and going in and out of a network know which PC to go to? This is done <a id="_idIndexMarker205"/>using a <strong class="bold">media access control</strong> (<strong class="bold">MAC</strong>) address. Inside the internal network, the devices only work though MAC addresses. MAC addresses will be explained in the <em class="italic">MAC address</em> section.</p>
			<h3>Public versus private IP addresses</h3>
			<p>The main differences <a id="_idIndexMarker206"/>between public and private IP addresses are as follows:</p>
			<div>
				<div id="_idContainer049" class="IMG---Figure">
					<img src="image/Table_02.jpg" alt="Table 3.2 – Differences between public and private IP addresses&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Table 3.2 – Differences between public and private IP addresses</p>
			<p>The IP <a id="_idIndexMarker207"/>addresses we have seen so far are IPV4 addresses, which are quite popular. However, there are other addresses as well. Let's take a look. </p>
			<h2 id="_idParaDest-92"><a id="_idTextAnchor096"/>IPv4 versus IPv6</h2>
			<p>So far, the<a id="_idIndexMarker208"/> IP addresses we have learned about are called IPv4 <a id="_idIndexMarker209"/>addresses. There is another version of the IP address <a id="_idIndexMarker210"/>called IPv6. These are 128-bit addresses. They have been created to be used in future computing systems. However, their adoption has been slow due to the use of the NAT protocol. Currently, only 40% of the internet supports IPv6 addresses. </p>
			<h2 id="_idParaDest-93"><a id="_idTextAnchor097"/>MAC address </h2>
			<p>A MAC address<a id="_idIndexMarker211"/> is also called a hardware address and is usually associated <a id="_idIndexMarker212"/>with the NIC card. Each NIC has its own MAC address. A MAC address is a physical number that's assigned by the manufacturer. Each manufacturer is assigned a pool of numbers that it can use to manufacture its products. A MAC address is a 48-bit number: </p>
			<div>
				<div id="_idContainer050" class="IMG---Figure">
					<img src="image/B14788_03_11.jpg" alt="Figure 3.11 – MAC address bytes&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.11 – MAC address bytes</p>
			<p>Next, let's discuss ports.</p>
			<h2 id="_idParaDest-94"><a id="_idTextAnchor098"/>Ports</h2>
			<p>While a <a id="_idIndexMarker213"/>MAC address<a id="_idIndexMarker214"/> uniquely identifies a NIC, which the data uses to identify the correct device it should go to, a port identifies a unique service running on a PC. It serves as a logical endpoint of communication. Each device has multiple applications sending or receiving data over a network. For example, you could be browsing on your PC while you have a download running in the background and another service is uploading data to a server. Once the data reaches your PC, it uses ports to distinguish between the different processes the data belongs to. There are total of 65,535 ports on a system. Some of the first 1,024 are reserved and it is not recommended to use these ports.</p>
			<h1 id="_idParaDest-95"><a id="_idTextAnchor099"/>Protection</h1>
			<p>So<a id="_idIndexMarker215"/> far in this chapter, we have learned about the basics of computer networking, which are essential to understanding the rest of this book. Now, we will start looking at what parameters can be used to track us and how we can protect ourselves. In the previous chapter, we learned that the first step in ethical hacking is information gathering. But before we start gathering information, we must make sure that our identity is protected. Otherwise, we can be easily tracked. Your identity can be tracked back to you with a number of parameters. The most common is your IP address and your MAC address. </p>
			<p>To mask your public IP address, you can <a id="_idIndexMarker216"/>use <strong class="bold">Virtual Private Networks</strong> (<strong class="bold">VPNs</strong>). We will not be discussing VPNs as they are not in the scope of this book. One important thing to note here is that you should not put complete trust in your VPN provider. From a security point of view, using a VPN simply means that you are handing over your trust from <a id="_idIndexMarker217"/>your <strong class="bold">internet service provider</strong> (<strong class="bold">ISP</strong>) to another company that provides VPN services. You should be very careful about your choice in <a id="_idIndexMarker218"/>VPNs and from cybersecurity aspect, you should be very cautious about free VPNs as a lot of them are bundled with either malware or use your PC resources for other purposes, such as bitcoin mining. Some VPNs leak<a id="_idIndexMarker219"/> your <strong class="bold">domain name server</strong> (<strong class="bold">DNS</strong>), a server used for mapping website names to IP addresses, even though they might claim to mask your identity. </p>
			<p>However, when we are scanning our local networks, we can be traced with our MAC address. In <a href="B14788_02_Final_JC_ePub.xhtml#_idTextAnchor054"><em class="italic">Chapter 2</em></a>, <em class="italic">Getting Started – Setting Up Your Lab Environment</em>, we installed two virtual machines: Kali and Windows 10. The Kali machine will be our attack machine. Our machine has a NIC, which is used to communicate with other devices. This NIC has a MAC address. In the <em class="italic">Changing our MAC address</em> section, we will try to spoof a MAC address so that we can change it when scanning. By doing this, even<a id="_idIndexMarker220"/> if the <strong class="bold">intrusion detection system</strong> (<strong class="bold">IDS</strong>) finds out that we were scanning a port on a PC, it will not find out our real MAC address.</p>
			<h1 id="_idParaDest-96"><a id="_idTextAnchor100"/>Changing our MAC address</h1>
			<p>In this section, we<a id="_idIndexMarker221"/> will try to change our MAC address on the Kali machine. Let's start our Kali machine and open up a Terminal. To change the MAC address, you will need to install the <strong class="source-inline">net-tools</strong> package. In most Linux distributions, this tool is already available. However, if it is not installed, you can install it using the following commands: </p>
			<p class="source-code"> sudo apt-get update -y</p>
			<p class="source-code">sudo apt-get install -y net-tools</p>
			<p>It will prompt you for a password, which is <strong class="source-inline">kali</strong>. Once the tools have been installed, you can view the MAC address with the following command:</p>
			<p class="source-code">sudo ifconfig</p>
			<p>If everything goes well, you will see an output similar to the following:</p>
			<div>
				<div id="_idContainer051" class="IMG---Figure">
					<img src="image/B14788_03_12.jpg" alt="Figure 3.12 – ifconfig command output&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.12 – ifconfig command output</p>
			<p>There is a lot to <a id="_idIndexMarker222"/>unpack here, so let's break it down. There are two values here called <strong class="source-inline">eth0</strong> and <strong class="source-inline">lo</strong>. <strong class="source-inline">eth0</strong> is the name of the NIC, whereas <strong class="source-inline">lo</strong> is the loopback adapter. For now, we can ignore the loopback adapter. The <strong class="source-inline">inet</strong> field represents the private IP address of the Kali machine. <strong class="source-inline">inet6</strong> is the IPv6 address of the Kali machine. <strong class="source-inline">ether</strong> is the MAC address, and this is the field we want to change. </p>
			<p>If you want to change the MAC address, you can't do so while the NIC is turned on. First, you have to shut down the network interface. To shut down the interface, you can use the following command: </p>
			<p class="source-code">sudo ifconfig eth0 down</p>
			<p>This command will shut down the NIC named <strong class="source-inline">eth0</strong>. If you don't see an error in the command's output, this means that the command ran successfully.</p>
			<p>Now, if you type in the <strong class="source-inline">ifconfig</strong> command again, you will see the following output: </p>
			<div>
				<div id="_idContainer052" class="IMG---Figure">
					<img src="image/B14788_03_13.jpg" alt="Figure 3.13 – Shutting down a network interface card&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.13 – Shutting down a network interface card</p>
			<p>Now, you will <a id="_idIndexMarker223"/>only see the loopback adapter and that <strong class="source-inline">eth0</strong> has been turned off. To change the MAC address, you can run the following command. Let's say you want your new MAC address to be <strong class="source-inline">00:11:22:33:44:55</strong>. Here, you can do the following:</p>
			<p class="source-code">sudo ifconfig eth0 hw ether 00:11:22:33:44:55</p>
			<p>This command changes the <strong class="source-inline">eth0</strong> interface and the <strong class="source-inline">ether</strong> parameter of this NIC:</p>
			<div>
				<div id="_idContainer053" class="IMG---Figure">
					<img src="image/B14788_03_14.jpg" alt="Figure 3.14 – Changing MAC address&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.14 – Changing MAC address</p>
			<p>Now, if there is no error, this means that the command ran successfully. At this point, we can turn on the interface again by running the following command: </p>
			<p class="source-code">sudo ifconfig eth0 up</p>
			<p>Now, let's run the <strong class="source-inline">ifconfig</strong> command again to see if our changes took place:</p>
			<div>
				<div id="_idContainer054" class="IMG---Figure">
					<img src="image/B14788_03_15.jpg" alt="Figure 3.15 – Changed MAC address&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.15 – Changed MAC address</p>
			<p>Here, you can see that the<a id="_idIndexMarker224"/> MAC address has been changed successfully. Now, if we want to scan something in a network, this MAC address will be shown instead of our real MAC address. </p>
			<h2 id="_idParaDest-97"><a id="_idTextAnchor101"/>Creating a Python script</h2>
			<p>So far, we have written <a id="_idIndexMarker225"/>manual commands to change our MAC. Ideally, we would like to write a Python script that will help us to change it. To do this, we need to find a way to run bash commands with the help of Python. Luckily, Python has a standard library that it uses to run system commands called <strong class="source-inline">subprocess</strong>. This library allows you to interact with the underlying OS. </p>
			<p>To import this library into your module, you can simply write the following command: </p>
			<p class="source-code">import subprocess</p>
			<p>To run a command, <strong class="source-inline">subprocess</strong> has a method called <strong class="source-inline">run</strong>. Using this method, you can execute system commands on your operating system. If you want to see the information about <strong class="source-inline">eth0</strong>, you can run the following command:</p>
			<p class="source-code">    subprocess.run(</p>
			<p class="source-code">        ["ifconfig", "eth0"],</p>
			<p class="source-code">        shell=True,</p>
			<p class="source-code">    )</p>
			<p>This function <a id="_idIndexMarker226"/>requires a list of commands. The other parameter, <strong class="source-inline">shell=true</strong>, means that we want to see the output printed to the console.</p>
			<p>If you run the previous file, you will see an output similar to running the <strong class="source-inline">ifconfig eth0</strong> command. Note that you need to be a root user to run the command, so it should look like this: </p>
			<p class="source-code">sudo python3 main.py</p>
			<p>Here's the output:</p>
			<div>
				<div id="_idContainer055" class="IMG---Figure">
					<img src="image/B14788_03_16.jpg" alt="Figure 3.16 – Running system commands using Python&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.16 – Running system commands using Python</p>
			<p>Now that you<a id="_idIndexMarker227"/> know how to run system commands using Python, you can repeat the preceding commands using Python. The full code is as follows: </p>
			<p class="source-code">import subprocess</p>
			<p class="source-code">if __name__ == "__main__":</p>
			<p class="source-code">    interface = "eth0"</p>
			<p class="source-code">    new_mac = "22:11:22:33:44:57"</p>
			<p class="source-code">    print("Shutting down the interface")</p>
			<p class="source-code">    subprocess.run(["ifconfig", "eth0", "down"])</p>
			<p class="source-code">    print("changing the interface hw address of ", interface, " to ", new_mac)</p>
			<p class="source-code">    subprocess.run(["ifconfig", interface, "hw", "ether", new_mac])</p>
			<p class="source-code">    print("MAC address changed to ", new_mac)</p>
			<p class="source-code">    subprocess.run(["ifconfig", interface, "up"])</p>
			<p class="source-code">    </p>
			<p class="source-code">    print("network interfaced turned on")</p>
			<p>If you check the interface again, you will be able to see the new MAC address:</p>
			<div>
				<div id="_idContainer056" class="IMG---Figure">
					<img src="image/B14788_03_17.jpg" alt="Figure 3.17 – New MAC address&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.17 – New MAC address</p>
			<p>Now that we <a id="_idIndexMarker228"/>have learned how to run commands on a system and how to change MAC address of a system using Python, we will stop our discussion here. In next chapter, we will look at information gathering. </p>
			<h1 id="_idParaDest-98"><a id="_idTextAnchor102"/>Summary</h1>
			<p>In this chapter, we learned about the basics of networking and how we can protect ourselves on a local network by spoofing our MAC address for scanning purposes. This chapter helped us get a deeper insight into the networking aspects of the computer system, as well as how we can use Python to protect and mask our identity in a local network. In the next chapter, we will learn about scanning local networks. </p>
		</div>
	</body></html>