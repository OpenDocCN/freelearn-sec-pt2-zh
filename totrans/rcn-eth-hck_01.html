<html><head></head><body>
		<div id="_idContainer012">
			<h1 id="_idParaDest-16" class="chapter-number"><a id="_idTextAnchor015"/>1</h1>
			<h1 id="_idParaDest-17"><a id="_idTextAnchor016"/>Fundamentals of Reconnaissance</h1>
			<p>As an aspiring ethical hacker, penetration tester, or red teamer, reconnaissance plays an important role in helping cybersecurity professionals reduce organizations’ digital footprint on the internet. These digital footprints enable adversaries such as hackers to leverage publicly available information about a target to plan future operations and cyber-attacks. As more organizations and users are connecting their systems and networks to the largest network infrastructure in the world, the internet, access to information and the sharing of resources are readily available to everyone. The internet has provided the platform for many organizations to extend their products and services beyond traditional borders to potential and new customers around the world. Furthermore, people are using the internet to enroll and attend online classes, perform e-commerce transactions, operate online businesses, and communicate and share ideas <span class="No-Break">with others.</span></p>
			<p>Nowadays, using the internet is very common for many people. For instance, if an organization is looking to hire an employee to fill a new or existing role, the recruiter simply posts the job vacancy with all the necessary details that are needed for an interested candidate. This enables anyone with internet access to visit various job forums and recruiting websites to seek new career opportunities and easily submit an application via the online platform. Information that’s posted and available online enables adversaries to collect and leverage specific details about the targeted organization. Such details help hackers to determine the type of network infrastructure, systems, and services that are running on the internal network of a company without breaking in. This book will teach you all about how threat actors and ethical hackers are able to leverage publicly available information in planning future operations that lead to <span class="No-Break">a cyber-attack.</span></p>
			<p>During the course of this chapter, you will gain a solid understanding of the importance of reconnaissance from both an adversary and cybersecurity professional’s perspective, and why organizations need to be mindful when connecting their systems and network to the internet. Furthermore, you will learn the fundamentals of attack surface management, why it’s important to organizations, and how cybersecurity professionals use it to reduce the risk of a possible cyber-attack on their networks. Lastly, you will discover the tactics, techniques, and procedures that are commonly used by threat actors, adversaries, ethical hackers, and penetration testers during the reconnaissance phase of <span class="No-Break">an attack.</span></p>
			<p>In this chapter, we will cover the <span class="No-Break">following topics:</span></p>
			<ul>
				<li>What is <span class="No-Break">ethical hacking?</span></li>
				<li>Importance <span class="No-Break">of reconnaissance</span></li>
				<li>Understanding attack <span class="No-Break">surface management</span></li>
				<li>Reconnaissance tactics, techniques, <span class="No-Break">and procedures</span></li>
			</ul>
			<p>Let’s <span class="No-Break">dive in!</span></p>
			<h1 id="_idParaDest-18"><a id="_idTextAnchor017"/>What is ethical hacking?</h1>
			<p>The term <em class="italic">hacking</em> is <a id="_idIndexMarker000"/>commonly used to<a id="_idIndexMarker001"/> describe the techniques and activities that are performed by a person with malicious intentions, such as a <em class="italic">hacker</em>, to gain<a id="_idIndexMarker002"/> unauthorized access to a system or network. Since the early days of telephone systems, computers, and the internet, many people have developed a high level of interest in determining how various devices and technologies operate and work together. It’s quite fascinating that a person can use a traditional landline telephone to dial the telephone number of another person and establish a connection for a verbal conversation. Or even using a computer to send an email message to someone else, where the email message can be delivered to the intended recipient’s mailbox almost instantaneously compared to traditional <span class="No-Break">postal operations.</span></p>
			<p>Due to the curiosity of people around the world, the idea of disassembling a system to further understand its functions created the foundation of hacking. Early generations of hackers sought to understand how systems and devices work, and whether there was any flaw in the design that could be taken advantage of to alter the original function of the system. For instance, during the 1950s and 1960s in the United States, a security vulnerability was found in a telephone system that enabled users to manipulate/alter telephone signals to allow free long-distance calls. This technique was known as <strong class="bold">phreaking</strong> in the <a id="_idIndexMarker003"/>telecommunication industry. Specifically, a person could use whistles that operated at 2600 MHz to recreate signals that were used as the telephone routing signals, thus enabling free long-distance calling to anyone who exploited this flaw. However, telecommunication <a id="_idIndexMarker004"/>providers had implemented a solution known as <strong class="bold">Common Channel Interoffice Signaling</strong> (<strong class="bold">CCIS</strong>) that separated the signals from the voice channel. In this scenario, people discovered a security vulnerability in a system and exploited it to alter the operation of the system. However, the intention varied from one person to another, whether for fun, experimental, or even to gain free <span class="No-Break">long-distance calling.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">A <strong class="bold">vulnerability</strong> is<a id="_idIndexMarker005"/> commonly used to describe a security flaw or weakness in a system. An <strong class="bold">exploit</strong> is<a id="_idIndexMarker006"/> anything that can be used to take advantage of a security vulnerability. A <strong class="bold">threat</strong> is<a id="_idIndexMarker007"/> anything that has the potential to cause damage to a system. A <strong class="bold">threat actor</strong> or <strong class="bold">adversary</strong> is the person(s) who’s<a id="_idIndexMarker008"/> responsible for the cyber-attack or <a id="_idIndexMarker009"/>creating <span class="No-Break">a threat.</span></p>
			<p>A very<a id="_idIndexMarker010"/> common question that is usually asked is why someone would want to hack into another system or network. There are various motives behind each hacker, for instance, many hackers will break into systems for fun, to prove a point to others, to steal data from organizations, for financial gain by selling stolen data on the dark web, or even as a personal challenge. Whatever the reason is, hacking is illegal around the world as it involves using a computing system to cause harm or damage to <span class="No-Break">another system.</span></p>
			<p>While hacking seems all bad on mainstream media, it’s not all bad because cybersecurity professionals such as ethical hackers and penetration testers use similar techniques and tools to simulate real-world cyber-attacks on organizations’ networks with legal permission and intent to discover and resolve hidden security vulnerabilities before real cyber-attacks occur in the future. Ethical hackers are simply good people and are commonly referred to as <em class="italic">white-hat hackers</em> in the<a id="_idIndexMarker011"/> cybersecurity industry, who use their knowledge and skills to help organizations find and resolve their hidden security weaknesses and flaws prior to a real cyber-attack. Although threat actors and ethical hackers have similar skill sets, they have different moral compasses, with threat actors using their skills and abilities for malicious and illegal purposes and ethical hackers using their skills to help organizations defend themselves and safeguard their assets from <span class="No-Break">malicious hackers.</span></p>
			<p>The following are common types of threat actors and <span class="No-Break">their motives:</span></p>
			<ul>
				<li><strong class="bold">Advanced Persistent Threat (APT) groups</strong> – The <a id="_idIndexMarker012"/>members of an <a id="_idIndexMarker013"/>APT group design their attacks to be very stealthy and undetectable by most threat detection systems on a targeted network or system. The intention is to compromise the targeted organization and remain on its network while exploiting additional systems and <span class="No-Break">exfiltrating data.</span></li>
				<li><strong class="bold">Insider threats</strong> – This is <a id="_idIndexMarker014"/>an attacker who is inside the targeted organization’s<a id="_idIndexMarker015"/> network infrastructure. This can be a hacker who is employed within the company and is behind the organization’s security defense systems and has direct access to vulnerable machines. In addition, an insider threat can be a disgruntled employee who intends to cause harm to the network infrastructure of <span class="No-Break">the company.</span></li>
				<li><strong class="bold">State actors</strong> – These are<a id="_idIndexMarker016"/> cybersecurity professionals who are employed by a<a id="_idIndexMarker017"/> nation’s government to focus on national security and perform reconnaissance on other nations around <span class="No-Break">the world.</span></li>
				<li><strong class="bold">Hacktivists</strong> – These are<a id="_idIndexMarker018"/> persons who use their hacking skills to support a social or <a id="_idIndexMarker019"/>political agenda such as defacing websites and disrupting the availability of or access to <span class="No-Break">web servers.</span></li>
				<li><strong class="bold">Script kiddie</strong> – This type of <a id="_idIndexMarker020"/>hacker is a novice and lacks the technical expertise<a id="_idIndexMarker021"/> in the industry but follows the tutorials or instructions of experts to perform cyber-attacks on targeted systems. However, since this person does not fully understand the technicalities behind the attack, they can cause more damage than a <span class="No-Break">real hacker.</span></li>
				<li><strong class="bold">Criminal syndicates</strong> – This is an <a id="_idIndexMarker022"/>organized crime group that focuses on financial<a id="_idIndexMarker023"/> gain and each person has a specialized skill to improve the attack and increase the likelihood of success. Furthermore, this group is usually well funded to ensure they have access to <a id="_idIndexMarker024"/>the best <a id="_idIndexMarker025"/>tools that money <span class="No-Break">can buy.</span></li>
				<li><strong class="bold">White hat</strong> – These<a id="_idIndexMarker026"/> are cybersecurity professionals such as ethical hackers, penetration<a id="_idIndexMarker027"/> testers, and red teamers who use their skills to help organizations prevent cyber-attacks <span class="No-Break">and threats.</span></li>
				<li><strong class="bold">Gray hat</strong> – These are<a id="_idIndexMarker028"/> people who use their hacking skills for both good and bad. For<a id="_idIndexMarker029"/> instance, a gray hat threat actor could be a cybersecurity professional who uses their skills in their day job to help organizations and at night for <span class="No-Break">malicious reasons.</span></li>
				<li><strong class="bold">Black hat</strong> – These are <a id="_idIndexMarker030"/>typical threat<a id="_idIndexMarker031"/> actors who use their skills for <span class="No-Break">malicious reasons.</span></li>
			</ul>
			<p>Ethical hackers, penetration testers, and red team operators always need to obtain legal permission from authorities before engaging in simulating any type of real-world cyber-attacks and threats on their customers’ systems and network infrastructure, while ensuring they remain within scope. For instance, the following agreements need to be signed between the <a id="_idIndexMarker032"/>cybersecurity <a id="_idIndexMarker033"/>service provider and <span class="No-Break">the customer:</span></p>
			<ul>
				<li><strong class="bold">Non-Disclosure </strong><span class="No-Break"><strong class="bold">Agreement</strong></span><span class="No-Break"> (</span><span class="No-Break"><strong class="bold">NDA</strong></span><span class="No-Break">)</span></li>
				<li><strong class="bold">Statement of </strong><span class="No-Break"><strong class="bold">Work</strong></span><span class="No-Break"> (</span><span class="No-Break"><strong class="bold">SOW</strong></span><span class="No-Break">)</span></li>
				<li><strong class="bold">Master Service </strong><span class="No-Break"><strong class="bold">Agreement</strong></span><span class="No-Break"> (</span><span class="No-Break"><strong class="bold">MSA</strong></span><span class="No-Break">)</span></li>
				<li><strong class="bold">Permission </strong><span class="No-Break"><strong class="bold">of Attack</strong></span></li>
			</ul>
			<p>The NDA is <a id="_idIndexMarker034"/>commonly referred to as a <em class="italic">confidentiality agreement</em>, which <a id="_idIndexMarker035"/>specifies that the ethical hacker, penetration tester, or red teamer will not disclose, share, or hold on to any private, confidential, sensitive, or proprietary information that was discovered during the security assessment of the customer’s systems and <span class="No-Break">network infrastructure.</span></p>
			<p>However, the SOW <a id="_idIndexMarker036"/>documentation usually contains all the details about the type of security testing that will be performed by the ethical hacker/service provider for the customer and the scope of the security testing, such as the specific IP addresses and ranges. It’s extremely important that ethical hackers do not go beyond the scope of security testing for legal reasons. Furthermore, the SOW will contain the billing details, duration <a id="_idIndexMarker037"/>of the security testing, disclaimer and liability details, and deliverables to <span class="No-Break">the customer.</span></p>
			<p>The MSA<a id="_idIndexMarker038"/> is a general agreement that contains the payment details and terms, confidentiality and work standards of the provider, limitations and constraints, and delivery requirements. This type of agreement helps the cybersecurity service provider to reduce the time taken for any similar work that needs to be provided to either new or existing customers. In addition, the MSA document can be customized to fit the needs of each customer as they may require unique or <span class="No-Break">specialized services.</span></p>
			<p><em class="italic">Permission of attack</em> is a very <a id="_idIndexMarker039"/>important agreement for ethical hackers, penetration testers, and red teamers as it contains the legal authorization that is needed to perform the security testing on the customer’s systems and network infrastructure. Consider this agreement, in the form of a document, as the <em class="italic">get-out-of-jail card</em> that is <a id="_idIndexMarker040"/>signed by the legal authorities, which indicates the granting of permission to the service provider and its employee(s) who are performing ethical hacking and penetration testing services on the customer’s systems <span class="No-Break">and network.</span></p>
			<h2 id="_idParaDest-19"><a id="_idTextAnchor018"/>Mindset and skills of ethical hackers</h2>
			<p>Threat actors<a id="_idIndexMarker041"/> are always seeking new and advanced techniques to compromise their target’s systems and networks for legal purposes. For instance, there are different types of hackers and groups around the world, and each of these has its own motive and <a id="_idIndexMarker042"/>rationale for <span class="No-Break">their cyber-attacks:</span></p>
			<ul>
				<li>Personal accomplishment/challenge, such as proving they have the skills and capabilities to break into an organization and <span class="No-Break">its systems</span></li>
				<li>Financial gain, such as stealing confidential data from organizations and selling it on various dark <span class="No-Break">web marketplaces</span></li>
				<li>Supporting a social or political agenda such as defacing and compromising websites that are associated with a <span class="No-Break">social/political movement</span></li>
				<li>Cyber warfare, such as compromising <a id="_idIndexMarker043"/>the <strong class="bold">Industrial Control Systems</strong> (<strong class="bold">ICS</strong>) that manage the critical infrastructure of <span class="No-Break">a country</span></li>
			</ul>
			<p>While there are many cybersecurity companies around the world who are developing and improving solutions to help organizations defend and safeguard their assets from cyber criminals, attacks, and threats, there’s also a huge demand for cybersecurity professionals in the industry. It’s already noticeable through mainstream media platforms that it’s only a matter of time before another organization is the target of threat actors. In an online article published by the World Economic Forum on January 21, 2015, <em class="italic">What does the Internet of Everything mean for security?</em>, the former executive chairman and CEO of Cisco Systems, John Chambers, said, “<em class="italic">There are two types of companies: those who have been hacked, and those who don’t yet know they have been hacked.</em>” Each day, this<a id="_idIndexMarker044"/> statement is becoming more evident, and more of a reality, as many companies are reporting data breaches, and some reports indicate attackers were <em class="italic">living off the land</em> for many days or even months before the security incident was detected <span class="No-Break">and contained.</span></p>
			<p>The need for ethical hacking<a id="_idIndexMarker045"/> skills and knowledge is ever growing around the world, as leadership teams within small to large enterprises are realizing their assets need to be protected and ethical hackers and penetration testers can help discover and remediate hidden security vulnerabilities, reduce the attack surface, and improve the cyber defenses of their company against cyber criminals and threats. Ethical hackers have the same skill set and expertise as malicious attackers such as threat actors, however, the difference is their intention. Ethical hackers have a good moral compass and choose to use their skills for good reasons, whereas threat actors use their skills and knowledge for bad reasons, such as causing harm and damage to systems for <span class="No-Break">illegal purposes.</span></p>
			<p>The following are common <a id="_idIndexMarker046"/>technical skills of ethical hackers in the <span class="No-Break">cybersecurity industry:</span></p>
			<ul>
				<li>Administrative-level skills with various operating systems such as Windows <span class="No-Break">and Linux</span></li>
				<li>Solid foundational knowledge of networking, such as routing <span class="No-Break">and switching</span></li>
				<li>Understanding the fundamentals of common security principles and <span class="No-Break">best practices</span></li>
				<li>Familiar with programming <a id="_idIndexMarker047"/>languages such <a id="_idIndexMarker048"/>as Go and <a id="_idIndexMarker049"/>Python, and <a id="_idIndexMarker050"/>scripting languages such as Bash <span class="No-Break">and PowerShell</span></li>
				<li>Familiarity with virtualization, containerization, and <span class="No-Break">the cloud</span></li>
			</ul>
			<p>While the preceding list of foundational skills seems a bit intimidating, always remember the field of cybersecurity and learning is like a marathon and not a sprint. It’s not how quickly you can learn something, but ensuring you’re taking the time you need to fully understand and master <span class="No-Break">a topic.</span></p>
			<p>The following are non-technical skills<a id="_idIndexMarker051"/> of <span class="No-Break">ethical hackers:</span></p>
			<ul>
				<li>Being proficient in oral and written communication between technical and <span class="No-Break">non-technical persons</span></li>
				<li>Being an <span class="No-Break"><em class="italic">out-of-the-box</em></span><span class="No-Break"> thinker</span></li>
				<li>Being self-motivated and driven to learn about new topics and <span class="No-Break">expand knowledge</span></li>
				<li>Ensuring you understand the difference between using knowledge for good and <span class="No-Break">bad intentions</span></li>
			</ul>
			<p>Ethical hackers use the same techniques, tools, and procedures as real threat actors to meet their objectives and discover hidden security vulnerabilities in systems. There’s a proverb that says if you want to catch a thief, you need to think like one. This proverb applies to ethical hacking – if you want to find the security vulnerabilities that real hackers are able to discover and exploit, then you need to adapt your mindset while using the same techniques, tools, and procedures to help you do the same, with legal permission and <span class="No-Break">good intentions.</span></p>
			<p>The following<a id="_idIndexMarker052"/> diagram shows the EC-Council’s five stages of <span class="No-Break">ethical hacking:</span></p>
			<div>
				<div id="_idContainer008" class="IMG---Figure">
					<img src="image/Figure_1.1_B19448.jpg" alt="Figure 1.1 – Stages of hacking"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.1 – Stages of hacking</p>
			<p>As shown in<a id="_idIndexMarker053"/> the preceding diagram, ethical hackers and threat actors start with reconnaissance on their target, then move on to scanning and enumeration, then onward to gaining access and establishing a foothold in the system by maintaining access, and then covering tracks to remove any evidence of an attack. Since this book is based on the concept of <em class="italic">Reconnaissance for Ethical Hackers</em>, we’ll focus on reconnaissance, scanning, and enumeration during the course <span class="No-Break">of it.</span></p>
			<h1 id="_idParaDest-20"><a id="_idTextAnchor019"/>The importance of reconnaissance</h1>
			<p>The first phase of ethical hacking is <strong class="bold">reconnaissance</strong> – the techniques and procedures that are used by the ethical hacker to <a id="_idIndexMarker054"/>collect as much information as possible about the target to determine their network infrastructure, cyber defenses, and security vulnerabilities that can be compromised to gain unauthorized access and improve attack operations accordingly. From a military perspective, reconnaissance plays an important role in planning and launching an attack on a target. Collecting information about the target helps the attacker to determine the points of entry, type of infrastructure, assets owned, and the target’s strengths <span class="No-Break">and weaknesses.</span></p>
			<p>To put it simply, reconnaissance helps ethical hackers to gain a deeper understanding of an organization’s systems and network infrastructure before launching an attack. The collected information can be leveraged to identify any security vulnerabilities that can be exploited, thus enabling the ethical hacker to compromise and gain a foothold in the targeted systems. For instance, using reconnaissance techniques enables the ethical hacker to identify any running services and open ports and the service and software versions on a system, all of which can be used to identify and determine potential attack vectors on <span class="No-Break">the </span><span class="No-Break"><a id="_idIndexMarker055"/></span><span class="No-Break">target.</span></p>
			<p>In addition, using reconnaissance techniques such as <strong class="bold">Open Source Intelligence</strong> (<strong class="bold">OSINT</strong>) enables the ethical <a id="_idIndexMarker056"/>hacker to passively collect information about their target that’s publicly available on the internet. Such information may contain usernames, email addresses, and job titles of employees of the targeted organization. This information can be leveraged to create various <em class="italic">social engineering</em> attacks and <em class="italic">phishing</em> email campaigns that are sent to specific employees within the <span class="No-Break">targeted company.</span></p>
			<p>The following screenshot shows an example of employees’ information that’s publicly available on <span class="No-Break">the internet:</span></p>
			<div>
				<div id="_idContainer009" class="IMG---Figure">
					<img src="image/Figure_1.2_B19448.jpg" alt="Figure 1.2 – Employees’ data"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.2 – Employees’ data</p>
			<p>As shown in the <a id="_idIndexMarker057"/>preceding screenshot, these are various employees of a specific organization. Their names, email addresses, and job titles are publicly known on the internet. A threat actor could look for patterns in their email addresses to determine the format that’s used for all employees of the company. For instance, let’s imagine there’s an employee whose name is John Doe and his email address is <strong class="source-inline">jdoe@companyname.com</strong> and another employee is Jane Foster with an email address of <strong class="source-inline">jfoster@companyname.com</strong>. This information shows a pattern and format for employees within the same organization: <strong class="source-inline">{f}{lastname}@domain-name.com</strong>, where <strong class="source-inline">f</strong> is the initial letter of the person’s first name followed by their last name and the company’s domain name. Such information can help an ethical hacker to send phishing email campaigns to specific email addresses of high-profile employees of the <span class="No-Break">targeted organization.</span></p>
			<p>Reconnaissance helps organizations to reduce the risk of being compromised by a threat actor and improve their cyber defenses. By enabling an ethical hacker to perform reconnaissance techniques and procedures on an organization’s systems and network infrastructure, the organization can efficiently identify security vulnerabilities and take the necessary measures to remediate and resolve them before they are discovered and exploited by adversaries. Furthermore, reconnaissance helps organizations to both identify and keep track of potential threat actors, enabling the company to gain a better understanding of the cybersecurity threat landscape while implementing and improving proactive countermeasures to safeguard their assets, systems, and networks. Hence, reconnaissance is not only important to adversaries but cybersecurity professionals use the gathered information<a id="_idIndexMarker058"/> to <span class="No-Break">help organizations.</span></p>
			<p>Reconnaissance is divided into the <span class="No-Break">following types:</span></p>
			<ul>
				<li><span class="No-Break"><strong class="bold">Passive reconnaissance</strong></span></li>
				<li><span class="No-Break"><strong class="bold">Active reconnaissance</strong></span></li>
			</ul>
			<p>Passive reconnaissance<a id="_idIndexMarker059"/> enables the ethical hacker to leverage OSINT techniques <a id="_idIndexMarker060"/>to gather information that’s publicly available<a id="_idIndexMarker061"/> from various sources on the internet<a id="_idIndexMarker062"/> without making direct contact with <span class="No-Break">the target.</span></p>
			<p>The following are<a id="_idIndexMarker063"/> some examples of OSINT <span class="No-Break">data sources:</span></p>
			<ul>
				<li><span class="No-Break">Job websites</span></li>
				<li><span class="No-Break">Online forums</span></li>
				<li>Social <span class="No-Break">media platforms</span></li>
				<li>Company <span class="No-Break">registry websites</span></li>
				<li>Public <strong class="bold">Domain Name System</strong> (<span class="No-Break"><strong class="bold">DNS</strong></span><span class="No-Break">) servers</span></li>
			</ul>
			<p>It’s important for ethical hackers to use similar techniques and procedures as adversaries during their security assessments to provide real-world experience to their customers. In addition, it also helps the organization to determine whether its security team and solutions are able to detect any security intrusions that are created by the ethical hacker. If the security team were unable to detect any actions that were performed during the ethical hacking and penetration testing assessment, it’s a good sign for the ethical hacker as their techniques were stealthy enough to bypass and evade any threat detection systems on the network. However, this means the organization’s security team needs to improve their threat monitoring and detection strategies and tune their sensors to catch any <span class="No-Break">security-related anomalies.</span></p>
			<p>Active reconnaissance<a id="_idIndexMarker064"/> involves a more direct approach by the <a id="_idIndexMarker065"/>threat actor and ethical hacker to gather information about the target. In active reconnaissance, the ethical hacker uses scanning and enumeration techniques and tools to obtain specific details about the targeted systems and networks. For instance, to determine running services and open ports on a server, the ethical hacker can use a network and port scanning tool such as <strong class="bold">Nmap</strong> to perform<a id="_idIndexMarker066"/> host discovery on a network. However, active reconnaissance increases the risk of triggering security sensors and alerting the security team about a possible reconnaissance-based attack <span class="No-Break">being performed.</span></p>
			<p>In the next section, you will learn how cybersecurity professionals, including ethical hackers, leverage the information that is collected during reconnaissance to help organizations improve their security posture and manage their <span class="No-Break">attack surfaces.</span></p>
			<h1 id="_idParaDest-21"><a id="_idTextAnchor020"/>Understanding attack surface management</h1>
			<p>The <strong class="bold">attack surface</strong> is<a id="_idIndexMarker067"/> simply the number of potential security vulnerabilities that can be exploited to gain access to a system, network, and organization using attack vectors. If organizations are unable to identify their security vulnerabilities and implement countermeasures, they are simply leaving themselves susceptible and exposed to cyber-attacks and threats. <strong class="bold">Attack Surface Management</strong> (<strong class="bold">ASM</strong>) is not a new study <a id="_idIndexMarker068"/>in the cybersecurity industry, rather it’s a new focus for cybersecurity professionals and organizations around the world. ASM is a strategy that’s used by cybersecurity professionals that enables them to focus on identifying, analyzing, and reducing the attack surface of an organization. As a result, by reducing the attack surface of an organization, it reduces the risk of being compromised by cyber-attacks and threats while safeguarding its assets, resources, and <span class="No-Break">sensitive information.</span></p>
			<p>Adopting ASM within an organization enables the security team to identify and prioritize security vulnerabilities based on their vulnerability score and potential impact. The <strong class="bold">Common Vulnerability Scoring System</strong> (<strong class="bold">CVSS</strong>) is commonly<a id="_idIndexMarker069"/> referenced within many vulnerability scanning tools to provide vulnerability of between <strong class="source-inline">0</strong> and <strong class="source-inline">10</strong>, where <strong class="source-inline">0</strong> is the least impact and <strong class="source-inline">10</strong> is critical. These scores help cybersecurity professionals to apply high priority and resources to remediate security vulnerabilities with <span class="No-Break">higher severity.</span></p>
			<p>For instance, the following screenshot shows the base metrics of the <span class="No-Break">CVSS calculator:</span></p>
			<div>
				<div id="_idContainer010" class="IMG---Figure">
					<img src="image/Figure_1.3_B19448.jpg" alt="Figure 1.3 – CVSS calculator"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.3 – CVSS calculator</p>
			<p>As shown in the <a id="_idIndexMarker070"/>preceding snippet, the metrics within the base score influence the vulnerability score. For instance, if an attacker can compromise a security vulnerability on a targeted system over a network, where the attack complexity is low and does not require any user interaction or escalated privileges, where the impact will greatly affect the confidentiality and integrity of the system, the CVSS calculator provides a vulnerability score of 9.4. Keep in mind, these scores are assigned to a vulnerability based on the criticality and impact on <span class="No-Break">the system.</span></p>
			<p class="callout-heading">Tip</p>
			<p class="callout">To learn more about the <a id="_idIndexMarker071"/>CVSS calculator, please <span class="No-Break">see </span><a href="https://www.first.org/cvss/calculator/3.1"><span class="No-Break">https://www.first.org/cvss/calculator/3.1</span></a><span class="No-Break">.</span></p>
			<p>The following snippet shows the results of a Nessus vulnerability scan, displaying the number of security flaws and <span class="No-Break">their scores:</span></p>
			<div>
				<div id="_idContainer011" class="IMG---Figure">
					<img src="image/Figure_1.4_B19448.jpg" alt="Figure 1.4 – Nessus scan results"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.4 – Nessus scan results</p>
			<p>As shown in the preceding snippet, the CVSS scores were referenced from the <span class="No-Break">CVSS calculator.</span></p>
			<p>It’s important to recognize that cybersecurity professionals may identify a security vulnerability that is critical to the operation of the organization and its business processes but has a low potential impact. There can be security vulnerabilities that are less critical to the operation of the business but have a greater potential impact if they’re exploited by a threat actor. Therefore, ASM <a id="_idIndexMarker072"/>helps organizations in prioritizing security vulnerabilities based on their impact levels while allocating their resources to remediating the most critical security <span class="No-Break">vulnerabilities first.</span></p>
			<p>Additionally, organizations that implement ASM are able to better identify and track changes to their attack surfaces. For instance, if an organization installs a new update to an existing system, this new update could introduce new security vulnerabilities and potentially change the attack surface, enabling a threat actor to use new techniques to compromise the system. Similarly, if an organization implements a new system or application on its network infrastructure, it has the potential of bringing new security flaws to the attack surface. However, ASM enables cybersecurity professionals to track changes that are being made to the attack surface of the organization while ensuring the security team is aware of any new security vulnerabilities that are introduced during this process. Furthermore, the organization can take the necessary actions to remediate these security vulnerabilities before they can be exploited by a <span class="No-Break">threat actor.</span></p>
			<p>Another benefit of <a id="_idIndexMarker073"/>ASM is its capability of helping organizations efficiently monitor their attack surface and identify any suspicious activities. This improves real-time threat detection and response within the company, enabling the security team to take immediate action to prevent, contain, or remediate the threat from systems and networks. Lastly, when ASM is implemented properly, it helps security teams to identify whether any malicious activities or threats that evaded security solutions have gone undetected on their systems <span class="No-Break">and networks.</span></p>
			<p>The following are the major benefits <a id="_idIndexMarker074"/>of ASM within the <span class="No-Break">cybersecurity industry:</span></p>
			<ul>
				<li><strong class="bold">Reducing risk</strong> – Organizations that adopted ASM are able to identify and reduce their own attack surfaces, thereby reducing the risk of potential cyber-attacks and threats, and protecting their assets from threat actors. Hence, by identifying and remediating security vulnerabilities, it becomes more difficult for threat actors to compromise systems and gain <span class="No-Break">a foothold.</span></li>
				<li><strong class="bold">Prioritization</strong> – ASM helps companies to prioritize their resources to remediate security vulnerabilities that are more critical <span class="No-Break">than others.</span></li>
				<li><strong class="bold">Continuous monitoring</strong> – For organizations to ensure their attack surface is small, continuous monitoring and maintenance are needed. This helps both cybersecurity professionals and organizations to always be aware of any new security vulnerability that may exist, either due to a new implementation or an upgrade to a system, therefore, taking the necessary actions needed to mitigate any security vulnerabilities before they can <span class="No-Break">be exploited.</span></li>
				<li><strong class="bold">Improving incident response</strong> – ASM helps security teams to efficiently identify and respond to security incidents on their network in real time, as a result, reducing the impact and spread of <span class="No-Break">a threat.</span></li>
				<li><strong class="bold">Compliance</strong> – There are regulatory standards and frameworks that are needed within organizations that operate in certain industries. For instance, organizations that operate in the payment card industry need to ensure their systems and networks are <a id="_idIndexMarker075"/>compliant with the <strong class="bold">Payment Card Industry Data Security Standard</strong> (<strong class="bold">PCI DSS</strong>). Being compliant means the organization’s systems and networks have the specific security controls in place to ensure data <span class="No-Break">is protected.</span></li>
				<li><strong class="bold">Cost-effectiveness</strong> – Since <a id="_idIndexMarker076"/>ASM helps organizations to improve the identification and remediation of security vulnerabilities, it reduces the risk of data breaches and increases the availability of systems that are critical to <span class="No-Break">the organization.</span></li>
			</ul>
			<p>The following are key steps that organizations and cybersecurity professionals can use to get started <span class="No-Break">with ASM:</span></p>
			<ol>
				<li><strong class="bold">Asset management</strong> – Ensure <a id="_idIndexMarker077"/>all assets within your organization are properly tracked and entered into your inventory. These may include computers, servers, applications, and mobile devices. This helps organizations to better understand which assets are to be protected and identify security flaws <span class="No-Break">in them.</span></li>
				<li><strong class="bold">Identifying and mapping the attack surface</strong> – At this stage, the cybersecurity professionals are to identify security vulnerabilities and map the attack surface of the organization. This stage includes potential attack vectors that could be used to deliver an exploit and points of entry such as open ports and vulnerable running services on systems <span class="No-Break">and networks.</span></li>
				<li><strong class="bold">Assessing risk</strong> – This stage focuses on assessing the risk of each security vulnerability and its impact on the organization. This phase helps with prioritizing and focusing on the most critical security vulnerabilities, then on less <span class="No-Break">critical vulnerabilities.</span></li>
				<li><strong class="bold">Implementing security controls</strong> – This phase focuses on implementing security controls and solutions to remediate and mitigate security vulnerabilities that were identified in the previous stages. Here, the security team will implement network security devices, threat monitoring and prevention solutions, network segmentation, and <span class="No-Break">so on.</span></li>
				<li><strong class="bold">Monitoring and maintenance</strong> – For ASM to be effective, continuous monitoring of all assets, systems, and devices is required. It’s important to continuously monitor and maintain security controls that are responsible for mitigating cyber-attacks and threats from exploiting security vulnerabilities. In addition, continuous monitoring and maintenance help ensure security controls are effective in safeguarding the assets of <span class="No-Break">the organization.</span></li>
				<li><strong class="bold">Continuously perform reconnaissance</strong> – To identify new security vulnerabilities on the attack surface, organizations need to continuously perform reconnaissance on their assets, systems, and network infrastructure. Once new<a id="_idIndexMarker078"/> security vulnerabilities are identified, the lifecycle of ASM is repeated, taking the necessary steps to mitigate the <span class="No-Break">security risk.</span></li>
			</ol>
			<p>In addition to using the preceding key steps, there are several tools that will help both cybersecurity professionals and organizations <span class="No-Break">with ASM:</span></p>
			<ul>
				<li><strong class="bold">Vulnerability scanners</strong> – These are <a id="_idIndexMarker079"/>specialized, automated tools that help cybersecurity professionals identify security vulnerabilities in a system and<a id="_idIndexMarker080"/> provide recommendations on how to remediate the issue. Furthermore, these tools provide severity ratings, vulnerability scores, and <span class="No-Break">potential impact.</span></li>
				<li><strong class="bold">Network scanners and mappers</strong> – This type of tool helps cybersecurity and networking professionals to determine live hosts, open service ports, and running applications on host devices. In addition, they help organizations to map their entire network<a id="_idIndexMarker081"/> infrastructure and identify unauthorized devices that are connected to the <span class="No-Break">company’s network.</span></li>
				<li><strong class="bold">Configuration management tools</strong> – This <a id="_idIndexMarker082"/>type of tool helps organizations track and manage their configurations on systems and networks. It also helps cybersecurity professionals to identify new security vulnerabilities such as misconfigurations that are introduced onto a device after a <span class="No-Break">new change.</span></li>
				<li><strong class="bold">Application security testing tools</strong> – These are specialized tools that are commonly used by cybersecurity <a id="_idIndexMarker083"/>professionals to perform security testing on applications and software to identify any unknown <span class="No-Break">security flaw.</span></li>
				<li><strong class="bold">Attack Surface Reduction</strong> (<strong class="bold">ASR</strong>) tools – These tools are designed to help organizations reduce their attack <a id="_idIndexMarker084"/>surfaces. It works by identifying and denying any malicious network traffic and disabling unnecessary services on systems <span class="No-Break">and protocols.</span></li>
				<li><strong class="bold">Risk management tools</strong> – Risk <a id="_idIndexMarker085"/>management tools enable organizations to both track and manage the risk as it’s associated with their attack surface. Furthermore, this tool helps cybersecurity professionals to monitor the effectiveness of the security controls that are in place to prevent cyber-attacks <span class="No-Break">and threats.</span></li>
				<li><strong class="bold">Security Information and Event Management</strong> (<strong class="bold">SIEM</strong>) – This is a security solution that<a id="_idIndexMarker086"/> collects, aggregates, and analyzes security-related log messages generated from<a id="_idIndexMarker087"/> systems and devices within an organization to identify any potential cyber-attack and threat in <span class="No-Break">real time.</span></li>
			</ul>
			<p>While these tools are simply recommendations, it’s important to remember no single tool has the capability of providing complete coverage of the attack surface of an organization. Therefore, a combination of different tools, techniques, and procedures is required to ensure the organization can effectively manage its attack surface. Furthermore, as many tools are software-based, it’s important they are regularly updated to ensure they have the capability of detecting the latest security vulnerabilities and threats in <span class="No-Break">the industry.</span></p>
			<p>In the next section, you will learn about the tactics, techniques, and procedures that are used by adversaries during the reconnaissance phase of <span class="No-Break">a cyber-attack.</span></p>
			<h1 id="_idParaDest-22"><a id="_idTextAnchor021"/>Reconnaissance tactics, techniques, and procedures</h1>
			<p>As you have learned thus far, before an adversary launches an attack against an organization, they need to perform reconnaissance to gather as much information as possible on the target to determine its attack surface (points of entry). While there are many techniques that are used by both threat actors and ethical hackers, MITRE has created its <a id="_idIndexMarker088"/>well-known <strong class="bold">MITRE ATT&amp;CK</strong> framework, which outlines the <strong class="bold">Tactics, Techniques, and Procedures</strong> (<strong class="bold">TTPs</strong>) of <a id="_idIndexMarker089"/>adversaries that are based on real-world events. These TTPs are commonly used by cybersecurity professionals, researchers, and organizations to both develop and improve their threat modeling and <span class="No-Break">cyber defenses.</span></p>
			<p>MITRE ATT&amp;CK includes reconnaissance TTPs that help us to better understand the methods that are used by adversaries to collect information about their targets prior to launching an attack. These TTPs are also used by ethical hackers to efficiently identify security vulnerabilities and how a threat actor could compromise the attack surface of their client’s <span class="No-Break">network infrastructure.</span></p>
			<p>The following are common reconnaissance TTPs that are used <span class="No-Break">by adversaries:</span></p>
			<ul>
				<li><strong class="bold">Active scanning</strong> – During<a id="_idIndexMarker090"/> active scanning, adversaries use various scanning tools to collect information about<a id="_idIndexMarker091"/> the target that can be leveraged in future operations. These scanning tools send special probes to targeted systems and networks to determine live hosts, operating systems, open ports, and running services on the host machine. Active scanning is an active reconnaissance technique that involves scanning IP network blocks and public IP addresses of the target, vulnerability scanning to identify security weaknesses that can be exploited, and wordlist scanning to retrieve possible passwords for future password-based attacks against <span class="No-Break">the target.</span></li>
				<li><strong class="bold">Gathering victim host information</strong> – This technique enables the attacker to collect specific details about the <a id="_idIndexMarker092"/>target’s devices such as their hostnames, IP addresses, device types/roles, configurations, and operating systems. Additionally, the adversary is able to collect hardware, software, and client configuration details that can be used to improve the plan of attack. This technique involves using a combination of both active and passive reconnaissance as a threat actor can gain a lot of intelligence from OSINT alone and can perform active reconnaissance to identify specific details that are not easily available on <span class="No-Break">the internet.</span></li>
				<li><strong class="bold">Gathering victim identity information</strong> – This technique focuses on collecting details about the<a id="_idIndexMarker093"/> target’s identity – personal data such as employees’ names, email addresses, job titles, and users’ credentials. This type of information can be collected using passive reconnaissance and leveraged for future social engineering attacks and gaining access to the <span class="No-Break">target’s systems.</span></li>
				<li><strong class="bold">Gathering victim network information</strong> – Adversaries can use passive reconnaissance techniques to <a id="_idIndexMarker094"/>collect information on the target’s network infrastructure such as IP ranges, domain names, domain registrar details (physical addresses, email addresses, and telephone numbers), and DNS records. However, active reconnaissance techniques will help the attacker to better identify the target’s network topology, networking devices, and security appliances. Such information helps the adversary to better understand the target’s <span class="No-Break">network infrastructure.</span></li>
				<li><strong class="bold">Gathering victim organization information</strong> – This technique enables adversaries to collect <a id="_idIndexMarker095"/>specific information about the target’s organization such as names of departments, business operations and processes, and employees’ roles and responsibilities. Such information can be collected using passive reconnaissance. Furthermore, adversaries use this technique to determine physical locations, business relations, and <span class="No-Break">operating hours.</span></li>
				<li><strong class="bold">Phishing for information</strong> – Adversaries<a id="_idIndexMarker096"/> send phishing email messages to employees of the target organization with the intention of tricking a victim into performing an action such as downloading and installing malware on their system or even revealing sensitive information such as their user credentials. Adversaries can use spear phishing services from online service providers, insert malicious attachments in email messages, and insert obfuscated links within the body of the email message. Since the attacker is using a direct approach, this is an active <span class="No-Break">reconnaissance technique.</span></li>
				<li><strong class="bold">Searching closed sources</strong> – The <a id="_idIndexMarker097"/>adversary may attempt to collect information about the target from closed sources, where the information is available as a paid subscription (passive reconnaissance). Such information includes threat intel vendors such as private details from threat intelligence sources that can be used to compromise the target. Furthermore, adversaries can purchase information about the target from <em class="italic">Dark Web</em> <span class="No-Break">marketplaces/black markets.</span></li>
				<li><strong class="bold">Searching open technical databases</strong> – There are many public online sources that enable anyone to collect<a id="_idIndexMarker098"/> information about a target. This technique focuses on leveraging public information that can be used to improve the plan of attack against an organization. For instance, the adversary can leverage public DNS records, WHOIS data (domain registration details), digital certificates (help identify sub-domains), and public databases that contain IP addresses, open ports, and server banner details about the target. This is another passive reconnaissance technique to collect information about <span class="No-Break">the target.</span></li>
				<li><strong class="bold">Searching open websites and domains</strong> – Adversaries use this technique to search various online websites <a id="_idIndexMarker099"/>and platforms such as social media, internet search engines, and code repositories (such as GitHub) to collect information that can be used to compromise the target. Searching open websites and domains is another passive reconnaissance technique for collecting <span class="No-Break">public information.</span></li>
				<li><strong class="bold">Searching victim-owned websites</strong> – This technique is used by the adversary to search the target’s<a id="_idIndexMarker100"/> websites for any details that can be leveraged, such as organizational details, physical locations, email addresses of employees, high-profile employees, and even employees’ names and contact details. This is an active reconnaissance technique since the attacker establishes a direct connection to the <span class="No-Break">target’s asset.</span></li>
			</ul>
			<p>These are common strategies used by threat actors, and it helps ethical hackers to efficiently identify security vulnerabilities within organizations. Additionally, keep in mind that reconnaissance TTPs are continuously expanding as adversaries are developing new techniques and tools to compromise organizations. However, cybersecurity professionals and organizations can leverage reconnaissance TTPs to improve cyber defenses, identify and remediate security vulnerabilities, and reduce their attack surface and risk of <span class="No-Break">a cyber-attack.</span></p>
			<h1 id="_idParaDest-23"><a id="_idTextAnchor022"/>Summary</h1>
			<p>In this chapter, you have learned the importance of ethical hacking and how it helps organizations to improve their security posture. You have also discovered why threat actors spend a lot of time collecting information about their targets and how it can be leveraged to identify security vulnerabilities. Furthermore, you have learned why ethical hackers use similar techniques and strategies to help organizations identify and remediate their security vulnerabilities before a real <span class="No-Break">cyber-attack occurs.</span></p>
			<p>In addition, you have explored the need for attack surface management within the cybersecurity industry and how it helps organizations improve their defenses against cyber-attacks and threats. Lastly, you have gained an insight into reconnaissance TTPs that are commonly observed around the world as it helps security professionals and organizations to improve their threat modeling and strategies in safeguarding their assets from <span class="No-Break">cyber criminals.</span></p>
			<p>I hope this chapter has been informative for you and helpful on your journey in the cybersecurity industry. In the next chapter, <em class="italic">Setting Up a Reconnaissance Lab</em>, you will learn how to construct a security lab environment that will be safe for performing active reconnaissance and vulnerability assessments on your <span class="No-Break">personal computer.</span></p>
			<h1 id="_idParaDest-24"><a id="_idTextAnchor023"/>Further reading</h1>
			<ul>
				<li>Basics of footprinting and <span class="No-Break">reconnaissance: </span><a href="https://www.eccouncil.org/cybersecurity-exchange/ethical-hacking/basics-footprinting-reconnaissance/"><span class="No-Break">https://www.eccouncil.org/cybersecurity-exchange/ethical-hacking/basics-footprinting-reconnaissance/</span></a></li>
				<li>Attack surface <span class="No-Break">management: </span><a href="https://www.crowdstrike.com/cybersecurity-101/attack-surface-management/"><span class="No-Break">https://www.crowdstrike.com/cybersecurity-101/attack-surface-management/</span></a></li>
				<li>MITRE <span class="No-Break">Reconnaissance: </span><a href="https://attack.mitre.org/tactics/TA0043/"><span class="No-Break">https://attack.mitre.org/tactics/TA0043/</span></a></li>
				<li>What does the Internet of Everything mean for <span class="No-Break">security?: </span><a href="https://www.weforum.org/agenda/2015/01/companies-fighting-cyber-crime/"><span class="No-Break">https://www.weforum.org/agenda/2015/01/companies-fighting-cyber-crime/</span></a></li>
			</ul>
		</div>
	</body></html>