<html><head></head><body>
		<div id="_idContainer155">
			<h1 id="_idParaDest-61" class="chapter-number"><a id="_idTextAnchor060"/>4</h1>
			<h1 id="_idParaDest-62"><a id="_idTextAnchor061"/>Domain and DNS Intelligence</h1>
			<p>As the internet continues to grow, there’s more access to information. <strong class="bold">Open Source Intelligence</strong> (<strong class="bold">OSINT</strong>) can be collected from any publicly available sources, such as the internet. Hackers collect OSINT about their target to help improve the <strong class="bold">Tactics, Techniques, and Procedures</strong> (<strong class="bold">TTPs</strong>) for their cyber-attack and operations. Hence, it’s important for cybersecurity professionals such as ethical hackers and penetration testers to have a solid understanding of how an adversary can collect and leverage OSINT, with the intention of the ethical hacker to use the same TTPs to help reduce the risk of a cyber-attack or threat and improve the cyber defenses of <span class="No-Break">their organization.</span></p>
			<p>Throughout the course of this chapter, you will learn about and gain practical skills commonly used by ethical hackers and penetration testers to gather publicly available information from various online sources and use popular techniques and tools to efficiently profile an organization. You will learn how to leverage data collected from internet search engines, acquire domain intelligence, identify sub-domains from organizations, and perform <strong class="bold">Domain Name System</strong> (<span class="No-Break"><strong class="bold">DNS</strong></span><span class="No-Break">) reconnaissance.</span></p>
			<p>In this chapter, we will cover the <span class="No-Break">following topics:</span></p>
			<ul>
				<li>Leveraging search engines <span class="No-Break">for OSINT</span></li>
				<li><span class="No-Break">Domain intelligence</span></li>
				<li><span class="No-Break">Discovering sub-domains</span></li>
				<li><span class="No-Break">DNS reconnaissance</span></li>
			</ul>
			<p>Let’s <span class="No-Break">dive in!</span></p>
			<h1 id="_idParaDest-63"><a id="_idTextAnchor062"/>Technical requirements</h1>
			<p>To follow along with the exercises in this chapter, please ensure that you have met the following hardware and <span class="No-Break">software requirements:</span></p>
			<ul>
				<li>Kali <span class="No-Break">Linux: </span><a href="https://www.kali.org/get-kali/"><span class="No-Break">https://www.kali.org/get-kali/</span></a></li>
			</ul>
			<h1 id="_idParaDest-64"><a id="_idTextAnchor063"/>Leveraging search engines for OSINT</h1>
			<p>The internet is the largest network in the world, and navigating and finding resources can be challenging at times, <a id="_idIndexMarker331"/>especially if <a id="_idIndexMarker332"/>we don’t know the domain name or <strong class="bold">Uniform Resource Locator</strong> (<strong class="bold">URL</strong>) of a specific website. To help <a id="_idIndexMarker333"/>us quickly find the right domain name for a website, we can use an internet search engine. Internet search engines crawl and index everything on the internet, which enables a person to perform an internet search using keywords to find all relevant resources while providing <span class="No-Break">safe results.</span></p>
			<p>Without internet search engines, a person needs to know the right domain name, hostname, or URL for the website they want to visit. For instance, imagine a world without internet search engines; each person would need to keep an up-to-date record of each new website and its IP address. If an organization changed its domain name, perhaps due to rebranding, the information would need to be shared with all internet subscribers. However, since the world is a very large place, the update may not reach everyone immediately, and some people may attempt to connect to the old domain name, which may not resolve to the new domain <span class="No-Break">or website.</span></p>
			<p>Hence, internet search engines play an important role on the internet by crawling billions of domain names, websites, and their pages using web crawlers. Web crawlers (bots or spiders) enable the internet search engine provider to navigate the internet, download each web page, and follow web links to efficiently discover new websites and pages that are available on the internet. Hence, internet search engines are tools to help us find and collect intelligence about an organization. As ethical hackers, we can use various internet search engines to find and collect information about our organization and determine what the company has exposed through <span class="No-Break">data leaks.</span></p>
			<p>The following <a id="_idIndexMarker334"/>are common internet <span class="No-Break">search engines:</span></p>
			<ul>
				<li><span class="No-Break">Google: </span><a href="https://www.google.com/"><span class="No-Break">https://www.google.com/</span></a></li>
				<li><span class="No-Break">Yahoo!: </span><a href="https://www.yahoo.com/"><span class="No-Break">https://www.yahoo.com/</span></a></li>
				<li><span class="No-Break">Bing: </span><a href="https://www.bing.com/"><span class="No-Break">https://www.bing.com/</span></a></li>
				<li><span class="No-Break">DuckDuckGo: </span><a href="https://duckduckgo.com/"><span class="No-Break">https://duckduckgo.com/</span></a></li>
				<li><span class="No-Break">Yandex: </span><a href="https://yandex.com/"><span class="No-Break">https://yandex.com/</span></a></li>
			</ul>
			<p class="callout-heading">Important note</p>
			<p class="callout">The DuckDuckGo internet search engine focuses on privacy and does not store the user’s internet searches <a id="_idIndexMarker335"/>or track their browser. Yandex is a Russian-based internet search engine <a id="_idIndexMarker336"/>that focuses on content within the Asia and <span class="No-Break">Europe regions.</span></p>
			<p>A typical person may choose one of the preceding internet search engines, perform an internet search using a keyword(s), and will most likely click on a link on the first page of the search results. As an ethical hacker, it’s important to understand that page 1 of the search results usually provides the most accurate data based on the search criteria; however, checking through page 2 and onward will provide additional information that may be meaningful to us about the target. Since internet search engines collect and record data, it’s essential to examine all the search results for any connections to the <span class="No-Break">targeted organization.</span></p>
			<p>In addition, each internet search engine uses a unique algorithm for how they crawl and index websites <a id="_idIndexMarker337"/>on the internet. As an ethical hacker, <a id="_idIndexMarker338"/>using only one internet search engine may not provide the same results that another internet search engine may provide. For instance, if you’re looking for specific data about a target, one internet search engine may not provide it due to its algorithm, while another may provide it to you. Hence, it’s recommended to always use multiple internet search engines to collect and analyze data found on the first 10 pages of each internet search engine’s <span class="No-Break">result pages.</span></p>
			<p>On many websites, you will find a <strong class="source-inline">robots.txt</strong> file that contains a list of directories. This file is commonly used by web administrators to allow or disallow the indexing of specific directories of a website by internet web crawlers. For instance, if a web administrator wanted to prevent internet search engines from indexing and displaying the administrator portal of their website to anyone searching the organization’s domain name, they could insert a <strong class="source-inline">disallow /administrator/</strong> statement within the <span class="No-Break"><strong class="source-inline">robots.txt</strong></span><span class="No-Break"> file.</span></p>
			<p>The following screenshot shows the contents of a sample <span class="No-Break"><strong class="source-inline">robots.txt</strong></span><span class="No-Break"> file:</span></p>
			<div>
				<div id="_idContainer098" class="IMG---Figure">
					<img src="image/B19448_04_01.jpg" alt="Figure 4.1 – robots.txt file"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.1 – robots.txt file</p>
			<p>As shown in the preceding screenshot, the <strong class="source-inline">robots.txt</strong> file seems to contain a listing of sensitive directories that <a id="_idIndexMarker339"/>should not appear on internet searches. Since the <strong class="source-inline">robots.txt</strong> file is publicly available on a website, ethical hackers can collect and analyze the data <a id="_idIndexMarker340"/>found within it to discover hidden <a id="_idIndexMarker341"/>directories of a target, which can be used to plan future operations. Furthermore, visiting each hidden directory may lead to discovering additional data leaks and resources exposed by <span class="No-Break">an organization.</span></p>
			<p>However, since you’ll be directly accessing the <strong class="source-inline">robots.txt</strong> file on the target’s website, this is a form of active reconnaissance, and the target will know you’ve made contact. Therefore, it’s always recommended to anonymize your internet traffic to help conceal your online identity and reduce your threat level during the <span class="No-Break">reconnaissance phase.</span></p>
			<h2 id="_idParaDest-65"><a id="_idTextAnchor064"/>Google hacking techniques</h2>
			<p><strong class="bold">Google hacking</strong> (<strong class="bold">dorking</strong>) is a <a id="_idIndexMarker342"/>common technique used by ethical hackers to leverage Google’s internet search algorithm to find sensitive information about people, places, organizations, and other things on the internet. The term <em class="italic">Google hacking</em> does not mean we’re actually hacking into Google’s infrastructure or systems in any way; it is simply a term that’s used to describe how we are leveraging the power of Google’s search engine to find specific details about our target without performing <span class="No-Break">illegal activities.</span></p>
			<p>For instance, searching for an organization based on a single keyword provides billions of results, as shown in the <span class="No-Break">following screenshot:</span></p>
			<div>
				<div id="_idContainer099" class="IMG---Figure">
					<img src="image/B19448_04_02.jpg" alt="Figure 4.2 – Google search"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.2 – Google search</p>
			<p>As an ethical hacker, it’s important to collect and analyze the data found not only on page 1 of the search <a id="_idIndexMarker343"/>results but all others to create a better profile of the target. However, as with any typical internet search on Google, it provides generic results that are associated with <span class="No-Break">the keyword.</span></p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Ensure you are not signed in to your Google account or the Chrome web browser when collecting information about <span class="No-Break">a target.</span></p>
			<p>To perform Google hacking techniques, it’s essential to understand how advanced Google search operators can help us filter specific results. The following are common Google advanced <span class="No-Break">search operators:</span></p>
			<ul>
				<li><strong class="source-inline">-</strong> (minus)—The dash is used to <a id="_idIndexMarker344"/>negate a term from the search results. For instance, <strong class="source-inline">cybersecurity -Cisco</strong> will provide results that contain the word <em class="italic">cybersecurity</em> but remove all entries that <span class="No-Break">contain </span><span class="No-Break"><em class="italic">Cisco</em></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">OR</strong>—This is a conditional operator to provide results of either one term or the other. For example, <strong class="source-inline">cybersecurity OR networking</strong> will provide results containing either the word <em class="italic">cybersecurity</em> or <em class="italic">networking</em> <span class="No-Break">in them.</span></li>
				<li><strong class="source-inline">AND</strong>—This conditional <a id="_idIndexMarker345"/>operator is used to provide results that include two terms. For instance, <strong class="source-inline">football AND england</strong> will return results that contain <span class="No-Break">both keywords.</span></li>
				<li><strong class="source-inline">intitle:</strong>—This operator is used to search for title pages that contain a specific term(s). For instance, <strong class="source-inline">intitle: administrator</strong> will search for all websites where <em class="italic">administrator</em> is found in the title and return <span class="No-Break">these results.</span></li>
				<li><strong class="source-inline">inurl:</strong>—This operator searches for URLs that contain a specific keyword. For example, <strong class="source-inline">inurl:security</strong> provides all URLs that contain the <span class="No-Break">keyword </span><span class="No-Break"><em class="italic">security</em></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">intext:</strong>—This operator enables Google to examine whether a specific keyword is found within the body of a website and provide results for those websites only. For example, <strong class="source-inline">intext:cryptocurrency</strong> provides results of web pages that contain the word <em class="italic">cryptocurrency</em> within <span class="No-Break">their body.</span></li>
				<li><strong class="source-inline">ext:</strong>/ <strong class="source-inline">filetype:</strong>—These operators are used to specify a file extension. For instance, <strong class="source-inline">cybersecurity filetype:pdf</strong> will provide results that contain the word <em class="italic">cybersecurity</em> and a <span class="No-Break">PDF file.</span></li>
				<li><strong class="source-inline">site:</strong>—This operator is used to provide results for a specific domain name. For example, <strong class="source-inline">site:microsoft.com</strong> will provide results for <a href="http://microsoft.com"><span class="No-Break">microsoft.com</span></a><span class="No-Break"> only.</span></li>
				<li><strong class="source-inline">before:</strong> <strong class="source-inline">yyyy-mm-dd</strong>—This <a id="_idIndexMarker346"/>operator filters results before a particular time. This is useful if you’re interested in finding results or data that was published before a <span class="No-Break">certain time.</span></li>
				<li><strong class="source-inline">after:</strong> <strong class="source-inline">yyyy-mm-dd</strong>—This operator filters results after a particular time. This is useful if you’re interested in finding results or data that was published after a <span class="No-Break">certain time.</span></li>
				<li><strong class="source-inline">*</strong> (asterisk)—This operator is used as a wildcard to match any keyword. For example, <strong class="source-inline">cyber *</strong> will provide results showing anything that starts <span class="No-Break">with </span><span class="No-Break"><em class="italic">cyber</em></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">Keyword1 keyword2</strong>—This search format is used to provide results with specific keywords. For <a id="_idIndexMarker347"/>instance, <strong class="source-inline">cybersecurity microsoft</strong> provides results on these <span class="No-Break">related terms.</span></li>
				<li><strong class="source-inline">" "</strong> (quotation marks)—Quotation marks are used to enclose a specific search term such as <strong class="source-inline">"</strong><span class="No-Break"><strong class="source-inline">John Doe"</strong></span><span class="No-Break">.</span></li>
			</ul>
			<p>The following are <a id="_idIndexMarker348"/>common scenarios for using Google advanced search operators to collect intelligence on <span class="No-Break">a target:</span></p>
			<ul>
				<li>Imagine you want to filter the Google results for a specific domain only. Using the <strong class="source-inline">site:domain-name</strong> syntax provides the <span class="No-Break">following results:</span></li>
			</ul>
			<div>
				<div id="_idContainer100" class="IMG---Figure">
					<img src="image/B19448_04_03.jpg" alt="Figure 4.3 – Filtering for a specific domain"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.3 – Filtering for a specific domain</p>
			<ul>
				<li>Imagine you’re interested in searching for a specific security vulnerability on a particular domain such as Microsoft’s website. Using the <strong class="source-inline">printnightmare site:microsoft.com</strong> syntax will provide results for <strong class="bold">PrintNightmare</strong> on <span class="No-Break">Microsoft’s website:</span></li>
			</ul>
			<div>
				<div id="_idContainer101" class="IMG---Figure">
					<img src="image/B19448_04_04.jpg" alt="Figure 4.4 – Combining a keyword with the site operator"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.4 – Combining a keyword with the site operator</p>
			<ul>
				<li>If you’re interested in finding the customer portals on a targeted website, using the <strong class="source-inline">customer AND login site:domain-name</strong> syntax filters the search results to look for <a id="_idIndexMarker349"/>customers and logins on a specific domain, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ul>
			<div>
				<div id="_idContainer102" class="IMG---Figure">
					<img src="image/B19448_04_05.jpg" alt="Figure 4.5 – Finding customer portals on a domain"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.5 – Finding customer portals on a domain</p>
			<ul>
				<li>If you’re looking for login portals on a specific domain, using the <strong class="source-inline">"login" site:domain-name</strong> syntax will filter <a id="_idIndexMarker350"/>results with the specific keyword <em class="italic">login</em> on the domain, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ul>
			<div>
				<div id="_idContainer103" class="IMG---Figure">
					<img src="image/B19448_04_06.jpg" alt="Figure 4.6 – Finding login portals"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.6 – Finding login portals</p>
			<ul>
				<li>Imagine you’re interested in finding specific file types on a domain. Using <strong class="source-inline">site:domain-name filetype:txt</strong> or <strong class="source-inline">site:domain-name filetype:pdf</strong> filters the Google search results, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ul>
			<div>
				<div id="_idContainer104" class="IMG---Figure">
					<img src="image/B19448_04_07.jpg" alt="Figure 4.7 – Searching for file types on a domain"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.7 – Searching for file types on a domain</p>
			<ul>
				<li>Imagine you’re interested in looking for <a id="_idIndexMarker351"/>all websites that contain the word <em class="italic">login</em> within their title for a specific domain. You can do this by using the <strong class="source-inline">site:domain-name intitle:login</strong> syntax, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ul>
			<div>
				<div id="_idContainer105" class="IMG---Figure">
					<img src="image/B19448_04_08.jpg" alt="Figure 4.8 – Finding login portals"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.8 – Finding login portals</p>
			<ul>
				<li>To find sub-domains for an organization, use the <strong class="source-inline">site:domain-name -www</strong> syntax to exclude the <strong class="source-inline">www</strong> parameter, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ul>
			<div>
				<div id="_idContainer106" class="IMG---Figure">
					<img src="image/B19448_04_09.jpg" alt="Figure 4.9 – Finding sub-domains"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.9 – Finding sub-domains</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Additionally, you can use the <strong class="source-inline">site:*.domain.com -site:www.domain.com</strong> Google dork syntax to find sub-domains of a target. For instance, if you want to find sub-domains of <em class="italic">microsoft.com</em>, the <strong class="source-inline">site:*.microsoft.com -site:www.microsoft.com</strong> syntax will filter the Google <span class="No-Break">search results.</span></p>
			<p>Many possible <a id="_idIndexMarker352"/>combinations of Google advanced search operators will provide unique results for us. To help ease the learning curve with Google’s advanced search operators, Google has included an <strong class="bold">Advanced Search</strong> feature on their main Google search page that reduces the need to use specific advanced <span class="No-Break">search operators.</span></p>
			<p>To access Google’s <strong class="bold">Advanced Search</strong> feature, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li>Go to Google’s home page at <a href="https://www.google.com/">https://www.google.com/</a> and click on <strong class="bold">Settings</strong>, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer107" class="IMG---Figure">
					<img src="image/B19448_04_10.jpg" alt="Figure 4.10 – Google home page"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.10 – Google home page</p>
			<ol>
				<li value="2">Next, click <a id="_idIndexMarker353"/>on <strong class="bold">Advanced search</strong> <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer108" class="IMG---Figure">
					<img src="image/B19448_04_11.jpg" alt="Figure 4.11 – Advanced search"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.11 – Advanced search</p>
			<ol>
				<li value="3">Lastly, you’ll access the <strong class="bold">Advanced Search</strong> menu, which provides many fields to help you perform <a id="_idIndexMarker354"/>advanced Google searches, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer109" class="IMG---Figure">
					<img src="image/B19448_04_12.jpg" alt="Figure 4.12 – Google Advanced Search menu"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.12 – Google Advanced Search menu</p>
			<p>Additionally, <strong class="bold">Exploit Database</strong> (<a href="https://www.exploit-db.com/">https://www.exploit-db.com/</a>) manages <a id="_idIndexMarker355"/>the <strong class="bold">Google Hacking Database</strong> (<strong class="bold">GHDB</strong>), a public repository of advanced Google search <a id="_idIndexMarker356"/>operators and combinations to find <a id="_idIndexMarker357"/>exposed systems and resources on the internet. The GHDB can be found <span class="No-Break">at </span><a href="https://www.exploit-db.com/google-hacking-database"><span class="No-Break">https://www.exploit-db.com/google-hacking-database</span></a><span class="No-Break">.</span></p>
			<p>The following screenshot shows some of the many Google dorks found on <span class="No-Break">the GHDB:</span></p>
			<div>
				<div id="_idContainer110" class="IMG---Figure">
					<img src="image/B19448_04_13.jpg" alt="Figure 4.13 – GHDB"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.13 – GHDB</p>
			<p>As shown in the preceding screenshot, each Google dork can be used to find sensitive and unintentionally exposed systems and files on the internet. Please be very mindful and careful when lurking around using Google hacking techniques. Do not use the information you find for malicious purposes or to<a id="_idIndexMarker358"/> cause harm to a system <span class="No-Break">or network.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">As an ethical hacker, Google dorks can help you find publicly exposed documents that contain metadata of username structures, which allows you to gain further insights into the way usernames are created for a <span class="No-Break">targeted organization.</span></p>
			<p>Having completed this section, you have learned how to use internet search engines to collect intelligence about a target. In the next section, you will learn how to collect <span class="No-Break">domain intelligence.</span></p>
			<h1 id="_idParaDest-66"><a id="_idTextAnchor065"/>Domain intelligence</h1>
			<p>Domain intelligence focuses on collecting and analyzing domain registry details and DNS records of a <a id="_idIndexMarker359"/>targeted organization to identify their systems, network infrastructure, and attack surface. As the internet continues to expand, there are more registered domain names on the internet as more organizations create an online presence to extend their market reach to new customers around the world. In addition, it’s quite easy for anyone to register a public domain name on the internet and use the namespace for their personal usage. Domain names have been around for quite some time, and they help us to easily access websites on the internet. For instance, imagine how challenging it would be for each person to know and record the IP addresses of each website they wanted to visit. If the IP address were unknown, then the user would not know how to connect to the destination website. Similarly to a postal service, if the destination mailing address is unknown, then the courier won’t be able to deliver <span class="No-Break">the letter.</span></p>
			<p>Domain names are easy-to-remember addresses that are unique on the internet, and they help us connect to websites such as <a href="http://google.com">google.com</a> and <a href="http://amazon.com">amazon.com</a>. However, a domain name is a string of unique characters that are usually mapped to an IP address of a device on a <a id="_idIndexMarker360"/>network. Domain names usually end with a <strong class="bold">Top Level Domain</strong> (<strong class="bold">TLD</strong>) such as <strong class="source-inline">.com</strong>, <strong class="source-inline">.net</strong>, <strong class="source-inline">.org</strong>, and so on. Different root DNS servers are managed by the <strong class="bold">Internet Assigned Numbers Authority</strong> (<strong class="bold">IANA</strong>). For <a id="_idIndexMarker361"/>instance, the <strong class="source-inline">.com</strong> root DNS server will contain the records for all domain names that have the <strong class="source-inline">.com</strong> TLD and their associated IP addresses. Therefore, if a user wants to retrieve the IP address for <a href="http://www.google.com">www.google.com</a>, they will need to query the <strong class="source-inline">.com</strong> root DNS server, which searches its database for all records of <a href="http://google.com">google.com</a>. Once the <a href="http://google.com">google.com</a> domain is found within the DNS server, the server then searches for the <strong class="source-inline">www</strong> record and its associated IP address and responds to the user’s computer. You can think of DNS servers as very large directories that contain many records of hostnames and their associated IP addresses, which helps many people around the world to easily connect to their destination websites <span class="No-Break">and servers.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">DNS is a common <a id="_idIndexMarker362"/>network protocol that allows a device <a id="_idIndexMarker363"/>to resolve a hostname to an IP address. DNS operates on <strong class="bold">User Datagram Protocol</strong> (<strong class="bold">UDP</strong>) port <strong class="source-inline">53</strong> to handle DNS queries and responses <a id="_idIndexMarker364"/>between clients and the DNS server. However, DNS servers also use <strong class="bold">Transmission Control Protocol</strong> (<strong class="bold">TCP</strong>) port <strong class="source-inline">53</strong> for the zone transfer of records between one DNS server <span class="No-Break">and another.</span></p>
			<p>The following diagram shows the concept of a root <span class="No-Break">DNS server:</span></p>
			<div>
				<div id="_idContainer111" class="IMG---Figure">
					<img src="image/B19448_04_14.jpg" alt="Figure 4.14 – Root DNS server structure"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.14 – Root DNS server structure</p>
			<p>Prior to using DNS servers for domain name resolution, each computer used a <strong class="source-inline">Hosts</strong> file that contained a list <a id="_idIndexMarker365"/>of hostnames and their associated IP addresses. This <strong class="source-inline">Hosts</strong> file required frequent updates to ensure it had the latest records. However, managing this file on all client computers became a challenging task, and DNS servers were used to overcome this issue. However, the <strong class="source-inline">Hosts</strong> file on Windows-based operating systems can be found in the <strong class="source-inline">C:\Windows\System32\drivers\etc</strong> folder directory. However, when a computer connects to a network, the <strong class="bold">Dynamic Host Configuration Protocol</strong> (<strong class="bold">DHCP</strong>) server usually <a id="_idIndexMarker366"/>provides the network’s DNS server IP addresses to the client. Therefore, the host operating system of the client device no longer queries the <strong class="source-inline">Hosts</strong> file, instead sending all DNS queries to the <span class="No-Break">DNS servers.</span></p>
			<p>The following screenshot shows the contents of the <strong class="source-inline">Hosts</strong> file of a Windows 11 <span class="No-Break">operating system:</span></p>
			<div>
				<div id="_idContainer112" class="IMG---Figure">
					<img src="image/B19448_04_15.jpg" alt="Figure 4.15 – Hosts file"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.15 – Hosts file</p>
			<p>As shown in the preceding <a id="_idIndexMarker367"/>screenshot, the file was originally created to map hostnames to IP addresses. However, all the lines are commented by default to prevent the operating system from reaching any of its contents, including the <span class="No-Break">default entries.</span></p>
			<p>The following are the general steps taken when performing a DNS query for <span class="No-Break">a hostname:</span></p>
			<ol>
				<li>When a user enters a domain name or hostname into the address bar of their web browser, the client device checks its local DNS cache for any previous entries that match the hostname. If no previous entries are found, the client device sends a DNS query to the preferred DNS server, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer113" class="IMG---Figure">
					<img src="image/B19448_04_16.jpg" alt="Figure 4.16 – DNS query"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.16 – DNS query</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">The <strong class="source-inline">ipconfig /displaydns</strong> command will display the local DNS cache on a Windows-based <span class="No-Break">operating system.</span></p>
			<ol>
				<li value="2">The DNS server will <a id="_idIndexMarker368"/>check its local database for the request record and respond with a DNS reply to the client device with the IP address for the hostname, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer114" class="IMG---Figure">
					<img src="image/B19448_04_17.jpg" alt="Figure 4.17 – DNS response"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.17 – DNS response</p>
			<ol>
				<li value="3">When the client device receives the IP address, it will insert it as the destination IP address within the <strong class="source-inline">Layer 3</strong> header of the IP packet and send it out on the network to establish a connection to the destination web server, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer115" class="IMG---Figure">
					<img src="image/B19448_04_18.jpg" alt="Figure 4.18 – Connection to the destination server"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.18 – Connection to the destination server</p>
			<p>Domain owners <a id="_idIndexMarker369"/>and DNS server administrators can create various types of DNS records for a domain, such as <span class="No-Break">the following:</span></p>
			<ul>
				<li><strong class="source-inline">A</strong>: This record maps <a id="_idIndexMarker370"/>a hostname to an <span class="No-Break">IPv4 address</span></li>
				<li><strong class="source-inline">AAAA</strong>: This record maps a hostname to an <span class="No-Break">IPv6 address</span></li>
				<li><strong class="source-inline">MX</strong>: This record is used to specify the (e)mail exchange servers for <span class="No-Break">the domain</span></li>
				<li><strong class="source-inline">NS</strong>: Contains the name servers for <span class="No-Break">the domain</span></li>
				<li><strong class="source-inline">CNAME</strong>: Specifies the canonical name (alias) for the domain or <span class="No-Break">a sub-domain</span></li>
				<li><strong class="source-inline">PTR</strong>: Used to resolve an IP address to <span class="No-Break">a hostname</span></li>
				<li><strong class="source-inline">RP</strong>: Used to specify the responsible person for <span class="No-Break">the domain</span></li>
				<li><strong class="source-inline">TXT</strong>: This record allows the domain owner to specify a text record, which is commonly used to validate ownership of <span class="No-Break">the domain</span></li>
				<li><strong class="source-inline">SRV</strong>: Used to specify a <span class="No-Break">service port</span></li>
				<li><strong class="source-inline">SOA</strong>: This record is <a id="_idIndexMarker371"/>used for storing administrative information about <span class="No-Break">the domain</span></li>
			</ul>
			<p>Public DNS servers are available to anyone on the internet and usually contain a copy of the DNS records for many registered domain names. As an ethical hacker or penetration tester, you can leverage both the domain registration details and DNS records of a domain name to help <a id="_idIndexMarker372"/>you better understand the target’s network infrastructure, publicly available servers, and additional assets that are owned by <span class="No-Break">the target.</span></p>
			<p>The following diagram shows a visual mind map of key areas for collecting <span class="No-Break">domain intelligence:</span></p>
			<div>
				<div id="_idContainer116" class="IMG---Figure">
					<img src="image/B19448_04_19.jpg" alt="Figure 4.19 – Domain intelligence mind map"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.19 – Domain intelligence mind map</p>
			<p>As shown in the preceding diagram, ethical hackers can collect domain registration details from public WHOIS databases, identify sub-domains using various tools and internet search engines, and retrieve DNS records from public <span class="No-Break">DNS servers.</span></p>
			<h2 id="_idParaDest-67"><a id="_idTextAnchor066"/>Working with WHOIS databases</h2>
			<p>Registering a <a id="_idIndexMarker373"/>domain name on the internet is <a id="_idIndexMarker374"/>quite a simple process. The user visits an online domain registrar, checks the availability of a preferred domain, and registers it for a number of years. During the registration process, the domain registrar collects a lot of <strong class="bold">Personally Identifiable Information</strong> (<strong class="bold">PII</strong>) about the new domain owner, such <a id="_idIndexMarker375"/>as <span class="No-Break">the following:</span></p>
			<ul>
				<li><span class="No-Break">Full name</span></li>
				<li><span class="No-Break">Physical address</span></li>
				<li><span class="No-Break">Email address</span></li>
				<li><span class="No-Break">Telephone number</span></li>
				<li><span class="No-Break">Mobile number</span></li>
				<li><span class="No-Break">Organization name</span></li>
			</ul>
			<p>By registering a domain on the internet, the registration details are publicly available by default, enabling anyone to identify the owner of the domain name and other sensitive details. However, many domain registrars provide an additional paid service to keep the registration details private for the duration of the lease. In addition, during the registration process, many people and organizations will choose to pay an additional fee to protect their privacy<a id="_idIndexMarker376"/> and keep their domain registration details <a id="_idIndexMarker377"/>private. However, not everyone chooses to pay the additional privacy charges, thus leaving their registration details exposed on <span class="No-Break">the internet.</span></p>
			<p>As an ethical hacker, you can leverage the information found on a WHOIS database to create a profile about a target and identify their contact details and physical location. The following are <a id="_idIndexMarker378"/>public <span class="No-Break">WHOIS databases:</span></p>
			<ul>
				<li><a href="https://who.is/"><span class="No-Break">https://who.is/</span></a></li>
				<li><a href="https://www.whois.com/whois/"><span class="No-Break">https://www.whois.com/whois/</span></a></li>
				<li><a href="https://whois.domaintools.com/"><span class="No-Break">https://whois.domaintools.com/</span></a></li>
			</ul>
			<p>The preceding list is just a few of the many public WHOIS online databases available. When performing a WHOIS lookup, it’s important to query the targeted domain on multiple WHOIS databases to ensure the information is accurate <span class="No-Break">and available.</span></p>
			<p>To get started with performing WHOIS lookup and retrieving domain registration information, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li>Firstly, power on your <strong class="bold">Kali Linux</strong> virtual machine and verify there’s internet connectivity <span class="No-Break">on it.</span></li>
				<li>Next, open the Terminal on Kali Linux and use the <strong class="source-inline">whois</strong> command, <span class="No-Break">like so:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">whois apple.com</strong></pre></li>
			</ol>
			<p>The following screenshot shows the <strong class="source-inline">whois</strong> response for the <span class="No-Break">targeted domain:</span></p>
			<div>
				<div id="_idContainer117" class="IMG---Figure">
					<img src="image/B19448_04_20.jpg" alt="Figure 4.20 – whois response"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.20 – whois response</p>
			<p>As shown in the preceding screenshot, the <strong class="source-inline">whois</strong> tool attempted to retrieve all the domain <a id="_idIndexMarker379"/>registration details, such as the domain <a id="_idIndexMarker380"/>registration period, the name servers, the owner’s personal information, and their contact details. However, the domain owner has domain privacy to protect their registration details from being exposed on <span class="No-Break">the internet.</span></p>
			<ol>
				<li value="3">Next, open the web browser within Kali Linux, go to <a href="https://mxtoolbox.com/Whois.aspx">https://mxtoolbox.com/Whois.aspx</a>, and enter a targeted domain name, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer118" class="IMG---Figure">
					<img src="image/B19448_04_21.jpg" alt="Figure 4.21 – MXToolbox Whois Lookup"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.21 – MXToolbox Whois Lookup</p>
			<p>As shown in the <a id="_idIndexMarker381"/>following screenshot, the MXToolbox WHOIS database <a id="_idIndexMarker382"/>provided the name servers of the domain and <span class="No-Break">registration details:</span></p>
			<div>
				<div id="_idContainer119" class="IMG---Figure">
					<img src="image/B19448_04_22.jpg" alt="Figure 4.22 – WHOIS results"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.22 – WHOIS results</p>
			<p>Most organizations <a id="_idIndexMarker383"/>will opt to pay additional fees to ensure their <a id="_idIndexMarker384"/>registration details are kept private from users on the internet. However, it’s a good practice to perform a WHOIS lookup because you may find something interesting to help you plan future operations in <span class="No-Break">ethical hacking.</span></p>
			<h2 id="_idParaDest-68"><a id="_idTextAnchor067"/>Using nslookup for reconnaissance</h2>
			<p>The <strong class="source-inline">nslookup</strong> tool is a popular network administration tool that is built into many operating systems <a id="_idIndexMarker385"/>such as Windows and Linux and <a id="_idIndexMarker386"/>enables IT professionals to troubleshoot DNS issues on a network. As an ethical hacker, you can leverage <strong class="source-inline">nslookup</strong> to retrieve domain information such as DNS records from the targeted DNS server and other publicly available DNS servers on <span class="No-Break">the internet.</span></p>
			<p>To get started with learning how to use <strong class="source-inline">nslookup</strong>, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li>Firstly, power on the <strong class="bold">Kali Linux</strong> virtual machine and ensure it has <span class="No-Break">internet connectivity.</span></li>
				<li>Next, open the Terminal on Kali Linux and execute the <strong class="source-inline">nslookup</strong> command. After executing the <a id="_idIndexMarker387"/>command, the Terminal prompt will <a id="_idIndexMarker388"/>change, and all queries on the Terminal will be sent to the IP address of the DNS server that’s configured on <span class="No-Break">Kali Linux.</span></li>
				<li>To change the current server to Google’s DNS server, use the <strong class="source-inline">server 8.8.8.8</strong> command. This command will send all DNS queries that are performed on the Terminal to Google’s <span class="No-Break">DNS servers.</span></li>
				<li>Next, enter a domain such as <a href="http://amazon.com">amazon.com</a> to perform a query, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer120" class="IMG---Figure">
					<img src="image/B19448_04_23.jpg" alt="Figure 4.23 – nslookup tool"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.23 – nslookup tool</p>
			<p>As shown in the preceding screenshot, <strong class="source-inline">nslookup</strong> sends the DNS query to <strong class="source-inline">8.8.8.8</strong> (Google’s DNS server), retrieves the DNS <strong class="source-inline">A</strong> records for the domain name, and shows <a id="_idIndexMarker389"/>the public IPv4 addresses of <a id="_idIndexMarker390"/>their <span class="No-Break">web servers.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">The non-authoritative answer means the information was retrieved from a DNS server other than the server with the original DNS records. Non-authoritative DNS servers usually have a cached copy of the original <span class="No-Break">DNS records.</span></p>
			<ol>
				<li value="5">Next, use the <strong class="source-inline">set type=mx</strong> command to change the query type and enter the targeted domain again to retrieve the email <span class="No-Break">server information:</span></li>
			</ol>
			<div>
				<div id="_idContainer121" class="IMG---Figure">
					<img src="image/B19448_04_24.jpg" alt="Figure 4.24 – Retrieving email server information"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.24 – Retrieving email server information</p>
			<p>As shown in the preceding screenshot, the hostname of the email server <span class="No-Break">was found.</span></p>
			<ol>
				<li value="6">To resolve the <a id="_idIndexMarker391"/>email server hostname to an IP address, use <a id="_idIndexMarker392"/>the <strong class="source-inline">set type=a</strong> command, then enter the hostname of the email server, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer122" class="IMG---Figure">
					<img src="image/B19448_04_25.jpg" alt="Figure 4.25 – Resolving a hostname to an IP address"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.25 – Resolving a hostname to an IP address</p>
			<p>As shown in the preceding screenshot, the public IPv4 address of the email server was retrieved from a public DNS server. Hence, it’s important to understand the type of records that are created on a DNS server and how ethical hackers can collect and analyze such information to create a profile about <span class="No-Break">a target.</span></p>
			<h1 id="_idParaDest-69"><a id="_idTextAnchor068"/>Discovering sub-domains</h1>
			<p>Sub-domains are used to both organize and develop a hierarchical structure for domain names, such as <a id="_idIndexMarker393"/>dividing a parent domain into smaller parts that can be easily managed by IT professionals. Furthermore, sub-domains are easily created by adding a prefix value to an existing parent domain. For instance, Google owns the <a href="http://google.com">google.com</a> domain and created <a href="http://mail.google.com">mail.google.com</a> as a sub-domain that points to its online email platform. This means that sub-domains can have their own IP address, content, and hosting server, and can be managed separately from the <span class="No-Break">parent domain.</span></p>
			<p>As an ethical hacker, it’s important to discover sub-domains of a target as they can provide valuable information during your reconnaissance phase. They can help you identify additional systems and network infrastructure and determine the security posture of the target. In addition, you can expand the attack surface, discovering security vulnerabilities that can lead to compromising the target and gaining a foothold. Furthermore, ethical hackers can spoof sub-domains that appear to be legitimate to a target’s domain name during a social engineering attack, tricking employees into revealing sensitive details such as their user credentials and even downloading malware onto their <span class="No-Break">company-owned systems.</span></p>
			<h2 id="_idParaDest-70"><a id="_idTextAnchor069"/>Certificate searching</h2>
			<p><strong class="bold">Certificate Search</strong> is an online database that collects information from digital certificates that are <a id="_idIndexMarker394"/>publicly available and found on the internet. Digital <a id="_idIndexMarker395"/>certificates enable a user to validate the authenticity of a system on an untrusted network such as the internet. For instance, hackers can easily set up fake <a id="_idIndexMarker396"/>websites on the internet to perform social engineering attacks on their victims, such as tricking a person into revealing their user credentials for their online account. Digital certificates are used to help a user verify the identity of a website or device while identifying the certificate issuer, the organization, and <span class="No-Break">its location.</span></p>
			<p>Keep in mind that digital certificates play an important role in e-commerce as they are used to help improve the security of online transactions and communication to ensure all transmitted data between the user’s web browser and the server is encrypted, thus ensuring the encrypted data can only be decrypted by the <span class="No-Break">intended recipient.</span></p>
			<p>Digital certificates are commonly issued <a id="_idIndexMarker397"/>by a third-party, trusted organization known as a <strong class="bold">certificate authority</strong> (<strong class="bold">CA</strong>) on the internet. The CA is responsible for validating the identity of the certificate holder; therefore, the issued certificate contains the <a id="_idIndexMarker398"/><span class="No-Break">following data:</span></p>
			<ul>
				<li><strong class="bold">Subject name</strong>—This field contains the name of the entity that will be using the certificate. The entity can be a person, website, server, <span class="No-Break">or organization.</span></li>
				<li><strong class="bold">Public key</strong>—This field contains <a id="_idIndexMarker399"/>the public key that will be used with the entity to <a id="_idIndexMarker400"/>perform data encryption between the client <span class="No-Break">and server.</span></li>
				<li><strong class="bold">Issuer name</strong>—This field contains the name of the CA that issued <span class="No-Break">the certificate.</span></li>
				<li><strong class="bold">Validity dates</strong>—This field indicates the validity duration of the certificate, after which the certificate will expire and become untrusted if it’s not renewed by the <span class="No-Break">entity/certificate holder.</span></li>
				<li><strong class="bold">Certificate serial number</strong>—The serial number is a unique value assigned by the CA for identifying <span class="No-Break">the certification.</span></li>
				<li><strong class="bold">Signature algorithm</strong>—This field contains the cryptographic algorithms that are used by the CA to digitally sign <span class="No-Break">the certificate.</span></li>
				<li><strong class="bold">Thumbprint</strong>—This field <a id="_idIndexMarker401"/>contains a <strong class="bold">unique identifier</strong> (<strong class="bold">UID</strong>) value that is used <span class="No-Break">for verification.</span></li>
			</ul>
			<p>The following screenshot <a id="_idIndexMarker402"/>shows general information on a digital certificate <span class="No-Break">for </span><a href="http://www.amazon.com"><span class="No-Break">www.amazon.com</span></a><span class="No-Break">:</span></p>
			<div>
				<div id="_idContainer123" class="IMG---Figure">
					<img src="image/B19448_04_26.jpg" alt="Figure 4.26 – Certificate details"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.26 – Certificate details</p>
			<p>As shown in the preceding screenshot, anyone can identify the CA as DigiCert Global Root CA, the intermediate CA as DigiCert Global CA GA, the holder of the certificate as <a href="http://www.amazon.com">www.amazon.com</a>, and its details. Additionally, the <strong class="bold">Subject Alt Names</strong> field indicates this digital certificate can be used with the additional sub-domains listed within this field. As an ethical hacker, this field helps us to easily discover additional sub-domains of a targeted organization, which can lead to additional points of entry into <span class="No-Break">a target.</span></p>
			<p>Certificate Search can help <a id="_idIndexMarker403"/>us to efficiently discover the digital certificates of an organization <a id="_idIndexMarker404"/>using passive reconnaissance. To get started with using Certificate Search as an online OSINT tool to discover the sub-domains of an organization, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li>Open the web browser on your computer or Kali Linux<a href="https://crt.sh/"> virtual machin</a>e, and go to the official website of Certificate Search <span class="No-Break">at </span><a href="https://crt.sh/"><span class="No-Break">https://crt.sh/</span></a><span class="No-Break">.</span></li>
				<li>Once the website loads, enter a public domain and click on the <strong class="bold">Search</strong> button, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer124" class="IMG---Figure">
					<img src="image/B19448_04_27.jpg" alt="Figure 4.27 – Certificate Search"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.27 – Certificate Search</p>
			<p>As shown in the <a id="_idIndexMarker405"/>preceding screenshot, Certificate Search allows <a id="_idIndexMarker406"/>anyone to enter an identity such as a domain name or organizational name, or a <span class="No-Break">certificate fingerprint.</span></p>
			<ol>
				<li value="3">Next, Certificate Search will return all results from its database showing all digital certificates that contain <strong class="source-inline">apple.com</strong> as the domain, <span class="No-Break">and sub-domains:</span></li>
			</ol>
			<div>
				<div id="_idContainer125" class="IMG---Figure">
					<img src="image/B19448_04_28.jpg" alt="Figure 4.28 – Certificate results"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.28 – Certificate results</p>
			<p>As shown in the <a id="_idIndexMarker407"/>preceding screenshot, the results contain the <strong class="source-inline">crt.sh</strong> ID, the <a id="_idIndexMarker408"/>logged date, validity period, <strong class="bold">Common Name</strong> (<strong class="bold">CN</strong>), matching identities, and additional details. The <strong class="bold">Matching Identities</strong> field displays the sub-domains of the organization; these hostnames can be easily resolved to IP addresses using the <span class="No-Break">DNS protocols.</span></p>
			<ol>
				<li value="4">Next, click on any <strong class="source-inline">crt.sh</strong> ID to view the details within a <span class="No-Break">digital certificate:</span></li>
			</ol>
			<div>
				<div id="_idContainer126" class="IMG---Figure">
					<img src="image/B19448_04_29.jpg" alt="Figure 4.29 – Certificate details"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.29 – Certificate details</p>
			<p>As shown in the preceding screenshot, the digital certificate contains the locale information about <a id="_idIndexMarker409"/>the organization, which can be used to find the physical <a id="_idIndexMarker410"/>location of the company. Such information is important when conducting a black-box penetration test on a target when only the organization name is given to the ethical hacker or penetration tester. It’s important that the ethical hacker finds the accurate physical location of the company to identify the company’s wireless networks and physical <span class="No-Break">security presence.</span></p>
			<p>As you have seen in the preceding steps, Certificate Search is a valuable resource to help us discover digital certificates associated with a target and displays their locale and sub-domain information, which helps ethical hackers to create a profile about their targets. Next, you will learn how to discover sub-domains using an OSINT tool on <span class="No-Break">Kali Linux.</span></p>
			<h2 id="_idParaDest-71"><a id="_idTextAnchor070"/>Working with Recon-ng</h2>
			<p><strong class="bold">Recon-ng</strong> is a popular open source reconnaissance tool that helps ethical hackers and penetration testers <a id="_idIndexMarker411"/>collect and analyze OSINT from the internet. This tool <a id="_idIndexMarker412"/>can be used to identify whether an organization is leaking sensitive data that can be leveraged by potential threat actors when planning a future cyber-attack. Recon-ng provides a command-line interface and contains various modules that are designed for specific tasks and collecting OSINT from various <span class="No-Break">data sources.</span></p>
			<p>The following are some advantages of using Recon-ng for collecting and <span class="No-Break">analyzing OSINT:</span></p>
			<ul>
				<li><strong class="bold">Automation</strong>—Recon-ng <a id="_idIndexMarker413"/>can be automated to collect OSINT from online <span class="No-Break">data sources</span></li>
				<li><strong class="bold">Modules</strong>—There are a lot of built-in modules that can be customized to provide additional features <span class="No-Break">and capabilities</span></li>
				<li><strong class="bold">Data management</strong>—Recon-ng has tools that enable a user to both organize and manage collected data efficiently <span class="No-Break">during reconnaissance</span></li>
				<li><strong class="bold">Reporting</strong>—There <a id="_idIndexMarker414"/>are multiple reporting <a id="_idIndexMarker415"/>modules and features that enable the <a id="_idIndexMarker416"/>user to generate reports in formats such as <strong class="bold">HyperText Markup Language</strong> (<strong class="bold">HTML</strong>), <strong class="bold">Extensible Markup Language</strong> (<strong class="bold">XML</strong>), and <strong class="bold">Comma-Separated Values</strong> (<span class="No-Break"><strong class="bold">CSV</strong></span><span class="No-Break">) files</span></li>
			</ul>
			<p>To get started with using Recon-ng to discover and collect sub-domains of a target, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li>Firstly, power <a id="_idIndexMarker417"/>on the <strong class="bold">Kali Linux</strong> virtual machine and ensure it has <span class="No-Break">internet connectivity.</span></li>
				<li>Next, open the Terminal and execute the following command to <span class="No-Break">start Recon-ng:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">recon-ng</strong></pre></li>
				<li>Next, Recon-ng has an online marketplace with additional modules that can be downloaded and installed. To install all modules from the marketplace, use the <span class="No-Break">following commands:</span><pre class="source-code">
[recon-ng][default] &gt; <strong class="bold">marketplace install all</strong></pre></li>
			</ol>
			<p>The following screenshot shows the additional modules are being downloaded and installed <span class="No-Break">on Recon-ng:</span></p>
			<div>
				<div id="_idContainer127" class="IMG---Figure">
					<img src="image/B19448_04_30.jpg" alt="Figure 4.30 – Installing modules"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.30 – Installing modules</p>
			<p>After the modules <a id="_idIndexMarker418"/>are installed, Recon-ng will reload all modules <a id="_idIndexMarker419"/>on the application, and you will see a lot of warning messages similar <span class="No-Break">to these:</span></p>
			<div>
				<div id="_idContainer128" class="IMG---Figure">
					<img src="image/B19448_04_31.jpg" alt="Figure 4.31 – Missing application programming interface (API) keys"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.31 – Missing application programming interface (API) keys</p>
			<p>As shown in the preceding screenshot, many Recon-ng modules require a valid API key to communicate with an online data source to query and retrieve data about a target. In a later step, you will learn how to add API keys for various <span class="No-Break">Recon-ng modules.</span></p>
			<ol>
				<li value="4">Next, to display a list of API keys and the associated module, use the <span class="No-Break">following command:</span><pre class="source-code">
[recon-ng][default] &gt; <strong class="bold">keys list</strong></pre></li>
			</ol>
			<p>As shown in the following screenshot, there are no API keys assigned to any module <span class="No-Break">by default:</span></p>
			<div>
				<div id="_idContainer129" class="IMG---Figure">
					<img src="image/B19448_04_32.jpg" alt="Figure 4.32 – Checking API keys"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.32 – Checking API keys</p>
			<ol>
				<li value="5">Next, to get an API key for <strong class="bold">BuiltWith</strong>, go to <a href="https://builtwith.com/">https://builtwith.com/</a> and create a free account. After <a id="_idIndexMarker420"/>creating an account, log in and cli<a href="https://hunter.io/">ck on <strong class="bold">Tools</strong> &gt; <strong class="bold">API </strong></a><strong class="bold">Access</strong> to get your <span class="No-Break">API key.</span></li>
				<li>Next, to get an <a id="_idIndexMarker421"/>API key for <strong class="bold">HunterIO</strong>, go to <a href="https://hunter.io/">https://hunter.io/</a> and create a free account. When <a id="_idIndexMarker422"/>you’re logged in, click on your profile and <a id="_idIndexMarker423"/>select <strong class="bold">&lt;/&gt; API</strong> to view your API key for <span class="No-Break">this platform.</span></li>
				<li>Repeat the previous <a id="_idIndexMarker424"/>steps to get API keys from <strong class="bold">VirusTotal</strong> at <a href="https://www.virustotal.com/">https://www.virustotal.com/</a>, <strong class="bold">Censys</strong> at <a href="https://search.censys.io/">https://search.censys.io/</a>, and <strong class="bold">Shodan</strong> at <a href="https://www.shodan.io/">https://www.shodan.io/</a>. Feel free to get <a id="_idIndexMarker425"/>additional API keys <a id="_idIndexMarker426"/>for supported modules <span class="No-Break">on Recon-ng.</span></li>
				<li>Next, to add an API key to an API-supported module, use the <strong class="source-inline">keys add &lt;API module name&gt; &lt;API key value&gt;</strong> command on Recon-ng—for instance, <strong class="source-inline">keys add </strong><span class="No-Break"><strong class="source-inline">builtwith_api 12345</strong></span><span class="No-Break">.</span></li>
				<li>Next, use the <strong class="source-inline">keys list</strong> command to verify the API keys were added successfully, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer130" class="IMG---Figure">
					<img src="image/B19448_04_33.jpg" alt="Figure 4.33 – Verifying API keys"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.33 – Verifying API keys</p>
			<ol>
				<li value="10">Next, when collecting data about a target, it’s good practice to keep your physical and digital <a id="_idIndexMarker427"/>workspace organized to easily find information <a id="_idIndexMarker428"/>when needed. Therefore, use the following commands to create a digital workspace <span class="No-Break">on Recon-ng:</span><pre class="source-code">
[recon-ng][default] &gt; <strong class="bold">workspaces create target1_recon</strong></pre></li>
				<li>Next, use the following command to view a list of all created workspaces <span class="No-Break">within Recon-ng:</span><pre class="source-code">
[recon-ng][target1_recon] &gt; <strong class="bold">workspaces list</strong></pre></li>
			</ol>
			<p>As shown in the following screenshot, the newly created workspace is available and we’re currently operating <span class="No-Break">within it:</span></p>
			<div>
				<div id="_idContainer131" class="IMG---Figure">
					<img src="image/B19448_04_34.jpg" alt="Figure 4.34 – Viewing workspaces"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.34 – Viewing workspaces</p>
			<ol>
				<li value="12">Next, let’s use the <strong class="source-inline">modules search</strong> command to find the <strong class="source-inline">bing_domain</strong> module that will help us identify the geo-location and sub-domains of <span class="No-Break">a target:</span><pre class="source-code">
[recon-ng][target1_recon] &gt; <strong class="bold">modules search bing_domain</strong></pre></li>
			</ol>
			<p>The following <a id="_idIndexMarker429"/>screenshot shows two modules were <a id="_idIndexMarker430"/>identified <span class="No-Break">and returned:</span></p>
			<div>
				<div id="_idContainer132" class="IMG---Figure">
					<img src="image/B19448_04_35.jpg" alt="Figure 4.35 – Search results"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.35 – Search results</p>
			<ol>
				<li value="13">Next, let’s use the <strong class="source-inline">recon/domains-hosts/bing_domain_web</strong> module and display <span class="No-Break">its description:</span><pre class="source-code">
[recon-ng][target1_recon] &gt; <strong class="bold">modules load recon/domains-hosts/bing_domain_web</strong></pre><pre class="source-code">
[recon-ng][target1_recon][bing_domain_web] &gt; <strong class="bold">info</strong></pre></li>
			</ol>
			<p>The following screenshot shows the module’s description and the required options to use <span class="No-Break">the module:</span></p>
			<div>
				<div id="_idContainer133" class="IMG---Figure">
					<img src="image/B19448_04_36.jpg" alt="Figure 4.36 – Displaying module descriptions"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.36 – Displaying module descriptions</p>
			<p>As shown in the <a id="_idIndexMarker431"/>preceding screenshot, the <strong class="source-inline">SOURCE</strong> value must <a id="_idIndexMarker432"/>be set before using the module to collect OSINT from <span class="No-Break">the internet.</span></p>
			<ol>
				<li value="14">Next, let’s set <span class="hidden">microsoft.com</span> as the target and execute the module using the <span class="No-Break">following commands:</span><pre class="source-code">
[recon-ng][target1_recon][bing_domain_web] &gt; <strong class="bold">options set SOURCE microsoft.com</strong></pre><pre class="source-code">
[recon-ng][target1_recon][bing_domain_web] &gt; <strong class="bold">run</strong></pre></li>
			</ol>
			<p class="callout-heading">Tip</p>
			<p class="callout">To unset a value within a module, use the <strong class="source-inline">options unset &lt;</strong><span class="No-Break"><strong class="source-inline">parameter/value&gt;</strong></span><span class="No-Break"> command.</span></p>
			<p>The following screenshot shows the module has started collecting OSINT about the targeted <span class="No-Break">domain name:</span></p>
			<div>
				<div id="_idContainer134" class="IMG---Figure">
					<img src="image/B19448_04_37.jpg" alt="Figure 4.37 – Running a module"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.37 – Running a module</p>
			<ol>
				<li value="15">Once the module <a id="_idIndexMarker433"/>has finished collecting OSINT on the target, execute <a id="_idIndexMarker434"/>the <strong class="source-inline">show hosts</strong> command to view the <span class="No-Break">collected data:</span></li>
			</ol>
			<div>
				<div id="_idContainer135" class="IMG---Figure">
					<img src="image/B19448_04_38.jpg" alt="Figure 4.38 – Viewing collected data"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.38 – Viewing collected data</p>
			<ol>
				<li value="16">To exit the <a id="_idIndexMarker435"/>current module on Recon-ng, type <strong class="source-inline">back</strong> and <a id="_idIndexMarker436"/><span class="No-Break">hit </span><span class="No-Break"><em class="italic">Enter</em></span><span class="No-Break">.</span></li>
			</ol>
			<p class="callout-heading">Important note</p>
			<p class="callout">The <strong class="source-inline">show</strong> command can be used with <strong class="source-inline">show</strong> <strong class="source-inline">[companies]</strong> <strong class="source-inline">[credentials] [hosts]</strong> <strong class="source-inline">[locations]</strong> <strong class="source-inline">[ports]</strong> <strong class="source-inline">[pushpins]</strong> <strong class="source-inline">[vulnerabilities] [contacts]</strong> <strong class="source-inline">[domains]</strong> <strong class="source-inline">[leaks]</strong> <strong class="source-inline">[netblocks]</strong> <strong class="source-inline">[profiles] [repositories]</strong> to view specific information that was collected <span class="No-Break">by Recon-ng.</span></p>
			<ol>
				<li value="17">Next, display a summary of all OSINT that was collected <span class="No-Break">by Recon-ng:</span><pre class="source-code">
[recon-ng][target1_recon] &gt; <strong class="bold">dashboard</strong></pre></li>
				<li>The following screenshot shows the summary of activities that were performed and collected <span class="No-Break">by Recon-ng:</span></li>
			</ol>
			<div>
				<div id="_idContainer136" class="IMG---Figure">
					<img src="image/B19448_04_39.jpg" alt="Figure 4.39 – Activity summary on Recon-ng"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.39 – Activity summary on Recon-ng</p>
			<ol>
				<li value="19">Next, to generate <a id="_idIndexMarker437"/>a report using an HTML reporting <a id="_idIndexMarker438"/>module, use the <span class="No-Break">following commands:</span><pre class="source-code">
[recon-ng][target1_recon] &gt; <strong class="bold">modules load reporting/html</strong></pre><pre class="source-code">
[recon-ng][target1_recon][html] &gt; <strong class="bold">info</strong></pre><pre class="source-code">
[recon-ng][target1_recon][html] &gt; <strong class="bold">options set CREATOR Glen</strong></pre><pre class="source-code">
[recon-ng][target1_recon][html] &gt; <strong class="bold">options set CUSTOMER NewCustomer1</strong></pre><pre class="source-code">
[recon-ng][target1_recon][html] &gt; <strong class="bold">options set FILENAME /home/kali/Recon-Report1.html</strong></pre><pre class="source-code">
[recon-ng][target1_recon][html] &gt; <strong class="bold">run</strong></pre></li>
			</ol>
			<p>The following screenshot shows the execution of the <span class="No-Break">preceding commands:</span></p>
			<div>
				<div id="_idContainer137" class="IMG---Figure">
					<img src="image/B19448_04_40.jpg" alt="Figure 4.40 – Using the reporting module"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.40 – Using the reporting module</p>
			<p>As shown in the <a id="_idIndexMarker439"/>preceding screenshot, a report was generated <a id="_idIndexMarker440"/>and stored in the <strong class="source-inline">/</strong><span class="No-Break"><strong class="source-inline">home/kali/</strong></span><span class="No-Break"> directory.</span></p>
			<ol>
				<li value="20">To view the report using a web browser, open a new Terminal and use the <span class="No-Break">following commands:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">firefox /home/kali/Recon-Report1.html</strong></pre></li>
			</ol>
			<p>The following screenshot shows the HTML version of the report with the data collected about the target <span class="No-Break">domain name:</span></p>
			<div>
				<div id="_idContainer138" class="IMG---Figure">
					<img src="image/B19448_04_41.jpg" alt="Figure 4.41 – HTML report"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.41 – HTML report</p>
			<ol>
				<li value="21">Lastly, to access the <a id="_idIndexMarker441"/>web interface of Recon-ng, open a <a id="_idIndexMarker442"/>new Terminal and execute the <strong class="source-inline">recon-web</strong> command, then open a web browser and go to <strong class="source-inline">http://127.0.0.1:5000/</strong>, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer139" class="IMG---Figure">
					<img src="image/B19448_04_42.jpg" alt="Figure 4.42 – Recon-ng web interface"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.42 – Recon-ng web interface</p>
			<p>Having completed this <a id="_idIndexMarker443"/>exercise, you have learned the fundamentals of <a id="_idIndexMarker444"/>using Recon-ng to collect and analyze OSINT. Next, you will learn how to perform DNS reconnaissance on <span class="No-Break">a target.</span></p>
			<h1 id="_idParaDest-72"><a id="_idTextAnchor071"/>DNS reconnaissance</h1>
			<p>DNS reconnaissance is a common technique used by ethical hackers and threat actors to collect information <a id="_idIndexMarker445"/>about a target by gathering publicly available information from DNS servers on the internet. If you recall, DNS is a network protocol that allows a system to resolve a hostname to an IP address, and there are many DNS servers on the internet that contain public DNS records about various registered <span class="No-Break">domain names.</span></p>
			<p>As an ethical hacker, DNS reconnaissance focuses on sending DNS queries to either the target-owned DNS server or a public DNS server to retrieve DNS records about the target’s domain name, IP addresses, and sub-domains. The collected responses are analyzed to identify any valuable information about the target such as their systems and network architecture, potential security vulnerabilities, and <span class="No-Break">application platforms.</span></p>
			<p>In this section, you will <a id="_idIndexMarker446"/>learn how to use various tools and techniques to efficiently collect and analyze DNS information to create a profile about <span class="No-Break">a target.</span></p>
			<h2 id="_idParaDest-73"><a id="_idTextAnchor072"/>Using DNSenum</h2>
			<p><strong class="bold">DNSenum</strong> is a common DNS enumeration tool that’s used to collect OSINT on domain names. It operates <a id="_idIndexMarker447"/>by sending various types of queries to a DNS server about a targeted domain name, IP addresses, email servers, name servers, <span class="No-Break">and sub-domains.</span></p>
			<p>To get started with using DNSenum to collect DNS information about a targeted domain name, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li>Firstly, power on the <strong class="bold">Kali Linux</strong> virtual machine and ensure it has <span class="No-Break">internet connectivity.</span></li>
				<li>Next, open the Terminal and use the following command to query Google’s DNS server for DNS records that belong <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">apple.com</strong></span><span class="No-Break">:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">dnsenum --dnsserver 8.8.8.8 apple.com</strong></pre></li>
			</ol>
			<p>As shown in the following screenshot, DNSenum is attempting to retrieve all DNS record types and name servers of the target <span class="No-Break">domain name:</span></p>
			<div>
				<div id="_idContainer140" class="IMG---Figure">
					<img src="image/B19448_04_43.jpg" alt="Figure 4.43 – DNSenum output"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.43 – DNSenum output</p>
			<p>As shown in the <a id="_idIndexMarker448"/>preceding screenshot, DNSenum was able to retrieve the public IP addresses of the target’s web server, name servers, and <span class="No-Break">email servers.</span></p>
			<ol>
				<li value="3">Once DNSenum has collected general DNS record details, it will automatically attempt to perform sub-domain enumeration by using a default wordlist to identify common sub-domains of the target, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer141" class="IMG---Figure">
					<img src="image/B19448_04_44.jpg" alt="Figure 4.44 – Sub-domain enumeration"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.44 – Sub-domain enumeration</p>
			<p>As shown in the preceding screenshot, DNSenum was able to enumerate many sub-domains of the <a id="_idIndexMarker449"/>target by performing a brute-force query to Google’s <span class="No-Break">DNS server.</span></p>
			<p>Having completed this exercise, you have learned how to automate the collection of DNS records of a target from a public DNS server. Next, you will learn how to use DNSRecon for performing <span class="No-Break">DNS reconnaissance.</span></p>
			<h2 id="_idParaDest-74"><a id="_idTextAnchor073"/>Working with DNSRecon</h2>
			<p><strong class="bold">DNSRecon</strong> is another common DNS reconnaissance tool that enables ethical hackers and penetration <a id="_idIndexMarker450"/>testers to discover DNS records about their target’s domain name. This tool helps automate the processes of retrieving various DNS records found on public DNS servers about a specific <span class="No-Break">domain name.</span></p>
			<p>To get started with using DNSRecon, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li>Firstly, power on the <strong class="bold">Kali Linux</strong> virtual machine and ensure it has <span class="No-Break">internet connectivity.</span></li>
				<li>Next, open the Terminal and use the following commands to query Google’s DNS server for the DNS records <span class="No-Break">of </span><span class="No-Break"><strong class="source-inline">apple.com</strong></span><span class="No-Break">:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">dnsrecon -d apple.com -n 8.8.8.8</strong></pre></li>
			</ol>
			<p>As shown in the following screenshot, DNSRecon was able to retrieve the public DNS records of <span class="No-Break">the target:</span></p>
			<div>
				<div id="_idContainer142" class="IMG---Figure">
					<img src="image/B19448_04_45.jpg" alt="Figure 4.45 – DNSRecon output"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.45 – DNSRecon output</p>
			<p>As shown in the <a id="_idIndexMarker451"/>preceding screenshot, DNSRecon was able to retrieve various types of DNS records such as <strong class="source-inline">A</strong>, <strong class="source-inline">AAAA</strong>, <strong class="source-inline">MX</strong>, <strong class="source-inline">TXT</strong>, <strong class="source-inline">NS</strong>, <span class="No-Break">and more.</span></p>
			<ol>
				<li value="3">Lastly, DNSRecon attempted to automatically enumerate the <strong class="source-inline">SRV</strong> record for the targeted domain, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer143" class="IMG---Figure">
					<img src="image/B19448_04_46.jpg" alt="Figure 4.46 – Enumerating SRV records"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.46 – Enumerating SRV records</p>
			<p>Having completed this <a id="_idIndexMarker452"/>exercise, you have learned how to enumerate DNS records using the DNSRecon tool to find sub-domains and IP addresses of a target. Next, you will learn how to perform DNS zone transfers on a misconfigured <span class="No-Break">DNS server.</span></p>
			<h2 id="_idParaDest-75"><a id="_idTextAnchor074"/>Performing DNS zone transfers</h2>
			<p>As you have learned so far, DNS servers have an important role in internal networks and on the internet. A DNS zone transfer is the process of copying the zone records or entire contents of a DNS <a id="_idIndexMarker453"/>zone from a primary DNS server onto another DNS server. DNS zone transfers are used to ensure DNS data is synchronized between primary and secondary DNS servers. However, the primary (master) DNS server holds the master zone record, and the secondary DNS server holds a copy of the same zone record file. Whenever there’s a change to the master zone record on the primary DNS server, the secondary DNS server needs to update its copy of the zone record too, hence the need for DNS zone transfers between <span class="No-Break">DNS servers.</span></p>
			<p>However, if a DNS server is misconfigured on a network or on the internet, an ethical hacker can attempt to copy the master zone records of an organization to identify security vulnerabilities on the assets owned by the target. Imagine a targeted organization did not separate its internal and external namespaces on its DNS server. If a DNS zone transfer is possible, the ethical hacker will be able to retrieve information about the organization’s internal systems and external systems. Keep in mind that it’s important to ensure ethical hackers obtain explicit permission before attempting to perform DNS zone transfers on customers’ <span class="No-Break">DNS servers.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">The folks at <em class="italic">DigiNinja</em> (<a href="https://digi.ninja">https://digi.ninja</a>) have created a vulnerable DNS server environment for learning how <a id="_idIndexMarker454"/>DNS zone transfers can impact organizations and have created the <a href="http://zonetransfer.me">zonetransfer.me</a> domain, which contains a DNS zone transfer <span class="No-Break">security vulnerability.</span></p>
			<p>To get started with learning how to perform a DNS zone transfer on a vulnerable DNS server, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li>Firstly, power on the <strong class="bold">Kali Linux</strong> virtual machine and ensure it has <span class="No-Break">internet connectivity.</span></li>
				<li>Next, open the <a id="_idIndexMarker455"/>Terminal on Kali Linux and execute the following commands to discover the DNS records of the <span class="No-Break"><strong class="source-inline">zonetransfer.me</strong></span><span class="No-Break"> domain:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">host zonetransfer.me</strong></pre></li>
			</ol>
			<p>The following screenshot shows the DNS <strong class="source-inline">A</strong> and <strong class="source-inline">MX</strong> records for the targeted <span class="No-Break">domain name:</span></p>
			<div>
				<div id="_idContainer144" class="IMG---Figure">
					<img src="image/B19448_04_47.jpg" alt="Figure 4.47 – Finding DNS records"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.47 – Finding DNS records</p>
			<ol>
				<li value="3">Next, use the following command to retrieve the name servers of the <span class="No-Break">targeted domain:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">host -t ns zonetransfer.me</strong></pre></li>
			</ol>
			<p>The following screenshot shows the name servers of the targeted domain <span class="No-Break">were found:</span></p>
			<div>
				<div id="_idContainer145" class="IMG---Figure">
					<img src="image/B19448_04_48.jpg" alt="Figure 4.48 – Retrieving name servers"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.48 – Retrieving name servers</p>
			<p>As shown in the <a id="_idIndexMarker456"/>preceding screenshot, the following are the two name servers for <span class="No-Break">the domain:</span></p>
			<ul>
				<li><span class="No-Break"><strong class="source-inline">nsztm2.digi.ninja</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">nsztm1.digi.ninja</strong></span></li>
			</ul>
			<p>As ethical hackers, we can use these two name servers to determine whether the targeted domain is leaking <span class="No-Break">zone records.</span></p>
			<ol>
				<li value="4">Next, let’s query the targeted domain name with one of the newly discovered <span class="No-Break">name servers:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">host -l zonetransfer.me nsztm1.digi.ninja</strong></pre></li>
			</ol>
			<p>The following screenshot shows the DNS records that were retrieved from the <strong class="source-inline">nsztm1.digi.ninja</strong> name server for the <strong class="source-inline">zonetransfer.me</strong> <span class="No-Break">domain name:</span></p>
			<div>
				<div id="_idContainer146" class="IMG---Figure">
					<img src="image/B19448_04_49.jpg" alt="Figure 4.49 – DNS records"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.49 – DNS records</p>
			<p>As shown in the preceding screenshot, there are many sensitive and interesting hostnames <a id="_idIndexMarker457"/>found within the results. Some of these hostnames and IP addresses may not be intentionally exposed by the organization; however, such information can be leveraged by an ethical hacker to expand the <span class="No-Break">attack surface.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">When performing DNS reconnaissance and zone transfers, ensure you query all name servers for a targeted domain as one server may lack proper security configuration compared with <span class="No-Break">the others.</span></p>
			<ol>
				<li value="5">Next, let’s use <strong class="bold">DNSenum</strong> to automate the DNS zone transfer process on the target <span class="No-Break">domain name:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">dnsenum zonetransfer.me</strong></pre></li>
			</ol>
			<p>The following screenshot shows that DNSenum was able to successfully perform a DNS zone transfer <a id="_idIndexMarker458"/>from the vulnerable <strong class="source-inline">nsztm2.digi.ninja</strong> name server of <span class="No-Break">the target:</span></p>
			<div>
				<div id="_idContainer147" class="IMG---Figure">
					<img src="image/B19448_04_50.jpg" alt="Figure 4.50 – DNS zone transfer"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.50 – DNS zone transfer</p>
			<p>Furthermore, DNSenum was able to retrieve additional interesting records from the vulnerable <span class="No-Break">DNS server:</span></p>
			<div>
				<div id="_idContainer148" class="IMG---Figure">
					<img src="image/B19448_04_51.jpg" alt="Figure 4.51 – Zone records"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.51 – Zone records</p>
			<p>The information collected from zone transfers can help ethical hackers to identify the network infrastructure <a id="_idIndexMarker459"/>of the targeted organization such as the hostname of systems and their IP addresses. Having completed this exercise, you have learned how to use perform DNS zone transfers on a vulnerable DNS server. Next, you will how SpiderFoot helps ethical hackers during their reconnaissance phase in <span class="No-Break">penetration testing.</span></p>
			<h2 id="_idParaDest-76"><a id="_idTextAnchor075"/>Exploring SpiderFoot</h2>
			<p><strong class="bold">SpiderFoot</strong> is a popular OSINT tool used by cybersecurity professionals for reconnaissance, <strong class="bold">threat intelligence</strong> (<strong class="bold">TI</strong>), and investigation <a id="_idIndexMarker460"/>purposes. SpiderFoot can help ethical hackers <a id="_idIndexMarker461"/>to automate the collection of OSINT from various data sources on the internet. For instance, SpiderFoot operates by collecting data from various internet search engines, social media platforms, DNS records, WHOIS databases, and other publicly available sources. Then, SpiderFoot will both organize the collected data and present information in a way that helps ethical hackers easily <span class="No-Break">analyze it.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">To learn more <a id="_idIndexMarker462"/>about the SpiderFoot project, please <span class="No-Break">visit </span><a href="https://github.com/smicallef/spiderfoot"><span class="No-Break">https://github.com/smicallef/spiderfoot</span></a><span class="No-Break">.</span></p>
			<p>To get started with using SpiderFoot for reconnaissance, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li>Firstly, power on the <strong class="bold">Kali Linux</strong> virtual machine and ensure it has <span class="No-Break">internet connectivity.</span></li>
				<li>Next, open the Terminal on Kali Linux and execute the following command to start the SpiderFoot <span class="No-Break">web interface:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">spiderfoot -l 0.0.0.0:1234</strong></pre></li>
			</ol>
			<p>The following screenshot shows the web interface for SpiderFoot <span class="No-Break">has started:</span></p>
			<div>
				<div id="_idContainer149" class="IMG---Figure">
					<img src="image/B19448_04_52.jpg" alt="Figure 4.52 – Starting the web interface for SpiderFoot"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.52 – Starting the web interface for SpiderFoot</p>
			<ol>
				<li value="3">Next, open the web <a id="_idIndexMarker463"/>browser within Kali Linux and go to <strong class="source-inline">http://127.0.0.1:1234</strong> to access the <span class="No-Break">web interface.</span></li>
				<li>Next, click <strong class="bold">New Scan</strong>, set a <strong class="bold">Scan Name</strong> value, set a <strong class="bold">Scan Target</strong> value, select <strong class="bold">Passive</strong>, and click on <strong class="bold">Run Scan Now</strong>, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer150" class="IMG---Figure">
					<img src="image/B19448_04_53.jpg" alt="Figure 4.53 – Setting up a new scan"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.53 – Setting up a new scan</p>
			<ol>
				<li value="5">Next, the scan will <a id="_idIndexMarker464"/>start, and SpiderFoot will automatically populate the scan progress with the collected OSINT, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer151" class="IMG---Figure">
					<img src="image/B19448_04_54.jpg" alt="Figure 4.54 – Summary data"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.54 – Summary data</p>
			<ol>
				<li value="6">Next, selecting <a id="_idIndexMarker465"/>the <strong class="bold">Browse</strong> sub-tab within the current scan will display the number of collected data elements for each type <span class="No-Break">of artifact:</span></li>
			</ol>
			<div>
				<div id="_idContainer152" class="IMG---Figure">
					<img src="image/B19448_04_55.jpg" alt="Figure 4.55 – Viewing artifact data"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.55 – Viewing artifact data</p>
			<ol>
				<li value="7">Next, select the <strong class="bold">Internet Name</strong> artifact <a id="_idIndexMarker466"/>to view a list of sub-domains for the targeted <span class="No-Break">domain name:</span></li>
			</ol>
			<div>
				<div id="_idContainer153" class="IMG---Figure">
					<img src="image/B19448_04_56.jpg" alt="Figure 4.56 – Viewing sub-domains"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.56 – Viewing sub-domains</p>
			<ol>
				<li value="8">Next, click <a id="_idIndexMarker467"/>on <strong class="bold">Browse</strong> &gt; <strong class="bold">Physical Location</strong> to view a list of the target’s <span class="No-Break">geo-location data:</span></li>
			</ol>
			<div>
				<div id="_idContainer154" class="IMG---Figure">
					<img src="image/B19448_04_57.jpg" alt="Figure 4.57 – Geo-locations"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.57 – Geo-locations</p>
			<p>After the entire scan is completed, ensure you visit all the artifact categories to view all collected <a id="_idIndexMarker468"/>OSINT about the target to improve the profile of the target and identify any security vulnerabilities that can be exploited to gain <span class="No-Break">a foothold.</span></p>
			<p>Having completed this section, you have learned how to use various tools and techniques to efficiently discover sensitive information about a target such as its hostname, IP address, and <span class="No-Break">even geo-locations.</span></p>
			<h1 id="_idParaDest-77"><a id="_idTextAnchor076"/>Summary</h1>
			<p>In this chapter, you have learned how to use leverage internet search engines to discover sensitive information about organizations. Additionally, you have gained hands-on skills to perform Google hacking techniques to find interesting domain names and sub-domains for a company. Furthermore, you have explored how to use various techniques and tools to discover and collect OSINT on domain names, sub-domains, and <span class="No-Break">DNS information.</span></p>
			<p>I hope this chapter has been informative for you and helpful in your journey in the cybersecurity industry. In the next chapter, <em class="italic">Organizational Infrastructure Intelligence</em>, you will gain the practical skills needed to identify the network and organizational infrastructure of a <span class="No-Break">targeted organization.</span></p>
			<h1 id="_idParaDest-78"><a id="_idTextAnchor077"/>Further reading</h1>
			<ul>
				<li>DNS <span class="No-Break">servers: </span><a href="https://www.cloudflare.com/learning/dns/what-is-a-dns-server/"><span class="No-Break">https://www.cloudflare.com/learning/dns/what-is-a-dns-server/</span></a></li>
				<li>DNS <span class="No-Break">records: </span><a href="https://www.cloudflare.com/learning/dns/dns-records/&#13;"><span class="No-Break">https://www.cloudflare.com/learning/dns/dns-records/</span></a></li>
				<li><span class="No-Break">SpiderFoot: </span><a href="https://github.com/smicallef/spiderfoot"><span class="No-Break">https://github.com/smicallef/spiderfoot</span></a></li>
			</ul>
		</div>
	</body></html>