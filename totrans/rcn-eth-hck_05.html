<html><head></head><body>
		<div id="_idContainer196">
			<h1 id="_idParaDest-79" class="chapter-number"><a id="_idTextAnchor078"/>5</h1>
			<h1 id="_idParaDest-80"><a id="_idTextAnchor079"/>Organizational Infrastructure Intelligence</h1>
			<p>As more systems and networks are connecting to the internet, there’s a lot more data and information publicly available to everyone around the world. Sometimes, organizations leak data about their assets and network infrastructure without realizing it, and this enables threat actors to strategically collect and analyze those data leaks to plan their future attacks<a id="_idIndexMarker469"/> on a target. As an aspiring ethical hacker, it’s important to understand the <strong class="bold">Tactics, Techniques, and Procedures</strong> (<strong class="bold">TTPs</strong>) that are commonly used by threat actors, and how such knowledge can be used to help organizations safeguard their infrastructure and reduce their attack surface to prevent a real hacker from compromising their systems <span class="No-Break">and networks.</span></p>
			<p>During the course of this chapter, you will learn how<a id="_idIndexMarker470"/> to use various online and offline tools to harvest data from the internet using <strong class="bold">Open Source Intelligence</strong> (<strong class="bold">OSINT</strong>) techniques to identify the infrastructure of an organization. Additionally, you will discover how ethical hackers and threat actors are able to discover vulnerable and exposed systems and devices on the internet and gain a better understanding of how attackers are able to gain a foothold into a <span class="No-Break">target’s network.</span></p>
			<p>In this chapter, we will cover the <span class="No-Break">following topics:</span></p>
			<ul>
				<li>Harvesting data from <span class="No-Break">the internet</span></li>
				<li>Discovering <span class="No-Break">exposed systems</span></li>
				<li>Collecting social <span class="No-Break">media OSINT</span></li>
			</ul>
			<p>Let’s <span class="No-Break">dive in!</span></p>
			<h1 id="_idParaDest-81"><a id="_idTextAnchor080"/>Technical requirements</h1>
			<p>To follow along with the exercises in this chapter, please ensure that you have met the following hardware and <span class="No-Break">software requirements:</span></p>
			<ul>
				<li>Kali <span class="No-Break">Linux: </span><a href="https://www.kali.org/get-kali/"><span class="No-Break">https://www.kali.org/get-kali/</span></a></li>
				<li>Trace Labs OSINT <span class="No-Break">VM: </span><a href="https://www.tracelabs.org/initiatives/osint-vm"><span class="No-Break">https://www.tracelabs.org/initiatives/osint-vm</span></a></li>
				<li><span class="No-Break">Sherlock: </span><a href="https://github.com/sherlock-project/sherlock"><span class="No-Break">https://github.com/sherlock-project/sherlock</span></a></li>
			</ul>
			<h1 id="_idParaDest-82"><a id="_idTextAnchor081"/>Harvesting data from the internet</h1>
			<p>The internet contains<a id="_idIndexMarker471"/> lots of websites, open databases, and servers<a id="_idIndexMarker472"/> that store data about people, networks, and organizations. Before an adversary launches a cyber-attack on their target, the attacker spends sufficient time researching the target to better understand their infrastructure and identify any security vulnerabilities that can be exploited to gain a foothold. Attackers gather and analyze OSINT from multiple data sources to create a profile of their target, which helps to identify targeted hosts, servers, operating systems, network block information, IP addresses, geo-location, subdomains, and so on. Such information is very useful in planning a cyber-attack as it enables the attacker to determine the attack surface of the <span class="No-Break">targeted organization.</span></p>
			<p>As an ethical hacker with a good moral compass and intentions, using the same TTPs as adversaries can help organizations identify how they are intentionally or unintentionally leaking sensitive data about their infrastructure, and how an attacker can leverage the same information collected from data leaks to compromise their systems <span class="No-Break">and networks.</span></p>
			<p>The following are popular websites and open databases for <span class="No-Break">gathering information:</span></p>
			<ul>
				<li><a href="http://www.netcraft.com:">www.netcraft.com:</a> Identify servers, their host operating<a id="_idIndexMarker473"/> systems, and <span class="No-Break">web application</span></li>
				<li><a href="http://www.shodan.io:">www.shodan.io:</a> Identify<a id="_idIndexMarker474"/> servers<a id="_idIndexMarker475"/> and <strong class="bold">Internet of Things</strong> (<span class="No-Break"><strong class="bold">IoT</strong></span><span class="No-Break">) devices</span></li>
				<li><a href="http://censys.io:">censys.io:</a> Identify attack surface on servers<a id="_idIndexMarker476"/> and other <span class="No-Break">connected systems</span></li>
				<li><a href="http://hunter.io:">hunter.io:</a> Identify email addresses<a id="_idIndexMarker477"/> <span class="No-Break">of employees</span></li>
				<li><a href="http://urlscan.io:">urlscan.io:</a> Identify web applications<a id="_idIndexMarker478"/> and <span class="No-Break">web servers</span></li>
				<li><a href="http://intelx.io:">intelx.io:</a> Gather OSINT from<a id="_idIndexMarker479"/> multiple <span class="No-Break">data sources</span></li>
				<li><a href="http://www.wigle.net:">www.wigle.net:</a> Identify wireless networks<a id="_idIndexMarker480"/> around <span class="No-Break">the world</span></li>
				<li><a href="http://fullhunt.io:">fullhunt.io:</a> Collect attack <a id="_idIndexMarker481"/><span class="No-Break">surface data</span></li>
				<li><a href="http://vulners.com:">vulners.com:</a> A search engine for security<a id="_idIndexMarker482"/> intelligence <span class="No-Break">and vulnerabilities</span></li>
				<li><a href="http://viz.greynoise.io:">viz.greynoise.io:</a> Identify <span class="No-Break">threat</span><span class="No-Break"><a id="_idIndexMarker483"/></span><span class="No-Break"> intelligence</span></li>
				<li><a href="http://builtwith.com:">builtwith.com:</a> Identify the web infrastructure<a id="_idIndexMarker484"/> of <span class="No-Break">a domain</span></li>
			</ul>
			<p>The preceding list of search engines will be valuable within your arsenal of tools and resources when performing passive information gathering on your target as an ethical hacker. Ensure you take the time <a id="_idIndexMarker485"/>to visit each of these websites to gain a better <a id="_idIndexMarker486"/>understanding of how they work, and the type of data they provide about <span class="No-Break">a target.</span></p>
			<p>Over the next few subsections, you will learn how to use both Netcraft and Maltego to collect and analyze OSINT about <span class="No-Break">an organization.</span></p>
			<h2 id="_idParaDest-83"><a id="_idTextAnchor082"/>Netcraft</h2>
			<p><strong class="bold">Netcraft</strong> provides various internet security services<a id="_idIndexMarker487"/> that collect and analyze data on various systems and networks found on the internet. One of the most popular services that is leveraged by cybersecurity<a id="_idIndexMarker488"/> professionals such as ethical hackers and penetration testers is the <strong class="bold">Web Server Survey</strong> tool, sometimes referred to as the <strong class="bold">Site Report</strong> tool on the Netcraft website. This tool enables anyone<a id="_idIndexMarker489"/> to identify the technologies and usage of web servers, their web applications, host operating systems, software version, hosting providers, and <span class="No-Break">network blocks.</span></p>
			<p>Netcraft provides the following data about a targeted domain and its <span class="No-Break">web servers:</span></p>
			<ul>
				<li><strong class="bold">Background</strong>: Provides information about the website title, rank, description, and when it was first seen on <span class="No-Break">the internet</span></li>
				<li><strong class="bold">Network</strong>: Provides information about the IPv4 and IPv6 addresses, network block owner, hosting providers and country, name servers, and domain <span class="No-Break">registrar details</span></li>
				<li><strong class="bold">IP delegation</strong>: Contains information about the allocation of IP addresses to <span class="No-Break">the domain</span></li>
				<li><strong class="bold">IP Geolocation</strong>: Provide geo-location details about the domain name and its associated IP address, such as city <span class="No-Break">and country</span></li>
				<li><strong class="bold">SSL/TLS</strong>: Provides information about the digital certificate for the <span class="No-Break">domain name</span></li>
				<li><strong class="bold">Site Technology</strong>: Provides information about the web technologies on the <span class="No-Break">web server</span></li>
				<li><strong class="bold">Hosting History</strong>: Provides information on the network block owner, name of the web application and host operating systems, and IP address of the <span class="No-Break">web server</span></li>
			</ul>
			<p>While the data provided by Netcraft<a id="_idIndexMarker490"/> is intended to help both IT and cybersecurity professionals to improve their organization’s security posture, threat actors can also leverage such information for malicious activities and planning future attacks on a target. However, as an ethical hacker, you can also leverage the information from Netcraft to help you better understand what type of data is being leaked about your organization’s web servers and its infrastructure, and whether there are any known security vulnerabilities <span class="No-Break">on them.</span></p>
			<p>To get started using Netcraft<a id="_idIndexMarker491"/> to profile a web server, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li>Open your web<a id="_idIndexMarker492"/> browser and go to <a href="https://sitereport.netcraft.com/">https://sitereport.netcraft.com/</a>, then insert a target domain name such as <a href="https://microsoft.com">https://microsoft.com</a> within the URL input field, and click on <strong class="bold">Look up</strong>, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer156" class="IMG---Figure">
					<img src="image/Figure_5.01_B19448.jpg" alt="Figure 5.1 – Netcraft lookup"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.1 – Netcraft lookup</p>
			<ol>
				<li value="2">Netcraft will take a few seconds<a id="_idIndexMarker493"/> to analyze the targeted domain and its technologies and then present the information, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer157" class="IMG---Figure">
					<img src="image/Figure_5.02_B19448.jpg" alt="Figure 5.2 – Netcraft data"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.2 – Netcraft data</p>
			<ol>
				<li value="3">Next, scroll down to the <strong class="bold">SSL/TLS</strong> section to identify the geo-location of the company and subdomains from the <span class="No-Break">digital certificate:</span></li>
			</ol>
			<div>
				<div id="_idContainer158" class="IMG---Figure">
					<img src="image/Figure_5.03_B19448.jpg" alt="Figure 5.3 – Identifying interesting data"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.3 – Identifying interesting data</p>
			<p>As shown in the preceding snippet, the digital certificate indicates the country and state of the organization. Additionally, the <strong class="bold">Subject Alternative Name</strong> field indicates the various subdomains that are associated with this <span class="No-Break">digital certificate.</span></p>
			<ol>
				<li value="4">Next, scroll down to the <strong class="bold">Hosting History</strong> section to identify the host operating system, running web<a id="_idIndexMarker494"/> application, and IP addresses of the target’s web server on <span class="No-Break">the internet:</span></li>
			</ol>
			<div>
				<div id="_idContainer159" class="IMG---Figure">
					<img src="image/Figure_5.04_B19448.jpg" alt="Figure 5.4 – Hosting ﻿History"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.4 – Hosting History</p>
			<p>Determining the host operating system and running web applications helps an ethical hacker to improve their planning and identify known security vulnerabilities that can be exploited to gain access to the target’s <span class="No-Break">network infrastructure.</span></p>
			<ol>
				<li value="5">Lastly, Netcraft can be used to provide<a id="_idIndexMarker495"/> a list of subdomains<a id="_idIndexMarker496"/> of a parent domain; go to <a href="https://searchdns.netcraft.com/">https://searchdns.netcraft.com/</a> and enter <strong class="source-inline">.microsoft.com</strong> within the search field and click on <strong class="bold">Search</strong>, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer160" class="IMG---Figure">
					<img src="image/Figure_5.05_B19448.jpg" alt="Figure 5.5 – Subdomain lookup"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.5 – Subdomain lookup</p>
			<p>After a few seconds, Netcraft will provide the results showing a list of subdomains, their network blocks, host operating systems, and the date first seen, as shown in the <span class="No-Break">following screenshot:</span></p>
			<div>
				<div id="_idContainer161" class="IMG---Figure">
					<img src="image/Figure_5.06_B19448.jpg" alt="Figure 5.6 – Finding subdomains"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.6 – Finding subdomains</p>
			<p>As shown in the preceding snippet, Netcraft can be used to collect and identify subdomains of a <span class="No-Break">target</span><span class="No-Break"><a id="_idIndexMarker497"/></span><span class="No-Break"> organization.</span></p>
			<p>Having completed this exercise, you have learned how to use Netcraft to identify the public infrastructure of an organization. Next, you will learn how to use Maltego to collect and analyze OSINT from multiple data sources to improve the profile of <span class="No-Break">a target.</span></p>
			<h2 id="_idParaDest-84"><a id="_idTextAnchor083"/>Maltego</h2>
			<p><strong class="bold">Maltego</strong> is a powerful data collection, visualization, and analysis<a id="_idIndexMarker498"/> tool for performing passive reconnaissance on people, networks, and organizations. This tool was created to assist cybersecurity investigators and analysts in efficiently collecting and analyzing large amounts of OSINT from various data sources, such as online databases, websites, and even social <span class="No-Break">media platforms.</span></p>
			<p>Maltego helps cybersecurity professionals such as ethical hackers and penetration testers to better understand the relationships between complex datasets by showing patterns and associations between different pieces of collected data, which can help identify interesting patterns. This tool is commonly used by ethical hackers during their reconnaissance phase when collecting and analyzing data about <span class="No-Break">their targets.</span></p>
			<p>To get started using Maltego for reconnaissance, please use the <span class="No-Break">following instructions.</span></p>
			<h3>Part 1 – setting up Maltego</h3>
			<p>To set up<a id="_idIndexMarker499"/> Maltego, follow <span class="No-Break">these steps:</span></p>
			<ol>
				<li>Firstly, open<a id="_idIndexMarker500"/> your web browser and go to <a href="https://www.maltego.com/ce-registration/">https://www.maltego.com/ce-registration/</a> to register for a Maltego CE account on the <span class="No-Break">official website.</span></li>
				<li>Next, open the <strong class="bold">VirtualBox Manager</strong> application, power on the Trace Labs virtual machine (TL OSINT VM 2022.1), and log in using <strong class="source-inline">osint</strong>/<strong class="source-inline">osint</strong> as the username <span class="No-Break">and password.</span></li>
				<li>Once you’re logged in to the Trace Labs virtual machine, click on the <strong class="bold">Kali Linux</strong> icon in the top-left corner of the desktop and select <strong class="bold">Open Source Intelligence</strong> | <strong class="bold">Frameworks</strong> | <strong class="bold">maltego</strong>, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer162" class="IMG---Figure">
					<img src="image/Figure_5.07_B19448.jpg" alt="Figure 5.7 – OSINT Frameworks"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.7 – OSINT Frameworks</p>
			<ol>
				<li value="4">Next, the Maltego application will load on the desktop and display the <strong class="bold">Product Selection</strong> window; select <strong class="bold">Maltego CE (Free)</strong> and click <strong class="bold">Run</strong>, as shown in the <span class="No-Break">following</span><span class="No-Break"><a id="_idIndexMarker501"/></span><span class="No-Break"> screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer163" class="IMG---Figure">
					<img src="image/Figure_5.08_B19448.jpg" alt="Figure 5.8 – Production selection"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.8 – Production selection</p>
			<ol>
				<li value="5">Next, the <strong class="bold">Configure Maltego</strong> setup menu will appear; ensure you check <strong class="bold">Accept</strong> and click on <strong class="bold">Next &gt;</strong> <span class="No-Break">to continue:</span></li>
			</ol>
			<div>
				<div id="_idContainer164" class="IMG---Figure">
					<img src="image/Figure_5.09_B19448.jpg" alt="Figure 5.9 – License Agreement"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.9 – License Agreement</p>
			<ol>
				<li value="6">Next, the <strong class="bold">Login</strong> window<a id="_idIndexMarker502"/> will appear; ensure you use the credentials that were created during <em class="italic">Step 1</em> and click on <strong class="bold">Next &gt;</strong> <span class="No-Break">to continue:</span></li>
			</ol>
			<div>
				<div id="_idContainer165" class="IMG---Figure">
					<img src="image/Figure_5.10_B19448.jpg" alt="Figure 5.10 – Logging in to Maltego"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.10 – Logging in to Maltego</p>
			<ol>
				<li value="7">On the <strong class="bold">Login Result</strong> page, your login results will appear; simply click on <span class="No-Break"><strong class="bold">Next &gt;</strong></span><span class="No-Break">.</span></li>
				<li>On the <strong class="bold">Install Transforms</strong> page, the transforms set will install automatically; then click on <span class="No-Break"><strong class="bold">Next &gt;</strong></span><span class="No-Break">.</span></li>
				<li>On the <strong class="bold">Web Browser Options</strong> page, select <strong class="bold">Firefox</strong> as the preferred<a id="_idIndexMarker503"/> web browser and click <span class="No-Break">on </span><span class="No-Break"><strong class="bold">Finish</strong></span><span class="No-Break">.</span></li>
			</ol>
			<h3>Part 2 – working with Maltego</h3>
			<p>To work with<a id="_idIndexMarker504"/> Maltego, follow <span class="No-Break">these steps:</span></p>
			<ol>
				<li>Once the Maltego CE application loads, click on the <strong class="bold">Maltego</strong> icon in the top-left corner of the application window, then select <strong class="bold">New</strong> to create a new case file (project), as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer166" class="IMG---Figure">
					<img src="image/Figure_5.11_B19448.jpg" alt="Figure 5.11 – Creating a new case file"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.11 – Creating a new case file</p>
			<ol>
				<li value="2">Next, to get started with identifying<a id="_idIndexMarker505"/> the infrastructure of a targeted organization, search for the <strong class="bold">Domain</strong> entity from <strong class="bold">Entity Palette</strong>, then drag and drop the <strong class="bold">Domain</strong> entity anywhere onto the graph pane, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer167" class="IMG---Figure">
					<img src="image/Figure_5.12_B19448.jpg" alt="Figure 5.12 – Domain entity"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.12 – Domain entity</p>
			<p>As shown in the preceding snippet, <strong class="bold">Entity Palette</strong> contains various objects that enable us to collect<a id="_idIndexMarker506"/> and analyze data on a target based on their identity, social media, organization, and <span class="No-Break">even network.</span></p>
			<ol>
				<li value="3">Next, double-click on the <strong class="bold">Domain</strong> entity to open its <strong class="bold">Details</strong> pane, then change <strong class="bold">Domain Name</strong> to <strong class="source-inline">microsoft.com</strong> and click <span class="No-Break">on </span><span class="No-Break"><strong class="bold">OK</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer168" class="IMG---Figure">
					<img src="image/Figure_5.13_B19448.jpg" alt="Figure 5.13 – Setting a target domain name"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.13 – Setting a target domain name</p>
			<ol>
				<li value="4">To discover the <strong class="bold">Domain Name System</strong> (<strong class="bold">DNS</strong>) records of the domain, right-click<a id="_idIndexMarker507"/> on the <strong class="bold">Domain</strong> entity | <strong class="bold">All Transforms</strong> | <strong class="bold">To DNS Name – NS</strong> (<strong class="bold">name server</strong>), the result is shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer169" class="IMG---Figure">
					<img src="image/Figure_5.14_B19448.jpg" alt="Figure 5.14 – Identifying name servers"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.14 – Identifying name servers</p>
			<p>As shown in the preceding snippet, Maltego was able to retrieve the name servers for the target<a id="_idIndexMarker508"/> domain. The name servers are used to map the hostnames of a domain to <span class="No-Break">IP addresses.</span></p>
			<ol>
				<li value="5">To discover the email exchange servers of a domain, right-click on the <strong class="bold">Domain</strong> entity | <strong class="bold">All Transforms</strong> | <strong class="bold">To DNS Name – MX</strong> (<strong class="bold">mail server</strong>), the result is shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer170" class="IMG---Figure">
					<img src="image/Figure_5.15_B19448.jpg" alt="Figure 5.15 – Identifying email servers"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.15 – Identifying email servers</p>
			<ol>
				<li value="6">To identify the IP address<a id="_idIndexMarker509"/> of the email server, right-click on the <strong class="bold">Email Server</strong> entity | <strong class="bold">All Transforms</strong> | <strong class="bold">To IP Address</strong> [<strong class="bold">DNS</strong>], the result is shown in <span class="No-Break"><em class="italic">Figure 5</em></span><span class="No-Break"><em class="italic">.16</em></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer171" class="IMG---Figure">
					<img src="image/Figure_5.16_B19448.jpg" alt="Figure 5.16 – Identifying IP addresses"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.16 – Identifying IP addresses</p>
			<ol>
				<li value="7">To find the website that is associated with the domain name, right-click on the <strong class="bold">Domain</strong> entity | <strong class="bold">All Transforms</strong> | <strong class="bold">To Website</strong> [<span class="No-Break"><strong class="bold">Quick lookup</strong></span><span class="No-Break">].</span></li>
				<li>Next, to identify<a id="_idIndexMarker510"/> the IP address(es) of the website, right-click on the <strong class="bold">Website</strong> entity | <strong class="bold">To IP Address</strong> [<strong class="bold">DNS</strong>], the result is shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer172" class="IMG---Figure">
					<img src="image/Figure_5.17_B19448.jpg" alt="Figure 5.17 – IP addresses associated with the website"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.17 – IP addresses associated with the website</p>
			<p>As shown in the preceding snippet, Maltego was able to retrieve the IPv4 and IPv6 addresses of the <span class="No-Break">target website.</span></p>
			<ol>
				<li value="9">To retrieve email addresses that are associated with the domain, right-click on the <strong class="bold">Domain</strong> entity | <strong class="bold">Email Addresses from Domain</strong> | <strong class="bold">To Email Addresses</strong> [<strong class="bold">PGP</strong>], the result is shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer173" class="IMG---Figure">
					<img src="image/Figure_5.18_B19448.jpg" alt="Figure 5.18 – Harvesting email addresses"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.18 – Harvesting email addresses</p>
			<p>As shown in the preceding snippet, Maltego was able to harvest the email addresses of users that are associated with the domain. Email harvesting can be leveraged for social engineering attacks as an attack vector for gaining access to the target’s systems<a id="_idIndexMarker511"/> <span class="No-Break">and networks.</span></p>
			<p>Having completed this section, you have learned how to harvest OSINT from the internet and identify the infrastructure of an organization using Netcraft and Maltego. In the next section, you will learn how to discover unintentionally exposed systems and networks on <span class="No-Break">the internet.</span></p>
			<h1 id="_idParaDest-85"><a id="_idTextAnchor084"/>Discovering exposed systems</h1>
			<p>During the reconnaissance<a id="_idIndexMarker512"/> phase, it’s essential for ethical hackers and penetration testers to identify the internal and external network infrastructure of their targets, as such information is useful for identifying the attack surface and attack vectors and developing exploits for future operations. Organizations often connect their systems and networks to the internet without performing a reconnaissance or OSINT penetration test on their own infrastructure to determine whether any of their assets are unintentionally exposed on the internet. Ethical hackers and penetration testers are hired by organizations to identify how their systems and network infrastructures are exposed and how their attack surface can be reduced to prevent future cyber-attacks <span class="No-Break">and threats.</span></p>
			<p>During this section, you will learn how threat actors<a id="_idIndexMarker513"/> and cybersecurity professionals can collect OSINT from specialized search engines to identify an organization’s infrastructure and exposed service ports on servers. In addition, you will learn how recruiters often leak sensitive data on job boards about their organization’s systems and network infrastructure, which enables attackers to improve their planning <span class="No-Break">and operations.</span></p>
			<h2 id="_idParaDest-86"><a id="_idTextAnchor085"/>Shodan</h2>
			<p><strong class="bold">Shodan</strong> is a specialized internet search engine<a id="_idIndexMarker514"/> that enables cybersecurity professionals such as ethical hackers to discover exposed systems such as servers, IoT devices, modems, video surveillance systems, and <strong class="bold">Industrial Control Systems</strong> (<strong class="bold">ICSes</strong>). Shodan helps cybersecurity professionals<a id="_idIndexMarker515"/> to determine whether their organizations’ systems are exposed on the internet and what type of data can be collected by an adversary. For instance, many organizations have connected their network infrastructure to the internet without realizing that their internal servers and systems are unintentionally exposed to everyone and everything on the internet, such as hackers <span class="No-Break">and malware.</span></p>
			<p>For an ethical hacker, the data collected from Shodan can help identify exposed servers, open service ports, running services and technologies, and known security vulnerabilities. Such information can be used by real adversaries when planning their attack on an organization. However, ethical hackers use the same techniques and information to simulate real-world cyber-attacks to identify hidden security vulnerabilities, while providing insights on how to reduce the attack surface. It’s important to remember that not all organizations have the same level of security awareness training, a dedicated security team, and the know-how to safeguard their assets. Hence, ethical hackers and penetration testers are white-hat hackers who use their skills to help companies improve their cyber defenses and security posture to prevent a real cyber-attack in <span class="No-Break">the future.</span></p>
			<p>To get started using Shodan, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li value="1">On your computer, open<a id="_idIndexMarker516"/> your web browser, go to <a href="https://www.shodan.io/">https://www.shodan.io/</a> and register for a free <span class="No-Break">user account.</span></li>
				<li>Once your user account<a id="_idIndexMarker517"/> is created, log in to the Shodan website, as shown in <span class="No-Break"><em class="italic">Figure 5</em></span><span class="No-Break"><em class="italic">.19</em></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer174" class="IMG---Figure">
					<img src="image/Figure_5.19_B19448.jpg" alt="Figure 5.19 – Shodan website"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.19 – Shodan website</p>
			<ol>
				<li value="3">Using the Shodan search bar, perform a search for <strong class="source-inline">windows server 2008</strong> to find all systems on the internet that are running Microsoft Windows Server 2008, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer175" class="IMG---Figure">
					<img src="image/Figure_5.20_B19448.jpg" alt="Figure 5.20 – Identifying Windows Server machines"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.20 – Identifying Windows Server machines</p>
			<ol>
				<li value="4">Next, to filter the search results based <a id="_idIndexMarker518"/>on a specific country, append the <strong class="source-inline">country:"country code"</strong> syntax to the search, such as <strong class="source-inline">windows server 2008 country:"US"</strong>, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer176" class="IMG---Figure">
					<img src="image/Figure_5.21_B19448.jpg" alt="Figure 5.21 – Identifying devices based on their location"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.21 – Identifying devices based on their location</p>
			<p>As shown in the preceding snippet, the country syntax enables us to filter results for a specific country or geo-location. This syntax is useful for identifying the servers of a company within a <span class="No-Break">specific location.</span></p>
			<p class="callout-heading">Tip</p>
			<p class="callout">To learn more about<a id="_idIndexMarker519"/> Shodan filters, please <span class="No-Break">see </span><a href="https://www.shodan.io/search/filters"><span class="No-Break">https://www.shodan.io/search/filters</span></a><span class="No-Break">.</span></p>
			<ol>
				<li value="5">To identify servers and devices that are running<a id="_idIndexMarker520"/> a specific service or open port, add the <strong class="source-inline">port:port_number</strong> syntax to the search bar, such as <strong class="source-inline">windows server 2008 country:"US" port:3389</strong>, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer177" class="IMG---Figure">
					<img src="image/Figure_5.22_B19448.jpg" alt="Figure 5.22 – Identifying devices with specific running services"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.22 – Identifying devices with specific running services</p>
			<p>As shown in the preceding snippet, Shodan was able to identify a Microsoft Windows Server 2008 system within<a id="_idIndexMarker521"/> the United States, which has service port <strong class="source-inline">3389</strong> and is running <strong class="bold">Remote Desktop Protocol</strong> (<strong class="bold">RDP</strong>). Additionally, Shodan was able to perform a screen capture on the login window and display <span class="No-Break">users’ accounts.</span></p>
			<ol>
				<li value="6">Next, click on any system<a id="_idIndexMarker522"/> on the search results page to view specific details about the server such as open service ports, running services, and whether there are any known <span class="No-Break">security vulnerabilities:</span></li>
			</ol>
			<div>
				<div id="_idContainer178" class="IMG---Figure">
					<img src="image/Figure_5.23_B19448.jpg" alt="Figure 5.23 – Geo-location data"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.23 – Geo-location data</p>
			<p>As shown in the preceding snippet, Shodan collects geo-location details, which can be used by an ethical hacker to identify the physical location of their target during a penetration <span class="No-Break">testing assessment.</span></p>
			<p>The following snippet shows the open service port numbers on the server and <span class="No-Break">running services:</span></p>
			<div>
				<div id="_idContainer179" class="IMG---Figure">
					<img src="image/Figure_5.24_B19448.jpg" alt="Figure 5.24 – Identifying open ports and services"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.24 – Identifying open ports and services</p>
			<p>Whenever a service<a id="_idIndexMarker523"/> is running on a server, a service port is open to listen for incoming messages. Ethical hackers<a id="_idIndexMarker524"/> can profile a service<a id="_idIndexMarker525"/> and determine<a id="_idIndexMarker526"/> the number of services<a id="_idIndexMarker527"/> that are running<a id="_idIndexMarker528"/> by identifying open service ports, such as <strong class="bold">Hypertext Transfer Protocol</strong> (<strong class="bold">HTTP</strong>) – port <strong class="source-inline">80</strong>, <strong class="bold">Remote Procedure Call</strong> (<strong class="bold">RPC</strong>) – port <strong class="source-inline">135</strong>, <strong class="bold">NetBIOS</strong> – ports <strong class="source-inline">137</strong> and <strong class="source-inline">139</strong>, <strong class="bold">Hypertext Transfer Protocol Secure</strong> (<strong class="bold">HTTPS</strong>) – port <strong class="source-inline">443</strong>, <strong class="bold">Server Message Block</strong> (<strong class="bold">SMB</strong>) – port <strong class="source-inline">445</strong>, and RDP – port <strong class="source-inline">3389</strong>. Then, the ethical hacker can identify security vulnerabilities within each running service that can be exploited to gain access to the <span class="No-Break">target system.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">To learn more about each service<a id="_idIndexMarker529"/> port number, please see the service name and port number registry <span class="No-Break">at </span><a href="https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml"><span class="No-Break">https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml</span></a><span class="No-Break">.</span></p>
			<p>Lastly, Shodan is able to identify known<a id="_idIndexMarker530"/> security vulnerabilities on servers and devices, listing their <strong class="bold">Common Vulnerabilities and Exposures</strong> (<strong class="bold">CVE</strong>) identifier and description, as shown<a id="_idIndexMarker531"/> in the <span class="No-Break">following screenshot:</span></p>
			<div>
				<div id="_idContainer180" class="IMG---Figure">
					<img src="image/Figure_5.25_B19448.jpg" alt="Figure 5.25 – Vulnerabilities on the server"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.25 – Vulnerabilities on the server</p>
			<p>As shown in the preceding steps, ethical hackers can collect the data found on Shodan to create a profile of their target’s system and network infrastructure, identify host operating systems and running services, open service port numbers, vulnerabilities, and even usernames for <span class="No-Break">remote services.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">To gain more information<a id="_idIndexMarker532"/> about a reported vulnerability, visit <a href="https://cve.mitre.org/">https://cve.mitre.org/</a>, which is an open database that enables security professionals to record and track security vulnerabilities. In addition, each CVE record provides details about the vulnerability such as how it can be exploited and recommendations on resolving <span class="No-Break">the issue.</span></p>
			<p>Having completed this exercise, you have learned how to use Shodan to discover vulnerable and exposed systems<a id="_idIndexMarker533"/> on the internet. Next, you will learn how to leverage the data from Censys to identify systems owned by <span class="No-Break">an organization.</span></p>
			<h2 id="_idParaDest-87"><a id="_idTextAnchor086"/>Censys</h2>
			<p>Censys is a search engine that enables ethical hackers<a id="_idIndexMarker534"/> to collect information about servers and identify their attack surfaces. It operates by indexing data from domain names, IP addresses, digital certificates, and other elements found on the internet. The data is collected, analyzed, and presented in a user-friendly format, thus enabling ethical hackers to easily find specific data about their target during the <span class="No-Break">reconnaissance phase.</span></p>
			<p>To get started with using Censys to identify the attack surface of an organization, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li>On your computer, open<a id="_idIndexMarker535"/> the web browser and go to <a href="https://search.censys.io/">https://search.censys.io/</a>. Register for an account and <span class="No-Break">log in:</span></li>
			</ol>
			<div>
				<div id="_idContainer181" class="IMG---Figure">
					<img src="image/Figure_5.26_B19448.jpg" alt="Figure 5.26 – Censys ﻿search"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.26 – Censys search</p>
			<ol>
				<li value="2">Next, in the <strong class="bold">Search</strong> field, enter the IP address or domain name of a target and click on <strong class="bold">Search</strong> to perform a lookup, as shown in <span class="No-Break"><em class="italic">Figure 5</em></span><span class="No-Break"><em class="italic">.27</em></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer182" class="IMG---Figure">
					<img src="image/Figure_5.27_B19448.jpg" alt="Figure 5.27 – IP lookup"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.27 – IP lookup</p>
			<p>As shown in the preceding <a id="_idIndexMarker536"/>snippet, Censys was able to retrieve the network data about the IP address such as open ports and running services on the server, its geo-location, and its digital <span class="No-Break">certificate details.</span></p>
			<ol>
				<li value="3">Next, click on the <strong class="bold">Explore</strong> tab to view the associated IP addresses, domain names, <span class="No-Break">and servers:</span></li>
			</ol>
			<div>
				<div id="_idContainer183" class="IMG---Figure">
					<img src="image/Figure_5.28_B19448.jpg" alt="Figure 5.28 – Viewing associated systems"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.28 – Viewing associated systems</p>
			<p>If you right-click on any system shown on the <strong class="bold">Explore</strong> tab, you can further gather intelligence on that system such as its hostname and certificate details. This is useful when performing external network penetration testing and identifying additional assets owned by <span class="No-Break">the target.</span></p>
			<ol>
				<li value="4">Click the <strong class="bold">History</strong> tab to view a list<a id="_idIndexMarker537"/> of changes that are observed on the target system. History data is valuable to ethical hackers as it indicates software or <span class="No-Break">configuration changes.</span></li>
				<li>Lastly, click on the <strong class="bold">WHOIS</strong> tab to gather the network, hosting, and registrar details of the target, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer184" class="IMG---Figure">
					<img src="image/Figure_5.29_B19448.jpg" alt="Figure 5.29 – WHOIS data"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.29 – WHOIS data</p>
			<p>The information provided by Censys can be used<a id="_idIndexMarker538"/> to improve the profile of a target, such as identifying additional assets, open ports, and running services on servers. Such information is useful for determining the attack surface and security vulnerabilities on the systems and networks of an organization. In addition, ethical hackers can provide insights on how their organization is leaking technical data about their assets on the internet and how it can be leveraged <span class="No-Break">by adversaries.</span></p>
			<h2 id="_idParaDest-88"><a id="_idTextAnchor087"/>Job boards</h2>
			<p>In the workforce around the world, people<a id="_idIndexMarker539"/> commonly move between different companies and jobs according to their preference, and companies expand, creating new opportunities to hire additional staff. As a result, whenever an employee leaves their current job role either<a id="_idIndexMarker540"/> for a promotion or to exit the organization, the <strong class="bold">Human Resources</strong> (<strong class="bold">HR</strong>) department starts the off-boarding process and starts looking for a new candidate to fill the existing role. In doing so, the HR recruiter will post details about the vacant position on one or more recruiting websites, enabling anyone to view the description and requirements for a <span class="No-Break">preferred candidate.</span></p>
			<p>However, organizations sometimes leak too much sensitive data about their systems and network infrastructure when posting a job vacancy for a technical role within their company. From a HR perspective, they are listing all the necessary details for a potential candidate to be aware of before applying for the position. For instance, the job description contains the summary, role, responsibilities (duties), and required qualifications to help the candidate better understand whether the position is suitable <span class="No-Break">for them.</span></p>
			<p>From an adversary’s perspective, the technical<a id="_idIndexMarker541"/> details found on a job post can be leveraged as OSINT as they identify the technologies, operating systems, vendor devices, systems, and network infrastructure of the company’s internal network. An attacker can use this information to research security vulnerabilities in the IT infrastructure, create exploits and malware, and determine which attack vectors are suitable for delivering the payload to the target. As an ethical hacker or penetration tester, recruiting websites are valuable data sources when collecting OSINT on a targeted organization, as the recruiter or HR personnel may leak a lot of sensitive data without <span class="No-Break">realizing it.</span></p>
			<p>To gain a better understanding of how adversaries and ethical hackers can leverage the data found<a id="_idIndexMarker542"/> on a job post, let’s analyze the <span class="No-Break">following snippet:</span></p>
			<div>
				<div id="_idContainer185" class="IMG---Figure">
					<img src="image/Figure_5.30_B19448.jpg" alt="Figure 5.30 – Data leakage on job post"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.30 – Data leakage on job post</p>
			<p>As shown in the preceding snippet, the recruiter<a id="_idIndexMarker543"/> listed the main qualifications and experience/knowledge<a id="_idIndexMarker544"/> required for an ideal candidate, such as Microsoft 365, Azure <strong class="bold">Active Directory</strong> (<strong class="bold">AD</strong>), wireless networking, routing and switching, firewalls, <strong class="bold">Virtual Private Networks</strong> (<strong class="bold">VPNs</strong>), Windows Servers, disaster<a id="_idIndexMarker545"/> recovery systems, and <span class="No-Break">so on.</span></p>
			<p>The following can be derived from the technical list found in the <span class="No-Break">preceding snippet:</span></p>
			<ul>
				<li>The organization is using a cloud computing provider to host some of its services and resources. Therefore, if their IT team has misconfigured a cloud service, the ethical hacker may gain a foothold and access to the cloud resources owned by <span class="No-Break">the target.</span></li>
				<li>The organization is using Microsoft 365 applications and services, perhaps SharePoint and cloud-based email services. This means the ethical hacker can use social engineering techniques to trick employees into revealing their user credentials to gain access to <span class="No-Break">users’ accounts.</span></li>
				<li>There’s a wireless network infrastructure available at the physical location(s) of the company. Therefore, an ethical hacker can identify the physical location of the company and compromise the wireless network to gain a foothold in the <span class="No-Break">internal network.</span></li>
				<li>There is an enterprise wired network infrastructure with routers and switches. It’s important to have a solid foundation in networking and understand how major networking vendor devices are configured and how <span class="No-Break">they operate.</span></li>
				<li>The organization has one or more firewall appliances for filtering traffic <span class="No-Break">between networks.</span></li>
				<li>The company is using a site-to-site VPN between branch offices and/or a remote access VPN for various employees. Therefore, compromising a branch office with weak security enables the ethical hacker to pivot the attack from one branch office to another. Additionally, compromising the VPN user’s account enables the ethical hacker to remotely connect to the targeted network infrastructure while pretending to be an <span class="No-Break">authorized user.</span></li>
				<li>There are on-premises Windows Servers and the organization is using Microsoft Azure AD services for replication and redundancy. Therefore, the ethical hacker can create or obtain exploits for Microsoft Windows Server operating systems and research vulnerabilities within Microsoft AD roles <span class="No-Break">and services.</span></li>
			</ul>
			<p>Furthermore, when an organization<a id="_idIndexMarker546"/> posts a job vacancy on a recruiting website, it’s recommended to visit the company’s social media page and official website to identify any additional data leaks that can be used to improve the profiling of the target. Sometimes, the target may create a social media post indicating a new technology was recently implemented within their networks. However, an ethical hacker can use the information to research security vulnerabilities in the system to better plan their <span class="No-Break">attack methodology.</span></p>
			<p>Having completed this section, you have discovered various tactics and techniques that are commonly used by threat actors and ethical hackers to collect and analyze OSINT to create a profile of <span class="No-Break">their target.</span></p>
			<h1 id="_idParaDest-89"><a id="_idTextAnchor088"/>Collecting social media OSINT</h1>
			<p>Social networking platforms<a id="_idIndexMarker547"/> provide a medium that enables people to digitally connect and share experiences and life moments with their friends and families beyond traditional boundaries. With social media platforms, a person can create an account and update their profile as their life changes, share photographs and videos of precise moments with others, and join discussion groups for mutual topics. With social media platforms, people no longer need to be physically present at a specific location to participate in a forum; they can simply join an online group that enables them to post their opinions and comment on <span class="No-Break">other discussions.</span></p>
			<p>People use social media for various purposes ranging from connecting with friends and family to starting and advertising an online business from their homes. Social media has changed the way that humans connect with each other and share information. For instance, news companies use social media to post about events in real time to share awareness with their online followers, hence enabling the company to expand its reachability to a wider audience. A lot of organizations around the world use social media platforms to market their products and services to new and existing customers each day and gain feedback from consumers on how they can improve <span class="No-Break">their services.</span></p>
			<p>To put it simply, social media platforms help many people and organizations to share information and connect with others around the world. However, threat actors also use social platforms to collect information about their targets, such as people and organizations. Organizations commonly post about new products, services, and job vacancies on their social media pages. A hacker can use the list of followers from the company’s social media page to identify the employees of the targeted organization. Such information can be used for social engineering attacks on the employees, with the intention of tricking them into revealing their user credentials or installing malware onto the company’s systems. Sometimes, an organization may advertise a new job vacancy and leak a lot of technical details about its internal infrastructure to the public, which can be leveraged <span class="No-Break">by attackers.</span></p>
			<p>As an ethical hacker who is gathering information on a target, social media platforms contain an abundance<a id="_idIndexMarker548"/> of data about people and organizations. For instance, the following types of data can be found and collected from a person’s social <span class="No-Break">media profile:</span></p>
			<ul>
				<li><strong class="bold">Contact details</strong>: Email addresses and telephone numbers can be used for future social <span class="No-Break">engineering attacks.</span></li>
				<li><strong class="bold">Photos and videos</strong>: These media types may contain pictures of their employee badges, workspace, computers, office location, and sensitive objects in the background. For instance, a picture of an employee badge enables attackers to create a forged badge to gain physical access to a building. Pictures and videos may reveal passwords written on paper, applications running on a computer, and the location of where the photo <span class="No-Break">was taken.</span></li>
				<li><strong class="bold">Their favorite place for lunch</strong>: Such information can be used to determine the likelihood of this person visiting the particular restaurant<a id="_idIndexMarker549"/> during lunchtime. This creates the idea of setting up a <em class="italic">watering hole attack</em> at the restaurant location. <strong class="bold">Watering hole attacks</strong> enables the threat actor to target a specific group of people by infecting commonly visited websites with malware or even compromising the wireless network of the restaurant in the hope that the employee connects their mobile device to the wireless network and becomes infected with malware from the <span class="No-Break">threat actor.</span></li>
				<li><strong class="bold">View likes and dislikes</strong>: Such information can be useful to determine the person’s preferences and whether they are a <span class="No-Break">disgruntled employee.</span></li>
				<li><strong class="bold">Friends and connections</strong>: The friends and connections list may contain additional employees of the targeted organization, and their profiles might be leaking sensitive data about <span class="No-Break">the company.</span></li>
				<li><strong class="bold">Usernames</strong>: Social media platforms enable users to list their additional social media handles on their profiles. The handles are the usernames for their <span class="No-Break">online accounts.</span></li>
			</ul>
			<p>Various online tools are commonly used to help ethical hackers quickly find the social media accounts of people and organizations. For instance, <strong class="bold">Social Searcher</strong> (<a href="http://www.social-searcher.com">www.social-searcher.com</a>) enables you to find social media<a id="_idIndexMarker550"/> accounts based on mentions (hashtags), users, <span class="No-Break">and trends.</span></p>
			<p>The following snippet shows the results when I search my name on <span class="No-Break">Social Searcher:</span></p>
			<div>
				<div id="_idContainer186" class="IMG---Figure">
					<img src="image/Figure_5.31_B19448.jpg" alt="Figure 5.31 – Social Searcher"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.31 – Social Searcher</p>
			<p>The preceding snippet is a proof-of-concept in which I’ve performed a lookup using my name, and the results show various social media profiles and posts I’ve made in the past. Similarly, an ethical hacker can use this online tool to quickly discover the social media profiles and accounts<a id="_idIndexMarker551"/> of a target, whether the target is a person or <span class="No-Break">an organization.</span></p>
			<p>Over the next few subsections, you will learn how to collect data on social media accounts using various tools <span class="No-Break">and techniques.</span></p>
			<h2 id="_idParaDest-90"><a id="_idTextAnchor089"/>Sherlock</h2>
			<p><strong class="bold">Sherlock</strong> is a popular OSINT tool that enables ethical hackers<a id="_idIndexMarker552"/> to efficiently perform username<a id="_idIndexMarker553"/> lookups on multiple social media websites to identify the accounts of their targets. This tool quickly searches over 200 social media platforms for the target’s username, automates the checking process on each website, and provides a report <span class="No-Break">upon completion.</span></p>
			<p>To get started using Sherlock to discover where a targeted username is found on the internet, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li>Firstly, power on your Kali Linux <span class="No-Break">virtual machine.</span></li>
				<li>Next, open the Terminal<a id="_idIndexMarker554"/> and execute the following commands to update<a id="_idIndexMarker555"/> the package repository source list and download Sherlock from its official <span class="No-Break">GitHub repository:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo apt update</strong></pre><pre class="source-code">
kali@kali:~$ <strong class="bold">git clone https://github.com/sherlock-project/sherlock</strong></pre></li>
				<li>Next, use the following commands to change the working directory to the Sherlock folder and install its requirements <span class="No-Break">and dependencies:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">cd sherlock</strong></pre><pre class="source-code">
kali@kali:~/sherlock$ <strong class="bold">python3 -m pip install -r requirements.txt</strong></pre></li>
				<li>Once the installation is complete, use the <strong class="source-inline">python3 sherlock &lt;username&gt;</strong> syntax to perform a username lookup on various social media platforms, as <span class="No-Break">shown here:</span><pre class="source-code">
kali@kali:~/sherlock$ <strong class="bold">python3 sherlock microsoft --timeout 5</strong></pre></li>
			</ol>
			<p>The following snippet shows the execution of the preceding commands with <strong class="source-inline">--timeout</strong> used to instruct Sherlock to spend no more than 5 seconds on any of the social <span class="No-Break">media websites:</span></p>
			<div>
				<div id="_idContainer187" class="IMG---Figure">
					<img src="image/Figure_5.32_B19448.jpg" alt="Figure 5.32 – Sherlock"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.32 – Sherlock</p>
			<ol>
				<li value="5">After Sherlock completes<a id="_idIndexMarker556"/> its lookup, it automatically creates<a id="_idIndexMarker557"/> a text file within its current directory with a list of social media websites where the username <span class="No-Break">was found:</span></li>
			</ol>
			<div>
				<div id="_idContainer188" class="IMG---Figure">
					<img src="image/Figure_5.33_B19448.jpg" alt="Figure 5.33 – Displaying the collected data"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.33 – Displaying the collected data</p>
			<p>As shown in the preceding snippet, Sherlock has extracted the results and inserted them into a text file. This enables ethical hackers to semi-automate their data collection process when performing multiple username lookups at the same time. However, ensure you manually check each URL within the results to ensure <span class="No-Break">it’s valid.</span></p>
			<p class="callout-heading">Tip</p>
			<p class="callout">To learn more about Sherlock and its functionality, check out its official GitHub repository <span class="No-Break">at </span><a href="https://github.com/sherlock-project/sherlock"><span class="No-Break">https://github.com/sherlock-project/sherlock</span></a><span class="No-Break">.</span></p>
			<p>As an ethical hacker, the data collected<a id="_idIndexMarker558"/> from Sherlock can be further used<a id="_idIndexMarker559"/> to discover usernames and data leakage of sensitive information and find employees and contact details, which can be used to plan future operations such as social <span class="No-Break">engineering attacks.</span></p>
			<h2 id="_idParaDest-91"><a id="_idTextAnchor090"/>Facebook IDs</h2>
			<p>Facebook is a popular online social networking<a id="_idIndexMarker560"/> platform that enables people<a id="_idIndexMarker561"/> and organizations to digitally connect and share information with each other. When a user registers for an account, a user <strong class="bold">profile</strong> is automatically created and enables the person to update their profile details, share media, and connect with others. Once the account is created, the user can join or create groups and pages on Facebook. <strong class="bold">Groups</strong> are simply large bodies of people with similar interests or discussions, and <strong class="bold">pages</strong> are like digital places and enable organizations, professionals, and artists to connect with their customers <span class="No-Break">and supporters.</span></p>
			<p>When an account (profile), page, or group is created, Facebook automatically assigns a unique identifier to it. If there are two or more accounts with the same name, the identifier is a unique number that can be used to distinguish one account from the other. As an ethical hacker, you can obtain these identifiers when you’re collecting information on a target who uses Facebook as their social media platform. Such information can be used to identify a targeted account and filter their posts to find sensitive details about the <span class="No-Break">account holder.</span></p>
			<p>When you’re logged in to Facebook as a user, you can use the search bar to find people, groups, and pages. If you’re looking for common places that were visited by the target, then you’ll need to tweak the Facebook search filters until you’re able to find what you’re looking for. However, we can leverage the <strong class="bold">Intelligence X</strong> platform to help us find specific<a id="_idIndexMarker562"/> types of data about an account, group, or page on Facebook. Intelligence X is a search engine and data archival platform that helps ethical hackers to find specific data about a target from multiple <span class="No-Break">data sources.</span></p>
			<p>To get started using <strong class="bold">Intelligence X</strong> to gather<a id="_idIndexMarker563"/> social media intelligence, please use<a id="_idIndexMarker564"/> the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li>Firstly, ensure you’re logged in to Facebook at <a href="http://www.facebook.com">www.facebook.com</a> using your <strong class="bold">sock </strong><span class="No-Break"><strong class="bold">puppet</strong></span><span class="No-Break"> account.</span></li>
				<li>Next, find your target’s account or page by using the Facebook search field. For instance, we can use a public figure page for <span class="No-Break">this exercise:</span></li>
			</ol>
			<div>
				<div id="_idContainer189" class="IMG---Figure">
					<img src="image/Figure_5.34_B19448.jpg" alt="Figure 5.34 – Facebook page"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.34 – Facebook page</p>
			<p>On the account or page, you can see a lot of information such as recently visited places, photos with sensitive details, videos, and <span class="No-Break">so on.</span></p>
			<ol>
				<li value="3">When you’re on a target’s profile or page, right-click anywhere on the page and select <strong class="bold">View Page Source</strong> to view the <span class="No-Break">web coding.</span></li>
				<li>Next, use the <strong class="bold">Find</strong> feature on your web browser and search for <strong class="source-inline">userID</strong>, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer190" class="IMG---Figure">
					<img src="image/Figure_5.35_B19448.jpg" alt="Figure 5.35 – Finding the userID value"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.35 – Finding the userID value</p>
			<p>As shown in the preceding snippet, the <strong class="source-inline">userID</strong> value for the profile or page is <strong class="source-inline">4</strong>. Ensure you record<a id="_idIndexMarker565"/> this value as it will be needed<a id="_idIndexMarker566"/> in the <span class="No-Break">later steps.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Facebook accounts (profiles), groups, and pages contain a unique identifier that can be found in their source code. These can be found by searching for <strong class="source-inline">userID</strong>, <strong class="source-inline">entity_id</strong>, <strong class="source-inline">page_id</strong>, and <strong class="source-inline">group_id</strong> within the <span class="No-Break">source code.</span></p>
			<ol>
				<li value="5">Next, open a new tab on the<a id="_idIndexMarker567"/> same web browser and go to the <strong class="bold">Intelligence X</strong> tools page at <a href="https://intelx.io/tools">https://intelx.io/tools</a>. In the <strong class="bold">Social Media Tools</strong> category, click on <strong class="bold">Facebook</strong> to open <strong class="bold">Facebook </strong><span class="No-Break"><strong class="bold">Graph Searcher</strong></span><span class="No-Break">.</span></li>
				<li>Next, enter the <strong class="source-inline">userID</strong> value (<strong class="source-inline">4</strong>) in the <strong class="bold">ID of the user</strong> field and a keyword in the <strong class="bold">Talking about</strong> field to filter the search results and click on <strong class="bold">Search</strong>, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer191" class="IMG---Figure">
					<img src="image/Figure_5.36_B19448.jpg" alt="Figure 5.36 – Facebook Graph Searcher"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.36 – Facebook Graph Searcher</p>
			<ol>
				<li value="7">Next, a new tab will automatically<a id="_idIndexMarker568"/> open and will load the search results<a id="_idIndexMarker569"/> for the targeted profile or page using the keyword to filter the results, as shown in <span class="No-Break">the screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer192" class="IMG---Figure">
					<img src="image/Figure_5.37_B19448.jpg" alt="Figure 5.37 – Filtering social media posts"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.37 – Filtering social media posts</p>
			<p>As shown in the preceding snippet, the results were filtered using the keyword <span class="No-Break"><strong class="source-inline">New York</strong></span><span class="No-Break">.</span></p>
			<p>As an ethical hacker, Intelligence X provides<a id="_idIndexMarker570"/> the capabilities of quickly filtering search<a id="_idIndexMarker571"/> results for posts, pictures, and videos that are made by a target. In addition, the keyword helps to filter the search results, enabling us to find specific types <span class="No-Break">of data.</span></p>
			<h2 id="_idParaDest-92"><a id="_idTextAnchor091"/>Instagram</h2>
			<p>Instagram is a social media platform<a id="_idIndexMarker572"/> that allows people to share photos and videos<a id="_idIndexMarker573"/> with their followers. As an ethical hacker, you will commonly notice people sharing photos of themselves and other objects without considering what’s in the background of these pictures <span class="No-Break">or videos.</span></p>
			<p>The following are key details to consider when collecting information <span class="No-Break">from Instagram:</span></p>
			<ul>
				<li>Who are the people in the photos? Are these people all connected? If <span class="No-Break">so, how?</span></li>
				<li>What are the objects in <span class="No-Break">the background?</span></li>
				<li>Can you identify the geo-location of the photo based on the <span class="No-Break">background objects?</span></li>
				<li>When and where was the <span class="No-Break">photo taken?</span></li>
			</ul>
			<p>Sometimes, people or employees<a id="_idIndexMarker574"/> of an organization upload photos of themselves but reveal their desktop<a id="_idIndexMarker575"/> icons or files on their computer’s monitor. A <strong class="bold">threat actor</strong> who is targeting an organization can find photos that are uploaded <a id="_idIndexMarker576"/>by employees and look for anything within each picture that can help improve the exploitation phase of the cyber-attack. For instance, desktop icons on a computer can reveal the type of applications and software that are commonly used by employees, and the attacker can identify the host operating system based on the desktop interface and any user credentials that are written on paper on <span class="No-Break">the desk.</span></p>
			<p>Collecting data on social media platforms has become more challenging over the past years as improved security and privacy features are implemented to protect users. However, by visiting an Instagram user’s profile or page, you can collect the <span class="No-Break">following data:</span></p>
			<ul>
				<li><span class="No-Break">Usernames</span></li>
				<li><span class="No-Break">Email addresses</span></li>
				<li><span class="No-Break">Telephone numbers</span></li>
				<li><span class="No-Break">Addresses</span></li>
				<li><span class="No-Break">Hashtags</span></li>
			</ul>
			<p>Each profile or page displays the account’s username as their handle; therefore, ethical hackers can perform username harvesting of targeted accounts. Many businesses list their contact details and addresses on their Instagram profile or page to help their potential customers communicate with them. However, the contact details and addresses can be used for planning social engineering attacks and determining the geo-location of the company. Sometimes, people and organizations use hashtags to create a trend. Therefore, monitoring hashtags enables you to track and get notifications whenever the target or anyone uses the hashtag in <span class="No-Break">their posts.</span></p>
			<p>As a proof-of-concept, the following snippet shows my personal Instagram page with some <span class="No-Break">intelligence data:</span></p>
			<div>
				<div id="_idContainer193" class="IMG---Figure">
					<img src="image/Figure_5.38_B19448.jpg" alt="Figure 5.38 – Instagram page"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.38 – Instagram page</p>
			<p>As shown in the preceding<a id="_idIndexMarker577"/> snippet, the following<a id="_idIndexMarker578"/> data is revealed about the <span class="No-Break">account holder:</span></p>
			<ul>
				<li><span class="No-Break">Username</span></li>
				<li><span class="No-Break">Identity</span></li>
				<li><span class="No-Break">Profession</span></li>
				<li>The purpose of <span class="No-Break">the profile</span></li>
				<li><span class="No-Break">Websites</span></li>
				<li><span class="No-Break">Pictures</span></li>
			</ul>
			<p>Visiting a more popular Instagram account will contain hundreds of pictures, videos, and stories (short clips), and analyzing the large quantity of data on the live website can become challenging. <strong class="bold">Instaloader</strong> enables ethical hackers to efficiently<a id="_idIndexMarker579"/> collect various types of data such as photos, videos, locations, stories, and more from a <span class="No-Break">public profile.</span></p>
			<p>To get started using Instaloader to collect data<a id="_idIndexMarker580"/> on a person or organization’s Instagram account, please<a id="_idIndexMarker581"/> use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li value="1">Firstly, power on the Trace Labs OSINT virtual machine and log in using <strong class="source-inline">osint</strong>/<strong class="source-inline">osint</strong> as the username <span class="No-Break">and password.</span></li>
				<li>Open the web browser and find a target and record the username on <span class="No-Break">the profile.</span></li>
				<li>Next, open the Terminal and execute the <strong class="source-inline">instaloader --help</strong> command to view various commands and <span class="No-Break">their usage.</span></li>
				<li>Next, use the <strong class="source-inline">instaloader profile &lt;username&gt;</strong> syntax to download everything that’s publicly available on the account, as <span class="No-Break">shown here:</span><pre class="source-code">
osint@osint:~$ <strong class="bold">instaloader profile zuck</strong></pre></li>
			</ol>
			<p>The preceding command will download images, videos, locations, stories, and feed data and save it within the <strong class="source-inline">/home/osint/</strong> directory, as shown in the <span class="No-Break">following screenshot:</span></p>
			<div>
				<div id="_idContainer194" class="IMG---Figure">
					<img src="image/Figure_5.39_B19448.jpg" alt="Figure 5.39 – Download files"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.39 – Download files</p>
			<p>As shown in the preceding snippet, Instaloader downloaded pictures, videos,  and geo-location and feed data offline <span class="No-Break">for post-analysis.</span></p>
			<p>As an ethical hacker, ensure you check<a id="_idIndexMarker582"/> each download file during your analysis phase to determine whether it contributes<a id="_idIndexMarker583"/> toward building a profile of your target and future <span class="No-Break">attack operations.</span></p>
			<h2 id="_idParaDest-93"><a id="_idTextAnchor092"/>LinkedIn</h2>
			<p>LinkedIn is a social networking<a id="_idIndexMarker584"/> site that’s designed for academics, industry<a id="_idIndexMarker585"/> professionals, students, and researchers to connect, collaborate, and share ideas with each other. As an ethical hacker, you can collect a lot of valuable information about your target from LinkedIn, whether your target is a person or an organization. The following are common types of data that can be gathered from a person’s <span class="No-Break">LinkedIn profile:</span></p>
			<ul>
				<li><span class="No-Break">Name</span></li>
				<li><span class="No-Break">Location</span></li>
				<li>Current and <span class="No-Break">past jobs</span></li>
				<li><span class="No-Break">Educational history</span></li>
				<li>Pictures of employee badges <span class="No-Break">and workplace</span></li>
				<li><span class="No-Break">Past projects</span></li>
			</ul>
			<p>A LinkedIn profile is a like a resume and curriculum vitae in the form of a web page for each user, enabling others to view and connect based on mutual interests. While LinkedIn has a lot of privacy features that enable users to restrict access to their profiles, threat actors can create a fake account and trick their target into connecting with them, allowing the attacker to view the details on their <span class="No-Break">LinkedIn profile.</span></p>
			<p>Let’s imagine that every time a person changes their job, they update their work experience to reflect the change. This may include adding a new job title at a new company and including a description of their role and responsibilities. While this information is useful for HR professionals and recruiters, an attacker can look for any technical details within a job description to identify the organization’s network infrastructure and system. Furthermore, if the user works on a technical project, the employee may include the technical details on their LinkedIn profile, which provides better insights into the organization’s infrastructure, technologies, and whether any security <span class="No-Break">vulnerabilities exist.</span></p>
			<p>Another technique is to map the list of IT certifications that are obtained by an employee to their work history from their LinkedIn profile. Many employees obtain IT certifications to become proficient in their jobs and better understand the technologies used within the organization. For instance, if a LinkedIn user has been employed at the targeted organization for the past 4 years and obtained specific Microsoft certifications for the duration, this is an indication the company may be using (or has implemented) those specific technologies. Hence, such information can be harvested from LinkedIn to collect data from users’ online resumes to profile an organization. As an ethical hacker, these techniques will enable you to better profile and gain insights into the technologies used by <span class="No-Break">your target.</span></p>
			<p>As an ethical hacker, having a sock puppet on LinkedIn can help you examine the connections between both your target and their employees. Using the following Google Dork syntax enables you to find LinkedIn profiles by specifying a <span class="No-Break">person’s name:</span></p>
			<pre class="source-code">
<strong class="bold">site:linkedin.com NAME intitle:professional</strong></pre>
			<p>The following snippet shows a proof-of-concept using my <span class="No-Break">first name:</span></p>
			<div>
				<div id="_idContainer195" class="IMG---Figure">
					<img src="image/Figure_5.40_B19448.jpg" alt="Figure 5.40 – Google Dorking"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.40 – Google Dorking</p>
			<p>As you may realize already, people share a lot of information on LinkedIn and such information can be harvested<a id="_idIndexMarker586"/> and analyzed. Hence, sharing too much information<a id="_idIndexMarker587"/> can be used for both good and <span class="No-Break">bad actions.</span></p>
			<h2 id="_idParaDest-94"><a id="_idTextAnchor093"/>Twitter</h2>
			<p>Twitter is another popular social networking<a id="_idIndexMarker588"/> platform that enables people to post short messages, pictures, and video clips<a id="_idIndexMarker589"/> and allows them to follow other users and get notifications when they post something new. Over the past few years, people have posted almost everything about their thoughts and daily activities on the platform. As an ethical hacker, you can use a sock puppet to harvest the following types of data from a target’s <span class="No-Break">Twitter account:</span></p>
			<ul>
				<li><strong class="bold">Profile handle</strong>: Can be used to identify other users who tagged your target within <span class="No-Break">their posts</span></li>
				<li><strong class="bold">Profile description</strong>: Can be used to better understand <span class="No-Break">your target</span></li>
				<li><strong class="bold">Location</strong>: Can be used to identify the physical location of <span class="No-Break">the target</span></li>
				<li><strong class="bold">Website</strong>: Enables you to identify their website and collect data from it for other types <span class="No-Break">of attacks</span></li>
				<li><strong class="bold">Joined date</strong>: Indicates the age of the profile, which helps to determine how often the target makes a new post and identifies the types of devices that were used to post on <span class="No-Break">the platform</span></li>
				<li><strong class="bold">Media</strong>: Enables you to view any photos and videos that may contain sensitive details and <span class="No-Break">geo-location data</span></li>
				<li><strong class="bold">Likes</strong>: Helps you determine your target’s <a id="_idIndexMarker590"/>preferences <span class="No-Break">and interests</span></li>
				<li><strong class="bold">Tweets</strong>: View the actual content made by <span class="No-Break">your target</span></li>
				<li><strong class="bold">Followers</strong>: Helps to identify employees of <span class="No-Break">the </span><span class="No-Break"><a id="_idIndexMarker591"/></span><span class="No-Break">company</span></li>
			</ul>
			<p>Having completed this section, you have learned<a id="_idIndexMarker592"/> how ethical <a id="_idIndexMarker593"/>hackers are able to <a id="_idIndexMarker594"/>harvest sensitive data from social media<a id="_idIndexMarker595"/> platforms to better profile <span class="No-Break">their targets.</span></p>
			<h1 id="_idParaDest-95"><a id="_idTextAnchor094"/>Summary</h1>
			<p>During the course of this chapter, you learned how to collect and analyze OSINT from various data sources to identify the network infrastructure of organizations. Additionally, you discovered how to use various online websites such as Shodan, Censys, social media platforms, and even job boards to find data leaks and gain insights into how a threat actor can leverage the data to profile an organization and determine their <span class="No-Break">attack surface.</span></p>
			<p>I hope this chapter has been informative for you and is helpful in your journey in the cybersecurity industry. In the next chapter, <em class="italic">Imagery, People, and Signals Intelligence</em>, you will learn how to analyze images and use mapping applications to identify the physical location of a target, collect user credentials from online databases, and identify wireless devices within <span class="No-Break">an area.</span></p>
			<h1 id="_idParaDest-96"><a id="_idTextAnchor095"/>Further reading</h1>
			<ul>
				<li><em class="italic">DNS </em><span class="No-Break"><em class="italic">records</em></span><span class="No-Break">: </span><a href="https://www.cloudflare.com/learning/dns/dns-records/"><span class="No-Break">https://www.cloudflare.com/learning/dns/dns-records/</span></a></li>
				<li><em class="italic">Maltego Foundations </em><span class="No-Break"><em class="italic">1</em></span><span class="No-Break">: </span><a href="https://courses.maltego.com/courses/maltego-foundations-1-NEW"><span class="No-Break">https://courses.maltego.com/courses/maltego-foundations-1-NEW</span></a></li>
				<li><em class="italic">MITRE </em><span class="No-Break"><em class="italic">Reconnaissance</em></span><span class="No-Break">: </span><a href="https://attack.mitre.org/tactics/TA0043/"><span class="No-Break">https://attack.mitre.org/tactics/TA0043/</span></a></li>
			</ul>
		</div>
	</body></html>