<html><head></head><body>
		<div id="_idContainer260">
			<h1 id="_idParaDest-97" class="chapter-number"><a id="_idTextAnchor096"/>6</h1>
			<h1 id="_idParaDest-98"><a id="_idTextAnchor097"/>Imagery, People, and Signals Intelligence</h1>
			<p>Photographs can tell you a lot and threat actors collect imagery intelligence on their targets to identify their geo-locations and any sensitive data in the background of pictures that can be used to improve their operations. People around the world are always posting pictures of themselves, their family members, and their locations on social media platforms without fully understanding how adversaries can track <span class="No-Break">their whereabouts.</span></p>
			<p>In this chapter, you will learn how to analyze imagery and maps to identify the physical location of a target, and collect and analyze data from public databases to identify valid usernames and passwords of people. Additionally, you will learn how to perform wireless signals intelligence to identify wireless devices within an area and profile a targeted wireless <span class="No-Break">network infrastructure.</span></p>
			<p>In this chapter, we will cover the <span class="No-Break">following topics:</span></p>
			<ul>
				<li>Image and <span class="No-Break">metadata analysis</span></li>
				<li>People and <span class="No-Break">user intelligence</span></li>
				<li>Wireless <span class="No-Break">signals intelligence</span></li>
			</ul>
			<p>Let’s <span class="No-Break">dive in!</span></p>
			<h1 id="_idParaDest-99"><a id="_idTextAnchor098"/>Technical requirements</h1>
			<p>To follow along with the exercises in this chapter, please ensure that you have met the following hardware and <span class="No-Break">software requirements:</span></p>
			<ul>
				<li>Kali <span class="No-Break">Linux: </span><a href="https://www.kali.org/get-kali/"><span class="No-Break">https://www.kali.org/get-kali/</span></a></li>
				<li>Trace Labs OSINT <span class="No-Break">VM: </span><a href="https://www.tracelabs.org/initiatives/osint-vm"><span class="No-Break">https://www.tracelabs.org/initiatives/osint-vm</span></a></li>
				<li>Kali Linux <span class="No-Break">ARM: </span><a href="https://www.kali.org/get-kali/"><span class="No-Break">https://www.kali.org/get-kali/</span></a></li>
				<li>Google Earth <span class="No-Break">Pro: </span><a href="https://www.google.com/earth/versions/"><span class="No-Break">https://www.google.com/earth/versions/</span></a></li>
				<li>Raspberry Pi <span class="No-Break">Imager: </span><a href="https://www.raspberrypi.com/software/"><span class="No-Break">https://www.raspberrypi.com/software/</span></a></li>
				<li><span class="No-Break">Rufus: </span><a href="https://rufus.ie/"><span class="No-Break">https://rufus.ie/</span></a></li>
				<li>Raspberry Pi <span class="No-Break">3 B+</span></li>
				<li>A 32-GB Samsung EVO+ <span class="No-Break">microSD card</span></li>
				<li>A microSD <span class="No-Break">card reader</span></li>
				<li>A <span class="No-Break">micro-USB cable</span></li>
				<li>An Alfa AWUS036NHA - Wireless B/G/N <span class="No-Break">USB adapter</span></li>
				<li>A VK-162 G-Mouse USB GPS Dongle <span class="No-Break">Navigation Module</span></li>
				<li>A portable <span class="No-Break">power bank</span></li>
			</ul>
			<h1 id="_idParaDest-100"><a id="_idTextAnchor099"/>Image and metadata analysis</h1>
			<p><strong class="bold">Exchangeable Image File</strong> (<strong class="bold">EXIF</strong>) is a standard that specifies the formatting of sounds and images that are commonly used in image <a id="_idIndexMarker596"/>handling devices such as scanners and digital cameras. Put simply, EXIF is the metadata embedded into photo files taken by a digital camera and includes camera data such as the geo-location, time and date, manufacturer, resolution, and so on. Images with EXIF data can be leveraged by ethical hackers for reconnaissance and <span class="No-Break">social engineering.</span></p>
			<p>As an ethical hacker, you can collect publicly available images of your target and analyze them for EXIF data. The collected EXIF data may reveal the target’s geo-location, the type of device used for capturing the photo, and the time the picture was taken. For instance, if a picture was taken with a digital camera within a server room of an organization, an ethical hacker who is hired to simulate real-world cyberattacks can identify whether the geo-location data is available and use it determine the physical location of the server room and the targeted company. Additionally, the EXIF data can be used by ethical hackers to improve their social engineering attacks by identifying the geo-location of the photo and sending spear phishing email messages that appear to originate from the same physical location as the target, therefore attempting to trick the target into thinking the email originates from a <span class="No-Break">trusted source.</span></p>
			<p>However, many smartphone and mobile operating system vendors have improved the security of their devices and implemented security mechanisms to prevent sensitive EXIF data from being attached to photos and videos captured using their devices. Imagine if all the photos uploaded on the internet contained EXIF data; then cyber criminals would be able to track their potential victims a lot easier than before by using a smartphone or computer. Therefore, the EXIF location data has been made a bit more secure over the years and reduces the risk <a id="_idIndexMarker597"/>of someone collecting the <strong class="bold">Global Positioning System</strong> (<strong class="bold">GPS</strong>) data from a photo, and some social media platforms have implemented security mechanisms to remove the EXIF data from photos before they are published on the <span class="No-Break">online platform.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Digital forensic investigators can use EXIF data from a photo to determine when the picture was taken and where. Such information is useful during investigations as it helps identify a potential suspect and focus on the timeline of <span class="No-Break">an attack.</span></p>
			<p>EXIF provides a lot of data, which can be leveraged the right way by an ethical hacker to determine the whereabouts of a target, the device used for capturing the picture, the direction to target was facing, the device settings, and <span class="No-Break">much more.</span></p>
			<h2 id="_idParaDest-101"><a id="_idTextAnchor100"/>EXIF data analysis</h2>
			<p>In this exercise, you will learn how<a id="_idIndexMarker598"/> to identify and analyze EXIF data from a photo and determine the geo-location of where it was captured. To get started with this exercise, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li>Power on the <strong class="bold">Trace Labs OSINT virtual machine</strong> and log in using <strong class="source-inline">osint</strong>/<strong class="source-inline">osint</strong> as the username <span class="No-Break">and password.</span></li>
				<li>Once you’re logged in to the Trace Labs OSINT virtual machine, open the <strong class="bold">web browser</strong> and go to <a href="https://osint.tools">https://osint.tools</a> for a practice file. In the menu on the left column, you will see a list of resources – click on <strong class="bold">Exif Example 1</strong> <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer197" class="IMG---Figure">
					<img src="image/Figure_6.01_B19448.jpg" alt="Figure 6.1 – EXIF file"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.1 – EXIF file</p>
			<ol>
				<li value="3">Next, a picture will load on the web page. Right-click on it and select <strong class="bold">Save Image As...</strong> to download <a id="_idIndexMarker599"/>and save the image to the <strong class="bold">Trace Labs virtual machine</strong> <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer198" class="IMG---Figure">
					<img src="image/Figure_6.02_B19448.jpg" alt="Figure 6.2 – EXIF picture"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.2 – EXIF picture</p>
			<p>By default, all downloads are automatically saved in the <strong class="source-inline">/home/osint/Downloads</strong> directory on the Trace Labs <span class="No-Break">virtual machine.</span></p>
			<ol>
				<li value="4">Next, use <strong class="source-inline">exiftool</strong> to extract<a id="_idIndexMarker600"/> the EXIF data from the image file. Open the <strong class="bold">Terminal</strong> and execute the <span class="No-Break">following command:</span><pre class="source-code">
osint@osint:~$ <strong class="bold">exiftool Downloads/exif1.jpg</strong></pre></li>
			</ol>
			<p>The following screenshot shows the output from executing the <span class="No-Break">preceding command:</span></p>
			<div>
				<div id="_idContainer199" class="IMG---Figure">
					<img src="image/Figure_6.03_B19448.jpg" alt="Figure 6.3 – EXIF data"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.3 – EXIF data</p>
			<p>As shown in the preceding screenshot, we are able to view the EXIF data from the image. The time and date, geo-location, device type and model, and resolution can be collected <span class="No-Break">and analyzed.</span></p>
			<ol>
				<li value="5">Next, let’s use the <strong class="source-inline">exifprobe</strong> tool to extract EXIF data from the <span class="No-Break">same picture:</span><pre class="source-code">
osint@osint:~$ <strong class="bold">exifprobe Downloads/exif1.jpg</strong></pre></li>
			</ol>
			<p>As shown in the following screenshot, the exifprobe tool extracted the EXIF and geo-location data from <span class="No-Break">the picture:</span></p>
			<div>
				<div id="_idContainer200" class="IMG---Figure">
					<img src="image/Figure_6.04_B19448.jpg" alt="Figure 6.4 – The exifprobe tool"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.4 – The exifprobe tool</p>
			<ol>
				<li value="6">Next, open the<a id="_idIndexMarker601"/> web browser again and go to <a href="https://fotoforensics.com/">https://fotoforensics.com/</a>, where you can upload a picture to extract the EXIF data. Simply click on <strong class="bold">Browse...</strong> to attach the file and select <strong class="bold">Upload</strong> to perform the extraction and analysis <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer201" class="IMG---Figure">
					<img src="image/Figure_6.05_B19448.jpg" alt="Figure 6.5 – Fotoforensics website"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.5 – Fotoforensics website</p>
			<p>After a few seconds or<a id="_idIndexMarker602"/> minutes, the website will display all the EXIF data and provide various specific categories of data <span class="No-Break">to view.</span></p>
			<ol>
				<li value="7">Next, select <strong class="bold">Analysis</strong> | <strong class="bold">Metadata</strong> to view the <span class="No-Break">EXIF data:</span></li>
			</ol>
			<div>
				<div id="_idContainer202" class="IMG---Figure">
					<img src="image/Figure_6.06_B19448.jpg" alt="Figure 6.6 – Viewing metadata"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.6 – Viewing metadata</p>
			<p>The following<a id="_idIndexMarker603"/> screenshot shows all the EXIF data that was found in <span class="No-Break">the file:</span></p>
			<div>
				<div id="_idContainer203" class="IMG---Figure">
					<img src="image/Figure_6.07_B19448.jpg" alt="Figure 6.7 – EXIF data from the uploaded image"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.7 – EXIF data from the uploaded image</p>
			<ol>
				<li value="8">Next, scroll <a id="_idIndexMarker604"/>down the end of the EXIF results page to view the geo-location of <span class="No-Break">the image:</span></li>
			</ol>
			<div>
				<div id="_idContainer204" class="IMG---Figure">
					<img src="image/Figure_6.08_B19448.jpg" alt="Figure 6.8 – Geo-location data"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.8 – Geo-location data</p>
			<p>As shown in the<a id="_idIndexMarker605"/> preceding screenshot, the GPS data was found and applied to a mapping system to identify the approximate location of where the photo <span class="No-Break">was taken.</span></p>
			<ol>
				<li value="9">Lastly, you can copy the GPS coordinates from the previous step and enter them into <a href="https://maps.google.com">https://maps.google.com</a> (Google Maps) to get a second opinion on the location <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer205" class="IMG---Figure">
					<img src="image/Figure_6.09_B19448.jpg" alt="Figure 6.9 – Google Maps"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.9 – Google Maps</p>
			<p>As shown in<a id="_idIndexMarker606"/> the preceding screenshot, GPS coordinates can be used on Google Maps to gain better insights into the vicinity and street view of <span class="No-Break">a location.</span></p>
			<h2 id="_idParaDest-102"><a id="_idTextAnchor101"/>Reverse image search</h2>
			<p>Reverse image search allows anyone to perform an internet search for pictures by either uploading a photo or providing<a id="_idIndexMarker607"/> a URL that points to an image. Just as most people are familiar with using internet search engines to find websites and domain names based on keywords, reverse image search enables us to find similar pictures of various sizes amd resolutions, different versions of the same picture, and even pictures that contain the <span class="No-Break">same objects.</span></p>
			<p>Reverse image search is very useful for ethical hackers as it enables them to identify the source and location of the picture, and determine where the picture has been used on the internet. If you’re trying to identify the location of where a picture was taken by your target, this technology provides you with the capabilities to find <span class="No-Break">the location.</span></p>
			<p>The following are popular search engines for performing reverse <span class="No-Break">image searches:</span></p>
			<ul>
				<li><span class="No-Break">Google: </span><a href="https://images.google.com"><span class="No-Break">https://images.google.com</span></a></li>
				<li><span class="No-Break">Bing: </span><a href="https://www.bing.com"><span class="No-Break">https://www.bing.com</span></a></li>
				<li><span class="No-Break">Yandex: </span><a href="https://yandex.com"><span class="No-Break">https://yandex.com</span></a></li>
				<li><span class="No-Break">TinEye: </span><a href="https://tineye.com"><span class="No-Break">https://tineye.com</span></a></li>
			</ul>
			<p>To gain a better <a id="_idIndexMarker608"/>understanding of how reverse image search helps ethical hackers to identify the geo-location of a target, let’s consider the <span class="No-Break">following scenario:</span></p>
			<ol>
				<li>You’re given a photo and need to identify the location of where the picture was taken. In this exercise, we are using a publicly available photo taken by photographer Mauro Lima from <a href="https://unsplash.com">https://unsplash.com</a> <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer206" class="IMG---Figure">
					<img src="image/Figure_6.10_B19448.jpg" alt="Figure 6.10 – An example photograph"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.10 – An example photograph</p>
			<p>As shown in the preceding figure, it’s a lovely picture taken by a photographer showing a religious place of worship. Sometimes, it’s recommended to remove any objects or subjects<a id="_idIndexMarker609"/> from a photo before performing a reverse image search to ensure the search engine is better able to identify similar pictures on <span class="No-Break">the internet.</span></p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Being able to identify specific architecture styles, signage, flora, and fauna can help you determine the specific region of the world a picture was taken. For instance, specific types of trees can only be found in <span class="No-Break">certain countries.</span></p>
			<ol>
				<li value="2">We can use <strong class="bold">Cleanup.pictures</strong> (<a href="https://cleanup.pictures">https://cleanup.pictures</a>) to remove specific objects from the picture, such as the person and vehicles. The following screenshot shows the Cleanup.pictures website with the upload field, upload your <span class="No-Break">image here:</span></li>
			</ol>
			<div>
				<div id="_idContainer207" class="IMG---Figure">
					<img src="image/Figure_6.11_B19448.jpg" alt="Figure 6.11 – Cleanup.pictures website"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.11 – Cleanup.pictures website</p>
			<ol>
				<li value="3">Next, use the eraser brush to select the objects and people you want to remove and enable the <strong class="bold">Artificial Intelligence</strong> (<strong class="bold">AI</strong>) to automatically fill in the <span class="No-Break">highlighted</span><span class="No-Break"><a id="_idIndexMarker610"/></span><span class="No-Break"> area:</span></li>
			</ol>
			<div>
				<div id="_idContainer208" class="IMG---Figure">
					<img src="image/Figure_6.12_B19448.jpg" alt="Figure 6.12 – Objects and people"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.12 – Objects and people</p>
			<ol>
				<li value="4">Next, ensure you download and save the <span class="No-Break">AI-modified image:</span></li>
			</ol>
			<div>
				<div id="_idContainer209" class="IMG---Figure">
					<img src="image/Figure_6.13_B19448.jpg" alt="Figure 6.13 – AI modified image"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.13 – AI modified image</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">You can use <strong class="bold">Remote Background</strong> at <a href="https://www.remove.bg">https://www.remove.bg</a> to remove backgrounds <span class="No-Break">from pictures.</span></p>
			<ol>
				<li value="5">Next, to <a id="_idIndexMarker611"/>perform a reverse image search, go to <strong class="bold">Google Images</strong> at <a href="https://images.google.com">https://images.google.com</a> and upload the modified image to view the results <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer210" class="IMG---Figure">
					<img src="image/Figure_6.14_B19448.jpg" alt="Figure 6.14 – Reverse image search results"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.14 – Reverse image search results</p>
			<p>As shown in the<a id="_idIndexMarker612"/> preceding screenshot, the location and similar images <span class="No-Break">were found.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout"><strong class="bold">Google Images</strong> has integrated <strong class="bold">Google Lens</strong> to improve its image search. This technology enables you to select a specific area of the image, or the <span class="No-Break">entire thing.</span></p>
			<ol>
				<li value="6">Next, enter the location <strong class="source-inline">Convento de Santo Domingo, Cartagena</strong> within <strong class="bold">Google Maps</strong> at <a href="https://maps.google.com">https://maps.google.com</a> <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer211" class="IMG---Figure">
					<img src="image/Figure_6.15_B19448.jpg" alt="Figure 6.15 – Google Maps"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.15 – Google Maps</p>
			<ol>
				<li value="7">Lastly, using the <strong class="bold">Street View</strong> feature on Google Maps, you can virtually navigate around the location to collect <span class="No-Break">additional intelligence:</span></li>
			</ol>
			<div>
				<div id="_idContainer212" class="IMG---Figure">
					<img src="image/Figure_6.16_B19448.jpg" alt="Figure 6.16 – Google Maps Street View"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.16 – Google Maps Street View</p>
			<p>As shown in the <a id="_idIndexMarker613"/>preceding screenshot, we have found the location where the photo was taken by <span class="No-Break">the photographer.</span></p>
			<p>As you have now learned, reverse image searching helps ethical hackers to identify the geo-location and whereabouts of a target, along with using global mapping systems to view the surroundings of the location. This knowledge is also useful when performing a physical penetration testing assessment to identify the points of entry into a building or compound with the <span class="No-Break">least resistance.</span></p>
			<h2 id="_idParaDest-103"><a id="_idTextAnchor102"/>Geo-location analysis</h2>
			<p>Mapping systems are excellent data <a id="_idIndexMarker614"/>sources for ethical hackers to identify the physical location of a targeted organization and its vicinity. Imagine you need to perform a wireless penetration test on a targeted organization during a black-box assessment. You can perform Google searches on the organization’s name to identify its websites and check whether its address is listed. Additionally, you can use publicly available online maps such as <strong class="bold">Google Maps</strong> to identify the physical location of <span class="No-Break">an organization.</span></p>
			<p>For instance, we can use Google Maps to find the physical location of Twitter HQ (red pin) and gain a better understanding of the surroundings <span class="No-Break">as shown:</span></p>
			<div>
				<div id="_idContainer213" class="IMG---Figure">
					<img src="image/Figure_6.17_B19448.jpg" alt="Figure 6.17 – Locating a company"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.17 – Locating a company</p>
			<p>As shown in the preceding screenshot, Google Maps was able to provide us with a picture of the building to better identify the target, its street address, its hours of operations, and its contact details, which can be used during future operations such as social <span class="No-Break">engineering attacks.</span></p>
			<p>Changing to Satellite view on Google Maps helps us to gain a better visual of the layout and surrounding areas of the<a id="_idIndexMarker615"/> company, such as identifying a place to set up wireless attacks as an <span class="No-Break">ethical hacker:</span></p>
			<div>
				<div id="_idContainer214" class="IMG---Figure">
					<img src="image/Figure_6.18_B19448.jpg" alt="Figure 6.18 – Satellite view"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.18 – Satellite view</p>
			<p>Furthermore, we can observe there are nearby restaurants that employees are likely to visit frequently and may connect their mobile devices to the restaurants’ wireless networks. As an ethical hacker, you could set up a rogue wireless network to trick an employee of your target into connecting and redirect their traffic to phishing websites and perform <strong class="bold">Domain Name System</strong> (<strong class="bold">DNS</strong>) <span class="No-Break">poisoning attacks.</span></p>
			<p>Google Maps provides the Street View feature, which enables ethical hackers to interact with panoramic views of streets, allowing you to view the vicinity of the target’s building and look for car parks, points of entry, and <span class="No-Break">security checkpoints.</span></p>
			<p>The following screenshot shows you a street view of the Twitter headquarters without you leaving <span class="No-Break">your computer:</span></p>
			<div>
				<div id="_idContainer215" class="IMG---Figure">
					<img src="image/Figure_6.19_B19448.jpg" alt="Figure 6.19 – Street View"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.19 – Street View</p>
			<p>As an ethical hacker, you <a id="_idIndexMarker616"/>can leverage Street View to look at the sides and other pathways that may be convenient and have less security presence for physical penetration testing and wireless <span class="No-Break">network assessments.</span></p>
			<p>The following screenshot shows a side view of the Twitter building with a <span class="No-Break">small restaurant:</span></p>
			<div>
				<div id="_idContainer216" class="IMG---Figure">
					<img src="image/Figure_6.20_B19448.jpg" alt="Figure 6.20 – Side view"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.20 – Side view</p>
			<p>While ethical hackers use these tactics and techniques to help organizations, threat actors are also using them for malicious purposes. Hence, it’s important that organizations ensure they perform OSINT penetration testing to ensure their cyber defenses are improved and to reduce their <span class="No-Break">attack surface.</span></p>
			<p>During this section, you <a id="_idIndexMarker617"/>gained the hands-on skills to collect and analyze imagery and geo-location intelligence and gain further insights into how threat actors are able to use publicly available information to profile their targets. In the next section, you will learn how to collect intelligence on people and users <span class="No-Break">from organizations.</span></p>
			<h1 id="_idParaDest-104"><a id="_idTextAnchor103"/>People and user intelligence</h1>
			<p>People OSINT focuses on collecting information about a person’s names, address, telephone numbers, usernames, and <a id="_idIndexMarker618"/>even their social media accounts. Such information is useful when identifying the employees of a targeted organization and improving social engineering attacks to gain a foothold within the target’s network. People often create social<a id="_idIndexMarker619"/> media accounts and add their company, job title, and contact details, which helps threat actors to easily harvest such data when planning their attacks. For instance, employees sometimes include their company’s email address in their contact information on social media platforms such as LinkedIn <span class="No-Break">and Facebook.</span></p>
			<p>Organizations use various formats for their employees’ email addresses, such as <span class="No-Break">the following:</span></p>
			<ul>
				<li><strong class="source-inline">firstname @ domain . </strong><span class="No-Break"><strong class="source-inline">com</strong></span></li>
				<li><strong class="source-inline">firstnameinitial + lastname @ domain . </strong><span class="No-Break"><strong class="source-inline">com</strong></span></li>
				<li><strong class="source-inline">firstname.lastnameinitial @ domain . </strong><span class="No-Break"><strong class="source-inline">com</strong></span></li>
				<li><strong class="source-inline">firstname + lastnameinitial @ domain . </strong><span class="No-Break"><strong class="source-inline">com</strong></span></li>
				<li><strong class="source-inline">fullname @ domain . </strong><span class="No-Break"><strong class="source-inline">com</strong></span></li>
			</ul>
			<p>Therefore, if an attacker is collecting OSINT on a targeted organization, collecting email addresses from current employees found on social media allows them to determine the email format used within the organization. Some companies even publicly post their organizational charts on their websites outlining various high-profile employees and their departments. Such information can be used to identify specific persons and determine their email address format to plan <span class="No-Break">spear-phishing attacks.</span></p>
			<p>Furthermore, there are many online forums where students, professionals, and researchers can get help with technical issues<a id="_idIndexMarker620"/> such as <strong class="bold">Stack Overflow</strong> (<a href="https://stackoverflow.com">https://stackoverflow.com</a>). Attackers can use the information on Stack Overflow to identify the technologies and security vulnerabilities that exist within a targeted organization. For instance, imagine the technical team is experiencing some issues with an application and decides to create an account on Stack Overflow using their real name, job title, and organizational name on their profiles. They then proceed to make a post containing the technical details of their infrastructure, host operating systems, application<a id="_idIndexMarker621"/> name, and service version. While this information is useful for anyone providing assistance with good intentions, such information reveals a lot to a threat actor about their target and makes it easier to identify the <span class="No-Break">attack surface.</span></p>
			<p>As an ethical hacker, it’s important to fully understand the tactics and techniques that are commonly used by threat actors to collect and analyze data leaks from the internet. Sometimes, finding people can be a challenging task, whether you’re helping law enforcement or identifying the employees of a targeted organization. There are many people-based search engines that can be used for collecting names, addresses, telephone numbers, social media accounts, and usernames of individuals. The following is a list of both free and commercial people-based <span class="No-Break">search engines:</span></p>
			<ul>
				<li><a href="http://www.peekyou.com"><span class="No-Break">www.peekyou.com</span></a></li>
				<li><a href="http://thatsthem.com"><span class="No-Break">thatsthem.com</span></a></li>
				<li><a href="http://radaris.com"><span class="No-Break">radaris.com</span></a></li>
				<li><a href="http://www.beenverified.com"><span class="No-Break">www.beenverified.com</span></a></li>
				<li><a href="http://www.skopenow.com"><span class="No-Break">www.skopenow.com</span></a></li>
			</ul>
			<p>During a penetration test, ethical hackers commonly perform a technique known as <strong class="bold">password spraying</strong>, whereby a common password is used with multiple usernames on the same application or system. The<a id="_idIndexMarker622"/> purpose of using password spraying is to identify users that have configured their accounts with weak passwords or used the same one as others within the organization. Sometimes, the name (user) portion of an email address is an employee’s username for accessing a company-owned system or application. In some cases, the entire email address is used as the <span class="No-Break">employee’s username.</span></p>
			<p>When harvesting email addresses from various data sources on the internet, it’s essential to identify<a id="_idIndexMarker623"/> whether an address is valid or blacklisted and whether there’s an online social media account associated with it. This can be done by performing a search on social media websites using the target’s email address to identify their social media account on the platform if <span class="No-Break">it exists.</span></p>
			<p>The following websites can be used to determine the reputation and validity of an <span class="No-Break">email address:</span></p>
			<ul>
				<li><span class="No-Break">MXToolBox: </span><a href="https://mxtoolbox.com/emailhealth"><span class="No-Break">https://mxtoolbox.com/emailhealth</span></a></li>
				<li>Simply Email <span class="No-Break">Reputation: </span><a href="https://emailrep.io"><span class="No-Break">https://emailrep.io</span></a></li>
				<li>Cisco <span class="No-Break">Talos: </span><a href="https://www.talosintelligence.com/reputation_center/email_rep"><span class="No-Break">https://www.talosintelligence.com/reputation_center/email_rep</span></a></li>
			</ul>
			<p>In addition, <strong class="bold">Hunter</strong> (<a href="https://hunter.io">https://hunter.io</a>) enables ethical hackers to discover employees, their job titles, and any email addresses associated with a targeted domain. Hunter allows you to perform a lookup using the domain name of your target, then searches its database and multiple data sources on the internet for individuals’ contact details related to this <span class="No-Break">domain name.</span></p>
			<p>The following screenshot shows a lookup that was performed on the <a href="http://microsoft.com"><span class="No-Break">microsoft.com</span></a><span class="No-Break"> domain:</span></p>
			<div>
				<div id="_idContainer217" class="IMG---Figure">
					<img src="image/Figure_6.21_B19448.jpg" alt="Figure 6.21 – Hunter domain lookup"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.21 – Hunter domain lookup</p>
			<p>As shown in the<a id="_idIndexMarker624"/> preceding screenshot, Hunter is a useful tool for ethical hackers as it helps you to harvest organizational and people intelligence from the internet. The data collected from Hunter can be used to plan social engineering attacks on a <span class="No-Break">targeted organization.</span></p>
			<h2 id="_idParaDest-105"><a id="_idTextAnchor104"/>People and geolocation</h2>
			<p>There are many platforms on the<a id="_idIndexMarker625"/> internet that enable people to upload and share pictures of themselves and places they’ve visited. Social media and photo-sharing platforms are valuable repositories for ethical hackers to identify targets and their locations. For instance, imagine you’re given the task of identifying the high-profile employees of a targeted organization, determining their whereabouts, and identifying any places of interest associated with <span class="No-Break">your target.</span></p>
			<p>You can use social media platforms such as LinkedIn, Facebook, and Twitter to perform a lookup/search using the organization’s name and filter the results as needed. On an employee’s profile, they may include the target organization and their location. Some people often use the check-in feature on social media, which provides useful data for threat actors including insights into how often a person visits a particular location, travels for work, and when and where the person goes <span class="No-Break">on vacation.</span></p>
			<p>To get a better understanding of how data can be collected and leveraged by adversaries, let’s observe the following Twitter profile of a famous person of <span class="No-Break">our times:</span></p>
			<div>
				<div id="_idContainer218" class="IMG---Figure">
					<img src="image/Figure_6.22_B19448.jpg" alt="Figure 6.22 – Twitter profile"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.22 – Twitter profile</p>
			<p>The preceding screenshot shows their public profile with lots of data. For instance, if you’re looking for a photo of a<a id="_idIndexMarker626"/> target, their social media profile will most likely have an up-to-date picture of themselves. In addition, the public profile picture can then be used with reverse image lookup to identify additional data sources that may contain the same or similar pictures on the internet. The preceding screenshot also shows the location of the individual, their website, and the age of their profile. As previously mentioned, the location helps you identify the target’s general location or city. The website on the profile can be used to find additional intelligence. Lastly, you can view all the posts and media uploaded by the target; much sensitive information can be found within these to help you identify the infrastructure of a given <span class="No-Break">target organization.</span></p>
			<p>Social media apps on smartphones enable a user to include their geo-location data on their posts to allow their followers, connections, and friends to know their location at the time the post was made. Imagine you want to identify all the employees of a target organization but all you have is the address of the company. As an ethical hacker, you can use <strong class="bold">Google Maps</strong> to find the specific location of the organization and obtain the <span class="No-Break">GPS coordinates.</span></p>
			<p>To get a better understanding of how to geolocate people based on their GPS data, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li value="1">Open the web browser and go to <strong class="bold">Google Maps</strong> <span class="No-Break">at </span><a href="https://maps.google.com"><span class="No-Break">https://maps.google.com</span></a><span class="No-Break">.</span></li>
				<li>Next, left-click anywhere on the map to place a point <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer219" class="IMG---Figure">
					<img src="image/Figure_6.23_B19448.jpg" alt="Figure 6.23 – Collecting GPS data"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.23 – Collecting GPS data</p>
			<p>As shown in the <a id="_idIndexMarker627"/>preceding screenshot, Times Square was used as an example. Once you’ve clicked on a specific spot on Google Maps, a pin is inserted and the URL is updated to include the GPS data <span class="No-Break">coordinates: </span><span class="No-Break"><strong class="source-inline">40.757791,-73.9854071</strong></span><span class="No-Break">.</span></p>
			<ol>
				<li value="3">Next, to find all the people who’ve posted from this location, go to <a href="https://twitter.com">https://twitter.com</a> and enter the following syntax within the <span class="No-Break"><strong class="bold">Search</strong></span><span class="No-Break"> field:</span><pre class="source-code">
<strong class="bold">geocode:40.757791,-73.9854071,1km</strong></pre></li>
			</ol>
			<p>The preceding syntax will show the results for all profiles that posted within 1 km of the GPS coordinates <span class="No-Break">as shown:</span></p>
			<div>
				<div id="_idContainer220" class="IMG---Figure">
					<img src="image/Figure_6.24_B19448.jpg" alt="Figure 6.24 – Filtering posts based on GPS data"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.24 – Filtering posts based on GPS data</p>
			<p>The preceding exercise is a proof-of-concept that can be used to obtain the GPS coordinates of a targeted organization and filter the posts made by people from that location. Some of the posts found will most likely be made by employees; hence, it’s important to analyze all the collected data to ensure it’s useful for your OSINT operations and for planning <span class="No-Break">future attacks.</span></p>
			<p>When profiling a person<a id="_idIndexMarker628"/> or employee, it’s important to ensure you’re not collecting data on a fake profile or performing a reverse image lookup on a fake profile picture. A website such as <strong class="bold">WhatsMyName</strong> (<a href="https://whatsmyname.app">https://whatsmyname.app</a>) is useful for ethical hackers and penetration testers to search usernames across multiple data sources and websites on the internet to identify where a specific username is registered. The results help you to determine additional areas on the internet where a target may be posting more <span class="No-Break">useful information.</span></p>
			<p>The following screenshot shows the WhatsMyName website with the <span class="No-Break">lookup field:</span></p>
			<div>
				<div id="_idContainer221" class="IMG---Figure">
					<img src="image/Figure_6.25_B19448.jpg" alt="Figure 6.25 – WhatsMyName lookup"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.25 – WhatsMyName lookup</p>
			<p>Lastly, you can use websites such as <strong class="bold">TinEye</strong> (<a href="https://tineye.com">https://tineye.com</a>) and <strong class="bold">PimEyes</strong> (<a href="https://pimeyes.com">https://pimeyes.com</a>) to perform a reverse image search on a person’s picture to identify where on the internet<a id="_idIndexMarker629"/> similar images or the same images are found. These tools are useful for law enforcement when trying to find a missing person and track <span class="No-Break">their movement.</span></p>
			<p>The following screenshot shows the search results for a fake picture of a non-existent person <span class="No-Break">on TinEye:</span></p>
			<div>
				<div id="_idContainer222" class="IMG---Figure">
					<img src="image/Figure_6.26_B19448.jpg" alt="Figure 6.26 – TinEye results"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.26 – TinEye results</p>
			<p>As shown in the <a id="_idIndexMarker630"/>preceding screenshot, TinEye was able to identify similar pictures on the internet with their data sources, URLs, filenames, and <span class="No-Break">first-seen data.</span></p>
			<p>PimEyes uses face recognition to better identify the person within a picture. The following screenshot shows the PimEyes results of a <span class="No-Break">fake picture:</span></p>
			<div>
				<div id="_idContainer223" class="IMG---Figure">
					<img src="image/Figure_6.27_B19448.jpg" alt="Figure 6.27 – PimEyes results"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.27 – PimEyes results</p>
			<p>As shown in the preceding <a id="_idIndexMarker631"/>screenshot, PimEyes was able to identify people with very similar facial structures and attributes, while providing the source of the data <span class="No-Break">and more.</span></p>
			<h2 id="_idParaDest-106"><a id="_idTextAnchor105"/>User credential OSINT</h2>
			<p>Many people<a id="_idIndexMarker632"/> commonly configure weak passwords or have experienced their accounts being compromised by a hacker. Often, when accounts are compromised, the breached data is used by adversaries to expand their operations and for future attacks, and can also be sold on the dark web for profit. As an ethical hacker, access to breached data is beneficial as it provides us with user credentials for a <span class="No-Break">targeted organization.</span></p>
			<p>For instance, imagine you’re performing a penetration test on a network and attempting to gain a foothold into Windows-based systems that are connected to the domain. If the company was breached prior to the penetration test, there’s a chance the breached data is available on the dark web or online databases. Within the breached data, you may find users’ credentials for their domain accounts. Some users may change their passwords after a breach, while others may not. For users who haven’t changed their password after their accounts were compromised, you can leverage their user credentials from the breached data to gain a foothold into the network and perform various types of password-based attacks to identify additional <span class="No-Break">security vulnerabilities.</span></p>
			<p>The following are free and commercial repositories and databases that help ethical hackers and penetration testers to identify the user credentials of <span class="No-Break">their target:</span></p>
			<ul>
				<li>Have I Been <span class="No-Break">Pwned?: </span><a href="https://haveibeenpwned.com"><span class="No-Break">https://haveibeenpwned.com</span></a></li>
				<li>Intelligence <span class="No-Break">X: </span><a href="https://intelx.io"><span class="No-Break">https://intelx.io</span></a></li>
				<li><span class="No-Break">Dehashed: </span><a href="https://www.dehashed.com"><span class="No-Break">https://www.dehashed.com</span></a></li>
			</ul>
			<p>Ethical hackers can use <strong class="bold">Have I Been Pwned?</strong> to identify whether email addresses and telephone <a id="_idIndexMarker633"/>numbers were found in batches of leaked data. For instance, an ethical hacker can perform a lookup on their target’s email address as <span class="No-Break">shown here:</span></p>
			<div>
				<div id="_idContainer224" class="IMG---Figure">
					<img src="image/Figure_6.28_B19448.jpg" alt="Figure 6.28 – Have I Been Pwned?"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.28 – Have I Been Pwned?</p>
			<p><em class="italic">Have I Been Pwned?</em> provides results showing which data breaches contained the email address as <span class="No-Break">shown here:</span></p>
			<div>
				<div id="_idContainer225" class="IMG---Figure">
					<img src="image/Figure_6.29_B19448.jpg" alt="Figure 6.29 – Search results"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.29 – Search results</p>
			<p>The preceding data can <a id="_idIndexMarker634"/>be analyzed by ethical hackers to further determine the validity of the email address and its holder, and the websites on which the target used the email address to register for an account. In addition, hackers usually expose compromised account data such as usernames and passwords on the internet. Without some additional research, you may be able to find the password for the email account. Sometimes, users are not aware of data breaches and don’t always change their passwords often. You may be lucky enough to find valid user credentials belonging to your target and use them to gain a foothold into their accounts, systems, <span class="No-Break">or networks.</span></p>
			<p>Furthermore, if you scroll all the way down to the end of the results page on <em class="italic">Have I Been Pwned?</em>, you will get the pastes (sources) for all data breaches containing the given email address, as shown in the <span class="No-Break">following screenshot:</span></p>
			<div>
				<div id="_idContainer226" class="IMG---Figure">
					<img src="image/Figure_6.30_B19448.jpg" alt="Figure 6.30 – Breached data sources"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.30 – Breached data sources</p>
			<p>Furthermore, <strong class="bold">Intelligence X</strong> helps<a id="_idIndexMarker635"/> ethical hackers to locate user credentials from breached data. For instance, you can perform an email lookup to identify all relevant data associated with the email address, <span class="No-Break">as follows:</span></p>
			<div>
				<div id="_idContainer227" class="IMG---Figure">
					<img src="image/Figure_6.31_B19448.jpg" alt="Figure 6.31 – Intelligence X email lookup"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.31 – Intelligence X email lookup</p>
			<p>The following screenshot shows the data provided by <span class="No-Break">Intelligence X:</span></p>
			<div>
				<div id="_idContainer228" class="IMG---Figure">
					<img src="image/Figure_6.32_B19448.jpg" alt="Figure 6.32 – Intelligence X results"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.32 – Intelligence X results</p>
			<p>As shown in the<a id="_idIndexMarker636"/> preceding screenshot, Intelligence X provides some results freely, while other results contain redacted data. A paid account/subscription is required to view the redacted data on <span class="No-Break">Intelligence X.</span></p>
			<p>As an ethical hacker, you can click on a data collection to view all its contents, as shown in the <span class="No-Break">following screenshot:</span></p>
			<div>
				<div id="_idContainer229" class="IMG---Figure">
					<img src="image/Figure_6.33_B19448.jpg" alt="Figure 6.33 – Data collection"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.33 – Data collection</p>
			<p>As shown in the preceding screenshot, some data collections contain a lot of entries, so using the search field will help you find specific results within a <span class="No-Break">data collection.</span></p>
			<p>Lastly, <strong class="bold">Dehashed</strong> is an online<a id="_idIndexMarker637"/> database that allows ethical hackers to purchase user credentials from data breaches. This website is a valuable tool for ethical hackers and penetration testers who are performing password-based attacks on accounts and systems of a targeted organization. It allows you to perform lookups on email addresses, usernames, IP addresses, names, addresses, telephone numbers, and <span class="No-Break">domain names.</span></p>
			<p>Having completed this section, you have learned how to collect and analyze OSINT on people and their geo-locations, and locate data breaches that contain user credentials. In the next section, you will learn how to collect and analyze data on <span class="No-Break">wireless signals.</span></p>
			<h1 id="_idParaDest-107"><a id="_idTextAnchor106"/>Wireless signals intelligence</h1>
			<p>Wireless <strong class="bold">Signals Intelligence</strong> (<strong class="bold">SIGINT</strong>) is a common<a id="_idIndexMarker638"/> technique used by ethical hackers, penetration testers, and<a id="_idIndexMarker639"/> red teamers to intercept and analyze wireless traffic to discover and exploit security vulnerabilities found in both radio and wireless transmissions. SIGINT is typically used in military operations by governments to monitor the communication channels of other countries and identify potential threats. However, using various tools and techniques, cybersecurity professionals can employ SIGINT to identify their target’s wireless network infrastructure (such as access points and associated clients), intercept and monitor <strong class="bold">Wireless Local Area Network</strong> (<strong class="bold">WLAN</strong>) frames, which <a id="_idIndexMarker640"/>can then be used to retrieve passphrases for accessing the network, and locate devices within <span class="No-Break">a vicinity.</span></p>
			<p>Organizations obtain the following benefits from performing SIGINT techniques on their <span class="No-Break">wireless infrastructure:</span></p>
			<ul>
				<li><strong class="bold">Identifying security vulnerabilities</strong>: Ethical <a id="_idIndexMarker641"/>hackers can capture and analyze the WLAN traffic on their target’s network to identify any security vulnerabilities such as weak wireless security standards, weak encryption algorithms, and insecure <span class="No-Break">authentication protocols</span></li>
				<li><strong class="bold">Reconnaissance</strong>: Ethical hackers can perform wireless SIGINT to gain insights into things such as the targeted wireless network infrastructure, the type of wireless devices and their usage, and what security countermeasures can be implemented to reduce the <span class="No-Break">attack surface</span></li>
				<li><strong class="bold">Testing security controls</strong>: After implementing cyber defenses and security controls, its good practice to test the effectiveness of those countermeasures to ensure they are working as expected to reduce the risk of a potential cyberattack <span class="No-Break">or threat</span></li>
				<li><strong class="bold">Improving incident response and handling</strong>: If an attacker was able to gain a foothold into an organization’s network via their wireless infrastructure, cybersecurity professionals could perform wireless SIGINT to identify the tools, techniques, and source of the attack to improve their <strong class="bold">Cyber Threat </strong><span class="No-Break"><strong class="bold">Intelligence</strong></span><span class="No-Break"> (</span><span class="No-Break"><strong class="bold">CTI</strong></span><span class="No-Break">)</span></li>
			</ul>
			<p>Generally, wireless <a id="_idIndexMarker642"/>SIGINT helps organizations to better understand the attack surface of their wireless network infrastructure from an adversary’s perspective and the techniques that can be used to potentially compromise the network. The data collected during SIGINT helps ethical hackers to provide recommendations to their customers and organizations for improving their security posture, situational awareness, and incident response and handling. However, keep in mind that ethical hackers must obtain legal permission from the relevant authorities before performing <span class="No-Break">wireless SIGINT.</span></p>
			<p>Next, you will learn how to build a portable/mobile infrastructure for performing <span class="No-Break">wireless SIGINT.</span></p>
			<h2 id="_idParaDest-108"><a id="_idTextAnchor107"/>Building a SIGINT infrastructure</h2>
			<p>Many ethical hackers and<a id="_idIndexMarker643"/> penetration testers use a laptop with an external wireless network adapter that supports monitoring mode and packet injection to collect and analyze wireless signals within a vicinity. However, if you want to create a more compact setup that can be placed in a backpack for <a id="_idIndexMarker644"/>war-walking or mounted on an aerial drone for war-flying, then a laptop isn’t the best choice due to its size and weight. We can leverage the power of microcomputers such as a <strong class="bold">Raspberry Pi</strong> running <strong class="bold">Kali Linux ARM</strong> to perform reconnaissance on a target’s <span class="No-Break">wireless network.</span></p>
			<p>The following is a list of materials that <a id="_idIndexMarker645"/>will be needed to set up our portal wireless <span class="No-Break">signals infrastructure:</span></p>
			<ul>
				<li>Raspberry Pi <span class="No-Break">3 B+</span></li>
				<li>A 32-GB Samsung EVO+ <span class="No-Break">microSD card</span></li>
				<li>A <span class="No-Break">micro-USB cable</span></li>
				<li>An Alfa AWUS036NHA Wireless B/G/N <span class="No-Break">USB adapter</span></li>
				<li>A VK-162 G-Mouse USB GPS Dongle <span class="No-Break">Navigation Module</span></li>
				<li>A portable <span class="No-Break">power bank</span></li>
			</ul>
			<p>Raspberry Pi is a microcomputer with sufficient computing power to run <strong class="bold">Kismet</strong>, a wireless signals intelligence tool for <a id="_idIndexMarker646"/>monitoring IEEE 802.11, Bluetooth, and RF signals and detecting wireless network intrusions. The microSD card will be used to store the Kali Linux ARM operating system and all the data collected. The Alfa AWUS036NHA wireless network adapter supports <a id="_idIndexMarker647"/>monitoring mode and packet injection and connects to Raspberry Pi. The VK-162 G-Mouse USB GPS Dongle is used to collect the GPS coordinates of wireless stations (clients) and access points when they are found. The portable power bank will supply power to Raspberry Pi while war-walking, war-driving, <span class="No-Break">or war-flying.</span></p>
			<p>The following diagram shows the signals intelligence infrastructure <span class="No-Break">when assembled:</span></p>
			<div>
				<div id="_idContainer230" class="IMG---Figure">
					<img src="image/Figure_6.34_B19448.jpg" alt="Figure 6.34 – Signal﻿s intelligence infrastructure"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.34 – Signals intelligence infrastructure</p>
			<p>In addition, we’ll configure Raspberry Pi as an<a id="_idIndexMarker648"/> access point with a <strong class="bold">Dynamic Host Configuration Protocol</strong> (<strong class="bold">DHCP</strong>) server to provide IP addresses and subnet masks to any device that’s<a id="_idIndexMarker649"/> connected to its <strong class="source-inline">wlan0</strong> interface. This enables us to easily connect our <a id="_idIndexMarker650"/>laptop and use <strong class="bold">Secure Shell</strong> (<strong class="bold">SSH</strong>) to securely access the Kali Linux ARM operating system that’s running on Raspberry Pi during our wireless penetration <span class="No-Break">testing assessments.</span></p>
			<p>To get started with setting up Raspberry Pi for signals intelligence, please use the <span class="No-Break">following instructions:</span></p>
			<h3>Part 1 – Installing Kali Linux ARM</h3>
			<ol>
				<li>First, download<a id="_idIndexMarker651"/> and<a id="_idIndexMarker652"/> install <strong class="bold">Raspberry Pi Imager</strong> <span class="No-Break">from </span><a href="https://www.raspberrypi.com/software/"><span class="No-Break">https://www.raspberrypi.com/software/</span></a><span class="No-Break">.</span></li>
				<li>Next, download the official <strong class="bold">Kali Linux ARM</strong> operating system from <a href="https://www.kali.org/get-kali/">https://www.kali.org/get-kali/</a> for your version of <span class="No-Break">Raspberry Pi:</span></li>
			</ol>
			<div>
				<div id="_idContainer231" class="IMG---Figure">
					<img src="image/Figure_6.35_B19448.jpg" alt="Figure 6.35 – Kali Linux ARM"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.35 – Kali Linux ARM</p>
			<ol>
				<li value="3">Next, connect the microSD card to your host computer using an SD <span class="No-Break">card reader.</span></li>
				<li>To load the Kali Linux ARM operating system onto the microSD card, launch <strong class="bold">Raspberry Pi Imager</strong> and click on <strong class="bold">CHOOSE OS</strong> <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer232" class="IMG---Figure">
					<img src="image/Figure_6.36_B19448.jpg" alt="Figure 6.36 – Raspberry Pi Imager"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.36 – Raspberry Pi Imager</p>
			<ol>
				<li value="5">Next, the <strong class="bold">Operating System</strong> window<a id="_idIndexMarker653"/> will appear. Click<a id="_idIndexMarker654"/> on <strong class="bold">Use custom</strong> <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer233" class="IMG---Figure">
					<img src="image/Figure_6.37_B19448.jpg" alt="Figure 6.37 – Operating System menu"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.37 – Operating System menu</p>
			<ol>
				<li value="6">Next, select the <strong class="bold">Kali Linux ARM</strong> file and click on <strong class="bold">Open</strong> to load it onto <strong class="bold">Raspberry </strong><span class="No-Break"><strong class="bold">Pi Imager</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer234" class="IMG---Figure">
					<img src="image/Figure_6.38_B19448.jpg" alt="Figure 6.38 – Kali Linux ARM file"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.38 – Kali Linux ARM file</p>
			<ol>
				<li value="7">Next, return to the <a id="_idIndexMarker655"/>main menu on <strong class="bold">Raspberry Pi Imager</strong>, click on <strong class="bold">CHOOSE STORAGE</strong>, and select the<a id="_idIndexMarker656"/> microSD card as the <strong class="bold">Storage</strong> device. Then, click on the gear icon to open the <span class="No-Break">advanced options:</span></li>
			</ol>
			<div>
				<div id="_idContainer235" class="IMG---Figure">
					<img src="image/Figure_6.39_B19448.jpg" alt="Figure 6.39 – Writing the operating system"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.39 – Writing the operating system</p>
			<ol>
				<li value="8">Next, the <strong class="bold">Advanced options</strong> menu will appear. Check the <strong class="bold">Enable SSH</strong> box, set a username <a id="_idIndexMarker657"/>and password (<strong class="source-inline">kali</strong>/<strong class="source-inline">kali</strong>), and click on <strong class="bold">SAVE</strong>, as shown in the <span class="No-Break">following</span><span class="No-Break"><a id="_idIndexMarker658"/></span><span class="No-Break"> screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer236" class="IMG---Figure">
					<img src="image/Figure_6.40_B19448.jpg" alt="Figure 6.40 – Enabling SSH"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.40 – Enabling SSH</p>
			<ol>
				<li value="9">Next, you will automatically be returned to the <strong class="bold">Raspberry Pi Imager</strong> main window. Click on <strong class="bold">WRITE</strong> to begin writing the Kali Linux ARM OS image to the <span class="No-Break">microSD card:</span></li>
			</ol>
			<div>
				<div id="_idContainer237" class="IMG---Figure">
					<img src="image/Figure_6.41_B19448.jpg" alt="Figure 6.41 – Write button"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.41 – Write button</p>
			<p>This process usually <a id="_idIndexMarker659"/>takes a few minutes to write <span class="No-Break">and verify.</span></p>
			<ol>
				<li value="10">Once the write process is completed, insert the microSD card into Raspberry Pi, connect the GPS <a id="_idIndexMarker660"/>dongle and wireless network adapter, and power up the device by connecting it to a <span class="No-Break">power source.</span></li>
				<li>Next, connect Raspberry Pi to your wired network using a <span class="No-Break">network cable.</span></li>
				<li>Log in to your modem, router, or DHCP server to determine the IP address assigned to Raspberry Pi. The IP address will be required for the <span class="No-Break">next steps.</span></li>
			</ol>
			<h3>Part 2 – Setting up Kismet with GPS</h3>
			<ol>
				<li value="1">If you are<a id="_idIndexMarker661"/> using a <strong class="bold">Windows 10</strong> computer, open <strong class="bold">Command Prompt</strong> and execute the <strong class="source-inline">powershell</strong> command before <a id="_idIndexMarker662"/>proceeding to the <span class="No-Break">next step.</span></li>
				<li>If you are using a <strong class="bold">Windows 11</strong> or Linux-based operating system, open the <strong class="bold">Terminal</strong> and use the <strong class="source-inline">ssh kali@ip-address</strong> syntax, where <strong class="source-inline">ip-address</strong> is the IP address of Raspberry Pi on your network. Log in using the default user credentials of <strong class="source-inline">kali</strong>/<strong class="source-inline">kali</strong> as the username and password <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer238" class="IMG---Figure">
					<img src="image/Figure_6.42_B19448.jpg" alt="Figure 6.42 – Connecting to Raspberry P﻿i"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.42 – Connecting to Raspberry Pi</p>
			<p>As shown in the <a id="_idIndexMarker663"/>preceding screenshot, we<a id="_idIndexMarker664"/> are using SSH to securely access Raspberry Pi over the network to perform additional configurations and continue the <span class="No-Break">setup process.</span></p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Press <em class="italic">Ctrl</em> + <em class="italic">P</em> to change the layout of the <span class="No-Break">Terminal prompt.</span></p>
			<ol>
				<li value="3">Next, use the following command to update the software package <span class="No-Break">repository file:</span><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo apt update</strong></pre></li>
				<li>Next, install the latest version of Kismet and the GPS packages on Raspberry Pi using the <span class="No-Break">following command:</span><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo apt install kismet gpsd gpsd-clients</strong></pre></li>
			</ol>
			<p class="callout-heading">Tip</p>
			<p class="callout">You can use the <strong class="source-inline">dmesg | grep tty</strong> command to display the kernel messages associated with the <strong class="bold">teletypewriter</strong> (<strong class="bold">tty</strong>) subsystem. This command helps you to determine whether an attached USB device is detected and recognized by the <span class="No-Break">operating system.</span></p>
			<ol>
				<li value="5">Next, you’ll need <a id="_idIndexMarker665"/>to modify Kismet’s configurations to ensure the <strong class="source-inline">gpsd</strong> package is able<a id="_idIndexMarker666"/> to connect to the GPS dongle and send data to Kismet. To do this, use the following command to open the <strong class="source-inline">kismet.conf</strong> file in the <strong class="source-inline">nano</strong> command-line <span class="No-Break">text editor:</span><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo nano /etc/kismet/kismet.conf</strong></pre></li>
				<li>Next, use the down arrow on your keyboard to scroll down the text file until you’ve found the GPS settings. Then, insert the following on a <span class="No-Break">new line:</span><pre class="source-code">
gps=gpsd:host=localhost,port=2947,reconnect=true</pre></li>
			</ol>
			<p>This should look <span class="No-Break">as follows:</span></p>
			<div>
				<div id="_idContainer239" class="IMG---Figure">
					<img src="image/Figure_6.43_B19448.jpg" alt="Figure 6.43 – Modifying the GPS settings in Kismet"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.43 – Modifying the GPS settings in Kismet</p>
			<ol>
				<li value="7">Next, to save the modifications to the <strong class="source-inline">kismet.conf</strong> file, press <em class="italic">Ctrl</em> + <em class="italic">X</em>, then <em class="italic">Y</em>, and <span class="No-Break">hit </span><span class="No-Break"><em class="italic">Enter</em></span><span class="No-Break">.</span></li>
				<li>Next, configure <strong class="source-inline">gpsd</strong> to work with the GPS receiver on USB0 with the <span class="No-Break">following command:</span><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo gpsd -b /dev/ttyUSB0</strong></pre></li>
				<li>Reboot Raspberry<a id="_idIndexMarker667"/> Pi using the <strong class="source-inline">sudo reboot</strong> command and log <span class="No-Break">in</span><span class="No-Break"><a id="_idIndexMarker668"/></span><span class="No-Break"> again.</span></li>
				<li>Next, having ensured the GPS dongle has a clear vertical line of sight to the sky, use either the <strong class="source-inline">cgps –s</strong> or <strong class="source-inline">gpsmon</strong> commands to receive GPS data from orbital satellites, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer240" class="IMG---Figure">
					<img src="image/Figure_6.44_B19448.jpg" alt="Figure 6.44 – cgps data"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.44 – cgps data</p>
			<p>As shown in the<a id="_idIndexMarker669"/> preceding screenshot, the GPS software and dongle were able to identify and connect to a few satellites (right column). Additionally, Raspberry Pi was able<a id="_idIndexMarker670"/> to retrieve its current GPS coordinates (blurred for privacy) and other data for positioning and tracking. Press <em class="italic">Ctrl</em> + <em class="italic">C</em> to stop <strong class="bold">cgps</strong> <span class="No-Break">from running.</span></p>
			<h3>Part 3 – setting up an access point on Raspberry Pi</h3>
			<p>Setting up Raspberry Pi to <a id="_idIndexMarker671"/>function as an access point enables us to connect wirelessly to<a id="_idIndexMarker672"/> it using a mobile device such as a laptop or smartphone, hence removing the need for a wired connection. This makes Raspberry Pi fully autonomous and mobile for war-driving, war-walking, or war-flying exercises. Let’s do this <span class="No-Break">as follows:</span></p>
			<ol>
				<li>On Raspberry Pi, download and install the <strong class="source-inline">dnsmasq</strong> and <strong class="source-inline">hostapd</strong> packages for configuring wireless and <span class="No-Break">IP services:</span><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo apt install dnsmasq hostapd</strong></pre></li>
				<li>Next, use the following commands to stop the <strong class="source-inline">dnsmasq</strong> and <strong class="source-inline">hostapd</strong> services until they’re <span class="No-Break">needed later:</span><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo systemctl stop dnsmasq</strong></pre><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo systemctl stop hostapd</strong></pre></li>
				<li>Next, we need to set the<a id="_idIndexMarker673"/> parameters for the wireless network that will be broadcasted from the <strong class="source-inline">wlan0</strong> interface. Use the following command to edit the <span class="No-Break"><strong class="source-inline">hostapd.conf</strong></span><span class="No-Break"> file:</span><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo nano /etc/hostapd/hostapd.conf</strong></pre></li>
			</ol>
			<p>Then, insert the following configurations into the <span class="No-Break"><strong class="source-inline">hostapd.conf</strong></span><span class="No-Break"> file:</span></p>
			<pre class="source-code">
interface=wlan0
driver=nl80211
ssid=MyNetwork
hw_mode=g
channel=7
macaddr_acl=0
auth_algs=1
ignore_broadcast_ssid=0
wpa=2
wpa_passphrase=Password123
wpa_key_mgmt=WPA-PSK
wpa_pairwise=TKIP
rsn_pairwise=CCMP</pre>
			<p>Keep in mind, you<a id="_idIndexMarker674"/> can change <strong class="source-inline">MyNetwork</strong> to any wireless network name of your choice, and <strong class="source-inline">Password123</strong> to a stronger password for the network. The following <a id="_idIndexMarker675"/>screenshot shows the preceding configurations within the <span class="No-Break"><strong class="source-inline">hostapd.conf</strong></span><span class="No-Break"> file:</span></p>
			<div>
				<div id="_idContainer241" class="IMG---Figure">
					<img src="image/Figure_6.45_B19448.jpg" alt="Figure 6.45 – Hostapd configurations"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.45 – Hostapd configurations</p>
			<p>Press <em class="italic">Ctrl</em> + <em class="italic">X</em>, then press <em class="italic">Y</em>, and hit <em class="italic">Enter</em> to save <span class="No-Break">the file.</span></p>
			<ol>
				<li value="4">Next, install the <strong class="source-inline">dhcpcd</strong> package, which we will use to configure a static IP address on the <strong class="source-inline">wlan0</strong> interface <a id="_idIndexMarker676"/>of <span class="No-Break">Raspberry Pi:</span><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo apt install dhcpcd</strong></pre></li>
				<li>Next, modify the <strong class="bold">dhcpcd</strong> configuration file to assign the <strong class="source-inline">192.168.4.1</strong> address to the <strong class="source-inline">wlan0</strong> wireless adapter using the <span class="No-Break">following command:</span><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo nano /etc/dhcpcd.conf</strong></pre></li>
			</ol>
			<p>Insert the following parameters at the end of the <span class="No-Break"><strong class="source-inline">dhcpcd.conf</strong></span><span class="No-Break"> file:</span></p>
			<pre class="source-code">
interface wlan0
    static ip_address=192.168.4.1/24
    nohook wpa_supplicant</pre>
			<p>The following screenshot <a id="_idIndexMarker677"/>shows the preceding parameters inserted at the end of <span class="No-Break">the file:</span></p>
			<div>
				<div id="_idContainer242" class="IMG---Figure">
					<img src="image/Figure_6.46_B19448.jpg" alt="Figure 6.46 – dhcpcd file"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.46 – dhcpcd file</p>
			<p>Press <em class="italic">Ctrl</em> + <em class="italic">X</em>, then press <em class="italic">Y</em>, and hit <em class="italic">Enter</em> to save <span class="No-Break">the file.</span></p>
			<ol>
				<li value="6">Next, restart the <strong class="bold">dhcpcd</strong> service <a id="_idIndexMarker678"/>and enable it to automatically start on <span class="No-Break">system boot:</span><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo service dhcpcd restart</strong></pre><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo systemctl enable dhcpcd</strong></pre></li>
				<li>Next, back up the <strong class="source-inline">dnsmasq</strong> configuration file and create a new file using the <span class="No-Break">following commands:</span><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo mv /etc/dnsmasq.conf /etc/dnsmasq.conf.orig</strong></pre><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo nano /etc/dnsmasq.conf</strong></pre></li>
			</ol>
			<p>Then, insert the following parameters in the new <strong class="bold">dnsmasq</strong> <span class="No-Break">configuration file:</span></p>
			<pre class="source-code">
interface=wlan0
dhcp-range=192.168.4.2,192.168.4.20,255.255.255.0,24h</pre>
			<p>The following screenshot shows the preceding parameters within the <strong class="bold">dnsmasq</strong> <span class="No-Break">configuration file:</span></p>
			<div>
				<div id="_idContainer243" class="IMG---Figure">
					<img src="image/Figure_6.47_B19448.jpg" alt="Figure 6.47 – DNSmasq configurations"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.47 – DNSmasq configurations</p>
			<p>The configurations shown in the preceding screenshot are used to provide an IP address and subnet <a id="_idIndexMarker679"/>mask to any client that connects to the wireless <a id="_idIndexMarker680"/>network that’s generated from the <strong class="source-inline">wlan0</strong> interface on <span class="No-Break">Raspberry Pi.</span></p>
			<ol>
				<li value="8">Next, enable and restart the <strong class="source-inline">dnsmasq</strong> and <strong class="source-inline">hostapd</strong> services with the <span class="No-Break">following commands:</span><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo systemctl enable dnsmasq</strong></pre><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo systemctl restart dnsmasq</strong></pre><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo systemctl unmask hostapd</strong></pre><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo systemctl enable hostapd</strong></pre><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo systemctl restart hostapd</strong></pre></li>
				<li>Lastly, use the <strong class="source-inline">sudo reboot</strong> commands to reboot Raspberry Pi. After the device is rebooted, you will see the <strong class="source-inline">MyNetwork</strong> wireless network is available. Now you can connect to Raspberry Pi using the wireless network, and your device will receive an IP address within the <strong class="source-inline">192.168.4.2</strong> – <strong class="source-inline">192.168.4.20</strong> range. Then, you<a id="_idIndexMarker681"/> can access Raspberry Pi over SSH with the <strong class="source-inline">192.168.4.1</strong> address that’s statically <a id="_idIndexMarker682"/>configured on its <span class="No-Break"><strong class="source-inline">wlan0</strong></span><span class="No-Break"> interface.</span></li>
			</ol>
			<h3>Part 4 – Monitoring and data collection</h3>
			<ol>
				<li value="1">You’ll need to change the <a id="_idIndexMarker683"/>operating mode of your external wireless network adapter from manage to monitor<a id="_idIndexMarker684"/> mode. Use the <strong class="source-inline">iwconfig</strong> command to view the list of wireless adapters on Raspberry Pi <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer244" class="IMG---Figure">
					<img src="image/Figure_6.48_B19448.jpg" alt="Figure 6.48 – Wireless network adapters"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.48 – Wireless network adapters</p>
			<p>As shown in the preceding screenshot, <strong class="source-inline">wlan0</strong> is the embedded wireless adapter that’s used for the access point on Raspberry Pi and <strong class="source-inline">wlan1</strong> is the <span class="No-Break">external adapter.</span></p>
			<ol>
				<li value="2">Next, use <strong class="source-inline">airmon-ng</strong> to enable monitoring mode on the <span class="No-Break"><strong class="source-inline">wlan1</strong></span><span class="No-Break"> adapter:</span><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">sudo airmon-ng start wlan1</strong></pre></li>
			</ol>
			<p>The following screenshot shows the expected results when creating <strong class="source-inline">wlan1mon</strong>, the adapter with <span class="No-Break">monitor mode:</span></p>
			<div>
				<div id="_idContainer245" class="IMG---Figure">
					<img src="image/Figure_6.49_B19448.jpg" alt="Figure ﻿6.49 – Enabling monitor mode"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.49 – Enabling monitor mode</p>
			<ol>
				<li value="3">Next, use <a id="_idIndexMarker685"/>the <strong class="source-inline">iwconfig</strong> command<a id="_idIndexMarker686"/> to verify <strong class="source-inline">wlan1mon</strong> was created and that it’s operating in monitor mode <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer246" class="IMG---Figure">
					<img src="image/Figure_6.50_B19448.jpg" alt="Figure 6.50 – Verifying the adapter"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.50 – Verifying the adapter</p>
			<ol>
				<li value="4">Next, create a new<a id="_idIndexMarker687"/> directory called <strong class="source-inline">wardrive</strong> to store the <a id="_idIndexMarker688"/><span class="No-Break">collected data:</span><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">mkdir wardrive</strong></pre><pre class="source-code">
kali@kali-raspberry-pi:~$ <strong class="bold">cd wardrive</strong></pre></li>
			</ol>
			<p class="callout-heading">Tip</p>
			<p class="callout">When Kismet is running, you’ll be required to stay connected to the Kismet terminal. Any disruption of the connection will stop Kismet. To prevent this issue, we’ll use <strong class="bold">Tmux</strong>, which is a <a id="_idIndexMarker689"/>multiplexer terminal that lets us send terminal windows to the background without losing the session. Therefore, we can start a Tmux session, disconnect from Raspberry Pi, and then reconnect and regain access to the Tmux session. To learn more about Tmux, please <span class="No-Break">see </span><a href="https://github.com/tmux/tmux"><span class="No-Break">https://github.com/tmux/tmux</span></a><span class="No-Break">.</span></p>
			<ol>
				<li value="5">Next, start a <strong class="bold">Tmux</strong> session using the <span class="No-Break">following command:</span><pre class="source-code">
kali@kali-raspberry-pi:~/wardrive$ <strong class="bold">tmux</strong></pre></li>
				<li>Once the new Tmux session has opened, use the following commands to run <strong class="bold">Kismet</strong> and attach the monitor-mode wireless adapter <span class="No-Break">to it:</span><pre class="source-code">
kali@kali-raspberry-pi:~/wardrive$ <strong class="bold">kismet -c wlan1mon</strong></pre></li>
			</ol>
			<p>The following<a id="_idIndexMarker690"/> screenshot shows Kismet running with the GPS daemon attached, and<a id="_idIndexMarker691"/> our signals intelligence monitoring <span class="No-Break">has started:</span></p>
			<div>
				<div id="_idContainer247" class="IMG---Figure">
					<img src="image/Figure_6.51_B19448.jpg" alt="Figure 6.51 – Starting Kismet"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.51 – Starting Kismet</p>
			<p>As shown in the preceding screenshot, you can access the Kismet web interface by going <span class="No-Break">to </span><a href="http://ip-address-rasp-pi:2501"><span class="No-Break">http://ip-address-rasp-pi:2501</span></a><span class="No-Break">.</span></p>
			<ol>
				<li value="7">Next, to send the current Tmux session to the background, press <em class="italic">Ctrl</em> + <em class="italic">B</em>, then <span class="No-Break">press </span><span class="No-Break"><em class="italic">D</em></span><span class="No-Break">.</span></li>
			</ol>
			<p>At this point, if your Raspberry Pi is connected to a portable power bank, you can also terminate the SSH session and start war-driving, war-walking, or war-flying to collect signals intelligence within <span class="No-Break">an area.</span></p>
			<h3>Part 5 – Using the Kismet web interface</h3>
			<ol>
				<li>While you’re<a id="_idIndexMarker692"/> still connected to the access point from Raspberry Pi, open your web browser<a id="_idIndexMarker693"/> and go to <a href="http://ip-address-rasp-pi:2501">http://ip-address-rasp-pi:2501</a> to access the Kismet <span class="No-Break">web interface.</span></li>
				<li>Next, set your preferred login credentials to access Kismet and log in. The following screenshot shows the main dashboard <span class="No-Break">of Kismet:</span></li>
			</ol>
			<div>
				<div id="_idContainer248" class="IMG---Figure">
					<img src="image/Figure_6.52_B19448.jpg" alt="Figure 6.52 – Kismet web interface"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.52 – Kismet web interface</p>
			<p>As shown in the preceding screenshot, beacons and probes are captured and analyzed by Kismet. Beacons are WLAN frames sent from access points and probes are sent from clients. Additionally, in the top-right corner, you will notice your GPS coordinates <span class="No-Break">will appear.</span></p>
			<ol>
				<li value="3">Next, to display all access points within the vicinity, click on <strong class="bold">Devices</strong> | <strong class="bold">Wi-Fi Access Points</strong> <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer249" class="IMG---Figure">
					<img src="image/Figure_6.53_B19448.jpg" alt="Figure 6.53 – Filtering access points"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.53 – Filtering access points</p>
			<ol>
				<li value="4">Now, the<a id="_idIndexMarker694"/> dashboard will display only access points. Using the interface, you can identify<a id="_idIndexMarker695"/> their signal strength, view the amount of data transmitted, see the wireless security features, and more. Click on any wireless access point to view specific data, as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer250" class="IMG---Figure">
					<img src="image/Figure_6.54_B19448.jpg" alt="Figure 6.54 – Access point intelligence"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.54 – Access point intelligence</p>
			<p>As shown in the preceding screenshot, we are able to identify the specific 2.4-GHz channel and the<a id="_idIndexMarker696"/> frequency used by the target, along with the signal<a id="_idIndexMarker697"/> strength, MAC address of the access point, and manufacturer. Such information helps you to better profile the target device and determine the operating channel and approximate distance between your device and the targeted <span class="No-Break">access point.</span></p>
			<ol>
				<li value="5">Next, expand the <strong class="bold">Wi-Fi (802.11)</strong> tab to view the wireless network settings <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer251" class="IMG---Figure">
					<img src="image/Figure_6.55_B19448.jpg" alt="Figure 6.55 – Wireless settings"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.55 – Wireless settings</p>
			<p>As shown in the<a id="_idIndexMarker698"/> preceding screenshot, Kismet is able to identify the amount of WLAN frames (traffic) traveling<a id="_idIndexMarker699"/> through the targeted access point, advertised <strong class="bold">Service Set Identifiers</strong> (<strong class="bold">SSIDs</strong>), and whether there are multiple SSIDs advertised from the <a id="_idIndexMarker700"/>same <span class="No-Break">access point.</span></p>
			<ol>
				<li value="6">Next, on the same <strong class="bold">Wi-Fi (802.11)</strong> tab, you can see a list of stations (clients) that are associated with the <span class="No-Break">access point:</span></li>
			</ol>
			<div>
				<div id="_idContainer252" class="IMG---Figure">
					<img src="image/Figure_6.56_B19448.jpg" alt="Figure 6.56 – Stations"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.56 – Stations</p>
			<p>The stations are<a id="_idIndexMarker701"/> represented by their MAC addresses. Clicking on a station provides additional<a id="_idIndexMarker702"/> details such as data transmitted, connection status, and times of first and last connected. If an access point is configured with MAC address filtering, obtaining a list of authorized MAC addresses will be useful during a wireless network penetration <span class="No-Break">testing assessment.</span></p>
			<ol>
				<li value="7">To view more details about a station, click on <strong class="bold">View Client Details</strong> to open a new window as shown in the <span class="No-Break">following screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer253" class="IMG---Figure">
					<img src="image/Figure_6.57_B19448.jpg" alt="Figure 6.57 – Viewing a station’s details"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.57 – Viewing a station’s details</p>
			<p>As shown in the <a id="_idIndexMarker703"/>preceding screenshot, Kismet helps us determine the associated wireless network of a client, and whether the client is sending probes for any additional <a id="_idIndexMarker704"/>wireless networks. As an ethical hacker, you can set up a rogue access point to advertise the SSIDs found within probes. This technique can be used to trick the target into connecting to the fake network and capturing the WPA or WPA2 handshake, which can then be used to perform <span class="No-Break">password cracking.</span></p>
			<h3>Part 6 – Mapping the data onto Google Earth</h3>
			<ol>
				<li value="1">After you’ve collected the data, use the <strong class="source-inline">tmux ls</strong> command to view the Tmux session ID for the<a id="_idIndexMarker705"/> <span class="No-Break">background session:</span><pre class="source-code">
kali@kali-raspberry-pi:~/wardrive$ <strong class="bold">tmux ls</strong></pre><pre class="source-code">
0: 1 windows (created Fri Mar 31 16:09:42 2023)</pre></li>
			</ol>
			<p>As shown here, session ID <strong class="source-inline">0</strong> is the background session that’s <span class="No-Break">running Kismet.</span></p>
			<ol>
				<li value="2">To re-attach the background session to Tmux, use the <span class="No-Break">following commands:</span><pre class="source-code">
kali@kali-raspberry-pi:~/wardrive$ <strong class="bold">tmux attach –t 0</strong></pre></li>
			</ol>
			<p>The following screenshots the <a id="_idIndexMarker706"/>Kismet session re-attached and running <span class="No-Break">as expected:</span></p>
			<div>
				<div id="_idContainer254" class="IMG---Figure">
					<img src="image/Figure_6.58_B19448.jpg" alt="Figure 6.58 – Kismet"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.58 – Kismet</p>
			<ol>
				<li value="3">To gracefully stop Kismet and save the collected data, press <em class="italic">Ctrl</em> + <em class="italic">C</em> to stop <span class="No-Break">the process:</span></li>
			</ol>
			<div>
				<div id="_idContainer255" class="IMG---Figure">
					<img src="image/Figure_6.59_B19448.jpg" alt="Figure 6.59 – Stopping Kismet"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.59 – Stopping Kismet</p>
			<p>Once Kismet is<a id="_idIndexMarker707"/> stopped, a <strong class="source-inline">.kismet</strong> file is automatically created containing all the <span class="No-Break">collected data:</span></p>
			<div>
				<div id="_idContainer256" class="IMG---Figure">
					<img src="image/Figure_6.60_B19448.jpg" alt="Figure 6.60 – Kismet file"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.60 – Kismet file</p>
			<ol>
				<li value="4">Next, type <strong class="source-inline">exit</strong> to leave the <a id="_idIndexMarker708"/>Tmux terminal and return to the default shell on the <span class="No-Break">Linux terminal:</span><pre class="source-code">
kali@kali-raspberry-pi:~/wardrive$ <strong class="bold">exit</strong></pre></li>
				<li>Next, use the following commands to convert the <strong class="source-inline">.kismet</strong> file into a <strong class="source-inline">.</strong><span class="No-Break"><strong class="source-inline">kml</strong></span><span class="No-Break"> file:</span><pre class="source-code">
kali@kali-raspberry-pi:~/wardrive$ <strong class="bold">sudo kismetdb_to_kml --in Kismet-20230302-16-15-13-1.kismet --out wardrive1.kml</strong></pre></li>
			</ol>
			<p>The following screenshot shows the output during the <span class="No-Break">conversion process:</span></p>
			<div>
				<div id="_idContainer257" class="IMG---Figure">
					<img src="image/Figure_6.61_B19448.jpg" alt="Figure 6.61 – Creating a KML file"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.61 – Creating a KML file</p>
			<p class="callout-heading">Important note</p>
			<p class="callout"><strong class="bold">Keyhole Markup Language</strong> (<strong class="bold">KML</strong>) is a data format that is used to represent geographic data and visualization within 2D and 3D mapping systems such as <span class="No-Break"><strong class="bold">Google Earth</strong></span><span class="No-Break">.</span></p>
			<ol>
				<li value="6">Next, reconnect <a id="_idIndexMarker709"/>Raspberry Pi to your network and use a tool such as <strong class="bold">WinSCP</strong> to securely connect<a id="_idIndexMarker710"/> and download the <strong class="source-inline">.kml</strong> file onto your <span class="No-Break">host computer.</span></li>
				<li>Next, download and install <strong class="bold">Google Earth Pro</strong> <span class="No-Break">from </span><a href="https://www.google.com/earth/versions/"><span class="No-Break">https://www.google.com/earth/versions/</span></a><span class="No-Break">.</span></li>
				<li>Next, launch the <strong class="bold">Google Earth Pro</strong> application on your computer and click on <strong class="bold">File | Open...</strong> to attach the <strong class="source-inline">.kml</strong> file <span class="No-Break">as shown:</span></li>
			</ol>
			<div>
				<div id="_idContainer258" class="IMG---Figure">
					<img src="image/Figure_6.62_B19448.jpg" alt="Figure 6.62 – Google Earth Pro ﻿File menu"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.62 – Google Earth Pro File menu</p>
			<p>After the <strong class="source-inline">.kml</strong> file is loaded, Google Earth Pro shows yellow pins that represent the locations of wireless <a id="_idIndexMarker711"/>devices such as access points and stations discovered<a id="_idIndexMarker712"/> using Kismet, as shown in the <span class="No-Break">following screenshot:</span></p>
			<div>
				<div id="_idContainer259" class="IMG---Figure">
					<img src="image/Figure_6.63_B19448.jpg" alt="Figure 6.63 – Mapping wireless devices"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.63 – Mapping wireless devices</p>
			<p>As an ethical hacker, signals intelligence<a id="_idIndexMarker713"/> helps you to better understand the wireless landscape around your target, which is especially useful if you’re trying to find your target’s wireless networks<a id="_idIndexMarker714"/> and clients. Having completed this section, you have learned how to perform wireless <span class="No-Break">signals intelligence.</span></p>
			<h1 id="_idParaDest-109"><a id="_idTextAnchor108"/>Summary</h1>
			<p>During this chapter, you learned how images contain a lot of data that can be leveraged by adversaries to identify the location of a target and their whereabouts. In addition, you gained the skills to extract EXIF data from images and use it with global mapping systems to identify a target’s geo-location at the time the picture was taken. Furthermore, you learned how to collect and analyze intelligence on people and search data breaches to identify user credentials for gaining access to a target’s account, system, <span class="No-Break">or network.</span></p>
			<p>Lastly, you learned about the importance of performing wireless SIGINT as an ethical hacker and gained the hands-on skills for constructing a mobile wireless SIGINT infrastructure for war-driving, war-walking, <span class="No-Break">and war-flying.</span></p>
			<p>I hope this chapter has been informative and helpful for your journey in the cybersecurity industry. In the next chapter, <em class="italic">Working with Active Reconnaissance</em>, you will learn how to determine open ports and running services, profile operating systems, and enumerate resources <span class="No-Break">on hosts.</span></p>
			<h1 id="_idParaDest-110"><a id="_idTextAnchor109"/>Further reading</h1>
			<ul>
				<li>OSINT attack surface <span class="No-Break">diagrams: </span><a href="https://www.osintdojo.com/diagrams/main"><span class="No-Break">https://www.osintdojo.com/diagrams/main</span></a></li>
				<li>OSINT tools and <span class="No-Break">tutorials: </span><a href="https://osint.tools/"><span class="No-Break">https://osint.tools/</span></a></li>
				<li><span class="No-Break">SIGINT: </span><a href="https://www.techtarget.com/whatis/definition/SIGINT-signals-intelligence"><span class="No-Break">https://www.techtarget.com/whatis/definition/SIGINT-signals-intelligence</span></a></li>
				<li>Understanding location <span class="No-Break">data: </span><a href="https://www.quadrant.io/resources/location-data"><span class="No-Break">https://www.quadrant.io/resources/location-data</span></a></li>
			</ul>
		</div>
	

		<div id="_idContainer261" class="Content">
			<h1 id="_idParaDest-111"><a id="_idTextAnchor110"/>Part 2: Scanning and Enumeration</h1>
			<p>In this section, you will learn how to perform advanced scanning techniques to discover hosts, identify security vulnerabilities on systems, enumerate common network services, collect intelligence on websites, and identify reconnaissance activities in <span class="No-Break">a network.</span></p>
			<p>This part has the <span class="No-Break">following chapters:</span></p>
			<ul>
				<li><a href="B19448_07.xhtml#_idTextAnchor111"><em class="italic">Chapter 7</em></a>, <em class="italic">Working with Active Reconnaissance</em></li>
				<li><a href="B19448_08.xhtml#_idTextAnchor129"><em class="italic">Chapter 8</em></a>, <em class="italic">Performing Vulnerability Assessments</em></li>
				<li><a href="B19448_09.xhtml#_idTextAnchor145"><em class="italic">Chapter 9</em></a>, <em class="italic">Delving into Website Reconnaissance</em></li>
				<li><a href="B19448_10.xhtml#_idTextAnchor165"><em class="italic">Chapter 10</em></a>, <em class="italic">Implementing Recon Monitoring and Detection Systems</em></li>
			</ul>
		</div>
		<div>
			<div id="_idContainer262" class="Basic-Graphics-Frame">
			</div>
		</div>
		<div>
			<div id="_idContainer263">
			</div>
		</div>
	</body></html>