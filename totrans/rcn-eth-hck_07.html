<html><head></head><body>
		<div id="_idContainer311">
			<h1 id="_idParaDest-112" class="chapter-number"><a id="_idTextAnchor111"/>7</h1>
			<h1 id="_idParaDest-113"><a id="_idTextAnchor112"/>Working with Active Reconnaissance</h1>
			<p>The more information known about a target, the more ethical hackers are able to identify security vulnerabilities, which can be exploited to get unauthorized access to the systems and networks of organizations. Active reconnaissance helps ethical hackers and penetration testers to collect and analyze information about a target that’s not accessible or available during passive reconnaissance. Since passive reconnaissance relies on <strong class="bold">Open Source Intelligence</strong> (<strong class="bold">OSINT</strong>) and publicly available information from multiple online sources, the information may not be up to date, and inaccuracy affects planning future operations such as weaponization and exploitation of the target. With active reconnaissance, ethical hackers collect data in real time to better identify <span class="No-Break">security vulnerabilities.</span></p>
			<p>In this chapter, you will learn how to efficiently scan hosts on a network to identify their operating systems, open ports, and running services using automated tools and techniques. In addition, you will gain hands-on experience in spoofing your identity and evading threat detection systems, such as firewalls and <strong class="bold">Intrusion Detection Systems</strong> (<strong class="bold">IDSes</strong>), while performing host discovery on a network. Lastly, you will learn how to enumerate sensitive data from vulnerable systems on a network and perform <span class="No-Break">wireless reconnaissance.</span></p>
			<p>In this chapter, we will cover the <span class="No-Break">following topics:</span></p>
			<ul>
				<li><span class="No-Break">Automating reconnaissance</span></li>
				<li>Spoofing your identity on <span class="No-Break">a network</span></li>
				<li>Discovering live hosts on <span class="No-Break">a network</span></li>
				<li>Using <span class="No-Break">evasion techniques</span></li>
				<li>Enumerating <span class="No-Break">network services</span></li>
				<li><span class="No-Break">Wireless reconnaissance</span></li>
			</ul>
			<p>Let’s <span class="No-Break">dive in!</span></p>
			<h1 id="_idParaDest-114"><a id="_idTextAnchor113"/>Technical requirements</h1>
			<p>To follow along with the exercises in this chapter, please ensure that you have met the following hardware and <span class="No-Break">software requirements:</span></p>
			<ul>
				<li>Kali <span class="No-Break">Linux: </span><a href="https://www.kali.org/get-kali/"><span class="No-Break">https://www.kali.org/get-kali/</span></a></li>
				<li><span class="No-Break">Metasploitable 3</span></li>
				<li>An Alfa AWUS036NHA – Wireless B/G/N <span class="No-Break">USB adapter</span></li>
			</ul>
			<h1 id="_idParaDest-115"><a id="_idTextAnchor114"/>Active reconnaissance</h1>
			<p>Unlike passive reconnaissance, which leverages OSINT to help ethical hackers create a profile of a target, active reconnaissance uses a more direct approach by sending probes to the targeted systems <a id="_idIndexMarker715"/>and networks to collect sensitive and specific details. For instance, during passive reconnaissance, the threat actor depends on the accuracy of the collected data from multiple online sources. If the data is outdated or inaccurate, it can affect both the weaponization and exploitation phases and prevent ethical hacking from gaining access to the target. With active reconnaissance, the collection of data is performed in real time, enabling ethical hacking to collect and analyze current data to help improve <span class="No-Break">future operations.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Scanning is intrusive and illegal <a id="_idIndexMarker716"/>in many countries, so ensure that you obtain legal permission from the authorities before scanning any system or network you do <span class="No-Break">not own.</span></p>
			<p>Active reconnaissance plays an important role during ethical hacking and penetration testing, as it helps cybersecurity professionals to collect data about live systems on a network, and such data can be leveraged to identify the attack surface, which consists of the vulnerable points of entry that can be exploited to gain a foothold into a target. The following are the various types of data that can be collected to better profile the target or the <span class="No-Break">targeted systems:</span></p>
			<ul>
				<li>The number of live hosts on <span class="No-Break">a network</span></li>
				<li>Open service ports <span class="No-Break">on systems</span></li>
				<li>Running services (<span class="No-Break">banner grabbing)</span></li>
				<li>The operating systems of <span class="No-Break">host devices</span></li>
				<li>Identifying <span class="No-Break">security vulnerabilities</span></li>
				<li>The <span class="No-Break">network topology</span></li>
				<li>The placement of <span class="No-Break">networking devices</span></li>
				<li>Identifying <span class="No-Break">security appliances</span></li>
			</ul>
			<p>To identify live hosts, an ethical hacker sends specially crafted probes on the network. This helps the ethical <a id="_idIndexMarker717"/>hacker to determine whether a targeted host is online or not before attempting any future actions, such as enumeration<a id="_idIndexMarker718"/> and vulnerability <a id="_idIndexMarker719"/>analysis. This is commonly referred to as <strong class="bold">network scanning</strong> or <span class="No-Break"><strong class="bold">host discovery</strong></span><span class="No-Break">.</span></p>
			<p>After the targeted host(s) are discovered on the network, the next step is to identify any open service port on the device. These ports are the entry and exit points within an operating system, and <a id="_idIndexMarker720"/>they are associated with an application-layer protocol within the <strong class="bold">Transmission Control Protocol/Internet Protocol</strong> (<strong class="bold">TCP/IP</strong>) networking model. Before a client sends packets onto a network, it opens an ephemeral/dynamic port for the outgoing traffic. When a server runs an application such as Apache HTTP Server, it opens either port <strong class="source-inline">80</strong> or <strong class="source-inline">443</strong> to listen for <span class="No-Break">incoming packets.</span></p>
			<p>The following diagram shows the source and destination addressing information that will be included within a packet from a client to a web server over <span class="No-Break">a network:</span></p>
			<div>
				<div id="_idContainer264" class="IMG---Figure">
					<img src="image/Figure_7.01_B19448.jpg" alt="Figure 7.1 – The HTTP request message"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.1 – The HTTP request message</p>
			<p>The following diagram <a id="_idIndexMarker721"/>shows how the source information from the client is used to send a response from <span class="No-Break">the server:</span></p>
			<div>
				<div id="_idContainer265" class="IMG---Figure">
					<img src="image/Figure_7.02_B19448.jpg" alt="Figure 7.2 – The HTTP response"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.2 – The HTTP response</p>
			<p>As an ethical hacker, identifying open ports helps us to determine the running services on a targeted system. In addition, you can attempt to perform banner grabbing to identify the service versions of all running services. The service version can be leveraged to find known security vulnerabilities and their severity for a specific service on the <span class="No-Break">targeted system.</span></p>
			<p>The following table shows the categories of <span class="No-Break">port numbers:</span></p>
			<div>
				<div id="_idContainer266" class="IMG---Figure">
					<img src="image/Figure_7.03_B19448.jpg" alt="Figure 7.3 – Port number ranges"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.3 – Port number ranges</p>
			<p>As shown in the preceding table, ports <strong class="source-inline">1</strong>–<strong class="source-inline">1023</strong> are commonly referred to as well-known ports, as <a id="_idIndexMarker722"/>these ports are associated with <a id="_idIndexMarker723"/>common application-layer protocols such as <strong class="bold">Hypertext Transfer Protocol Secure</strong> (<strong class="bold">HTTPS</strong>), <strong class="bold">Domain Name System</strong> (<strong class="bold">DNS</strong>), and <strong class="bold">Simple Mail Transfer Protocol</strong> (<strong class="bold">SMTP</strong>). Registered ports are simply network <a id="_idIndexMarker724"/>service ports that are designated to specific application-layer protocols or services, and private/dynamic ports are temporarily open to send packets from a client to other systems on <span class="No-Break">a network.</span></p>
			<p>Next, it’s important to identify the operating system of targeted hosts, as it helps ethical hackers to identify <a id="_idIndexMarker725"/>possible security vulnerabilities that can be exploited to gain a foothold on the target. In addition, different operating systems have different security controls and mechanisms, and architectures that can make them more or less secure to various types of cyberattacks and threats. Therefore, such information can be leveraged by ethical hackers to customize their exploits and payloads for specific security vulnerabilities on a specific <span class="No-Break">operating system.</span></p>
			<p>For instance, if your target runs outdated versions of an operating system such as Microsoft Windows 7, you can research known security vulnerabilities and how they can be exploited. For example, <strong class="bold">Microsoft Security Bulletin MS17-010</strong> describes a known security <a id="_idIndexMarker726"/>vulnerability within Microsoft <a id="_idIndexMarker727"/>Windows 7–Windows Server 2016 operating systems, which enables an attacker to perform <strong class="bold">Remote Code Execution</strong> (<strong class="bold">RCE</strong>) by exploiting <a id="_idIndexMarker728"/>the Microsoft <strong class="bold">Server Message Block</strong> (<strong class="bold">SMB</strong>) version 1 service on the host. Such information is useful when performing vulnerability analysis and developing a payload for the <span class="No-Break">exploitation phase.</span></p>
			<p>When scanning a network, ethical hackers can determine the layout of the network topology, such as identifying the placement of network switches and routers, and security appliances such as firewalls. This information helps you to understand what type of devices are between your attacker machine and the targeted host. If there are routers on the <a id="_idIndexMarker729"/>network, these routers may be configured with packet-filtering capabilities such as <strong class="bold">Access Control Lists</strong> (<strong class="bold">ACLs</strong>) to filter specific layer 3 and layer 4 traffic between a source and destination. If firewalls are present on the network, they may be configured to <a id="_idIndexMarker730"/>perform <strong class="bold">Deep Packet Inspection</strong> (<strong class="bold">DPI</strong>) to inspect application-layer traffic for malicious code and <a id="_idIndexMarker731"/>advanced filtering between networks. Hence, understanding the network topology helps you to better plan your attacks and <span class="No-Break">future operations.</span></p>
			<p>Having completed this section, you have learned the importance of active reconnaissance and how it helps ethical hackers during their security assessments. Next, you will learn how to spoof your device’s identity on <span class="No-Break">a network.</span></p>
			<h1 id="_idParaDest-116"><a id="_idTextAnchor115"/>Spoofing your identity on a network</h1>
			<p>Ethical hackers commonly use the same <strong class="bold">Tactics, Techniques, and Procedures</strong> (<strong class="bold">TTPs</strong>) as real adversaries <a id="_idIndexMarker732"/>and threat actors, with the intention <a id="_idIndexMarker733"/>of efficiently discovering hidden security vulnerabilities on a target’s systems and network before a real hacker is able to discover and exploit them. A common technique used during ethical hacking, penetration testing, and red teaming is concealing your identity <a id="_idIndexMarker734"/>by spoofing your device’s IP address and <strong class="bold">Media Access Control</strong> (<span class="No-Break"><strong class="bold">MAC</strong></span><span class="No-Break">) address.</span></p>
			<p>A device can be assigned an IP address via a <strong class="bold">Dynamic Host Configuration Protocol</strong> (<strong class="bold">DHCP</strong>) server on a <a id="_idIndexMarker735"/>network or statically <a id="_idIndexMarker736"/>assigned by a user. Any of these methods allow an IP address to be assigned to the device’s <strong class="bold">Network Interface Card</strong> (<strong class="bold">NIC</strong>). There’s a unique 48-bit hexadecimal MAC address that’s embedded into the firmware of the network adapter by its manufacturer. Whenever a device sends a frame (message) on a network, the source MAC address of the sender and the destination MAC address of the target are inserted into the frame header. The first 24 bits of a MAC address are unique <a id="_idIndexMarker737"/>to the manufacturer, which is known as the <strong class="bold">Organizational Unique Identifier</strong> (<strong class="bold">OUI</strong>), and anyone can perform a vendor lookup on any MAC address using various online databases to determine the manufacturer and type of device. Cybersecurity and networking professionals can capture and analyze packets on a network to identify unauthorized devices based on their IP and <span class="No-Break">MAC addresses.</span></p>
			<p>The following <a id="_idIndexMarker738"/>are online databases to perform MAC <span class="No-Break">vendor lookup:</span></p>
			<ul>
				<li>Wireshark OUI Lookup <span class="No-Break">tool: </span><a href="https://www.wireshark.org/tools/oui-lookup.html"><span class="No-Break">https://www.wireshark.org/tools/oui-lookup.html</span></a></li>
				<li>MAC <span class="No-Break">Vendors: </span><a href="https://macvendors.com/"><span class="No-Break">https://macvendors.com/</span></a></li>
				<li><span class="No-Break">MACaddress.io: </span><a href="https://macaddress.io/"><span class="No-Break">https://macaddress.io/</span></a></li>
			</ul>
			<p>As an ethical hacker, consider changing the MAC address of your attacker machine to something that is very <a id="_idIndexMarker739"/>common on a typical network within an organization, such as an IP phone, network printer, or a popular brand of devices. The tactic is to ensure that your device does not stand out or attract the attention of the security team during your ethical hacking and penetration testing exercises. Therefore, if your device is assigned the MAC address of a network printer or an IP phone, an inexperienced security professional may not notice your device sending probes to other systems on the network to <span class="No-Break">collect information.</span></p>
			<p>To get started with spoofing the identity of your attacker machine, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li value="1">Firstly, power on your <strong class="bold">Kali Linux</strong> virtual machine and <span class="No-Break">log in.</span></li>
				<li>Next, open the Terminal and use the following commands to verify the MAC address of the <strong class="source-inline">eth1</strong> network adapter that’s connected to the <strong class="source-inline">172.30.1.0/24</strong> (<em class="italic">PentestNet</em>) network within <span class="No-Break">our lab:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">ip address show eth1</strong></pre></li>
			</ol>
			<p>The following snippet shows that the <strong class="source-inline">eth1</strong> network adapter is assigned the <strong class="source-inline">08:00:27:7d:98:8e</strong> <span class="No-Break">MAC address:</span></p>
			<div>
				<div id="_idContainer267" class="IMG---Figure">
					<img src="image/Figure_7.04_B19448.jpg" alt="Figure 7.4 – Verifying the MAC address"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.4 – Verifying the MAC address</p>
			<ol>
				<li value="3">Next, change the <strong class="source-inline">eth1</strong> network adapter status <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">down</strong></span><span class="No-Break">:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo ifconfig eth1 down</strong></pre></li>
				<li>Next, we can use the pre-installed <strong class="source-inline">macchanger</strong> tool to view the different options for altering the MAC address on the <span class="No-Break">network adapter:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo macchanger -h</strong></pre></li>
			</ol>
			<p>The following <a id="_idIndexMarker740"/>snippet shows there are various options to change the MAC address on the network adapter, such as randomly generating one, statically setting the MAC address of your preference, and assigning an address based on <span class="No-Break">a vendor:</span></p>
			<div>
				<div id="_idContainer268" class="IMG---Figure">
					<img src="image/Figure_7.05_B19448.jpg" alt="Figure 7.5 – The MAC changer menu"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.5 – The MAC changer menu</p>
			<ol>
				<li value="5">Next, assign a randomly generated MAC address to the <strong class="source-inline">eth1</strong> <span class="No-Break">network adapter:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo macchanger -A eth1</strong></pre></li>
			</ol>
			<p>The following snippet shows the current (original) MAC address and the new randomly generated address on the <span class="No-Break">network adapter:</span></p>
			<div>
				<div id="_idContainer269" class="IMG---Figure">
					<img src="image/Figure_7.06_B19448.jpg" alt="Figure 7.6 – The spoofed MAC address"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.6 – The spoofed MAC address</p>
			<ol>
				<li value="6">Next, use the following command to re-enable the <strong class="source-inline">eth1</strong> <span class="No-Break">network adapter:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo ifconfig eth1 up</strong></pre></li>
				<li>Next, use either the <strong class="source-inline">ip address show eth1</strong> or <strong class="source-inline">ifconfig eth1</strong> commands to <a id="_idIndexMarker741"/>verify the <strong class="source-inline">eth1</strong> network adapter is up and assigned the spoofed MAC address, as <span class="No-Break">shown here:</span></li>
			</ol>
			<div>
				<div id="_idContainer270" class="IMG---Figure">
					<img src="image/Figure_7.07_B19448.jpg" alt="Figure 7.7 – Verifying the interface status"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.7 – Verifying the interface status</p>
			<p>Any frames that originate from the <strong class="source-inline">eth1</strong> network adapter of your Kali Linux machine will be <a id="_idIndexMarker742"/>assigned the spoofed MAC address as the new source <span class="No-Break">MAC address.</span></p>
			<p>Having completed this section, you have learned how to spoof the MAC address of a network adapter to spoof the identity of your device. In the next section, you will learn how to discover and profile hosts on <span class="No-Break">a network.</span></p>
			<h1 id="_idParaDest-117"><a id="_idTextAnchor116"/>Discovering live hosts on a network</h1>
			<p>Host discovery is an important <a id="_idIndexMarker743"/>part of ethical hacking and penetration testing, as it enables an ethical hacker to identify which systems on a network are discoverable and live within an organization. If your targeted host is offline, you won’t be able to identify security vulnerabilities and send an exploit <span class="No-Break">to it.</span></p>
			<p>There are various techniques and tools that help ethical hackers efficiently discover live hosts on a network and identify open ports and running services. This section will help you develop the skills and knowledge to perform host discovery as an <span class="No-Break">ethical hacker.</span></p>
			<h2 id="_idParaDest-118"><a id="_idTextAnchor117"/>Performing passive scanning with Netdiscover</h2>
			<p><strong class="bold">Netdiscover</strong> is a pre-installed tool within Kali Linux that enables ethical hackers to either actively scan a <a id="_idIndexMarker744"/>network range <a id="_idIndexMarker745"/>or passively listen and analyze network packets to discover live hosts. Active scanning sends probes to each device within the network to determine which hosts are online. When using passive-mode, network packets that are captured by the attacker’s machine will be analyzed to identify the IP and MAC addresses of other devices. However, passive-mode within Netdiscover reduces your threat detection level on the network unless the security team actively scans their network infrastructure to identify <span class="No-Break">unauthorized devices.</span></p>
			<p>To get started with using Netdiscover in passive-mode, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li>Firstly, power on the <strong class="bold">Kali Linux</strong> virtual machine and <span class="No-Break">log in.</span></li>
				<li>Next, power on the <strong class="bold">Metasploitable 3</strong> virtual machine. This machine will be used to generate traffic on the <span class="No-Break"><strong class="source-inline">PentestNet</strong></span><span class="No-Break"> network.</span></li>
				<li>Next, open the Terminal on Kali Linux and use the following commands to verify the IP address and subnet mask of the <strong class="source-inline">eth1</strong> <span class="No-Break">network adapter:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">ip addr show eth1</strong></pre></li>
			</ol>
			<p>As shown in the following snippet, <strong class="source-inline">eth1</strong> is connected to the <strong class="source-inline">172.30.1.0/24</strong> <span class="No-Break">network (</span><span class="No-Break"><em class="italic">PentestNet</em></span><span class="No-Break">):</span></p>
			<div>
				<div id="_idContainer271" class="IMG---Figure">
					<img src="image/Figure_7.08_B19448.jpg" alt="Figure 7.8 – Checking the interface status"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.8 – Checking the interface status</p>
			<p>It’s important to verify which network adapter on your attacker machine is connected to <a id="_idIndexMarker746"/>the targeted <a id="_idIndexMarker747"/>network. If you start scanning the wrong network or range of IP addresses, you can land yourself in some legal trouble, as scanning is considered illegal, and you’ll be breaching the legal penetration <span class="No-Break">testing agreement.</span></p>
			<ol>
				<li value="4">Next, enable <strong class="bold">Netdiscover</strong> to operate in passive-mode and listen on the <strong class="source-inline">eth1</strong> interface for <span class="No-Break">network traffic:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo netdiscover -p -i eth1</strong></pre></li>
			</ol>
			<p>The following snippet shows Netdiscover was able to identify the MAC and IP addresses of devices that transmitted messages on the <span class="No-Break"><strong class="source-inline">172.30.1.0/24</strong></span><span class="No-Break"> network:</span></p>
			<div>
				<div id="_idContainer272" class="IMG---Figure">
					<img src="image/Figure_7.09_B19448.jpg" alt="Figure 7.9 – Passive scanning"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.9 – Passive scanning</p>
			<p>Passive-mode in Netdiscover can only analyze network traffic if it’s detected on the <strong class="source-inline">eth1</strong> network <a id="_idIndexMarker748"/>adapter on a Kali Linux virtual machine. If you’re not seeing any results <a id="_idIndexMarker749"/>appearing, simply log in to the Metasploitable 3 virtual machine with the <strong class="source-inline">Administrator</strong>/<strong class="source-inline">vagrant</strong> user credentials and send <strong class="bold">ping</strong> messages to the Kali Linux <span class="No-Break">virtual machine.</span></p>
			<p>While passive scanning may reduce your threat detection by the target, it may not provide the expected results needed to move forward with your ethical hacking and penetration testing methodology. Next, you will learn how to perform a ping sweep across an <span class="No-Break">entire network.</span></p>
			<h2 id="_idParaDest-119"><a id="_idTextAnchor118"/>Performing a ping sweep</h2>
			<p>A <strong class="bold">ping sweep</strong> is a common technique used by IT and security professionals to easily identify live hosts <a id="_idIndexMarker750"/>on a network. It involves sending <strong class="bold">ICMP ECHO Request</strong> messages <a id="_idIndexMarker751"/>to each host on the network; when a live host receives <a id="_idIndexMarker752"/>the ICMP ECHO Request message, it will respond by sending an <strong class="bold">ICMP ECHO Reply</strong> message to the sender, which indicates that the host is online. Within client and server operating systems, there’s a <strong class="bold">Ping</strong> utility, which leverages <strong class="bold">Internet Control Message Protocol</strong> (<strong class="bold">ICMP</strong>), a network protocol that <a id="_idIndexMarker753"/>helps networking professionals to identify common <span class="No-Break">network issues.</span></p>
			<p>The following snippet shows a Wireshark packet capture of ICMP messages between a client and Google’s <span class="No-Break">DNS server:</span></p>
			<div>
				<div id="_idContainer273" class="IMG---Figure">
					<img src="image/Figure_7.10_B19448.jpg" alt="Figure 7.10 – Ping messages"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.10 – Ping messages</p>
			<p>If you want to perform a ping sweep across the <em class="italic">PentestNet</em> network within our lab environment, you will need to ping each host on the <strong class="source-inline">172.30.1.0/24</strong> network that ranges from <strong class="source-inline">172.30.1.1</strong>–<strong class="source-inline">172.30.1.254</strong>. This is usually a manual, mundane, and time-consuming task <a id="_idIndexMarker754"/>for many. However, as an aspiring ethical hacker, you <a id="_idIndexMarker755"/>can automate the ping sweep process using various programming languages and <a id="_idIndexMarker756"/>even the native <strong class="bold">Bourne Again Shell</strong> (<strong class="bold">BASH</strong>) in Linux-based <span class="No-Break">operating systems.</span></p>
			<p>To automate the ping sweep process on Kali Linux using BASH, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li>Firstly, power on both the <strong class="bold">Kali Linux</strong> and <strong class="bold">Metasploitable 3</strong> Windows <span class="No-Break">virtual machines.</span></li>
				<li>Next, log in to <strong class="bold">Kali Linux</strong> and use the following commands within the Terminal to create a new BASH script file, using the <strong class="source-inline">nano</strong> command-line <span class="No-Break">text editor:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo nano ping-sweep.sh</strong></pre></li>
				<li>Next, when Nano opens on the Terminal, type the following code to create <span class="No-Break">the script:</span><pre class="source-code">
#!/bin/bash</pre><pre class="source-code">
echo "Enter the network ID you want to scan (e.g. 192.168.1.0):"</pre><pre class="source-code">
read network</pre><pre class="source-code">
echo "Enter the subnet mask in CIDR notation (e.g. 24):"</pre><pre class="source-code">
read mask</pre><pre class="source-code">
if [[ $mask =~ ^[0-9]+$ ]] &amp;&amp; [ $mask -le 32 ]; then</pre><pre class="source-code">
  wildcard=$(( 2**(32-$mask) - 1 ))</pre><pre class="source-code">
  network_address=$(echo $network | awk -F'.' '{print $1"."$2"."$3"."0}')</pre><pre class="source-code">
  for host in $(seq 1 254); do</pre><pre class="source-code">
    ip=$(echo $network_address | awk -F'.' '{print $1"."$2"."$3"."'$host'}')</pre><pre class="source-code">
    ping -c1 -W1 $ip &gt; /dev/null</pre><pre class="source-code">
    if [ $? -eq 0 ]; then</pre><pre class="source-code">
      echo "$ip is up"</pre><pre class="source-code">
    fi</pre><pre class="source-code">
  done</pre><pre class="source-code">
else</pre><pre class="source-code">
  echo "Invalid subnet mask"</pre><pre class="source-code">
fi</pre></li>
			</ol>
			<p>When the preceding code executes, it will prompt the user to enter the network ID and subnet mask <a id="_idIndexMarker757"/>of the targeted network. It will calculate the <a id="_idIndexMarker758"/>range of host IP addresses and send one ICMP ECHO Request message to each host <span class="No-Break">IP address.</span></p>
			<ol>
				<li value="4">To save the file, press the <em class="italic">Ctrl</em> + <em class="italic">X</em> keys, then press <em class="italic">Y</em>, and hit <em class="italic">Enter</em> to confirm <span class="No-Break">and exit.</span></li>
				<li>Next, add execution privileges to the <span class="No-Break"><strong class="source-inline">ping-sweep.sh</strong></span><span class="No-Break"> file:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo chmod +x ping-sweep.sh</strong></pre></li>
				<li>Next, use the following commands to execute <span class="No-Break">the script:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">./ping-sweep.sh</strong></pre></li>
			</ol>
			<p>The following snippet shows that the script has prompted the user input of the network ID and subnet mask, and then it proceeds to check whether the hosts <span class="No-Break">are online:</span></p>
			<div>
				<div id="_idContainer274" class="IMG---Figure">
					<img src="image/Figure_7.11_B19448.jpg" alt="Figure 7.11 – A ping sweep"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.11 – A ping sweep</p>
			<p>As shown in the following <a id="_idIndexMarker759"/>screenshot, the Ping utility and the preceding script used <a id="_idIndexMarker760"/>the ICMP network protocol to perform the ping sweep across the <span class="No-Break"><strong class="source-inline">172.30.1.0/24</strong></span><span class="No-Break"> network:</span></p>
			<div>
				<div id="_idContainer275" class="IMG---Figure">
					<img src="image/Figure_7.12_B19448.jpg" alt="Figure 7.12 – Wireshark packet capture"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.12 – Wireshark packet capture</p>
			<p>While the preceding method seems efficient for discovering live hosts on a network, system administrators and security professionals often disable ICMP responses from critical assets, such as servers and firewalls, to reduce the likelihood of a novice hacker identifying these systems. In addition, sending too many ICMP messages on a network can generate a lot of <em class="italic">noise</em>,<em class="italic"> </em>which <a id="_idIndexMarker761"/>will increase the detection level of the<a id="_idIndexMarker762"/> ethical hacker on the network. Next, you will learn how to automate and improve your scanning techniques while reducing the detection level, using a powerful <span class="No-Break">network scanner.</span></p>
			<h2 id="_idParaDest-120"><a id="_idTextAnchor119"/>Host discovery with Nmap</h2>
			<p><strong class="bold">Network Mapper</strong> (<strong class="bold">Nmap</strong>) is a powerful network scanning tool with lots of <a id="_idIndexMarker763"/>advanced capabilities to help ethical hackers and penetration testers to <a id="_idIndexMarker764"/>efficiently profile their targets. Nmap enables ethical hackers to discover live hosts and identify open <strong class="bold">Transmission Control Protocol</strong> (<strong class="bold">TCP</strong>) and <strong class="bold">User Datagram Protocol</strong> (<strong class="bold">UDP</strong>) ports, running services <a id="_idIndexMarker765"/>and their versions, and the operating system of <span class="No-Break">a target.</span></p>
			<p>To get started <a id="_idIndexMarker766"/>with using Nmap for host discovery, follow <a id="_idIndexMarker767"/><span class="No-Break">these steps:</span></p>
			<ol>
				<li>Firstly, power on both the <strong class="bold">Kali Linux</strong> and <strong class="bold">Metasploitable 3</strong> virtual machines. As always, the attacker machine will be Kali Linux and the target will be <span class="No-Break">Metasploitable 3.</span></li>
				<li>On <strong class="bold">Kali Linux</strong>, open the Terminal and use either the <strong class="source-inline">ip address</strong> or <strong class="source-inline">ifconfig</strong> command to identify the IP address that’s assigned to the <strong class="source-inline">eth1</strong> interface, which is connected to the <strong class="source-inline">172.30.1.0/24</strong> <span class="No-Break">network (</span><span class="No-Break"><em class="italic">PentestNet</em></span><span class="No-Break">).</span></li>
			</ol>
			<p>If important to identify the IP address of your attacker machine (Kali Linux) so that you do not scan your own device during security assessments; otherwise, you’ll need to remove its details from <span class="No-Break">the results.</span></p>
			<ol>
				<li value="3">Next, perform a ping sweep on the entire <strong class="source-inline">172.30.1.0/24</strong> network while excluding the IP address of the Kali Linux machine, using the <span class="No-Break">following commands:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">nmap -sn 172.30.1.0/24 --exclude 172.30.1.49</strong></pre></li>
			</ol>
			<p>As shown in the following snippet, the <strong class="source-inline">-sn</strong> syntax specifies performing a ping scan on the target, while <strong class="source-inline">--exclude</strong> allows us to exclude a host, a range of addresses, or a network during <span class="No-Break">the scan:</span></p>
			<div>
				<div id="_idContainer276" class="IMG---Figure">
					<img src="image/Figure_7.13_B19448.jpg" alt="Figure 7.13 – A ping scan using Nmap"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.13 – A ping scan using Nmap</p>
			<p>As shown in the preceding snippet, the ping scan was able to identify that the <strong class="source-inline">172.30.1.45</strong> host <span class="No-Break">is online.</span></p>
			<p>Nmap does <a id="_idIndexMarker768"/>not send typical ICMP <a id="_idIndexMarker769"/>messages during a ping scan to a target. If the targeted device is configured not to respond to ICMP messages, then a typical ping sweep will fail to identify the status of the host on the network. Instead, Nmap sends specially crafted TCP <strong class="bold">Synchronization</strong> (<strong class="bold">SYN</strong>) packets to the targeted host, with the intention of triggering a TCP <strong class="bold">Acknowledgement</strong> (<strong class="bold">ACK</strong>) as a response from a <span class="No-Break">live/online host.</span></p>
			<p>The following snippet shows a packet capture within Wireshark of the Nmap <span class="No-Break">ping scan:</span></p>
			<div>
				<div id="_idContainer277" class="IMG---Figure">
					<img src="image/Figure_7.14_B19448.jpg" alt="Figure 7.14 – Wireshark packet capture"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.14 – Wireshark packet capture</p>
			<p>As shown in the preceding snippet, Kali Linux (<strong class="source-inline">172.30.1.49</strong>) sent a <strong class="bold">TCP SYN</strong> message to the target (<strong class="source-inline">172.30.1.45</strong>) on service port <strong class="source-inline">443</strong> (HTTPS), and the target responded with a <strong class="bold">TCP ACK/RST</strong> packet to acknowledge and reset the connection. This response indicates that port <strong class="source-inline">443</strong> is open and the target is live. While devices may be configured to not respond to ICMP messages, TCP/IP is designed to respond to <strong class="bold">TCP SYN</strong> packets on an open service port, and Nmap uses this technique to better determine whether a target is online <span class="No-Break">or not.</span></p>
			<p class="callout-heading">Tip</p>
			<p class="callout">To learn more about how TCP establishes a connection with a three-way handshake, please <span class="No-Break">see </span><a href="https://hub.packtpub.com/understanding-network-port-numbers-tcp-udp-and-icmp-on-an-operating-system/"><span class="No-Break">https://hub.packtpub.com/understanding-network-port-numbers-tcp-udp-and-icmp-on-an-operating-system/</span></a><span class="No-Break">.</span></p>
			<ol>
				<li value="4">Next, perform a <a id="_idIndexMarker770"/>port scan to identify <a id="_idIndexMarker771"/>the top 1,000 service ports that are open on <span class="No-Break">Metasploitable 3:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">nmap 172.30.1.45</strong></pre></li>
			</ol>
			<p>As shown in the following snippet, Nmap was able to identify the top 1,000 service ports that opened on the target and determined <span class="No-Break">their service:</span></p>
			<div>
				<div id="_idContainer278" class="IMG---Figure">
					<img src="image/Figure_7.15_B19448.jpg" alt="Figure 7.15 – Identifying the top 1,000 service ports"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.15 – Identifying the top 1,000 service ports</p>
			<p>As shown in the preceding snippet, Nmap helps us to better identify which ports are open and the <a id="_idIndexMarker772"/>associated services <a id="_idIndexMarker773"/>for each open port. Such information can be leveraged to identify the role, function, and the attack surface of a targeted device on a network. For instance, the preceding snippet shows that port <strong class="source-inline">22</strong> is open and running <strong class="bold">Secure Shell</strong> (<strong class="bold">SSH</strong>), a remote access service that <a id="_idIndexMarker774"/>can be compromised by an ethical hacker to gain a foothold into a system. It’s important to research the services for each open port to identify security vulnerabilities and how a real attacker can compromise <span class="No-Break">the target.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">By default, Nmap scans TCP <span class="No-Break">ports only.</span></p>
			<ol>
				<li value="5">Next, use the <strong class="source-inline">-p-</strong> syntax to specify all 65,535 ports and the <strong class="source-inline">-T4</strong> syntax to increase the scanning speed, as <span class="No-Break">shown here:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">nmap -T4 -p- 172.30.1.45</strong></pre></li>
			</ol>
			<p>The following snippet shows that Nmap has identified additional open service ports on the <span class="No-Break">target system:</span></p>
			<div>
				<div id="_idContainer279" class="IMG---Figure">
					<img src="image/Figure_7.16_B19448.jpg" alt="Figure 7.16 – Scanning all ports"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.16 – Scanning all ports</p>
			<p>As an ethical hacker, it’s important to scan all service ports on a targeted device to identify <a id="_idIndexMarker775"/>whether there are additional <a id="_idIndexMarker776"/>running services and determine whether they are vulnerable to cyber-attacks and threats. In addition, if your goal is to gain a foothold into the targeted system, you may be able to exploit a security vulnerability found on a <span class="No-Break">running service.</span></p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Nmap can scan a range of host addresses on a network by using the <strong class="source-inline">nmap 172.30.1.10-100</strong> syntax. Additionally, you can scan the selected host by using the <strong class="source-inline">nmap 172.30.1.10,172.30.1.20,172.30.1.40-50</strong> command. <strong class="source-inline">-T&lt;0-5&gt;</strong> allows you to set the timing template on an Nmap scan; higher is faster. Keep in mind that faster scans increase the amount of noise generated on a network and can raise the suspicions of the <span class="No-Break">security team.</span></p>
			<ol>
				<li value="6">By default, Nmap performs a ping scan on a targeted host to determine whether it’s online, and then it proceeds to scan. However, if the targeted host is configured to <a id="_idIndexMarker777"/>block ping probes from Nmap, we <a id="_idIndexMarker778"/>can perform a scan without pinging the target with the <span class="No-Break">following commands:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">nmap -PN 172.30.1.45</strong></pre></li>
			</ol>
			<p>The following snippet shows the execution of the <span class="No-Break">preceding commands:</span></p>
			<div>
				<div id="_idContainer280" class="IMG---Figure">
					<img src="image/Figure_7.17_B19448.jpg" alt="Figure 7.17 – Don’t ping scan"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.17 – Don’t ping scan</p>
			<ol>
				<li>To scan the top 1,000 UDP service ports on a targeted system, use the <span class="No-Break">following command:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo nmap -sU 172.30.1.45</strong></pre></li>
			</ol>
			<p>The following snippet shows Nmap was able to identify open UDP ports on <span class="No-Break">the target:</span></p>
			<div>
				<div id="_idContainer281" class="IMG---Figure">
					<img src="image/Figure_7.18_B19448.jpg" alt="Figure 7.18 – UDP port scanning"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.18 – UDP port scanning</p>
			<p>Since Nmap scans the top 1,000 ports by default, you can use the <strong class="source-inline">nmap -sU -p- 172.30.1.45</strong> command to scan all 65,535 UDP ports on the target. Additionally, you <a id="_idIndexMarker779"/>can use the <strong class="source-inline">-p</strong> syntax to <a id="_idIndexMarker780"/>specify a specific port or a range of ports – for instance, <strong class="source-inline">-p22</strong> and <strong class="source-inline">-p1-65535</strong>. The <strong class="source-inline">–U</strong> syntax allows you to specify a UDP port scan with the <strong class="source-inline">-p </strong><span class="No-Break"><strong class="source-inline">U:53</strong></span><span class="No-Break"> syntax.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Filtered ports indicate whether there’s a firewall or another security mechanism that’s blocking the port, and Nmap is unable to determine whether the port is open or closed on <span class="No-Break">the target.</span></p>
			<ol>
				<li value="2">To identify the service versions of running services on a targeted device, use the <span class="No-Break">following commands:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo nmap -sV 172.30.1.45</strong></pre></li>
			</ol>
			<p>The following snippet shows Nmap was able to identify the service versions of each <span class="No-Break">running service:</span></p>
			<div>
				<div id="_idContainer282" class="IMG---Figure">
					<img src="image/Figure_7.19_B19448.jpg" alt="Figure 7.19 – Identifying the service versions"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.19 – Identifying the service versions</p>
			<p>Identifying the service versions helps us to determine whether the running application or service is outdated, and whether there are any known security vulnerabilities <a id="_idIndexMarker781"/>that can be exploited to <a id="_idIndexMarker782"/>gain authorized access. If you recall, one of the reasons to perform reconnaissance is to determine the attack surface of a target, such as discovering security vulnerabilities and points <span class="No-Break">of entry.</span></p>
			<ol>
				<li value="3">To perform operating system detection on a targeted host, use the <strong class="source-inline">-O</strong> syntax, as <span class="No-Break">shown here:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo nmap -O 172.30.1.45</strong></pre></li>
			</ol>
			<p>The following snippet shows Nmap was able to identify the target host as running Microsoft Windows 7, 8, or <span class="No-Break">Server 2008:</span></p>
			<div>
				<div id="_idContainer283" class="IMG---Figure">
					<img src="image/Figure_7.20_B19448.jpg" alt="Figure 7.20 – Identifying the operating system"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.20 – Identifying the operating system</p>
			<p>As shown in the preceding snippet, identifying the operating system architecture and build number helps us to better plan future attacks during ethical hacking and penetration testing. For instance, you can research known security vulnerabilities and develop and test exploits for this specific operating system version, before preceding to the <span class="No-Break">exploitation phase.</span></p>
			<ol>
				<li value="4">Lastly, Nmap enables <a id="_idIndexMarker783"/>us to perform <a id="_idIndexMarker784"/>operating system detection, service version detection, script scanning, and traceroute by using the <strong class="source-inline">-A</strong> syntax, as <span class="No-Break">shown here:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo nmap -A 172.30.1.45</strong></pre></li>
			</ol>
			<p>As shown in the following snippet, the <strong class="source-inline">-A</strong> syntax enables Nmap to perform multiple types of scanning techniques at the <span class="No-Break">same time:</span></p>
			<div>
				<div id="_idContainer284" class="IMG---Figure">
					<img src="image/Figure_7.21_B19448.jpg" alt="Figure 7.21 – Multiple scans"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.21 – Multiple scans</p>
			<p>As shown in the preceding snippet, the <strong class="source-inline">-A</strong> syntax further enables Nmap to perform banner grabbing on each running service. Banner grabbing enables us to collect additional information about a service, such as the header details of a Microsoft <span class="No-Break">IIS service.</span></p>
			<p>In addition, the following is the remaining portion of the scan, which shows the SMB version, operating system version, computer name/hostname, and workgroup <span class="No-Break">or domain:</span></p>
			<div>
				<div id="_idContainer285" class="IMG---Figure">
					<img src="image/Figure_7.22_B19448.jpg" alt="Figure 7.22 – OS and SMB detection"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.22 – OS and SMB detection</p>
			<p>As you can see, Nmap is a powerful network scanning tool, with many features and capabilities to help <a id="_idIndexMarker785"/>ethical hackers and penetration <a id="_idIndexMarker786"/>testers collect sensitive information during active reconnaissance of <span class="No-Break">their targets.</span></p>
			<p class="callout-heading">Tip</p>
			<p class="callout">To learn <a id="_idIndexMarker787"/>more about Nmap and its scanning capabilities, please see <a href="https://nmap.org/book/man.html">https://nmap.org/book/man.html</a>. In addition, you can use the <strong class="source-inline">man nmap</strong> command on the Terminal to view the Nmap <span class="No-Break">manual page.</span></p>
			<p>Having completed this section, you have learned how to perform host discovery in active reconnaissance. In the next section, you will learn how to perform evasion techniques during <span class="No-Break">network scanning.</span></p>
			<h1 id="_idParaDest-121"><a id="_idTextAnchor120"/>Using evasion techniques</h1>
			<p>When a device such as a computer sends a packet to a network, the sender’s IP and MAC addresses <a id="_idIndexMarker788"/>are inserted into the packet header. As such, when ethical hackers perform host discovery on a network, their IP and MAC addresses are also included within each packet from their machine to the targeted hosts. Ethical hackers and penetration testers always try to remain undetected during security assessments, as part of simulating real-world cyberattacks on an organization’s <span class="No-Break">network infrastructure.</span></p>
			<p>There are various evasion techniques that can be used during host discovery to reduce the risk of being detected and traced by threat detection systems and the security team of a target. To get started, please use the <span class="No-Break">following instructions:</span></p>
			<ol>
				<li value="1">Power on both the <strong class="bold">Kali Linux</strong> and <strong class="bold">Metasploitable 3</strong> virtual machines. Ensure you’re logged in to <span class="No-Break">Kali Linux.</span></li>
				<li>Ensure you identify the IP address of Metasploitable 3, as this virtual machine will be the target of <span class="No-Break">this exercise.</span></li>
				<li>Nmap enables us to perform a scan using decoys to trick the target into thinking the source of the scan originates from different sources, rather than a single device. The <strong class="source-inline">-D</strong> syntax allows you to specify any number of decoy addresses, as <span class="No-Break">shown here:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">nmap 172.30.1.45 -D 172.30.1.20, 172.30.1.21,172.30.1.22</strong></pre></li>
			</ol>
			<p>Before Nmap performs the scan on the target, it checks each decoy address on the network to ensure that these systems are online. If a decoy address is not reachable by Nmap, it will be excluded from the scan. Therefore, I recommend performing a status check on the decoy systems before performing <span class="No-Break">a scan.</span></p>
			<ol>
				<li value="4">Nmap enables you to automatically spoof your MAC address when scanning a target by using the <strong class="source-inline">--spoof-mac</strong> syntax, as <span class="No-Break">shown here:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo nmap -sT -PN --spoof-mac 0 172.30.1.45</strong></pre></li>
			</ol>
			<p>The <strong class="source-inline">-ST</strong> syntax specifies performing a <strong class="bold">TCP Connect</strong> scan by establishing the TCP three-way handshake, <strong class="source-inline">-PN</strong> specifies not pinging the host, and <strong class="source-inline">--spoof-mac 0</strong> indicates spoofing a random MAC address. The following snippet shows the <a id="_idIndexMarker789"/>random spoof MAC address during <span class="No-Break">the scan:</span></p>
			<div>
				<div id="_idContainer286" class="IMG---Figure">
					<img src="image/Figure_7.23_B19448.jpg" alt="Figure 7.23 – Spoofing the random MAC address"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.23 – Spoofing the random MAC address</p>
			<ol>
				<li value="5">If you want to spoof a specific vendor’s MAC address, Nmap allows you to insert the vendor’s name, as shown in the <span class="No-Break">following command:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo nmap -sT -PN --spoof-mac dell 172.30.1.45</strong></pre></li>
			</ol>
			<p>The following snippet shows that Nmap uses a spoof MAC address <span class="No-Break">from Dell:</span></p>
			<div>
				<div id="_idContainer287" class="IMG---Figure">
					<img src="image/Figure_7.24_B19448.jpg" alt="Figure 7.24 – Spoofing the vendor address"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.24 – Spoofing the vendor address</p>
			<ol>
				<li value="6">If there’s a specific <a id="_idIndexMarker790"/>MAC address you want to spoof, it can be included, as shown in the <span class="No-Break">following command:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo nmap -sT -PN --spoof-mac 12:34:56:78:9A:BC 172.30.1.45</strong></pre></li>
			</ol>
			<p>The following snippet shows that the custom MAC address was used as the spoof address during the <span class="No-Break">Nmap scan:</span></p>
			<div>
				<div id="_idContainer288" class="IMG---Figure">
					<img src="image/Figure_7.25_B19448.jpg" alt="Figure 7.25 – Using a specific spoof address"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.25 – Using a specific spoof address</p>
			<ol>
				<li value="7">Lastly, Nmap provides the capability to send probes as smaller fragments on the network to reduce detection by network security systems. The following command is <span class="No-Break">an example:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo nmap -f 172.30.1.45</strong></pre></li>
			</ol>
			<p>The following snippet <a id="_idIndexMarker791"/>shows a Wireshark capture of Kali Linux (<strong class="source-inline">172.30.1.44</strong>) sending multiple fragmented IP packets of 42 bytes to Metasploitable <span class="No-Break">3 (</span><span class="No-Break"><strong class="source-inline">172.30.1.45</strong></span><span class="No-Break">):</span></p>
			<div>
				<div id="_idContainer289" class="IMG---Figure">
					<img src="image/Figure_7.26_B19448.jpg" alt="Figure 7.26 – Fragmenting packets"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.26 – Fragmenting packets</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Using the <strong class="source-inline">-sS</strong> syntax enables Nmap to <a id="_idIndexMarker792"/>perform a <strong class="bold">stealth scan</strong> (sometimes referred to as a <em class="italic">half-open scan</em>) on a target. The stealth scan does not establish a full TCP three-way handshake with the target. However, the Nmap stealth scan can be easily detected by seasoned cybersecurity professionals. To learn more about the Nmap stealth scan, please <span class="No-Break">see </span><a href="https://nmap.org/book/synscan.html"><span class="No-Break">https://nmap.org/book/synscan.html</span></a><span class="No-Break">.</span></p>
			<p>As you learned in this section, there are various techniques that are used by ethical hackers to evade detection during host discovery. In the next section, you will explore various <span class="No-Break">enumeration techniques.</span></p>
			<h1 id="_idParaDest-122"><a id="_idTextAnchor121"/>Enumerating network services</h1>
			<p>During the host discovery phase of ethical hacking, many open ports and running services can be <a id="_idIndexMarker793"/>found. The information collected during the host discovery phase is used to perform additional research to find known security vulnerabilities within those running services and how they can be exploited to gain unauthorized access to a target. Enumerating network services on targeted systems helps ethical hackers and penetration testers to better understand the target’s network infrastructure and attack surfaces and which attack vectors can be used to deliver a payload to <span class="No-Break">the target.</span></p>
			<h2 id="_idParaDest-123"><a id="_idTextAnchor122"/>NetBIOS and SMB enumeration</h2>
			<p><strong class="bold">Network Basic Input/Output System</strong> (<strong class="bold">NetBIOS</strong>) is an old legacy network protocol that’s commonly <a id="_idIndexMarker794"/>used within Windows-based <a id="_idIndexMarker795"/>environments for file and print sharing, and name resolution services on a <strong class="bold">Local Area Network</strong> (<strong class="bold">LAN</strong>). SMB is a newer network protocol that’s also used within Windows-based environments for file and print-sharing services. As <a id="_idIndexMarker796"/>an ethical hacker, performing NetBIOS and SMB enumeration helps you identify which systems on a network have network shares. A misconfigured system enables an ethical hacker to access sensitive directories and files over <span class="No-Break">a network.</span></p>
			<p>To get started with NetBIOS and SMB enumeration, please use the <span class="No-Break">following instruction:</span></p>
			<ol>
				<li>Firstly, power <a id="_idIndexMarker797"/>on the <strong class="bold">Kali Linux</strong> and <strong class="bold">Metasploitable 3</strong> virtual <a id="_idIndexMarker798"/>machines. Kali Linux will be the attacker machine and Metasploitable 3 will operate as <span class="No-Break">the target.</span></li>
				<li>Next, use <strong class="source-inline">nbtscan</strong> to retrieve the NetBIOS name and MAC address of <span class="No-Break">Metasploitable 3:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">nbtscan -r 172.30.1.45</strong></pre></li>
			</ol>
			<p>The <strong class="source-inline">-r</strong> syntax is used to specify a remote host on the network, as shown in the <span class="No-Break">following snippet:</span></p>
			<div>
				<div id="_idContainer290" class="IMG---Figure">
					<img src="image/Figure_7.27_B19448.jpg" alt="Figure 7.27 – A NetBIOS scan"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.27 – A NetBIOS scan</p>
			<p>If there are any logged-in users on the target, their usernames will appear within the <span class="No-Break"><strong class="source-inline">User</strong></span><span class="No-Break"> field.</span></p>
			<ol>
				<li value="3">Next, use <strong class="bold">Nmap</strong> to identify whether SMB runs the Metasploitable 3 by scanning port <strong class="source-inline">445</strong>, using the <span class="No-Break">following commands:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">nmap -A -T4 -Pn -n -p 445 172.30.1.45</strong></pre></li>
			</ol>
			<p>As shown in <a id="_idIndexMarker799"/>the following snippet, port <strong class="source-inline">445</strong> is open, and Nmap <a id="_idIndexMarker800"/>was able to profile the host <span class="No-Break">operating system:</span></p>
			<div>
				<div id="_idContainer291" class="IMG---Figure">
					<img src="image/Figure_7.28_B19448.jpg" alt="Figure 7.28 – Identifying SMB on a target"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.28 – Identifying SMB on a target</p>
			<ol>
				<li value="4">Next, use Nmap to perform a NetBIOS scan of Metasploitable 3 with the <span class="No-Break">following command:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo nmap -sV --script nbstat.nse 172.30.1.45</strong></pre></li>
			</ol>
			<p>As shown in the following snippet, Nmap was able to verify the operating system of <span class="No-Break">the host:</span></p>
			<div>
				<div id="_idContainer292" class="IMG---Figure">
					<img src="image/Figure_7.29_B19448.jpg" alt="Figure 7.29 – Identifying the target operating system"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.29 – Identifying the target operating system</p>
			<ol>
				<li value="5">Since SMB is found <a id="_idIndexMarker801"/>running on Metasploitable 3, use the <strong class="source-inline">smbclient</strong> tool to enumerate network scans on the target; <strong class="source-inline">-U</strong> specifies <a id="_idIndexMarker802"/><span class="No-Break">the username:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">smbclient -L //172.30.1.45 -U vagrant</strong></pre></li>
			</ol>
			<p>When prompted for a password, use <strong class="source-inline">vagrant</strong> to allow <strong class="source-inline">smbclient</strong> to enumerate the shares, as <span class="No-Break">shown here:</span></p>
			<div>
				<div id="_idContainer293" class="IMG---Figure">
					<img src="image/Figure_7.30_B19448.jpg" alt="Figure 7.30 – Network shares"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.30 – Network shares</p>
			<p>As shown in the preceding snippet, there are multiple network shares on <span class="No-Break">the target.</span></p>
			<p class="callout-heading">Tip</p>
			<p class="callout">To access a network share, use the <strong class="source-inline">smbclient -L //172.30.1.45/sharename -U vagrant</strong> command. Ensure you adjust the IP address, share name, and username accordingly for <span class="No-Break">your target.</span></p>
			<ol>
				<li value="6">Next, use the <strong class="source-inline">smbmap</strong> tool to identify the permissions on each <span class="No-Break">network share:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">smbmap -H 172.30.1.45 -u vagrant -p vagrant</strong></pre></li>
			</ol>
			<p>The <strong class="source-inline">-u</strong> and <strong class="source-inline">-p</strong> syntax <a id="_idIndexMarker803"/>allows us to specify the username and password <a id="_idIndexMarker804"/>to access the target, as <span class="No-Break">shown here:</span></p>
			<div>
				<div id="_idContainer294" class="IMG---Figure">
					<img src="image/Figure_7.31_B19448.jpg" alt="Figure 7.31 – Share permissions"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.31 – Share permissions</p>
			<p>As shown in the preceding snippet, some shares enable network users to both read and write to the directory. Access to sensitive directories is useful during ethical hacking and <span class="No-Break">penetration testing.</span></p>
			<ol>
				<li value="7">Next, use the following commands to perform SMB enumeration of shares <span class="No-Break">with Nmap:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo nmap -p139,445 --script=smb-enum-shares.nse 172.30.1.45</strong></pre></li>
			</ol>
			<p>The following snippet shows that Nmap attempted to find and enumerate shares on <span class="No-Break">the target:</span></p>
			<div>
				<div id="_idContainer295" class="IMG---Figure">
					<img src="image/Figure_7.32_B19448.jpg" alt="Figure 7.32 – Nmap SMB enumeration script"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.32 – Nmap SMB enumeration script</p>
			<ol>
				<li value="8">Lastly, we can <a id="_idIndexMarker805"/>use Nmap to identify SMB vulnerabilities <a id="_idIndexMarker806"/>on a target using the <span class="No-Break">following commands:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo nmap -p139,445 --script=smb-vuln-* 172.30.1.45</strong></pre></li>
			</ol>
			<p>As shown in the following snippet, Nmap was able to identify a security vulnerability on the target system and provide us with <span class="No-Break">reference information:</span></p>
			<div>
				<div id="_idContainer296" class="IMG---Figure">
					<img src="image/Figure_7.33_B19448.jpg" alt="Figure 7.33 – SMB vulnerability discovery"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.33 – SMB vulnerability discovery</p>
			<p>Having completed this section, <a id="_idIndexMarker807"/>you have learned how to use various tools and techniques<a id="_idIndexMarker808"/> to perform service enumeration. In the next section, you will learn how to perform <span class="No-Break">wireless reconnaissance.</span></p>
			<h1 id="_idParaDest-124"><a id="_idTextAnchor123"/>Wireless reconnaissance</h1>
			<p>Wireless reconnaissance enables ethical hackers and penetration testers to identify their target’s wireless <a id="_idIndexMarker809"/>network and determine associated clients, network settings, operating frequencies and channels, and the approximate distance between you and the <span class="No-Break">access point.</span></p>
			<p>When an access point is powered on, it sends <strong class="bold">beacons</strong> to advertise its presence and network information to nearby wireless clients. Within these beacons, the access point inserts the network name or <strong class="bold">Service Set Identifier</strong> (<strong class="bold">SSID</strong>), which helps clients to identify one wireless <a id="_idIndexMarker810"/>network from the other. Once a client is connected (associated) with a wireless network, it automatically saves the network information and password within its <strong class="bold">Preferred Network List</strong> (<strong class="bold">PNL</strong>). From then on, when wireless <a id="_idIndexMarker811"/>capabilities are enabled on the client, it will send <strong class="bold">probes</strong> to seek any of the saved networks from the PNL; once a network is found and within range, the client will attempt to automatically establish an association. As an ethical hacker, capturing and analyzing beacons and probes from wireless networks and clients helps us to identify whether the targeted wireless network is vulnerable <a id="_idIndexMarker812"/>to <span class="No-Break">wireless-based attacks.</span></p>
			<p class="callout-heading">Tip</p>
			<p class="callout">You can use <strong class="bold">Wigle.net</strong> to find wireless networks around the world. The website also allows users to upload Kismet data and helps ethical hackers to locate their <span class="No-Break">target networks.</span></p>
			<p>To get started with wireless reconnaissance, follow the <span class="No-Break">following instructions.</span></p>
			<h2 id="_idParaDest-125"><a id="_idTextAnchor124"/>Part 1 – attaching a wireless network adapter</h2>
			<p>To attach a wireless <a id="_idIndexMarker813"/>network adapter, follow <span class="No-Break">these steps.</span></p>
			<ol>
				<li>Connect the Alfa AWUS036NHA – Wireless B/G/N USB adapter to your <span class="No-Break">host computer.</span></li>
				<li>Next, open <strong class="bold">VirtualBox Manager</strong>, select the <strong class="bold">Kali Linux</strong> virtual machine, and click on <strong class="bold">Settings</strong>, as <span class="No-Break">shown here:</span></li>
			</ol>
			<div>
				<div id="_idContainer297" class="IMG---Figure">
					<img src="image/Figure_7.34_B19448.jpg" alt="Figure 7.34 – VirtualBox Manager"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.34 – VirtualBox Manager</p>
			<ol>
				<li value="3">Next, select the <strong class="bold">USB</strong> category from the left menu, and then select either the USB 2.0 or 3.0 controller, depending on your USB interface types on your host computer, and click on the <strong class="bold">Add USB device</strong> icon, as <span class="No-Break">shown here:</span></li>
			</ol>
			<div>
				<div id="_idContainer298" class="IMG---Figure">
					<img src="image/Figure_7.35_B19448.jpg" alt="Figure 7.35 – The Settings menu"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.35 – The Settings menu</p>
			<ol>
				<li value="4">After clicking <a id="_idIndexMarker814"/>on the <strong class="bold">Add USB device</strong> icon, a side menu will appear, displaying all your connected USB devices. Select the wireless network adapter, as <span class="No-Break">shown here:</span></li>
			</ol>
			<div>
				<div id="_idContainer299" class="IMG---Figure">
					<img src="image/Figure_7.36_B19448.jpg" alt="Figure 7.36 – Selecting the wireless network adapter"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.36 – Selecting the wireless network adapter</p>
			<ol>
				<li value="5">Next, you will <a id="_idIndexMarker815"/>automatically return to the main <strong class="bold">Settings</strong> menu. Click on <strong class="bold">OK</strong> <span class="No-Break">to save:</span></li>
			</ol>
			<div>
				<div id="_idContainer300" class="IMG---Figure">
					<img src="image/Figure_7.37_B19448.jpg" alt="Figure 7.37 – The wireless network adapter"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.37 – The wireless network adapter</p>
			<p>As shown in the preceding snippet, the wireless network adapter is now connected to the Kali Linux virtual machine as a <span class="No-Break">USB device.</span></p>
			<h2 id="_idParaDest-126"><a id="_idTextAnchor125"/>Part 2 – enabling monitor mode</h2>
			<p>To enable <a id="_idIndexMarker816"/>monitor mode, follow <span class="No-Break">these steps:</span></p>
			<ol>
				<li>Power on the <strong class="bold">Kali Linux</strong> virtual machine and <span class="No-Break">log in.</span></li>
				<li>Next, open the Terminal and use the <strong class="source-inline">iwconfig</strong> command to identify the wireless network adapter, as <span class="No-Break">shown here:</span></li>
			</ol>
			<div>
				<div id="_idContainer301" class="IMG---Figure">
					<img src="image/Figure_7.38_B19448.jpg" alt="Figure 7.38 – Verifying the network adapter"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.38 – Verifying the network adapter</p>
			<p>As shown in the preceding snippet, the wireless network adapter is displayed as the <span class="No-Break"><strong class="source-inline">wlan0</strong></span><span class="No-Break"> interface.</span></p>
			<ol>
				<li value="3">Next, use the <strong class="source-inline">sudo airmon-ng check kill</strong> command to terminate any conflicting processes that may prevent changing the <strong class="source-inline">wlan0</strong> interface to <span class="No-Break">monitor mode:</span></li>
			</ol>
			<div>
				<div id="_idContainer302" class="IMG---Figure">
					<img src="image/Figure_7.39_B19448.jpg" alt="Figure 7.39 – Killing processes"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.39 – Killing processes</p>
			<ol>
				<li value="4">Next, use <a id="_idIndexMarker817"/>the <strong class="source-inline">sudo airmon-ng start wlan0</strong> command to enable monitor mode on the <span class="No-Break"><strong class="source-inline">wlan0</strong></span><span class="No-Break"> interface:</span></li>
			</ol>
			<div>
				<div id="_idContainer303" class="IMG---Figure">
					<img src="image/Figure_7.40_B19448.jpg" alt="Figure 7.40 – Enabling monitor mode"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.40 – Enabling monitor mode</p>
			<ol>
				<li value="5">Next, use the <strong class="source-inline">iwconfig</strong> command to verify the new interface. <strong class="source-inline">wlan0mon</strong> is created and available on Kali Linux, as <span class="No-Break">shown here:</span></li>
			</ol>
			<div>
				<div id="_idContainer304" class="IMG---Figure">
					<img src="image/Figure_7.41_B19448.jpg" alt="Figure 7.41 – Verifying the interface status"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.41 – Verifying the interface status</p>
			<p>As shown in the <a id="_idIndexMarker818"/>preceding snippet, <strong class="source-inline">wlan0mon</strong> operates in monitor mode, which enables us to capture beacons and probes on <span class="No-Break">wireless networks.</span></p>
			<h2 id="_idParaDest-127"><a id="_idTextAnchor126"/>Part 3 – performing wireless reconnaissance</h2>
			<p>To perform wireless reconnaissance, follow <a id="_idIndexMarker819"/><span class="No-Break">these steps:</span></p>
			<ol>
				<li>Use the <strong class="bold">Airodump-ng</strong> tool to monitor (capture and analyze) nearly all the beacons and probes by using the <span class="No-Break">following commands:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo airodump-ng wlan0mon</strong></pre></li>
			</ol>
			<p>As shown in the following snippet, airodump-ng was able to identify wireless networks, access points, and <span class="No-Break">clients (stations):</span></p>
			<div>
				<div id="_idContainer305" class="IMG---Figure">
					<img src="image/Figure_7.42_B19448.jpg" alt="Figure 7.42 – Wireless networks and clients"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.42 – Wireless networks and clients</p>
			<p>The following is a description of each field shown in the <span class="No-Break">preceding snippet:</span></p>
			<ul>
				<li><strong class="source-inline">BSSID</strong>: This is the <strong class="bold">Basic Service Set Identifier</strong> (<strong class="bold">BSSID</strong>) or the MAC address <a id="_idIndexMarker820"/>of the <span class="No-Break">access point.</span></li>
				<li><strong class="source-inline">PWR</strong>: The power level helps ethical hackers to determine the distance between themselves and an access point or client (station). Lowering the power level <a id="_idIndexMarker821"/>means you are further away from <span class="No-Break">the target.</span></li>
				<li><strong class="source-inline">Beacons</strong>: This field contains the number of beacons that have been sent from <span class="No-Break">access points.</span></li>
				<li><strong class="source-inline">#Data</strong>: This field indicates the amount of captured packets on <span class="No-Break">the network.</span></li>
				<li><strong class="source-inline">#/s</strong>: This field helps us to determine the number of packets over a <span class="No-Break">10-second interval.</span></li>
				<li><strong class="source-inline">CH</strong>: This field indicates the operating channel of the wireless network on the <span class="No-Break">access point.</span></li>
				<li><strong class="source-inline">MB</strong>: This field helps us to determine the maximum speed of the <span class="No-Break">wireless network.</span></li>
				<li><strong class="source-inline">ENC</strong>: This field specifics the wireless security standard for the <span class="No-Break">wireless network.</span></li>
				<li><strong class="source-inline">AUTH</strong>: This field indicates the authentication type or protocol of the <span class="No-Break">wireless network.</span></li>
				<li><strong class="source-inline">ESSID</strong>: This is the <strong class="bold">Extended Service Set Identifier</strong> (<strong class="bold">ESSID</strong>), which is equivalent <a id="_idIndexMarker822"/>to the SSID or <span class="No-Break">network name.</span></li>
				<li><strong class="source-inline">STATION</strong>: This field contains the MAC addresses of nearly wireless clients, either connected or <a id="_idIndexMarker823"/>not connected to a <span class="No-Break">wireless network.</span></li>
				<li><strong class="source-inline">Probes</strong>: This field displays the saved networks from each client from <span class="No-Break">their PNL.</span></li>
			</ul>
			<p>The following snippet shows the station-to-access point associations by observing the <strong class="source-inline">BSSID</strong> and <span class="No-Break"><strong class="source-inline">STATION</strong></span><span class="No-Break"> fields:</span></p>
			<div>
				<div id="_idContainer306" class="IMG---Figure">
					<img src="image/Figure_7.43_B19448.jpg" alt="Figure 7.43 – Identifying the wireless clients"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.43 – Identifying the wireless clients</p>
			<ol>
				<li value="2">If the targeted wireless network operates on a specific channel, use the <strong class="source-inline">-c</strong> syntax to listen on a specific channel, as <span class="No-Break">shown here:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo airodump-ng -c 6 wlan0mon</strong></pre></li>
			</ol>
			<p>As shown in the following snippet, Airodump-ng listens on channel <span class="No-Break"><strong class="source-inline">6</strong></span><span class="No-Break"> only:</span></p>
			<div>
				<div id="_idContainer307" class="IMG---Figure">
					<img src="image/Figure_7.44_B19448.jpg" alt="Figure 7.44 – Listening on a specific channel"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.44 – Listening on a specific channel</p>
			<p>This technique helps ethical hackers to filter out any unwanted output and focus on <span class="No-Break">their target.</span></p>
			<ol>
				<li value="3">To set the focus on <a id="_idIndexMarker824"/>a specific target, the <strong class="source-inline">--essid</strong> syntax can be used to specify a targeted ESSID network name by using the <span class="No-Break">following command:</span><pre class="source-code">
kali@kali:~$ <strong class="bold">sudo airodump-ng -c 6 --essid Corp_Wi-Fi wlan0mon</strong></pre></li>
			</ol>
			<p>As shown in the following snippet, only the <strong class="bold">Corp_Wi-Fi</strong> network and its associated clients <span class="No-Break">are displayed:</span></p>
			<div>
				<div id="_idContainer308" class="IMG---Figure">
					<img src="image/Figure_7.45_B19448.jpg" alt="Figure 7.45 – Filtering the networks"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.45 – Filtering the networks</p>
			<ol>
				<li value="4">Associated stations that transmit data on a wireless network will be displayed under the <strong class="source-inline">STATION</strong> field. However, there may be idle stations that are associated with the target network but not shown <span class="No-Break">on Airodump-ng.</span></li>
			</ol>
			<p>As an ethical hacker, you can perform a dis-association attack on the target network to force all associated clients to disconnect and reconnect. This technique enables us to identify all associated clients for a specific network. To perform this action, open a new Terminal and use <strong class="bold">Aireplay-ng</strong> to send 100 de-authentication wireless frames to <span class="No-Break">the target:</span></p>
			<pre class="source-code">
kali@kali:~$ <strong class="bold">sudo aireplay-ng -0 100 -e Corp_Wi-Fi wlan0mon</strong></pre>
			<p>The following snippet shows aireplay-ng sending the de-authentication attack to <span class="No-Break">the target:</span></p>
			<div>
				<div id="_idContainer309" class="IMG---Figure">
					<img src="image/Figure_7.46_B19448.jpg" alt="Figure 7.46 – The de-authentication attack"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.46 – The de-authentication attack</p>
			<ol>
				<li value="5">Lastly, by <a id="_idIndexMarker825"/>checking the <strong class="bold">Airodump-ng</strong> window, you will see all other associated stations and their PNL, as <span class="No-Break">shown here:</span></li>
			</ol>
			<div>
				<div id="_idContainer310" class="IMG---Figure">
					<img src="image/Figure_7.47_B19448.jpg" alt="Figure 7.47 – Observing stations"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.47 – Observing stations</p>
			<p>Having completed this section, you have learned how to perform active reconnaissance on <span class="No-Break">wireless networks.</span></p>
			<h1 id="_idParaDest-128"><a id="_idTextAnchor127"/>Summary</h1>
			<p>During this chapter, you learned about the importance of active reconnaissance and how it helps ethical hackers to discover live hosts and identify open ports and running services. In addition, you gained the skills to perform reconnaissance on wireless network infrastructure to identify targeted access points and clients, as well as <span class="No-Break">network settings.</span></p>
			<p>I hope this chapter has been informative for you and helpful in your journey in the cybersecurity industry. In the next chapter, <em class="italic">Performing Vulnerability Assessments</em>, you will learn how to set up and work with vulnerability <span class="No-Break">assessment tools.</span></p>
			<h1 id="_idParaDest-129"><a id="_idTextAnchor128"/>Further reading</h1>
			<ul>
				<li>How port numbers <span class="No-Break">work: </span><a href="https://www.techtarget.com/searchnetworking/definition/port-number"><span class="No-Break">https://www.techtarget.com/searchnetworking/definition/port-number</span></a></li>
				<li>TCP three-way <span class="No-Break">handshake: </span><a href="https://www.techopedia.com/definition/10339/three-way-handshake"><span class="No-Break">https://www.techopedia.com/definition/10339/three-way-handshake</span></a></li>
			</ul>
		</div>
	</body></html>