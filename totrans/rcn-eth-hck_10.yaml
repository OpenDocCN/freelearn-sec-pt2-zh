- en: '10'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Implementing Recon Monitoring and Detection Systems
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The longer an organization takes to discover that its network infrastructure
    and systems are compromised, the more time adversaries spend in their network
    compromising additional systems to expand their foothold within the victim’s network.
    Implementing and working with network security tools helps **Security Operation
    Centers** (**SOCs**) and **Digital Forensic and Incident Response** (**DFIR**)
    teams to effectively monitor network traffic, detect potential threats, and provide
    real-time alerts for faster response times, containment, and eradication of threats.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, you will learn the fundamentals of using Wireshark to perform
    packet analysis as an ethical hacker. Additionally, you will learn how to deploy
    and use Security Onion to monitor a network and detect suspicious activities to
    further determine whether it’s a security event or an incident within your organization.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Wireshark for ethical hackers
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Monitoring and detection systems
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let’s dive in!
  prefs: []
  type: TYPE_NORMAL
- en: Technical requirements
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To follow along with the exercises in this chapter, please ensure that you
    have met the following hardware and software requirements:'
  prefs: []
  type: TYPE_NORMAL
- en: Wireshark – [https://www.wireshark.org/](https://www.wireshark.org/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Security Onion – [https://securityonionsolutions.com/](https://securityonionsolutions.com/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: VMware Workstation Pro – [https://www.vmware.com/products/workstation-pro.html](https://www.vmware.com/products/workstation-pro.html)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Wireshark for ethical hackers
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Wireshark is a popular and very powerful network protocol analyzer that’s commonly
    used by both networking and cybersecurity professionals in the industry to identify
    networking issues and threats within an organization’s network. Wireshark enables
    professionals to capture network packets and perform analysis to gain better insights
    into what’s happening in the network by viewing the contents of each packet or
    frame.
  prefs: []
  type: TYPE_NORMAL
- en: As you may know, the **Network Interface Card** (**NIC**) of a sender device
    is responsible for converting data into a signal that can be transported over
    a certain form of media, such as electrical signals for copper wires, light signals
    for fiber optics, and radio frequency for wireless communication. Wireshark can
    capture these signal types and convert them into human-readable language, helping
    us to better analyze network traffic.
  prefs: []
  type: TYPE_NORMAL
- en: 'Wireshark helps ethical hackers to detect security vulnerabilities within network-based
    applications, services, and protocols that can be exploited by threat actors.
    The following are common reasons why ethical hackers use Wireshark during security
    assessments:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Packet sniffing** – Ethical hackers can set up a network implant on the network
    to capture sensitive and confidential data sent over an organization’s network,
    which can be leveraged to perform future operations. In addition, ethical hackers
    can identify whether the organization is using any insecure network protocols
    that transmit messages in plaintext.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Protocol analysis** – Protocol analysis enables ethical hackers to better
    understand the behavior of the network, employees, and devices by observing network
    protocols and identifying services and applications that are running on critical
    systems such as servers. By identifying network protocols, ethical hackers can
    research whether there are any known security vulnerabilities within a protocol
    and how they can be exploited by an adversary.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Malware analysis** – Cybersecurity professionals such as threat hunters and
    incident response teams use Wireshark to identify whether there’s malware on their
    network, the type of malware, and whether it has established a **Command and Control**
    (**C2**) communication channel to an online server.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Exploit development** – An important stage when developing an exploit is
    testing to ensure it’s working as expected and determining its threat level. For
    instance, if a threat actor creates and delivers an exploit that establishes a
    remote connection to the attacker’s machine, the network connection may be detected
    as suspicious activity and blocked by the organization’s security team. Using
    Wireshark helps you better understand what is seen by networking and cybersecurity
    professionals.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Wireshark can be a bit daunting for beginners as it provides a lot of details
    of everything it has captured on the network, and its filters enable you to fully
    leverage the capabilities of this tool to analyze network traffic.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following are Wireshark operators and their descriptions:'
  prefs: []
  type: TYPE_NORMAL
- en: '**==** – This operator enables you to specify an exact match. For instance,
    if you want to filter packets with TCP port **80**, the filter will be **tcp.port
    ==** **80**.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**!=** – This operator means *not equal to* and it’s commonly used to exclude
    something. For instance, if you want to filter traffic that does not include TCP
    port **22**, the filter will be **tcp.port !=** **22**.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**<** or **>** – The *less than* or *greater than* operators are used to specify
    a value either less than or greater than within a packet. For instance, if you
    want to filter TCP packets that are greater than 150 bytes, the filter will be
    **tcp.len >** **150**.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**&&** – The *and* operator is used to combine multiple criteria that are all
    true. For instance, if you want to filter traffic from a specific sender to a
    destination address, the filter will be **(ip.src == 172.16.254.128) && (ip.dst
    ==** **8.8.8.8)**.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**||** – The *or* operator is used to specify multiple criteria where only
    one must be true. For instance, if you want to filter either HTTP (port **80**)
    or HTTPS (port **443**) packets, the filter will be **(tcp.port == 80 ) || (tcp.port
    ==** **443)**.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The following are common Wireshark display filters:'
  prefs: []
  type: TYPE_NORMAL
- en: 'To filter traffic based on a specific device with the **Media Access Control**
    (**MAC**) address **00:0c:29:b6:b5:48**:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'To filter **Address Resolution Protocol** (**ARP**) messages from a device
    with a source MAC address of **00:0c:29:b6:b5:48**:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'To filter traffic based on a specific device with an IP address of **172.16.254.128**:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'To filter ARP messages from a device with the IP address **172.16.254.128**:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'The following common operators to filter traffic types:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**eth** – Filters Ethernet messages'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**ip** – Filters IPv4 packets'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**ipv6** – Filters IPv6 packets'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**icmp** – Filters **Internet Control Message Protocol** (**ICMP**) v4 messages'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**icmpv6** – Filters ICMPv6 messages'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**tcp** – Filters **Transmission Control Protocol** (**TCP**) messages'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**udp** – Filters **User Datagram Protocol** (**UDP**) messages'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**http**, **http2**, and **http3** – Filters HTTP, HTTP/2 and HTTP/3 protocols'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Common application layer protocols such as **Domain Name System** (**DNS**),
    **Simple Mail Transfer Protocol** (**SMTP**), and **Secure Shell** (**SSH**) are
    also filters when written in lowercase letters, such as **dns**, **smtp**, **ssh**,
    and so on.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Tip
  prefs: []
  type: TYPE_NORMAL
- en: To learn more about Wireshark display filters, please see [https://wiki.wireshark.org/DisplayFilters/](https://wiki.wireshark.org/DisplayFilters/).
  prefs: []
  type: TYPE_NORMAL
- en: 'To get started with using Wireshark, please use the following instructions:'
  prefs: []
  type: TYPE_NORMAL
- en: Go to the official Wireshark website at [https://www.wireshark.org/](https://www.wireshark.org/)
    to download and install Wireshark on your computer, or you can open the Wireshark
    application within the Kali Linux virtual machine.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Let’s download a sample packet capture file, go to [https://www.honeynet.org/challenges/forensics-challenge-14-weird-python/](https://www.honeynet.org/challenges/forensics-challenge-14-weird-python/)
    and download the **conference.pcapng** file. Additionally, you can download more
    Wireshark sample files from [https://wiki.wireshark.org/SampleCaptures](https://wiki.wireshark.org/SampleCaptures).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Next, when you launch the Wireshark application on your computer, you will
    see a list of available network adapters as shown:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.1 – Wireshark interface](image/Figure_10.01_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.1 – Wireshark interface
  prefs: []
  type: TYPE_NORMAL
- en: If you double-click on an interface, Wireshark will begin to capture packets
    on that same interface and show you the live traffic.
  prefs: []
  type: TYPE_NORMAL
- en: 'To capture traffic, it’s important to set your monitoring/capturing interface
    to *promiscuous mode* by clicking on **Capture** | **Options**, then enabling
    **Promiscuous** mode on your preferred interface:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.2 – Network adapters](image/Figure_10.02_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.2 – Network adapters
  prefs: []
  type: TYPE_NORMAL
- en: 'Additionally, the **Output** tab enables you to customize the duration, number
    of packets, and location when storing the captured data:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 10.3 – Capture options](image/Figure_10.03_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.3 – Capture options
  prefs: []
  type: TYPE_NORMAL
- en: Once you click on **Start**, the packet capture will begin on the selected interface.
    However, do not start the capture; instead, we’ll use the **conference.pcapng**
    file for our analysis.
  prefs: []
  type: TYPE_NORMAL
- en: 'To load the **conference.pcapng** file, click on **File** | **Open**, and select
    the sample file; then the packets will populate in Wireshark as shown:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.4 – Wireshark](image/Figure_10.04_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.4 – Wireshark
  prefs: []
  type: TYPE_NORMAL
- en: As shown in the preceding snippet, **A** shows the Packet List pane, **B** shows
    the Packet Details pane and **C** shows the Packet Bytes pane. When a packet is
    selected in the Packet List, its details are shown in the Packet Details pane.
  prefs: []
  type: TYPE_NORMAL
- en: 'To filter packets with a source IP address of **172.16.254.128**, select packet
    5 from the **Packet List** pane, then expand the **Internet Protocol Version 4**
    header, and right-click on the **Source Address** field as shown:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.5 – Packet details](image/Figure_10.05_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.5 – Packet details
  prefs: []
  type: TYPE_NORMAL
- en: 'Then, click on **Apply as Filter** | **Selected** as shown:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 10.6 – Creating filters](image/Figure_10.06_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.6 – Creating filters
  prefs: []
  type: TYPE_NORMAL
- en: As shown in the preceding snippet, the **Apply as Filter** options will immediately
    apply the display filter. The **Prepare as Filter** options enable you to create
    filters without applying them immediately.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following snippet shows the display filter was applied and shows all the
    packets with a source IP address of **172.16.254.128**:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 10.7 – Filtering traffic based on the source IP address](image/Figure_10.07_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.7 – Filtering traffic based on the source IP address
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, to filter traffic between **172.16.254.128** and **8.8.8.8**, expand
    Packet Details for packet 5 again, right-click on **Destination Address: 8.8.8.8**,
    and select **Apply as Filter** | **Selected**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.8 – Creating display filters](image/Figure_10.08_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.8 – Creating display filters
  prefs: []
  type: TYPE_NORMAL
- en: As shown in the preceding snippet, the amended display filters help us to view
    conversations between specific source and destination hosts on a network.
  prefs: []
  type: TYPE_NORMAL
- en: 'To perform automatic name resolution of IP addresses, port numbers, and MAC
    addresses, click on **Edit** | **Preferences** | **Name Resolution** to enable
    these features as shown:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.9 – Name resolution](image/Figure_10.09_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.9 – Name resolution
  prefs: []
  type: TYPE_NORMAL
- en: 'To view all network conversations using Wireshark, click on **Statistics**
    | **Conversations**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.10 – Ethernet conversations](image/Figure_10.10_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.10 – Ethernet conversations
  prefs: []
  type: TYPE_NORMAL
- en: As shown in the preceding snippet, Wireshark shows all the source and destination
    MAC addresses, the numbers of frames, and the traffic within this sample file.
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, click on **IPv4** to view all IP addresses that are detected within the
    sample file and traffic flows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 10.11 – IPv4 addresses and traffic flows](image/Figure_10.11_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.11 – IPv4 addresses and traffic flows
  prefs: []
  type: TYPE_NORMAL
- en: 'Additionally, the **TCP** and **UDP** tabs show the network services and protocols
    of the packet capture:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 10.12 – Port numbers](image/Figure_10.12_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.12 – Port numbers
  prefs: []
  type: TYPE_NORMAL
- en: 'Lastly, to view and export files that are found within the capture file, click
    on **File** | **Export Objects** | **HTTP**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.13 – Objects](image/Figure_10.13_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.13 – Objects
  prefs: []
  type: TYPE_NORMAL
- en: You have the option to select a file or all files to extract from this sample
    capture and save on your desktop.
  prefs: []
  type: TYPE_NORMAL
- en: During this section, you have gained an introduction to leveraging Wireshark
    to capture network traffic as a cybersecurity professional. In the next section,
    you will learn how to use security tools to detect suspicious activities.
  prefs: []
  type: TYPE_NORMAL
- en: Monitoring and detection systems
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Actively monitoring network traffic within an organization helps cybersecurity
    professionals to detect whether there’s a threat on their system and which systems
    are compromised. For instance, the security team may notice an increase in DNS
    queries from an internal server that’s sending packets to an unknown DNS server
    on the internet. By analyzing the network traffic, it seems the internal server
    was compromised by malware that has established a C2 channel to a C2 server on
    the internet and is using a common network protocol such as DNS to reduce its
    threat level and detection. Without monitoring network traffic, this security
    incident may have gone unnoticed and the adversary would continue to expand their
    attack.
  prefs: []
  type: TYPE_NORMAL
- en: Furthermore, cybersecurity professionals need to monitor host systems to detect
    potential threats at an early stage. Once a threat is found, the security team
    can apply immediate actions to contain and eradicate the threat before it can
    spread and exploit additional systems and cause more damage. The data collected
    during this security incident can be used to improve incident response and handling,
    and threat detection on other systems.
  prefs: []
  type: TYPE_NORMAL
- en: 'Many free and commercial threat monitoring and detection tools are widely available
    from trusted providers on the internet. However, it’s important for organizations
    to implement the core tools and perform the core tasks:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Host-based Intrusion Detection** **Systems** (**HIDSes**)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Network-based Intrusion Detection** **Systems** (**NIDSes**)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Network traffic and packet analysis
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Data visualization
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The following are popular free and open source network security tools that
    help organizations monitor and detect threats:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Zeek** – This is an open source network security tool that’s used to monitor
    and analyze network traffic'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Wazuh** – This is an open source security platform that’s used to collect
    and analyze data from host devices'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Suricata** – This is an open source network analysis tool that is used to
    monitor network traffic and provide alerts on potential threats'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: You can find links on how to set up Zeek, Wazuh, and Suricata in the *Further*
    *reading* section.
  prefs: []
  type: TYPE_NORMAL
- en: Setting up the preceding tools can be quite fun and is a good learning experience
    to ensure each tool is working as expected and sharing data. However, it can be
    quite a time-consuming process, especially if there’s any troubleshooting that
    needs to resolve any issues along the way.
  prefs: []
  type: TYPE_NORMAL
- en: '**Security Onion** is an all-in-one security platform that has Zeek, Wazuh,
    Suricata, and many more open source tools already installed and configured to
    work together to help cybersecurity professionals and security teams get up and
    running quickly with threat monitoring, detection, and hunting.'
  prefs: []
  type: TYPE_NORMAL
- en: 'The following host-based tools can be installed on host/client devices that
    enable Security Onion to collect additional data from assets:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Wazuh** – This is a HIDS platform on Security Onion, enabling security professionals
    to install the Wazuh agent on a host to collect additional data and logs for analysis'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Osquery** – This is an endpoint agent that’s installed on a host device and
    used for monitoring and collecting analytics'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Beats** – This is a data shipping component for Elasticsearch that’s used
    to collect logs and metrics from host devices and send them to Security Onion
    for analysis'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The following are network-based tools that enable Security Onion to identify
    suspicious activities on a network:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Google Stenographer** – This tool enables Security Onion to perform full
    packet capture of network traffic'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Suricata** – This performs network traffic analysis and generates alerts
    for potential threats'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Zeek** – It provides connection logs and metadata on network traffic and
    extracts files from network data for further analysis'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Strelka** – This performs file analysis to detect threats'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The following are analyst tools that are used by cybersecurity professionals
    on Security Onion:'
  prefs: []
  type: TYPE_NORMAL
- en: '**SOC** –Security Onion Console, which provides the user access to all other
    tools'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Hunt** – Provides a dashboard that’s used to perform queries for threat hunting'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Kibana** – Used to provide data visualization on network traffic and threats'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Cases** – Allows the user to escalate an alert to a case for tracking the
    investigation during its life cycle'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**CyberChef** – Allows you to decode and analyze artifact data'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Playbook** – Enables users to create detection playbooks for identifying
    threats based on rules'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**FleetDM** – Allows you to run live and scheduled queries on endpoints'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Navigator** – Provides visualization on the MITRE ATT&CK framework'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: When setting up Security Onion on a network, it’s important to ensure there’s
    a dedicated network adapter for management and another for monitoring. The management
    interface is used to administratively access Security Onion and leverage its pre-installed
    tools for monitoring and detecting threats. The monitor interface is used to collect
    data and traffic from the network such as from a network tap or **Switched Port
    Analyzer** (**SPAN**) port on a switch.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following is a simplified diagram showing the placement of Security Onion:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 10.14 – Security Onion](image/Figure_10.14_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.14 – Security Onion
  prefs: []
  type: TYPE_NORMAL
- en: As shown in the preceding diagram, the switch is configured with a mirrored
    or SPAN interface to send a copy of network traffic between the **Local Area Network**
    (**LAN**) and the firewall to the monitor interface on Security Onion. This enables
    Security Onion to monitor and analyze the traffic that’s flowing between the internet
    and the internal network. However, a network tap needs to be implemented between
    the firewall and the **Demilitarized Zone** (**DMZ**) to enable Security Onion
    to monitor traffic within that area of the network.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following are the recommended specifications and considerations for a Security
    Onion virtual environment:'
  prefs: []
  type: TYPE_NORMAL
- en: '**CPU**: 4 cores'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Memory**: 12 GB RAM'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Storage**: 200 GB'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 2 NICs
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'To get started with setting up Security Onion, please use the following instructions:'
  prefs: []
  type: TYPE_NORMAL
- en: Part 1 – setting up the environment
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Firstly, download the **Security Onion** ISO image from [https://securityonionsolutions.com/software/](https://securityonionsolutions.com/software/)
    or [https://github.com/Security-Onion-Solutions/securityonion/blob/master/VERIFY_ISO.md](https://github.com/Security-Onion-Solutions/securityonion/blob/master/VERIFY_ISO.md).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Next, open **VMware Workstation Pro** and click on **File** | **New Virtual
    Machine…** as shown:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.15 – VMware Workstation](image/Figure_10.15_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.15 – VMware Workstation
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, the **New Virtual Machine Wizard** window will appear; select **Custom
    (advanced)** and click on **Next**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.16 – Type of configuration](image/Figure_10.16_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.16 – Type of configuration
  prefs: []
  type: TYPE_NORMAL
- en: 'In the **Choose the Virtual Machine Hardware Compatibility** menu, use the
    default option and click on **Next >**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.17 – Hardware compatibility](image/Figure_10.17_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.17 – Hardware compatibility
  prefs: []
  type: TYPE_NORMAL
- en: 'In the **Guest Operating System Installation** window, select **Browse…** under
    **Installer disc image file (iso)** to attach the Security Onion ISO and then
    click on **Next >**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.18 – Attaching the ISO file](image/Figure_10.18_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.18 – Attaching the ISO file
  prefs: []
  type: TYPE_NORMAL
- en: 'In the **Select a Guest Operating System** window, select **Linux** and **CentOS
    8 64-bit** and click on **Next >**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.19 – Guest operating system](image/Figure_10.19_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.19 – Guest operating system
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, create a name for this new virtual machine and click on **Next >**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.20 – Naming the virtual machine](image/Figure_10.20_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.20 – Naming the virtual machine
  prefs: []
  type: TYPE_NORMAL
- en: 'In the **Processor Configuration** window, it’s recommended to assign **4**
    CPU cores to the virtual machine; then, click on **Next >**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.21 – Assigning processor cores](image/Figure_10.21_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.21 – Assigning processor cores
  prefs: []
  type: TYPE_NORMAL
- en: 'In the **Memory for the Virtual Machine** window, it’s recommended to assign
    12 GB (**12288** MB) of memory to the virtual machine and click on **Next >**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.22 – Memory allocation](image/Figure_10.22_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.22 – Memory allocation
  prefs: []
  type: TYPE_NORMAL
- en: 'In the **Network Type** window, select **Use bridged networking** and click
    on **Next >**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.23 – Network type](image/Figure_10.23_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.23 – Network type
  prefs: []
  type: TYPE_NORMAL
- en: 'Under **Select I/O Controller Types**, use the default option and click on
    **Next >**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.24 – I/O controller type](image/Figure_10.24_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.24 – I/O controller type
  prefs: []
  type: TYPE_NORMAL
- en: 'In the **Select a Disk Type** window, use the default option and click on **Next
    >**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.25 – Disk type](image/Figure_10.25_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.25 – Disk type
  prefs: []
  type: TYPE_NORMAL
- en: 'In the **Select a Disk** window, select **Create a new virtual disk** and click
    on **Next >**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.26 – Selecting a disk option](image/Figure_10.26_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.26 – Selecting a disk option
  prefs: []
  type: TYPE_NORMAL
- en: 'In the **Specify Disk Capacity** window, set the maximum disk size to **200.0**
    GB, select **Split virtual disk into multiple files**, then click on **Next >**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.27 – Disk capacity](image/Figure_10.27_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.27 – Disk capacity
  prefs: []
  type: TYPE_NORMAL
- en: 'In the **Specify Disk File** window, use the default option and click on **Next
    >**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.28 – Disk file](image/Figure_10.28_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.28 – Disk file
  prefs: []
  type: TYPE_NORMAL
- en: 'In the **Ready to Create Virtual Machine** window, click on **Finish**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.29 – Virtual machine summary](image/Figure_10.29_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.29 – Virtual machine summary
  prefs: []
  type: TYPE_NORMAL
- en: After clicking on **Finish**, the virtual machine environment will automatically
    be saved within VMware Workstation.
  prefs: []
  type: TYPE_NORMAL
- en: Part 2 – attaching an additional network adapter
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Within **VMware Workstation**, select the **Security Onion** virtual machine
    and click on **Edit virtual machine settings** as shown:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.30 – Virtual machine](image/Figure_10.30_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.30 – Virtual machine
  prefs: []
  type: TYPE_NORMAL
- en: 'In the **Virtual Machine Settings** menu, click on **Add…**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.31 – Virtual Machine Settings menu](image/Figure_10.31_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.31 – Virtual Machine Settings menu
  prefs: []
  type: TYPE_NORMAL
- en: 'In the **Add Hardware Wizard** menu, select **Network Adapter** and click on
    **Finish**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.32 – Add Hardware Wizard](image/Figure_10.32_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.32 – Add Hardware Wizard
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, you’ll return to the **Virtual Machine Settings** window, select **Network
    Adapter 2**, choose **Bridged: Connected directly to the physical network** mode,
    and click on **OK**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.33 – Network connection type](image/Figure_10.33_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.33 – Network connection type
  prefs: []
  type: TYPE_NORMAL
- en: This network adapter will be used as the monitor interface in Security Onion.
  prefs: []
  type: TYPE_NORMAL
- en: 'To ensure your physical network adapter is associated with the bridge connection
    on VMware Workstation, on the menu bar, click on **Edit** > **Virtual Network
    Editor** > **Change Settings** as shown:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.34 – Network editor](image/Figure_10.34_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.34 – Network editor
  prefs: []
  type: TYPE_NORMAL
- en: As shown in the preceding snippet, **VMnet0** is the **Bridged** network adapter;
    ensure it’s bridged to your physical network adapter on your host machine.
  prefs: []
  type: TYPE_NORMAL
- en: Part 3 – installing Security Onion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In VMware Workstation, select the **Security Onion** virtual machine and power
    on this virtual machine.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Next, the Security Onion installation menu will appear; use the default option
    and hit *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.35 – Security Onion installation type](image/Figure_10.35_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.35 – Security Onion installation type
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, the installation wizard will appear; hit *Enter* to begin the initialization
    process:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.36 – Starting the installation](image/Figure_10.36_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.36 – Starting the installation
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, type **yes** to continue and create a user account as shown:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.37 – Installing Security Onion](image/Figure_10.37_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.37 – Installing Security Onion
  prefs: []
  type: TYPE_NORMAL
- en: The username and password created in this step are used to log in to the console
    only.
  prefs: []
  type: TYPE_NORMAL
- en: Next, the installation of the base operating system and software packages will
    start. This process will take a few minutes and the virtual machine will automatically
    reboot when finished.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Part 4 – configuring networking in Security Onion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'After the Security Onion virtual machine reboots, log in using the username
    and password you created in the previous steps. The **Security Onion Setup** wizard
    will appear on the Terminal/Console; using the direction keys (arrows) on your
    keyboard to select **<Yes>** and hit *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.38 – Security Onion Setup](image/Figure_10.38_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.38 – Security Onion Setup
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, click **Install** to start the standard installation of Security Onion:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.39 – Selecting a setup option](image/Figure_10.39_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.39 – Selecting a setup option
  prefs: []
  type: TYPE_NORMAL
- en: As shown in the preceding figure, you have the choice to proceed with the installation
    and setup or configure the network addresses and settings in Security Onion.
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, using the down arrow key on your keyboard, select **STANDALONE**, press
    the spacebar to place an asterisk (*****), and then hit *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.40 – Installation type](image/Figure_10.40_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.40 – Installation type
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, you will need to type **agree** within the input field to accept the
    terms and agreement to use Elastic Stack within Security Onion and then hit *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.41 – Elastic Stack license agreement](image/Figure_10.41_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.41 – Elastic Stack license agreement
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, insert a hostname for the Security Onion virtual machine and hit *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.42 – Setting a hostname](image/Figure_10.42_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.42 – Setting a hostname
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, you’ll be provided with an option to insert a description for this instance
    of Security Onion. This is optional but recommended if you’re doing a distributed
    installation in a network. Since we’re doing a standalone setup, leave it as the
    default and hit *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.43 – The description window](image/Figure_10.43_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.43 – The description window
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, select the first network adapter as the management NIC in Security Onion
    and hit *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.44 – Management interface](image/Figure_10.44_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.44 – Management interface
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, you are provided with the option to statically assign an IP address to
    the management interface or dynamically receive an address from the **Dynamic
    Host Configuration Server** (**DHCP**) server on the network. Select **STATIC**
    and hit *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.45 – Management interface setup](image/Figure_10.45_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.45 – Management interface setup
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, enter an unused/unallocated IP address and network prefix from your network
    and hit *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.46 – Setting a network address](image/Figure_10.46_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.46 – Setting a network address
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, insert your default gateway address and hit *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.47 – Default gateway address](image/Figure_10.47_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.47 – Default gateway address
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, Google’s DNS server addresses are automatically set; you can leave them
    as the default or change them if needed and hit *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.48 – DNS server settings](image/Figure_10.48_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.48 – DNS server settings
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, create a DNS search domain and hit *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.49 – Setting a search domain](image/Figure_10.49_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.49 – Setting a search domain
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, hit *Enter* to confirm the setup process:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.50 – Confirmation](image/Figure_10.50_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.50 – Confirmation
  prefs: []
  type: TYPE_NORMAL
- en: 'Lastly, the setup process will take a few minutes to complete. Once completed,
    the Security Onion virtual machine will automatically reboot. Then, log in and
    use the following command to check the status of each process and container:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'After a few minutes, all the processes and containers will be running as shown
    in the following snippet:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 10.51 – Verifying the status](image/Figure_10.51_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.51 – Verifying the status
  prefs: []
  type: TYPE_NORMAL
- en: Ensure all containers and processes are running and OK before proceeding to
    the next phase.
  prefs: []
  type: TYPE_NORMAL
- en: Part 5 – detecting suspicious activities
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To access the Security Onion user interface and leverage the security tools,
    open your web browser and go to https://<ip-address-security-onion>. Here, you
    will create a user account to log in and access the security tools within Security
    Onion. This account will be used to access all the tools in Security Onion.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Tip
  prefs: []
  type: TYPE_NORMAL
- en: To find the IP address of the Security Onion virtual machine, login to its console
    and execute the **ifconfig** or **ip address** command to view the IP address
    on the management interface.
  prefs: []
  type: TYPE_NORMAL
- en: 'Once you’ve logged in, you’ll see the main dashboard. Click on **Alerts** to
    see any security events and potential threats that have been detected:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.52 – Security alerts](image/Figure_10.52_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.52 – Security alerts
  prefs: []
  type: TYPE_NORMAL
- en: As shown in the preceding snippet, Suricata identified a potential threat with
    high severity and provided the name of the rule that was used for detection. Furthermore,
    Suricata recorded 136 counts (events) for this alert.
  prefs: []
  type: TYPE_NORMAL
- en: 'To view all related events for an alert, click on the alert name to open the
    drop-down menu and select **Drilldown** as shown:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.53 – Alert options](image/Figure_10.53_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.53 – Alert options
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, Security Onion will show a list of each count (event) for the alert while
    providing the timestamps, detection rules, severity levels, source IP addresses,
    and source port numbers as shown:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 10.54 – Viewing alerts](image/Figure_10.54_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.54 – Viewing alerts
  prefs: []
  type: TYPE_NORMAL
- en: The information shown in the preceding snippet helps cybersecurity professionals
    to identify the source of the threat and the sequence of events that occurred
    using the timestamps.
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, click on one of the events to view event data such as its source and
    destination IP addresses and port numbers, the security sensor that triggered
    the alert, the event severity, and a message that contains specific details about
    the threat, as shown:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.55 – Viewing alert data](image/Figure_10.55_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.55 – Viewing alert data
  prefs: []
  type: TYPE_NORMAL
- en: 'The **message** field contains the following information, which can be used
    by cybersecurity professionals to better understand the event:'
  prefs: []
  type: TYPE_NORMAL
- en: The time and date of the event
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The monitoring interface in Security Onion which detected the event
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The source and destination IP addresses
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The source and destination port numbers
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The signature that was found to trigger the event
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A description of the potential threat
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'To determine the trajectory of the threat and correlate all related events,
    click on an event and select **Correlate** as shown:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.56 – Correlating events](image/Figure_10.56_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.56 – Correlating events
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, Security Onion will provide a correlation of all events that belong to
    the same alert as shown:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 10.57 – Correlation of events](image/Figure_10.57_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.57 – Correlation of events
  prefs: []
  type: TYPE_NORMAL
- en: 'Additionally, clicking on an alert will provide the option to escalate an alert
    to a case. This case can be used by a security analyst to track the event while
    performing further analysis:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 10.58 – Creating a case](image/Figure_10.58_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.58 – Creating a case
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, click on the **Hunt** category to view all network traffic that’s associated
    with the threat. Then, click on a traffic flow from the list to open the additional
    menu and select **PCAP** to view the packet contents:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.59 – Traffic flow](image/Figure_10.59_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.59 – Traffic flow
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, Security Onion will provide a list of network packets for the selected
    flow as shown:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 10.60 – Network packets per flow](image/Figure_10.60_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.60 – Network packets per flow
  prefs: []
  type: TYPE_NORMAL
- en: 'Clicking on the **Expand and Detailed** icon will display the details within
    each packet as shown:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 10.61 – View packet details](image/Figure_10.61_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.61 – View packet details
  prefs: []
  type: TYPE_NORMAL
- en: To export the packet capture file for offline analysis, click on the download
    icon.
  prefs: []
  type: TYPE_NORMAL
- en: 'The **Dashboards** category shows a summary of all events and alerts that were
    detected using Security Onion as shown:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.62 – Dashboards](image/Figure_10.62_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.62 – Dashboards
  prefs: []
  type: TYPE_NORMAL
- en: 'To collect security intelligence from hosts on the network, you can download
    and install **Wazuh Agents** from the **Downloads** page as shown:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.63 – Wazuh Agents](image/Figure_10.63_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.63 – Wazuh Agents
  prefs: []
  type: TYPE_NORMAL
- en: 'For data visualization on all alerts and threats detected by Security Onion,
    click on **Tools** | **Kibana** and log in using your account. The following snippet
    shows the default Kibana dashboard:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.64 – Kibana dashboard](image/Figure_10.64_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.64 – Kibana dashboard
  prefs: []
  type: TYPE_NORMAL
- en: As shown in the preceding snippet, the Kibana dashboard provides cybersecurity
    professionals with an overall view of events and incidents, enabling a security
    analyst to drill down further into the activity during analysis.
  prefs: []
  type: TYPE_NORMAL
- en: 'To view all network connections and traffic flows, click on **Security Onion**
    | **Dataset** | **conn** as shown:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.65 – Datasets](image/Figure_10.65_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.65 – Datasets
  prefs: []
  type: TYPE_NORMAL
- en: 'The connections dashboard will appear, enabling you to click on IP addresses
    and port numbers to gain additional information as shown:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 10.66 – Connections dashboard](image/Figure_10.66_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.66 – Connections dashboard
  prefs: []
  type: TYPE_NORMAL
- en: 'Expand the left-hidden menu and click on **Analytics** to access more data
    visualization tools within Kibana:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 10.67 – Analytics menu](image/Figure_10.67_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.67 – Analytics menu
  prefs: []
  type: TYPE_NORMAL
- en: 'The **Discover** dashboard helps you determine when an event has been detected
    and how often it is occurring, as shown:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 10.68 – Discovery](image/Figure_10.68_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.68 – Discovery
  prefs: []
  type: TYPE_NORMAL
- en: 'Lastly, **Visualize Library** provides the option to create custom dashboards
    or use the existing dashboards to view specific details as shown:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 10.69 – Visualize Library](image/Figure_10.69_B19448.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 10.69 – Visualize Library
  prefs: []
  type: TYPE_NORMAL
- en: Be sure to explore all the features and dashboards within Security Onion, as
    it uses many open source security tools to help cybersecurity professionals to
    monitor their network infrastructure to identify potential threats on their systems.
  prefs: []
  type: TYPE_NORMAL
- en: Having completed this section, you have learned how to set up and use Security
    Onion and its tools to monitor a network and identify potential threats.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Over the course of this chapter, you gained the skills and hands-on experience
    in using Wireshark to perform packet analysis to identify potentially malicious
    traffic, and learned how to set up and use Security Onion to monitor and detect
    potential threats in a network.
  prefs: []
  type: TYPE_NORMAL
- en: Lastly, I know the journey of becoming a cybersecurity professional, such as
    an ethical hacker and penetration tester, has many challenges; there are so many
    new things to learn and keeping up to date with the ever-changing cyber-threat
    landscape can be tough. These challenges will help you expand your potential and
    become an industry expert in your field of study and carry you along the path
    to success, as long as there’s a balance of prioritization, focus, dedication,
    and time management.
  prefs: []
  type: TYPE_NORMAL
- en: I would personally like to thank you very much for your support in purchasing
    a copy of my book and congratulations on making it to the end and acquiring all
    these amazing new skills in performing reconnaissance as an ethical hacker. I
    do hope everything you have learned throughout this book has been informative
    for you and helpful in your journey to becoming super-awesome in the cybersecurity
    industry and beyond.
  prefs: []
  type: TYPE_NORMAL
- en: Further reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Wireshark documentation – [https://www.wireshark.org/docs/](https://www.wireshark.org/docs/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Security Onion documentation – [https://docs.securityonion.net/en/2.3/index.html](https://docs.securityonion.net/en/2.3/index.html)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Setting up Zeek – [https://docs.zeek.org/en/master/](https://docs.zeek.org/en/master/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Setting up Suricata – [https://suricata.io/documentation/](https://suricata.io/documentation/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Setting up Wazuh – [https://documentation.wazuh.com/current/index.html](https://documentation.wazuh.com/current/index.html)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
