<html><head></head><body>
<div id="_idContainer285">
<h1 class="chapter-number" id="_idParaDest-312"><a id="_idTextAnchor395"/><span class="koboSpan" id="kobo.1.1">11</span></h1>
<h1 id="_idParaDest-313"><a id="_idTextAnchor396"/><span class="koboSpan" id="kobo.2.1">Advanced Adventures with ZAP</span></h1>
<p><span class="koboSpan" id="kobo.3.1">Here we are at the final chapter. </span><span class="koboSpan" id="kobo.3.2">You’ve learned about the options </span><strong class="bold"><span class="koboSpan" id="kobo.4.1">Zed Attack Proxy</span></strong><span class="koboSpan" id="kobo.5.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.6.1">ZAP</span></strong><span class="koboSpan" id="kobo.7.1">) offers, from navigating the interface to configurations, from crawling web applications, scanning, and reporting to learning about authentication, authorization, session management, injection attacks on unvalidated inputs, as well as business logic testing, client-side attacks, and some advanced techniques. </span><span class="koboSpan" id="kobo.7.2">This final chapter will see a change of pace and look at other implementations and uses of ZAP. </span><span class="koboSpan" id="kobo.7.3">We’ll introduce you to using the OWASP ZAP GUI to start web crawling and scanning for vulnerabilities against APIs, but also how to use the API in Docker to scan web applications. </span><span class="koboSpan" id="kobo.7.4">We’ll also discuss and show you how to build ZAP into a Jenkins pipeline to conduct dynamic analysis of web applications, and how to install, build and configure the ZAP GUI OAST server for </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">out-of-band vulnerabilities.</span></span></p>
<p><a id="_idTextAnchor397"/><span class="koboSpan" id="kobo.9.1">In this chapter, we will cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">following recipes:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.11.1">How to use the ZAP GUI local API to scan </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">a target</span></span></li>
<li><span class="koboSpan" id="kobo.13.1">How to use the ZAP API </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">via Docker</span></span></li>
<li><span class="koboSpan" id="kobo.15.1">Utilizing ZAP DAST tests in a Jenkins CI </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">DevOps pipeline</span></span></li>
<li><span class="koboSpan" id="kobo.17.1">Installing, configuring, and running the ZAP GUI </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">OAST server</span></span></li>
</ul>
<h1 id="_idParaDest-314"><a id="_idTextAnchor398"/><span class="koboSpan" id="kobo.19.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.20.1">In this chapter, you will need to install numerous tools that will coordinate with ZAP to complete the recipes. </span><span class="koboSpan" id="kobo.20.2">For the API recipe, you will need to install Docker and the command-line script for the OWASP ZAP API. </span><span class="koboSpan" id="kobo.20.3">Docker will also be needed for the Jenkins pipeline as well as for the standalone BOAST server. </span><span class="koboSpan" id="kobo.20.4">In addition, we will continue to use the Mozilla Firefox browser and a fork of the GitHub Juice-shop application code. </span><span class="koboSpan" id="kobo.20.5">Lastly, we’ll test using the command-line </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">tool cURL.</span></span></p>
<h1 id="_idParaDest-315"><a id="_idTextAnchor399"/><span class="koboSpan" id="kobo.22.1">How to use the ZAP GUI local API to scan a target</span></h1>
<p><span class="koboSpan" id="kobo.23.1">The ZAP API scan </span><a id="_idIndexMarker501"/><span class="koboSpan" id="kobo.24.1">is a script included with the ZAP Docker images. </span><span class="koboSpan" id="kobo.24.2">It is optimized to scan APIs specified by OpenAPI, SOAP, or GraphQL through a local file or a URL. </span><span class="koboSpan" id="kobo.24.3">It imports the definition you give and then does an active scan of the URLs discovered. </span><span class="koboSpan" id="kobo.24.4">The ZAP API makes it possible to incorporate ZAP features into scripts and applications. </span><span class="koboSpan" id="kobo.24.5">In this recipe, we will walk through downloading the ZAP Docker image and then running it to scan against the </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">Juice-Shop URL.</span></span></p>
<h2 id="_idParaDest-316"><a id="_idTextAnchor400"/><span class="koboSpan" id="kobo.26.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.27.1">Docker will need to be installed as well as the ZAP Docker image. </span><span class="koboSpan" id="kobo.27.2">Be sure that the ZAP image is able to intercept requests and responses from the server to your browser. </span><span class="koboSpan" id="kobo.27.3">We will also be using the command line to run the image and kick off spidering and scanning. </span><span class="koboSpan" id="kobo.27.4">OWASP ZAP Desktop will also </span><span class="No-Break"><span class="koboSpan" id="kobo.28.1">be needed:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.29.1">
https://www.docker.com/products/docker-desktop</span></pre>
<h2 id="_idParaDest-317"><span class="koboSpan" id="kobo.30.1">How to do it…</span><a id="_idTextAnchor401"/></h2>
<p><span class="koboSpan" id="kobo.31.1">ZAP API-based effective automated analysis can assist in identifying emerging flaws. </span><span class="koboSpan" id="kobo.31.2">Using the current functional regression test</span><a id="_idTextAnchor402"/><span class="koboSpan" id="kobo.32.1"> suites and the ZAP Python API, OWASP ZAP will assist you in automating security tests to incorporate into the </span><strong class="bold"><span class="koboSpan" id="kobo.33.1">Continuous Integration</span></strong><span class="koboSpan" id="kobo.34.1">/</span><strong class="bold"><span class="koboSpan" id="kobo.35.1">Continuous Delivery</span></strong><span class="koboSpan" id="kobo.36.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.37.1">CI</span></strong><span class="koboSpan" id="kobo.38.1">/</span><strong class="bold"><span class="koboSpan" id="kobo.39.1">CD</span></strong><span class="koboSpan" id="kobo.40.1">) pipeline</span><a id="_idIndexMarker502"/><span class="koboSpan" id="kobo.41.1"> for </span><span class="No-Break"><span class="koboSpan" id="kobo.42.1">your applicatio</span><a id="_idTextAnchor403"/><span class="koboSpan" id="kobo.43.1">n.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.44.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.45.1">The ZAP API scan is a script that is available in the ZAP Docker images. </span><span class="koboSpan" id="kobo.45.2">Download owasp zap docker here: </span><strong class="source-inline"><span class="koboSpan" id="kobo.46.1">docker </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.47.1">pull owasp/zap2docker-stable</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.48.1">.</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.49.1">Start OWASP ZAP by running the desktop executable, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.50.1">zap.sh</span></strong><span class="koboSpan" id="kobo.51.1"> script (on Linux/macOS), or the </span><strong class="source-inline"><span class="koboSpan" id="kobo.52.1">zap.bat</span></strong><span class="koboSpan" id="kobo.53.1"> script (on Windows) from </span><span class="No-Break"><span class="koboSpan" id="kobo.54.1">the Terminal:</span></span><pre class="console"><span class="koboSpan" id="kobo.55.1">
Windows: .\zap.bat</span></pre><pre class="console"><span class="koboSpan" id="kobo.56.1">
Linux/Mac: ./zap.sh</span></pre><pre class="console"><span class="koboSpan" id="kobo.57.1">
Cross Platform: java -Xmx512m -jar zap-2.12.0.jar</span></pre></li>
</ol>
<p class="callout-heading"><span class="koboSpan" id="kobo.58.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.59.1">To run ZAP headless, use the -</span><em class="italic"><span class="koboSpan" id="kobo.60.1">daemon</span></em><span class="koboSpan" id="kobo.61.1"> flag. </span><span class="koboSpan" id="kobo.61.2">The OWASP ZAP daemon mode is a feature that allows the tool to run as a daemon, or background service, on a machine. </span><span class="koboSpan" id="kobo.61.3">This can be useful if you want to set up continuous scanning of a web application or want to remotely control the tool using the OWASP </span><span class="No-Break"><span class="koboSpan" id="kobo.62.1">ZAP API.</span></span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.63.1">In the OWASP </span><a id="_idIndexMarker503"/><span class="koboSpan" id="kobo.64.1">ZAP UI, open </span><strong class="bold"><span class="koboSpan" id="kobo.65.1">Tools</span></strong><span class="koboSpan" id="kobo.66.1"> then </span><strong class="bold"><span class="koboSpan" id="kobo.67.1">Options</span></strong><span class="koboSpan" id="kobo.68.1"> and go to the </span><strong class="bold"><span class="koboSpan" id="kobo.69.1">API</span></strong><span class="koboSpan" id="kobo.70.1"> tab. </span><span class="koboSpan" id="kobo.70.2">Note the API key, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.71.1">Figure 11</span></em></span><em class="italic"><span class="koboSpan" id="kobo.72.1">.1</span></em><span class="koboSpan" id="kobo.73.1">, as well as the permitted IP addresses for use with the API and a few other options. </span><span class="koboSpan" id="kobo.73.2">You have checkboxes to enable the API and web UI (</span><strong class="source-inline"><span class="koboSpan" id="kobo.74.1">127.0.0.1:PORT</span></strong><span class="koboSpan" id="kobo.75.1">/</span><strong class="source-inline"><span class="koboSpan" id="kobo.76.1">UI</span></strong><span class="koboSpan" id="kobo.77.1"> or /</span><strong class="source-inline"><span class="koboSpan" id="kobo.78.1">json</span></strong><span class="koboSpan" id="kobo.79.1">). </span><span class="koboSpan" id="kobo.79.2">In addition, there are a few debug options that are only recommended for testing purposes, such as </span><strong class="bold"><span class="koboSpan" id="kobo.80.1">Disable the </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.81.1">API key</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer269">
<span class="koboSpan" id="kobo.83.1"><img alt="Figure 11.1 – API options" src="image/Figure_11.1_B18829.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.84.1">Figure 11.1 – API options</span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.85.1">To get started, ensure</span><a id="_idIndexMarker504"/><span class="koboSpan" id="kobo.86.1"> the appropriate plugins are added from the Marketplace. </span><span class="koboSpan" id="kobo.86.2">OWASP ZAP supports OpenAPI, GraphQL, </span><span class="No-Break"><span class="koboSpan" id="kobo.87.1">and SOAP.</span></span></li>
<li><span class="koboSpan" id="kobo.88.1">To start a scan, you can simply use Automated Scan from the </span><strong class="bold"><span class="koboSpan" id="kobo.89.1">Quick Start</span></strong><span class="koboSpan" id="kobo.90.1"> menu and scan the endpoint. </span><span class="koboSpan" id="kobo.90.2">The only difference is to ensure that the URL has the appropriate </span><span class="No-Break"><span class="koboSpan" id="kobo.91.1">API scope:</span></span><pre class="console"><span class="koboSpan" id="kobo.92.1">
OpenAPI: https://www.example.com/openapi.json</span></pre><pre class="console"><span class="koboSpan" id="kobo.93.1">
GraphQL: https://www.example.com/graphql</span></pre></li>
<li><span class="koboSpan" id="kobo.94.1">The results will populate in the same </span><strong class="bold"><span class="koboSpan" id="kobo.95.1">Information</span></strong><span class="koboSpan" id="kobo.96.1"> window under the </span><strong class="bold"><span class="koboSpan" id="kobo.97.1">Alerts</span></strong><span class="koboSpan" id="kobo.98.1"> tab, as seen in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.99.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.100.1">.2</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.101.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer270">
<span class="koboSpan" id="kobo.102.1"><img alt="Figure 11.2 – The GraphQL Alerts results" src="image/Figure_11.2_B18829.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.103.1">Figure 11.2 – The GraphQL Alerts results</span></p>
<h2 id="_idParaDest-318"><a id="_idTextAnchor404"/><span class="koboSpan" id="kobo.104.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.105.1">You can interact with </span><a id="_idIndexMarker505"/><span class="koboSpan" id="kobo.106.1">the ZAP API scanner using a variety of different methods to carry out a variety of tasks, such as spidering a web application to learn about its contents, looking for application vulnerabilities, or creating reports. </span><span class="koboSpan" id="kobo.106.2">Making HTTP requests to the ZAP API endpoint, which is made available by the active ZAP instance, is the standard procedure for using the ZAP API. </span><span class="koboSpan" id="kobo.106.3">Depending on how you’ve set up the tool, the endpoint will be at a </span><span class="No-Break"><span class="koboSpan" id="kobo.107.1">particular URL.</span></span></p>
<p><span class="koboSpan" id="kobo.108.1">There are several ways to employ the ZAP API scanner. </span><span class="koboSpan" id="kobo.108.2">It allows you to scan an individual web page, an entire web application, or a collection of connected online applications. </span><span class="koboSpan" id="kobo.108.3">Additionally, it may be used to automate a number of security-related operations, including planning scans, creating reports, and connecting with other </span><span class="No-Break"><span class="koboSpan" id="kobo.109.1">security solution</span><a id="_idTextAnchor405"/><span class="koboSpan" id="kobo.110.1">s.</span></span></p>
<h1 id="_idParaDest-319"><a id="_idTextAnchor406"/><span class="koboSpan" id="kobo.111.1">How to use the ZAP API via Docker</span></h1>
<p><span class="koboSpan" id="kobo.112.1">Using Docker</span><a id="_idIndexMarker506"/><span class="koboSpan" id="kobo.113.1"> to execute and administer the ZAP application is </span><a id="_idIndexMarker507"/><span class="koboSpan" id="kobo.114.1">known as running ZAP </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">via Docker.</span></span></p>
<p><span class="koboSpan" id="kobo.116.1">If you want to run ZAP in a containerized environment or quickly install and operate ZAP on many machines, this can </span><span class="No-Break"><span class="koboSpan" id="kobo.117.1">be helpful.</span></span></p>
<h2 id="_idParaDest-320"><a id="_idTextAnchor407"/><span class="koboSpan" id="kobo.118.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.119.1">You must install Docker on your computer and get the ZAP Docker image from Docker Hub in order to access the ZAP API </span><span class="No-Break"><span class="koboSpan" id="kobo.120.1">via Docker.</span></span></p>
<p><span class="koboSpan" id="kobo.121.1">The image can then be run as a Docker container, and you can communicate with the container while it is running using the </span><span class="No-Break"><span class="koboSpan" id="kobo.122.1">ZAP API.</span></span></p>
<h2 id="_idParaDest-321"><a id="_idTextAnchor408"/><span class="koboSpan" id="kobo.123.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.124.1">The ZAP application will launch inside the container when you run the ZAP Docker image. </span><span class="koboSpan" id="kobo.124.2">ZAP will then handle any requests sent to the running container using the ZAP API. </span><span class="koboSpan" id="kobo.124.3">You can interact with ZAP using a variety of different methods provided by the ZAP API, such as spidering a web application to learn about its contents, looking for application vulnerabilities, or </span><span class="No-Break"><span class="koboSpan" id="kobo.125.1">creating reports:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.126.1">In addition to running the API scans via the GUI, you can kick off scans using Docker via the </span><span class="No-Break"><span class="koboSpan" id="kobo.127.1">command line.</span></span></li>
<li><span class="koboSpan" id="kobo.128.1">To use API via the Docker command line, open a Terminal session and run Docker to pull the image </span><span class="No-Break"><span class="koboSpan" id="kobo.129.1">off ZAP:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.130.1">docker pull owasp/zap2docker-stable</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.131.1">Next, after the image downloads, run Docker again but this time to create a container of ZAP that will run the ZAP API, </span><span class="No-Break"><span class="koboSpan" id="kobo.132.1">as follows:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.133.1">docker run -t owasp/zap2docker-stable zap-api-scan.py -t https://www.example.com/openapi.json -f openapi</span></strong></pre></li>
<li><span class="koboSpan" id="kobo.134.1">After a few moments, the command line will showcase the attacks running and whether they pass, fail, or come with other warnings, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.135.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.136.1">.3</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.137.1">.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer271">
<span class="koboSpan" id="kobo.138.1"><img alt="Figure 11.3 – A Docker API scan of Juice-Shop" src="image/Figure_11.3_B18829.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.139.1">Figure 11.3 – A Docker API scan of Juice-Shop</span></p>
<p><span class="koboSpan" id="kobo.140.1">You</span><a id="_idIndexMarker508"/><span class="koboSpan" id="kobo.141.1"> will</span><a id="_idIndexMarker509"/><span class="koboSpan" id="kobo.142.1"> see the results at the end as well (see </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.143.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.144.1">.4</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.145.1">).</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer272">
<span class="koboSpan" id="kobo.146.1"><img alt="Figure 11.4 – The Docker API scan results" src="image/Figure_11.4_B18829.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.147.1">Figure 11.4 – The Docker API scan results</span></p>
<p><span class="koboSpan" id="kobo.148.1">By default, the script does </span><span class="No-Break"><span class="koboSpan" id="kobo.149.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.150.1">Imports the specified </span><span class="No-Break"><span class="koboSpan" id="kobo.151.1">API definition</span></span></li>
<li><span class="koboSpan" id="kobo.152.1">Actively scans the API using a specific scan profile tailored </span><span class="No-Break"><span class="koboSpan" id="kobo.153.1">for APIs</span></span></li>
<li><span class="koboSpan" id="kobo.154.1">Notifies the command line of any </span><span class="No-Break"><span class="koboSpan" id="kobo.155.1">problems discovered</span></span></li>
</ul>
<p class="callout-heading"><span class="koboSpan" id="kobo.156.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.157.1">If no bugs are detected, this does not imply that your API is secure. </span><span class="koboSpan" id="kobo.157.2">You may need to conduct a manual </span><span class="No-Break"><span class="koboSpan" id="kobo.158.1">penetration test.</span></span></p>
<h2 id="_idParaDest-322"><a id="_idTextAnchor409"/><span class="koboSpan" id="kobo.159.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.160.1">The API provides a set of methods that can be used to perform various actions, such as starting and stopping a scan, setting the target for the scan, and retrieving the results of </span><span class="No-Break"><span class="koboSpan" id="kobo.161.1">the scan.</span></span></p>
<p><span class="koboSpan" id="kobo.162.1">To use the OWASP ZAP API, you will need to make HTTP requests to the API endpoint, which is typically hosted on the same </span><a id="_idIndexMarker510"/><span class="koboSpan" id="kobo.163.1">machine as the ZAP application. </span><span class="koboSpan" id="kobo.163.2">The API uses a </span><strong class="bold"><span class="koboSpan" id="kobo.164.1">Representational State Transfer</span></strong><span class="koboSpan" id="kobo.165.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.166.1">RESTful</span></strong><span class="koboSpan" id="kobo.167.1">) design, which means that you can use standard HTTP methods (such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.168.1">GET</span></strong><span class="koboSpan" id="kobo.169.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.170.1">POST</span></strong><span class="koboSpan" id="kobo.171.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.172.1">PUT</span></strong><span class="koboSpan" id="kobo.173.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.174.1">DELETE</span></strong><span class="koboSpan" id="kobo.175.1">) to perform </span><span class="No-Break"><span class="koboSpan" id="kobo.176.1">different actions.</span></span></p>
<p><span class="koboSpan" id="kobo.177.1">When you use the OWASP ZAP API to start a scan, the tool will begin to crawl the target web application and perform various types of tests to identify vulnerabilities. </span><span class="koboSpan" id="kobo.177.2">These tests can include looking for SQL injection (SQLI) </span><a id="_idIndexMarker511"/><span class="koboSpan" id="kobo.178.1">vulnerabilities, </span><strong class="bold"><span class="koboSpan" id="kobo.179.1">cross-site scripting</span></strong><span class="koboSpan" id="kobo.180.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.181.1">XSS</span></strong><span class="koboSpan" id="kobo.182.1">) vulnerabilities, and other types of vulnerabilities that can be exploited </span><span class="No-Break"><span class="koboSpan" id="kobo.183.1">by attackers.</span></span></p>
<p><span class="koboSpan" id="kobo.184.1">Once the scan is complete, the OWASP ZAP API will provide a report detailing any vulnerabilities that were identified. </span><span class="koboSpan" id="kobo.184.2">The report will typically include information about the type of vulnerability, the </span><a id="_idIndexMarker512"/><span class="koboSpan" id="kobo.185.1">location of the vulnerability within the </span><a id="_idIndexMarker513"/><span class="koboSpan" id="kobo.186.1">application, and any recommendations for how to fix </span><span class="No-Break"><span class="koboSpan" id="kobo.187.1">the vulnerability.</span></span></p>
<h2 id="_idParaDest-323"><a id="_idTextAnchor410"/><span class="koboSpan" id="kobo.188.1">There’s more…</span></h2>
<p><span class="koboSpan" id="kobo.189.1">In addition to using </span><a id="_idIndexMarker514"/><span class="koboSpan" id="kobo.190.1">the OWASP ZAP API through HTTP</span><a id="_idIndexMarker515"/><span class="koboSpan" id="kobo.191.1"> requests, there are also a number of client libraries and language bindings available that make it easier to use the API in different programming languages. </span><span class="koboSpan" id="kobo.191.2">These libraries provide a set of functions and methods that you can use to make API calls and interact with the ZAP tool, rather than having to manually construct and send </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">HTTP requests.</span></span></p>
<p><span class="koboSpan" id="kobo.193.1">For example, client libraries are available for languages such as Python, Java, and C#, allowing you to utilize the OWASP ZAP API in your own programs. </span><span class="koboSpan" id="kobo.193.2">Using these libraries can make integrating the ZAP tool into your own application or process easier, as well as save you time by handling the intricacies of performing API calls and analyzing </span><span class="No-Break"><span class="koboSpan" id="kobo.194.1">the answers.</span></span></p>
<p><span class="koboSpan" id="kobo.195.1">There are also a number of other ways that you can use the OWASP ZAP API, depending on your specific needs. </span><span class="koboSpan" id="kobo.195.2">For example, you can use the API to automate security testing as part of a CI/CD pipeline, or integrate the ZAP tool into a custom security tool or platform. </span><span class="koboSpan" id="kobo.195.3">You can also use the API</span><a id="_idIndexMarker516"/><span class="koboSpan" id="kobo.196.1"> to perform scans regularly or in response to specific events, such as the deployment </span><a id="_idIndexMarker517"/><span class="koboSpan" id="kobo.197.1">of new code to a </span><span class="No-Break"><span class="koboSpan" id="kobo.198.1">production environment.</span></span></p>
<h2 id="_idParaDest-324"><a id="_idTextAnchor411"/><span class="koboSpan" id="kobo.199.1">See also</span></h2>
<p><span class="koboSpan" id="kobo.200.1">When running the API script, here are some more command options for use with the </span><span class="No-Break"><span class="koboSpan" id="kobo.201.1">ZAP API:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.202.1">
Options:
</span><strong class="bold"><span class="koboSpan" id="kobo.203.1">-c config_file</span></strong><span class="koboSpan" id="kobo.204.1"> config file for INFO, IGNORE or FAIL warnings
</span><strong class="bold"><span class="koboSpan" id="kobo.205.1">-u config_url</span></strong><span class="koboSpan" id="kobo.206.1"> URL config file for INFO, IGNORE or FAIL warning
</span><strong class="bold"><span class="koboSpan" id="kobo.207.1">-g gen_file</span></strong><span class="koboSpan" id="kobo.208.1"> generate default config file(all rules set to WARN)
</span><strong class="bold"><span class="koboSpan" id="kobo.209.1">-r report_html</span></strong><span class="koboSpan" id="kobo.210.1"> file to write the full ZAP HTML report
</span><strong class="bold"><span class="koboSpan" id="kobo.211.1">-w report_md</span></strong><span class="koboSpan" id="kobo.212.1"> file to write the full ZAP Wiki(Markdown) report
</span><strong class="bold"><span class="koboSpan" id="kobo.213.1">-x report_xml</span></strong><span class="koboSpan" id="kobo.214.1"> file to write the full ZAP XML report
</span><strong class="bold"><span class="koboSpan" id="kobo.215.1">-a</span></strong><span class="koboSpan" id="kobo.216.1"> include the alpha passive scan rules as well
</span><strong class="bold"><span class="koboSpan" id="kobo.217.1">-d</span></strong><span class="koboSpan" id="kobo.218.1"> show debug messages
</span><strong class="bold"><span class="koboSpan" id="kobo.219.1">-P</span></strong><span class="koboSpan" id="kobo.220.1"> specify listen port
</span><strong class="bold"><span class="koboSpan" id="kobo.221.1">-D</span></strong><span class="koboSpan" id="kobo.222.1"> delay in seconds to wait for passive scanning
</span><strong class="bold"><span class="koboSpan" id="kobo.223.1">-i</span></strong><span class="koboSpan" id="kobo.224.1"> default rules not in the config file to INFO
</span><strong class="bold"><span class="koboSpan" id="kobo.225.1">-l level</span></strong><span class="koboSpan" id="kobo.226.1"> minimum level to show: PASS, IGNORE, INFO, WARN or FAIL, use with -s to hide example URLs
</span><strong class="bold"><span class="koboSpan" id="kobo.227.1">-n context_file</span></strong><span class="koboSpan" id="kobo.228.1"> context file which will be loaded prior to scanning the target
</span><strong class="bold"><span class="koboSpan" id="kobo.229.1">-p progress_file</span></strong><span class="koboSpan" id="kobo.230.1"> progress file which specifies issues that are being addressed
</span><strong class="bold"><span class="koboSpan" id="kobo.231.1">-s</span></strong><span class="koboSpan" id="kobo.232.1"> short output format - don't show PASSes or example URLs
</span><strong class="bold"><span class="koboSpan" id="kobo.233.1">-z zap_options</span></strong><span class="koboSpan" id="kobo.234.1"> ZAP CLI options (-z "-config aaa=bbb -config ccc=ddd")</span></pre>
<p><span class="koboSpan" id="kobo.235.1">For more information, visit the </span><span class="No-Break"><span class="koboSpan" id="kobo.236.1">following links:</span></span></p>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.237.1">OWASP ZAP official documentation: ZAP – API </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.238.1">Scan</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.239.1">: </span></span><a href="https://www.zaproxy.org/docs/docker/api-scan/"><span class="No-Break"><span class="koboSpan" id="kobo.240.1">https://www.zaproxy.org/docs/docker/api-scan/</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.241.1">OWASP ZAP official documentation: Options API </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.242.1">screen</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.243.1">: </span></span><a href="https://www.zaproxy.org/docs/desktop/ui/dialogs/options/api/"><span class="No-Break"><span class="koboSpan" id="kobo.244.1">https://www.zaproxy.org/docs/desktop/ui/dialogs/options/api/</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.245.1">OWASP ZAP official documentation: Scanning APIs with </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.246.1">ZAP</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.247.1">: </span></span><a href="https://www.zaproxy.org/blog/2017-06-19-scanning-apis-with-zap/"><span class="No-Break"><span class="koboSpan" id="kobo.248.1">https://www.zaproxy.org/blog/2017-06-19-scanning-apis-with-zap/</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.249.1">OWASP ZAP official documentation: Exploring APIs with </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.250.1">ZAP</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.251.1">: </span></span><a href="https://www.zaproxy.org/blog/2017-04-03-exploring-apis-with-zap/"><span class="No-Break"><span class="koboSpan" id="kobo.252.1">https://www.zaproxy.org/blog/2017-04-03-exploring-apis-with-zap/</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.253.1">OWASP ZAP official documentation: Why is an API key required by </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.254.1">default?</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.255.1">: </span></span><a href="https://www.zaproxy.org/faq/why-is-an-api-key-required-by-default/"><span class="No-Break"><span class="koboSpan" id="kobo.256.1">https://www.zaproxy.org/faq/why-is-an-api-key-required-by-default/</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.257.1">OWASP ZAP official documentation: How can I connect to ZAP </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.258.1">remotely?</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.259.1">: </span></span><a href="https://www.zaproxy.org/faq/how-can-i-connect-to-zap-remotely/"><span class="No-Break"><span class="koboSpan" id="kobo.260.1">https://www.zaproxy.org/faq/how-can-i-connect-to-zap-remotely/</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.261.1">OWASP ZAP official FAQ documentation on how to use the ZAP </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.262.1">API</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.263.1">: </span></span><a href="https://www.zaproxy.org/faq/how-can-you-use-zap-to-scan-apis/"><span class="No-Break"><span class="koboSpan" id="kobo.264.1">https://www.zaproxy.org/faq/how-can-you-use-zap-to-scan-apis/</span></span></a></li>
<li><em class="italic"><span class="koboSpan" id="kobo.265.1">A GitHub Action for running the OWASP ZAP API </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.266.1">scan</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.267.1">: </span></span><a href="https://github.com/marketplace/actions/owasp-zap-api-scan"><span class="No-Break"><span class="koboSpan" id="kobo.268.1">https://github.com/marketplace/actions/owasp-</span><span id="_idTextAnchor412"/><span class="koboSpan" id="kobo.269.1">zap-api-scan</span></span></a></li>
</ul>
<h1 id="_idParaDest-325"><a id="_idTextAnchor413"/><span class="koboSpan" id="kobo.270.1">Utilizing ZAP DAST testing with Jenkins</span></h1>
<p><span class="koboSpan" id="kobo.271.1">Jenkins is an open </span><a id="_idIndexMarker518"/><span class="koboSpan" id="kobo.272.1">source CI/CD technology</span><a id="_idIndexMarker519"/><span class="koboSpan" id="kobo.273.1"> that aids in the automation of the software development process. </span><span class="koboSpan" id="kobo.273.2">Jenkins allows developers to seamlessly merge code changes and automatically create, test, and deploy applications, making the software development process more efficient and dependable. </span><span class="koboSpan" id="kobo.273.3">Jenkins is extensively used by teams of all sizes to automate their software delivery processes, and it is easily customizable to meet </span><a id="_idIndexMarker520"/><span class="koboSpan" id="kobo.274.1">the demands of each project. </span><span class="koboSpan" id="kobo.274.2">In this context, the OWASP ZAP is a </span><strong class="bold"><span class="koboSpan" id="kobo.275.1">Dynamic Application Security</span></strong><span class="koboSpan" id="kobo.276.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.277.1">DAST</span></strong><span class="koboSpan" id="kobo.278.1">) vulnerability</span><a id="_idIndexMarker521"/><span class="koboSpan" id="kobo.279.1"> detection tool for web applications. </span><span class="koboSpan" id="kobo.279.2">It can be linked to a Jenkins pipeline to automate security testing as part of the </span><span class="No-Break"><span class="koboSpan" id="kobo.280.1">CI/CD process.</span></span></p>
<h2 id="_idParaDest-326"><a id="_idTextAnchor414"/><span class="koboSpan" id="kobo.281.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.282.1">This recipe requires the installation of Jenkins and Docker on an Ubuntu 22.04 virtual machine. </span><span class="koboSpan" id="kobo.282.2">Ensure Juice-Shop is running locally to scan </span><span class="No-Break"><span class="koboSpan" id="kobo.283.1">against it.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.284.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.285.1">If you are running Jenkins on a local system, you must offer access rights/permissions to owners, normal users, and non-users with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.286.1">sudo chmod 777 /var/run/docker.sock</span></strong><span class="koboSpan" id="kobo.287.1"> Terminal command. </span><span class="koboSpan" id="kobo.287.2">The script will not operate unless you provide access to owners, normal users, </span><span class="No-Break"><span class="koboSpan" id="kobo.288.1">and non-users.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.289.1">Please keep in mind that this script is exclusively for scanning applications that are already in </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.290.1">production/sandbox/UAT/SIT</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.291.1"> environments.</span></span></p>
<h2 id="_idParaDest-327"><a id="_idTextAnchor415"/><span class="koboSpan" id="kobo.292.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.293.1">In this recipe, we will walk you through the process of installing OWASP ZAP in a Jenkins pipeline and setting up the automation for running scans during new code iterations and pushes. </span><span class="koboSpan" id="kobo.293.2">In addition, we’ll build ticketing with JIRA into the process to complete the DevOps </span><span class="No-Break"><span class="koboSpan" id="kobo.294.1">life cycle:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.295.1">With Jenkins running and Docker installed, open your browser of choice and go to your </span><span class="No-Break"><span class="koboSpan" id="kobo.296.1">Jenkins app:</span></span><pre class="console"><span class="koboSpan" id="kobo.297.1">
http://&lt;VM_IP_ADDR&gt;:8080</span></pre></li>
</ol>
<p class="callout-heading"><span class="koboSpan" id="kobo.298.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.299.1">Jenkins boot setup runs by default at </span><strong class="source-inline"><span class="koboSpan" id="kobo.300.1">https://localhost:8080/</span></strong><span class="koboSpan" id="kobo.301.1">. </span><span class="koboSpan" id="kobo.301.2">Adjust the boot configuration by editing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.302.1">jenkins.xml</span></strong><span class="koboSpan" id="kobo.303.1"> file in your installation location. </span><span class="koboSpan" id="kobo.303.2">Other boot configuration parameters, such as JVM options, HTTPS configuration, and so on, can also be modified in </span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">this file.</span></span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.305.1">Log in with the credentials you created when first setting up Jenkins. </span><span class="koboSpan" id="kobo.305.2">If you have not completed this</span><a id="_idIndexMarker522"/><span class="koboSpan" id="kobo.306.1"> step, you </span><a id="_idIndexMarker523"/><span class="koboSpan" id="kobo.307.1">will need to enter </span><strong class="source-inline"><span class="koboSpan" id="kobo.308.1">initialAdminPassword</span></strong><span class="koboSpan" id="kobo.309.1">, which is found in the </span><span class="No-Break"><span class="koboSpan" id="kobo.310.1">following path:</span></span><pre class="console"><span class="koboSpan" id="kobo.311.1">
Windows: C:\ProgramData\Jenkins\.jenkins\secrets</span></pre><pre class="console"><span class="koboSpan" id="kobo.312.1">
Linux: /var/lib/jenkins/secrets/</span></pre><pre class="console"><span class="koboSpan" id="kobo.313.1">
MacOS: /Users/Shared/Jenkins/Home/secrets/</span></pre></li>
<li><span class="koboSpan" id="kobo.314.1">On the home screen, we’ll create a </span><em class="italic"><span class="koboSpan" id="kobo.315.1">new item</span></em><span class="koboSpan" id="kobo.316.1">, name it </span><strong class="source-inline"><span class="koboSpan" id="kobo.317.1">ZAP</span></strong><span class="koboSpan" id="kobo.318.1">, and select </span><strong class="bold"><span class="koboSpan" id="kobo.319.1">Pipeline</span></strong><span class="koboSpan" id="kobo.320.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.321.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.322.1">.5</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.323.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer273">
<span class="koboSpan" id="kobo.324.1"><img alt="Figure 11.5 – A new Jenkins item" src="image/Figure_11.5_B18829.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.325.1">Figure 11.5 – A new Jenkins item</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.326.1">On the next screen, you’ll have several settings or build triggers, but we’ll move past those and go to the </span><strong class="bold"><span class="koboSpan" id="kobo.327.1">Pipeline</span></strong><span class="koboSpan" id="kobo.328.1"> script (see </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.329.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.330.1">.6</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.331.1">).</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer274">
<span class="koboSpan" id="kobo.332.1"><img alt="Figure 11.6 – The Pipeline script" src="image/Figure_11.6_B18829.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.333.1">Figure 11.6 – The Pipeline script</span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.334.1">We’ll enter the </span><a id="_idIndexMarker524"/><span class="koboSpan" id="kobo.335.1">following</span><a id="_idIndexMarker525"/> <span class="No-Break"><span class="koboSpan" id="kobo.336.1">Groovy script:</span></span><pre class="console"><span class="koboSpan" id="kobo.337.1">
pipeline {</span></pre><pre class="console"><span class="koboSpan" id="kobo.338.1">
  agent any</span></pre><pre class="console"><span class="koboSpan" id="kobo.339.1">
  parameters {</span></pre><pre class="console"><span class="koboSpan" id="kobo.340.1">
      choice(name: "ZAP_SCAN", choices: ["zap-baseline.py", "zap-full-scan.py"], description: "Parameter to choose type of ZAP scan")</span></pre><pre class="console"><span class="koboSpan" id="kobo.341.1">
      string(name: "ENTER_URL", defaultValue: "http://192.168.1.1:3000", trim: true, description: "Parameter for entering a URL to be scanned")</span></pre><pre class="console"><span class="koboSpan" id="kobo.342.1">
  }</span></pre><pre class="console"><span class="koboSpan" id="kobo.343.1">
  stages {</span></pre><pre class="console"><span class="koboSpan" id="kobo.344.1">
     stage('Get Write Access'){</span></pre><pre class="console"><span class="koboSpan" id="kobo.345.1">
     steps {</span></pre><pre class="console"><span class="koboSpan" id="kobo.346.1">
           sh "chmod 777 \$(pwd)"</span></pre><pre class="console"><span class="koboSpan" id="kobo.347.1">
     }</span></pre><pre class="console"><span class="koboSpan" id="kobo.348.1">
     }</span></pre><pre class="console"><span class="koboSpan" id="kobo.349.1">
  stage('Setting up OWASP ZAP docker container') {</span></pre><pre class="console"><span class="koboSpan" id="kobo.350.1">
      steps {</span></pre><pre class="console"><span class="koboSpan" id="kobo.351.1">
      echo "Starting container --&gt; Start"</span></pre><pre class="console"><span class="koboSpan" id="kobo.352.1">
           sh "docker run --rm -v \$(pwd):/zap/wrk/:rw --name owasp -dt owasp/zap2docker-live /bin/bash"</span></pre><pre class="console"><span class="koboSpan" id="kobo.353.1">
     }</span></pre><pre class="console"><span class="koboSpan" id="kobo.354.1">
  }</span></pre><pre class="console"><span class="koboSpan" id="kobo.355.1">
     stage('Run Application Scan') {</span></pre><pre class="console"><span class="koboSpan" id="kobo.356.1">
     steps {</span></pre><pre class="console"><span class="koboSpan" id="kobo.357.1">
           sh "docker exec owasp ${params.ZAP_SCAN} -t ${params.ENTER_URL} -I -j --auto"</span></pre><pre class="console"><span class="koboSpan" id="kobo.358.1">
           }</span></pre><pre class="console"><span class="koboSpan" id="kobo.359.1">
      }</span></pre><pre class="console"><span class="koboSpan" id="kobo.360.1">
      stage('Stop and Remove Container') {</span></pre><pre class="console"><span class="koboSpan" id="kobo.361.1">
      steps {</span></pre><pre class="console"><span class="koboSpan" id="kobo.362.1">
      echo "Removing container"</span></pre><pre class="console"><span class="koboSpan" id="kobo.363.1">
           sh '''</span></pre><pre class="console"><span class="koboSpan" id="kobo.364.1">
                docker stop owasp</span></pre><pre class="console"><span class="koboSpan" id="kobo.365.1">
                '''</span></pre><pre class="console"><span class="koboSpan" id="kobo.366.1">
           }</span></pre><pre class="console"><span class="koboSpan" id="kobo.367.1">
      }</span></pre><pre class="console"><span class="koboSpan" id="kobo.368.1">
      }</span></pre><pre class="console"><span class="koboSpan" id="kobo.369.1">
}</span></pre></li>
<li><span class="koboSpan" id="kobo.370.1">Once you click </span><strong class="bold"><span class="koboSpan" id="kobo.371.1">Save</span></strong><span class="koboSpan" id="kobo.372.1">, you are brought to the </span><strong class="bold"><span class="koboSpan" id="kobo.373.1">Stage view</span></strong><span class="koboSpan" id="kobo.374.1"> screen. </span><span class="koboSpan" id="kobo.374.2">This is where you have options to see the status, see the changes, build now, configure, delete the pipeline, see the full stage view, rename your pipeline, and see the pipeline syntax, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.375.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.376.1">.7</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.377.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer275">
<span class="koboSpan" id="kobo.378.1"><img alt="Figure 11.7 – Stage View" src="image/Figure_11.7_B18829.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.379.1">Figure 11.7 – Stage View</span></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.380.1">To run the script</span><a id="_idIndexMarker526"/><span class="koboSpan" id="kobo.381.1"> we</span><a id="_idIndexMarker527"/><span class="koboSpan" id="kobo.382.1"> just entered, click </span><strong class="bold"><span class="koboSpan" id="kobo.383.1">Build </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.384.1">with Parameters</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.385.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.386.1">This will kick off the script and run through the steps we entered. </span><span class="koboSpan" id="kobo.386.2">You’ll see your new build running in </span><strong class="bold"><span class="koboSpan" id="kobo.387.1">Build History</span></strong><span class="koboSpan" id="kobo.388.1"> as well as the steps running in </span><strong class="bold"><span class="koboSpan" id="kobo.389.1">Stage View</span></strong><span class="koboSpan" id="kobo.390.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.391.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.392.1">.8</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.393.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer276">
<span class="koboSpan" id="kobo.394.1"><img alt="Figure 11.8 – The new build" src="image/Figure_11.8_B18829.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.395.1">Figure 11.8 – The new build</span></p>
<ol>
<li value="9"><span class="koboSpan" id="kobo.396.1">You can also click on the number in </span><strong class="bold"><span class="koboSpan" id="kobo.397.1">Build History</span></strong><span class="koboSpan" id="kobo.398.1"> to go to the build to see more details, such as </span><strong class="bold"><span class="koboSpan" id="kobo.399.1">Console Output</span></strong><span class="koboSpan" id="kobo.400.1">, which shows the pipeline executing, the commands, and any errors that may have occurred, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.401.1">Figure 11</span></em></span><em class="italic"><span class="koboSpan" id="kobo.402.1">.9</span></em><span class="koboSpan" id="kobo.403.1">. </span><span class="koboSpan" id="kobo.403.2">Errors will be </span><a id="_idIndexMarker528"/><span class="koboSpan" id="kobo.404.1">very </span><a id="_idIndexMarker529"/><span class="koboSpan" id="kobo.405.1">obvious, indicated by the red </span><strong class="bold"><span class="koboSpan" id="kobo.406.1">X</span></strong><span class="koboSpan" id="kobo.407.1"> symbol in </span><strong class="bold"><span class="koboSpan" id="kobo.408.1">Console Output</span></strong><span class="koboSpan" id="kobo.409.1"> or next to the number in </span><strong class="bold"><span class="koboSpan" id="kobo.410.1">Build History</span></strong><span class="koboSpan" id="kobo.411.1">, or will be red at the stage it occurred in </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.412.1">Stage View</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.413.1">.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer277">
<span class="koboSpan" id="kobo.414.1"><img alt="Figure 11.9 – Console Output" src="image/Figure_11.9_B18829.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.415.1">Figure 11.9 – Console Output</span></p>
<ol>
<li value="10"><span class="koboSpan" id="kobo.416.1">Once the scan completes, you can review the results by clicking on the stage in </span><strong class="bold"><span class="koboSpan" id="kobo.417.1">Stage View</span></strong><span class="koboSpan" id="kobo.418.1"> and then </span><strong class="bold"><span class="koboSpan" id="kobo.419.1">Logs</span></strong><span class="koboSpan" id="kobo.420.1">, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.421.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.422.1">.10</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.423.1">.</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer278">
<span class="koboSpan" id="kobo.424.1"><img alt="Figure 11.10 – Logs" src="image/Figure_11.10_B18829.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.425.1">Figure 11.10 – Logs</span></p>
<p><span class="koboSpan" id="kobo.426.1">This view will show </span><a id="_idIndexMarker530"/><span class="koboSpan" id="kobo.427.1">you</span><a id="_idIndexMarker531"/><span class="koboSpan" id="kobo.428.1"> the details of the scan, where you can digest all the findings and see where in the URL these issues occurred (see </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.429.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.430.1">.11</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.431.1">).</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer279">
<span class="koboSpan" id="kobo.432.1"><img alt="Figure 11.11 – Stage Logs" src="image/Figure_11.11_B18829.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.433.1">Figure 11.11 – Stage Logs</span></p>
<p><span class="koboSpan" id="kobo.434.1">A successful build</span><a id="_idIndexMarker532"/><span class="koboSpan" id="kobo.435.1"> and </span><a id="_idIndexMarker533"/><span class="koboSpan" id="kobo.436.1">scan require a lot of trial and error with the pipeline setup, which necessitates reading pipeline errors or commenting out sections in </span><span class="No-Break"><span class="koboSpan" id="kobo.437.1">the script.</span></span></p>
<h2 id="_idParaDest-328"><a id="_idTextAnchor416"/><span class="koboSpan" id="kobo.438.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.439.1">The Jenkins pipeline is configured to run OWASP ZAP as a step in the build process. </span><span class="koboSpan" id="kobo.439.2">This can be done using a Jenkins plugin or by calling the OWASP ZAP </span><strong class="bold"><span class="koboSpan" id="kobo.440.1">command-line interface</span></strong><span class="koboSpan" id="kobo.441.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.442.1">CLI</span></strong><span class="koboSpan" id="kobo.443.1">) directly </span><a id="_idIndexMarker534"/><span class="koboSpan" id="kobo.444.1">from a Jenkins script. </span><span class="koboSpan" id="kobo.444.2">When the pipeline is executed, Jenkins triggers OWASP ZAP to run a security scan against the application being tested. </span><span class="koboSpan" id="kobo.444.3">OWASP ZAP will attempt to find any vulnerabilities in the application, such as SQLI flaws or </span><span class="No-Break"><span class="koboSpan" id="kobo.445.1">XSS vulnerabilities.</span></span></p>
<p><span class="koboSpan" id="kobo.446.1">OWASP ZAP then generates a report, detailing any vulnerabilities that were found, along with recommendations for how to fix them. </span><span class="koboSpan" id="kobo.446.2">This report can be automatically sent to the development team for review. </span><span class="koboSpan" id="kobo.446.3">If the security scan identifies any critical vulnerabilities, the Jenkins pipeline can be configured to fail the build, preventing the vulnerable code from being deployed </span><span class="No-Break"><span class="koboSpan" id="kobo.447.1">to production.</span></span></p>
<p><span class="koboSpan" id="kobo.448.1">Overall, integrating OWASP ZAP into a Jenkins pipeline helps automate the process of identifying and addressing security vulnerabilities in web applications, making the software development </span><a id="_idIndexMarker535"/><span class="koboSpan" id="kobo.449.1">process</span><a id="_idIndexMarker536"/><span class="koboSpan" id="kobo.450.1"> more efficient </span><span class="No-Break"><span class="koboSpan" id="kobo.451.1">and secure.</span></span></p>
<h2 id="_idParaDest-329"><a id="_idTextAnchor417"/><span class="koboSpan" id="kobo.452.1">There’s more…</span></h2>
<p><span class="koboSpan" id="kobo.453.1">The pipeline script is just an example of a simple way to scan a URL and see the results in the pipeline. </span><span class="koboSpan" id="kobo.453.2">With some more work with the script, you can generate reports and get these copied from the Docker container over to a directory of your choice. </span><span class="koboSpan" id="kobo.453.3">In addition, this pipeline build we have scripted will also create parameters that allow you to switch between the baseline scan and full scan as well as enter the URL of choice to be scanned, allowing you to build the pipeline quicker on </span><span class="No-Break"><span class="koboSpan" id="kobo.454.1">your applications.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.455.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.456.1">If, for some reason, your build is not scanning, check to see whether your Docker has stopped the container. </span><span class="koboSpan" id="kobo.456.2">If it hasn’t, you will need to do so before running the </span><span class="No-Break"><span class="koboSpan" id="kobo.457.1">build again.</span></span></p>
<h2 id="_idParaDest-330"><a id="_idTextAnchor418"/><span class="koboSpan" id="kobo.458.1">See also</span></h2>
<p><span class="koboSpan" id="kobo.459.1">For more details, see the following when running </span><span class="No-Break"><span class="koboSpan" id="kobo.460.1">Docker scans:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.461.1">For the baseline scan, </span><span class="No-Break"><span class="koboSpan" id="kobo.462.1">see </span></span><a href="https://www.zaproxy.org/docs/docker/baseline-scan/"><span class="No-Break"><span class="koboSpan" id="kobo.463.1">https://www.zaproxy.org/docs/docker/baseline-scan/</span></span></a></li>
<li><span class="koboSpan" id="kobo.464.1">For the full scan, </span><span class="No-Break"><span class="koboSpan" id="kobo.465.1">see </span></span><a href="https://www.zaproxy.org/docs/docker/full-scan/"><span class="No-Break"><span class="koboSpan" id="kobo.466.1">https://www.zaproxy.or</span><span id="_idTextAnchor419"/><span class="koboSpan" id="kobo.467.1">g/docs/docker/full-scan/</span></span></a></li>
</ul>
<h1 id="_idParaDest-331"><a id="_idTextAnchor420"/><span class="koboSpan" id="kobo.468.1">Installing, configuring, and running the ZAP GUI OAST server</span></h1>
<p><span class="koboSpan" id="kobo.469.1">The BOAST </span><a id="_idIndexMarker537"/><span class="koboSpan" id="kobo.470.1">server </span><a id="_idIndexMarker538"/><span class="koboSpan" id="kobo.471.1">was created to receive and report the results</span><a id="_idIndexMarker539"/><span class="koboSpan" id="kobo.472.1"> of out-of-band application security testing. </span><span class="koboSpan" id="kobo.472.2">Some application security tests only result in out-of-band responses from the applications being examined. </span><span class="koboSpan" id="kobo.472.3">Because of the nature of these specific use case scenarios, the requests won’t transmit as a response back to the attacker and won’t be seen when a client is hidden behind a third-party NAT. </span><span class="koboSpan" id="kobo.472.4">A different component is then required in order to properly perceive such responses. </span><span class="koboSpan" id="kobo.472.5">This component needs the ability to be freely accessed over the internet and communicate the received protocols and ports without being constrained by that </span><span class="No-Break"><span class="koboSpan" id="kobo.473.1">third-party NAT.</span></span></p>
<p><span class="koboSpan" id="kobo.474.1">In this recipe, we will walk you through how to install, configure, and test applications that require OOB, using the OWASP ZAP BOAST server, and how to install your own BOAST server </span><span class="No-Break"><span class="koboSpan" id="kobo.475.1">for testing.</span></span></p>
<h2 id="_idParaDest-332"><a id="_idTextAnchor421"/><span class="koboSpan" id="kobo.476.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.477.1">This recipe requires ZAP set up to intercept and send requests and responses between the BOAST server and the client application. </span><span class="koboSpan" id="kobo.477.2">The following tools will need to </span><span class="No-Break"><span class="koboSpan" id="kobo.478.1">be installed:</span></span></p>
<ul>
<li><span class="No-Break"><span class="koboSpan" id="kobo.479.1">Docker: </span></span><a href="https://www.docker.com/products/docker-desktop/"><span class="No-Break"><span class="koboSpan" id="kobo.480.1">https://www.docker.com/products/docker-desktop/</span></span></a></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.481.1">GoLang: </span></span><a href="https://go.dev/doc/install"><span class="No-Break"><span class="koboSpan" id="kobo.482.1">https://go.dev/doc/install</span></span></a></li>
</ul>
<h2 id="_idParaDest-333"><a id="_idTextAnchor422"/><span class="koboSpan" id="kobo.483.1">How to do it…</span></h2>
<p><span class="koboSpan" id="kobo.484.1">In this</span><a id="_idIndexMarker540"/><span class="koboSpan" id="kobo.485.1"> recipe, we’ll be </span><a id="_idIndexMarker541"/><span class="koboSpan" id="kobo.486.1">going</span><a id="_idIndexMarker542"/><span class="koboSpan" id="kobo.487.1"> through different techniques on how to install, configure, and run your own BOAST services to conduct </span><span class="No-Break"><span class="koboSpan" id="kobo.488.1">out-of-band attacks:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.489.1">First, in order to use the OAST server, you’ll need to download the add-on from ZAP Marketplace (see </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.490.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.491.1">.12</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.492.1">).</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer280">
<span class="koboSpan" id="kobo.493.1"><img alt="Figure 11.12 –  ZAP Marketplace" src="image/Figure_11.12_B18829.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.494.1">Figure 11.12 –  ZAP Marketplace</span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.495.1">Once installed, go to the </span><strong class="bold"><span class="koboSpan" id="kobo.496.1">Tools</span></strong><span class="koboSpan" id="kobo.497.1"> menu, and </span><span class="No-Break"><span class="koboSpan" id="kobo.498.1">select </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.499.1">Options</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.500.1">.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.501.1">Then, either go to </span><strong class="bold"><span class="koboSpan" id="kobo.502.1">Tools</span></strong><span class="koboSpan" id="kobo.503.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.504.1">Options…</span></strong><span class="koboSpan" id="kobo.505.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.506.1">OAST</span></strong><span class="koboSpan" id="kobo.507.1">, click on the gear icon in the main toolbar and click </span><strong class="bold"><span class="koboSpan" id="kobo.508.1">OAST</span></strong><span class="koboSpan" id="kobo.509.1">, or press </span><em class="italic"><span class="koboSpan" id="kobo.510.1">Ctrl</span></em><span class="koboSpan" id="kobo.511.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.512.1">Alt</span></em><span class="koboSpan" id="kobo.513.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.514.1">O</span></em><span class="koboSpan" id="kobo.515.1"> and then </span><span class="No-Break"><span class="koboSpan" id="kobo.516.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.517.1">OAST</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.518.1">.</span></span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.519.1">To view the </span><strong class="bold"><span class="koboSpan" id="kobo.520.1">OAST</span></strong><span class="koboSpan" id="kobo.521.1"> options, scroll down the tool </span><strong class="bold"><span class="koboSpan" id="kobo.522.1">Options</span></strong><span class="koboSpan" id="kobo.523.1"> menu until you see </span><strong class="bold"><span class="koboSpan" id="kobo.524.1">OAST</span></strong><span class="koboSpan" id="kobo.525.1"> (see </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.526.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.527.1">.13</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.528.1">).</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer281">
<span class="koboSpan" id="kobo.529.1"><img alt="Figure 11.13 – OWASP OAST options" src="image/Figure_11.13_B18829.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.530.1">Figure 11.13 – OWASP OAST options</span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.531.1">In the</span><a id="_idIndexMarker543"/><span class="koboSpan" id="kobo.532.1"> first</span><a id="_idIndexMarker544"/><span class="koboSpan" id="kobo.533.1"> setting </span><a id="_idIndexMarker545"/><span class="koboSpan" id="kobo.534.1">under </span><strong class="bold"><span class="koboSpan" id="kobo.535.1">General</span></strong><span class="koboSpan" id="kobo.536.1">, there’s a dropdown to select either </span><strong class="bold"><span class="koboSpan" id="kobo.537.1">BOAST</span></strong><span class="koboSpan" id="kobo.538.1"> or </span><strong class="bold"><span class="koboSpan" id="kobo.539.1">Interactsh</span></strong><span class="koboSpan" id="kobo.540.1">, and a checkbox next to </span><strong class="bold"><span class="koboSpan" id="kobo.541.1">Use </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.542.1">Permanent Database</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.543.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.544.1">Select </span><strong class="bold"><span class="koboSpan" id="kobo.545.1">BOAST</span></strong><span class="koboSpan" id="kobo.546.1"> from the dropdown and go to the </span><strong class="bold"><span class="koboSpan" id="kobo.547.1">BOAST</span></strong><span class="koboSpan" id="kobo.548.1"> tab in the </span><strong class="bold"><span class="koboSpan" id="kobo.549.1">OAST</span></strong><span class="koboSpan" id="kobo.550.1"> options screen. </span><strong class="bold"><span class="koboSpan" id="kobo.551.1">Permanent Database</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.552.1">is optional.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.553.1">By checking </span><strong class="bold"><span class="koboSpan" id="kobo.554.1">Use Permanent Database</span></strong><span class="koboSpan" id="kobo.555.1">, you can keep track of registered out-of-band payloads in ZAP’s permanent database. </span><span class="koboSpan" id="kobo.555.2">According to the predetermined polling period, the persisted payloads will be placed into memory and queried with other payloads. </span><span class="koboSpan" id="kobo.555.3">Currently, only the BOAST service is able to provide a </span><span class="No-Break"><span class="koboSpan" id="kobo.556.1">permanent database.</span></span></p>
<p><span class="koboSpan" id="kobo.557.1">Note that this means that alerts may show up during a ZAP session, even if they are not particularly or directly connected to the first analysis </span><span class="No-Break"><span class="koboSpan" id="kobo.558.1">or scan.</span></span></p>
<ol>
<li value="6"><span class="koboSpan" id="kobo.559.1">Enter a valid server URI or use the default one. </span><span class="koboSpan" id="kobo.559.2">The URI that will be used for registration and polling should be pointed at by </span><span class="No-Break"><span class="koboSpan" id="kobo.560.1">this address:</span></span></li>
</ol>
<p><a href="https://odiss.eu:1337/events"><span class="No-Break"><span class="koboSpan" id="kobo.561.1">https://odiss.eu:1337/events</span></span></a></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.562.1">The scheme, the host, the port, and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.563.1">/events</span></strong><span class="koboSpan" id="kobo.564.1"> endpoint are all required components of a valid URI. </span><span class="koboSpan" id="kobo.564.2">A functional BOAST instance must be running on </span><span class="No-Break"><span class="koboSpan" id="kobo.565.1">the host.</span></span></li>
<li><span class="koboSpan" id="kobo.566.1">Select a polling interval. </span><span class="koboSpan" id="kobo.566.2">This is the frequency of polling for the registered BOAST servers. </span><span class="koboSpan" id="kobo.566.3">Values</span><a id="_idIndexMarker546"/><span class="koboSpan" id="kobo.567.1"> are </span><a id="_idIndexMarker547"/><span class="koboSpan" id="kobo.568.1">taken </span><a id="_idIndexMarker548"/><span class="koboSpan" id="kobo.569.1">in seconds. </span><span class="koboSpan" id="kobo.569.2">There is no maximum permissible value but a minimum of 10 seconds is required. </span><span class="koboSpan" id="kobo.569.3">The 60-second setting is </span><span class="No-Break"><span class="koboSpan" id="kobo.570.1">the default.</span></span></li>
<li><span class="koboSpan" id="kobo.571.1">Click on </span><strong class="bold"><span class="koboSpan" id="kobo.572.1">Register</span></strong><span class="koboSpan" id="kobo.573.1"> and a new entry for the payload and canary will be added to the </span><strong class="bold"><span class="koboSpan" id="kobo.574.1">Active Servers</span></strong><span class="koboSpan" id="kobo.575.1"> table. </span><span class="koboSpan" id="kobo.575.2">Copy this payload to use it in </span><span class="No-Break"><span class="koboSpan" id="kobo.576.1">your attacks.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.577.1">When a request is made to the appropriate payload address, a random string known as the Canary value is returned to the destination </span><span class="No-Break"><span class="koboSpan" id="kobo.578.1">web application.</span></span></p>
<ol>
<li value="10"><span class="koboSpan" id="kobo.579.1">Next, to test that the BOAST payload is working, open up a command-line terminal and curl the request of the URI given (see </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.580.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.581.1">.4</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.582.1">):</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.583.1">curl ij6azkfsiavavsmrjqpmj3pq54.odiss.eu</span></strong></pre></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer282">
<span class="koboSpan" id="kobo.584.1"><img alt="Figure 11.14 – A curl request" src="image/Figure_11.14_B18829.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.585.1">Figure 11.14 – A curl request</span></p>
<ol>
<li value="11"><span class="koboSpan" id="kobo.586.1">ZAP will now poll this server at the frequency you set and report all interactions (DNS, HTTP, etc.) To view the payload URI, open the </span><strong class="bold"><span class="koboSpan" id="kobo.587.1">OAST</span></strong><span class="koboSpan" id="kobo.588.1"> tab in the informational window, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.589.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.590.1">.5</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.591.1">:</span></span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer283">
<span class="koboSpan" id="kobo.592.1"><img alt="Figure 11.15 – BOAST" src="image/Figure_11.15_B18829.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.593.1">Figure 11.15 – BOAST</span></p>
<p><span class="koboSpan" id="kobo.594.1">We can also send </span><a id="_idIndexMarker549"/><span class="koboSpan" id="kobo.595.1">some other data via curl to see what is captured in our </span><span class="No-Break"><span class="koboSpan" id="kobo.596.1">OAST polling.</span></span></p>
<ol>
<li value="12"><span class="koboSpan" id="kobo.597.1">Here is an </span><a id="_idIndexMarker550"/><span class="koboSpan" id="kobo.598.1">example </span><a id="_idIndexMarker551"/><span class="koboSpan" id="kobo.599.1">of a curl request that sends a </span><strong class="bold"><span class="koboSpan" id="kobo.600.1">POST</span></strong><span class="koboSpan" id="kobo.601.1"> request with a simple header and </span><span class="No-Break"><span class="koboSpan" id="kobo.602.1">no data:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.603.1">curl -X POST -H "Content-Type: application/json" ij6azkfsiavavsmrjqpmj3pq54.odiss.eu</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.604.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.605.1">-X</span></strong><span class="koboSpan" id="kobo.606.1"> flag specifies the HTTP method to use – in this case, </span><strong class="source-inline"><span class="koboSpan" id="kobo.607.1">POST</span></strong><span class="koboSpan" id="kobo.608.1">. </span><span class="koboSpan" id="kobo.608.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.609.1">-H</span></strong><span class="koboSpan" id="kobo.610.1"> flag is used to set a custom header – in this case, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.611.1">Content-Type</span></strong><span class="koboSpan" id="kobo.612.1"> header is set to </span><strong class="source-inline"><span class="koboSpan" id="kobo.613.1">application/json</span></strong><span class="koboSpan" id="kobo.614.1"> to indicate that the request body contains JSON data. </span><span class="koboSpan" id="kobo.614.2">You can also use </span><strong class="source-inline"><span class="koboSpan" id="kobo.615.1">--data</span></strong><span class="koboSpan" id="kobo.616.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.617.1">-d flag</span></strong><span class="koboSpan" id="kobo.618.1"> to include a request body in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.619.1">POST</span></strong><span class="koboSpan" id="kobo.620.1"> request, </span><span class="No-Break"><span class="koboSpan" id="kobo.621.1">for example:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.622.1">
curl -X POST -H "Content-Type: application/json" -d '{"key": "value"}' secret.ij6azkfsiavavsmrjqpmj3pq54.odiss.eu</span></pre>
<p><span class="koboSpan" id="kobo.623.1">This sends a </span><strong class="bold"><span class="koboSpan" id="kobo.624.1">POST</span></strong><span class="koboSpan" id="kobo.625.1"> request with a JSON-encoded request body containing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.626.1">{"key": "value"}</span></strong><span class="koboSpan" id="kobo.627.1"> data, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.628.1">Figure 11</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.629.1">.6</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.630.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer284">
<span class="koboSpan" id="kobo.631.1"><img alt="Figure 11.16 – An example curl request with a secret" src="image/Figure_11.16_B18829.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.632.1">Figure 11.16 – An example curl request with a secret</span></p>
<h2 id="_idParaDest-334"><a id="_idTextAnchor423"/><span class="koboSpan" id="kobo.633.1">How it works…</span></h2>
<p><span class="koboSpan" id="kobo.634.1">An out-of-band attack occurs when an attacker utilizes a different communication route than the one the victim is using. </span><span class="koboSpan" id="kobo.634.2">This makes it simpler for the attacker to access sensitive data or systems, since it enables them to get over any security measures that might be in place on the main </span><span class="No-Break"><span class="koboSpan" id="kobo.635.1">communication route.</span></span></p>
<p><span class="koboSpan" id="kobo.636.1">There are several</span><a id="_idIndexMarker552"/><span class="koboSpan" id="kobo.637.1"> techniques</span><a id="_idIndexMarker553"/><span class="koboSpan" id="kobo.638.1"> to </span><a id="_idIndexMarker554"/><span class="koboSpan" id="kobo.639.1">conduct out-of-band exploits. </span><span class="koboSpan" id="kobo.639.2">An attacker may, for instance, send a target a phishing email that tempts them to click on a link that installs malware on their machine. </span><span class="koboSpan" id="kobo.639.3">The virus might then be used to access the victim’s machine, giving the attacker access to take advantage of it to disrupt operations or steal </span><span class="No-Break"><span class="koboSpan" id="kobo.640.1">important data.</span></span></p>
<p><span class="koboSpan" id="kobo.641.1">Another technique would be for an attacker to utilize a different communication channel to manage malware that has already been placed on a victim’s machine. </span><span class="koboSpan" id="kobo.641.2">For instance, the attacker may order the virus to do a certain action, such as deleting files or encrypting data for ransom, through a different channel, such as a phone call or </span><span class="No-Break"><span class="koboSpan" id="kobo.642.1">text message.</span></span></p>
<p><span class="koboSpan" id="kobo.643.1">In general, because out-of-band attacks employ a different communication route than the one that is being defended, they can be challenging to identify and stop. </span><span class="koboSpan" id="kobo.643.2">People and organizations should be aware of the dangers presented by these assaults and take precautions to protect themselves. </span><span class="koboSpan" id="kobo.643.3">This can entail creating secure passwords, setting up security software, keeping it updated, and exercising caution when opening links or downloading things from </span><span class="No-Break"><span class="koboSpan" id="kobo.644.1">untrusted sources.</span></span></p>
<h2 id="_idParaDest-335"><a id="_idTextAnchor424"/><span class="koboSpan" id="kobo.645.1">There’s more…</span></h2>
<p><span class="koboSpan" id="kobo.646.1">These types of flaws are extremely delicate and important to secure for a company, since malicious actors can take advantage of them. </span><span class="koboSpan" id="kobo.646.2">They are primarily seen in REST APIs and </span><span class="No-Break"><span class="koboSpan" id="kobo.647.1">web applications.</span></span></p>
<p><span class="koboSpan" id="kobo.648.1">Here are a few examples of </span><span class="No-Break"><span class="koboSpan" id="kobo.649.1">OOB attacks:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.650.1">Blind server-side XML/SOAP injection</span></strong><span class="koboSpan" id="kobo.651.1">: Similar to SQLI, an attacker sends </span><a id="_idIndexMarker555"/><span class="koboSpan" id="kobo.652.1">XML or SOAP requests to a server with the intent of manipulating the server’s behavior, potentially reading or modifying data, executing arbitrary code, or launching other attacks, and the attack is “blind” because the attacker receives no immediate feedback about the success of </span><span class="No-Break"><span class="koboSpan" id="kobo.653.1">the attack.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.654.1">Blind XSS (delayed XSS)</span></strong><span class="koboSpan" id="kobo.655.1">: A covert and difficult-to-detect assault that allows an attacker to inject malicious code into a website and wait for someone else to initiate the attack by visiting the compromised web page, possibly stealing personal information or seizing control of the </span><span class="No-Break"><span class="koboSpan" id="kobo.656.1">victim’s browser.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.657.1">Host header attack</span></strong><span class="koboSpan" id="kobo.658.1">: Manipulation of the host header in an HTTP request to deceive a web server into running malicious code or providing sensitive information, potentially allowing the attacker to take control of the server or reveal </span><span class="No-Break"><span class="koboSpan" id="kobo.659.1">sensitive information.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.660.1">Out-of-Band Remote Code Execution (OOB RCE)</span></strong><span class="koboSpan" id="kobo.661.1">: An attack that lets an attacker run arbitrary code on a target system by delivering the code and receiving the results over a separate communication channel, possibly revealing sensitive information or allowing the attacker to seize control of </span><span class="No-Break"><span class="koboSpan" id="kobo.662.1">the system.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.663.1">Out-of-Band SQL Injection (OOB SQLI)</span></strong><span class="koboSpan" id="kobo.664.1">: An SQLI attack in which an attacker executes arbitrary SQL instructions on a target database by leveraging a separate communication channel to send the commands and receive the results, possibly exposing sensitive information or allowing the attacker to gain control of </span><span class="No-Break"><span class="koboSpan" id="kobo.665.1">the database.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.666.1">Email header injection</span></strong><span class="koboSpan" id="kobo.667.1">: Injecting harmful code into the headers of an email message in order to manipulate the behavior of the email client or server, perhaps misleading the victim into submitting sensitive information or </span><span class="No-Break"><span class="koboSpan" id="kobo.668.1">downloading malware.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.669.1">Server-Side Request Forgery (SSRF)</span></strong><span class="koboSpan" id="kobo.670.1">: An attack in which an attacker sends arbitrary requests from a susceptible server to other servers, resources, or services on the network, possibly revealing sensitive information or allowing the attacker to launch </span><span class="No-Break"><span class="koboSpan" id="kobo.671.1">more attacks.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.672.1">XML External Entity (XXE) injection</span></strong><span class="koboSpan" id="kobo.673.1">: An attack that uses an XML parser vulnerability to </span><a id="_idIndexMarker556"/><span class="koboSpan" id="kobo.674.1">access files or execute arbitrary code on a target system, possibly revealing sensitive information or allowing the attacker to take control of </span><span class="No-Break"><span class="koboSpan" id="kobo.675.1">the machine.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.676.1">OS code injection – OOB</span></strong><span class="koboSpan" id="kobo.677.1">: An attack that enables an attacker to execute arbitrary system instructions on a target system by injecting the commands into a susceptible application, possibly exposing sensitive information or granting the attacker control of </span><span class="No-Break"><span class="koboSpan" id="kobo.678.1">the system.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.679.1">XXE – OOB</span></strong><span class="koboSpan" id="kobo.680.1">: A version of the XXE attack in which the results of the XXE assault</span><a id="_idIndexMarker557"/><span class="koboSpan" id="kobo.681.1"> are sent OOB over a different communication route than the one being abused, possibly allowing the attacker to obtain sensitive information or take control of the system without </span><span class="No-Break"><span class="koboSpan" id="kobo.682.1">being detected.</span></span></li>
</ul>
<p class="callout-heading"><span class="koboSpan" id="kobo.683.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.684.1">A new Extender script template called </span><strong class="source-inline"><span class="koboSpan" id="kobo.685.1">OAST Request Handler.js</span></strong><span class="koboSpan" id="kobo.686.1"> is introduced to ZAP if the </span><em class="italic"><span class="koboSpan" id="kobo.687.1">Script Console</span></em><span class="koboSpan" id="kobo.688.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.689.1">GraalVM JavaScript</span></em><span class="koboSpan" id="kobo.690.1"> add-ons are both installed. </span><span class="koboSpan" id="kobo.690.2">This template can be used to develop a script that executes a command whenever an OOB request is found. </span><span class="koboSpan" id="kobo.690.3">This action might be anything, such as running another ZAP script or sending yourself </span><span class="No-Break"><span class="koboSpan" id="kobo.691.1">an email.</span></span></p>
<h2 id="_idParaDest-336"><a id="_idTextAnchor425"/><span class="koboSpan" id="kobo.692.1">See also</span></h2>
<p><span class="koboSpan" id="kobo.693.1">There are a few other online services that allow us to interact with OOB attacks, such as </span><span class="No-Break"><span class="koboSpan" id="kobo.694.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.695.1">Free web GUI </span><span class="No-Break"><span class="koboSpan" id="kobo.696.1">Interactsh: </span></span><a href="https://app.interactsh.com/#/"><span class="No-Break"><span class="koboSpan" id="kobo.697.1">https://app.interactsh.com/#/</span></span></a></li>
<li><span class="koboSpan" id="kobo.698.1">For ZAP extensions, </span><span class="No-Break"><span class="koboSpan" id="kobo.699.1">see </span></span><a href="https://github.com/zaproxy/zap-extensions"><span class="No-Break"><span class="koboSpan" id="kobo.700.1">https://github.com/zaproxy/zap-extensions</span></span></a></li>
</ul>
</div>
</body></html>